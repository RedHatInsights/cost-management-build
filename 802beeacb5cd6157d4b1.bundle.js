(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[2340],{66785:(e,t,r)=>{"use strict";r.d(t,{T:()=>a});var s=r(43702);function a(e){return(0,s.stringify)(e,{encode:!1,indices:!1})}},96924:(e,t,r)=>{"use strict";r.d(t,{X:()=>p});var s=r(11762),a=r(97522),o=r.n(a),c=r(79878);const i={perspectiveSelector:{display:"flex",alignItems:"center"},perspectiveLabel:{marginBottom:0,marginRight:r(32412).ZP.var}};class n extends o().Component{constructor(){super(...arguments),this.defaultState={isPerspectiveOpen:!1},this.state=Object.assign({},this.defaultState),this.getDropDownItems=()=>{const{options:e,t}=this.props;return e.map((e=>o().createElement(s.DropdownItem,{component:"button",key:e.value,onClick:()=>this.handleClick(e.value)},t(e.label))))},this.getCurrentLabel=()=>{const{currentItem:e,options:t,t:r}=this.props;let s="";for(const a of t)if(e===a.value){s=r(a.label);break}return s},this.handleClick=e=>{const{onItemClicked:t}=this.props;t&&t(e)},this.handleSelect=()=>{this.setState({isPerspectiveOpen:!this.state.isPerspectiveOpen})},this.handleToggle=e=>{this.setState({isPerspectiveOpen:e})}}render(){const{isDisabled:e,t}=this.props,{isPerspectiveOpen:r}=this.state,a=this.getDropDownItems();return o().createElement("div",{style:i.perspectiveSelector},o().createElement("label",{style:i.perspectiveLabel},t("overview.perspective.label")),o().createElement(s.Dropdown,{onSelect:this.handleSelect,toggle:o().createElement(s.DropdownToggle,{isDisabled:e,onToggle:this.handleToggle},this.getCurrentLabel()),isOpen:r,dropdownItems:a}))}}const p=(0,c.withTranslation)()(n)},93509:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>gt});var s=r(11762),a=r(55795),o=r(86208),c=r(66785),i=r(73466),n=r(64146),p=r(13883),l=r(96924),u=r(97522),h=r.n(u);const d=({DashboardWidget:e,selectWidgets:t,widgets:r})=>h().createElement("div",null,h().createElement(s.Grid,{hasGutter:!0},r.map((r=>t[r].details.showHorizontal?h().createElement(s.GridItem,{sm:12,key:r},h().createElement(e,{widgetId:r})):h().createElement(s.GridItem,{lg:12,xl:6,xl2:4,key:r},h().createElement(e,{widgetId:r}))))));var g=r(79878),v=r(86588),b=r(94377),m=r(37062),y=r(95078),T=r(60232),f=r(71878),w=r(36234),R=r(17230),P=r(55399),F=r(901);class C extends h().Component{constructor(){super(...arguments),this.defaultState={isChartComparisonOpen:!1},this.state=Object.assign({},this.defaultState),this.getDropDownItems=()=>{const{options:e,t}=this.props;return e.map((e=>h().createElement(s.DropdownItem,{component:"button",key:e.value,onClick:()=>this.handleClick(e.value)},t(e.label))))},this.getCurrentLabel=()=>{const{currentItem:e,options:t,t:r}=this.props;let s="";for(const a of t)if(e===a.value){s=r(a.label);break}return s},this.handleClick=e=>{const{onItemClicked:t}=this.props;t&&t(e)},this.handleSelect=()=>{this.setState({isChartComparisonOpen:!this.state.isChartComparisonOpen})},this.handleToggle=e=>{this.setState({isChartComparisonOpen:e})}}render(){const{isChartComparisonOpen:e}=this.state,t=this.getDropDownItems();return h().createElement(s.Dropdown,{onSelect:this.handleSelect,toggle:h().createElement(s.DropdownToggle,{onToggle:this.handleToggle},this.getCurrentLabel()),isOpen:e,dropdownItems:t})}}const S=(0,g.withTranslation)()(C);var D=r(91707),I=r(32412),E=r(57640);const A={chartAltHeight:250,chartHeight:180,containerAltHeight:250,containerTrendHeight:180,containerUsageHeight:180},O={comparison:{marginBottom:I.ZP.value},tabs:{marginTop:D.ZP.value},tabItems:{marginTop:E.ZP.value}};class _ extends h().Component{constructor(){super(...arguments),this.state={activeTabKey:0,currentComparison:"cumulative"},this.buildDetailsLink=e=>{const{details:t,getIdKeyForTab:r}=this.props,s=r(e);return`${t.viewAllPath}?${(0,y.pm)({group_by:{[s]:"*"},order_by:{cost:"desc"}})}`},this.getChart=(e,t,r=!1)=>{const{chartType:s,trend:a}=this.props;return"dailyTrend"===s?this.getDailyTrendChart(e,t,r,a.showSupplementaryLabel):"dailyCost"===s?this.getDailyCostChart(e,t,r):"trend"===s?this.getTrendChart(e,t,r,a.showSupplementaryLabel):"usage"===s?this.getUsageChart(t,r):null},this.getChartComparison=()=>{const{t:e,trend:t}=this.props,{currentComparison:r}=this.state,s=this.getUnits(),a=e(t.titleKey,{units:e(`units.${s}`)}),o=[{label:e(t.dailyTitleKey,{units:e(`units.${s}`)}),value:"daily"},{label:a,value:"cumulative"}];return h().createElement(S,{currentItem:r||o[0].value,onItemClicked:this.handleComparisonClick,options:o})},this.getDailyCostChart=(e,t,r=!1)=>{const{currentReport:s,previousReport:a,trend:o}=this.props,{currentComparison:c}=this.state,i=o.computedReportItem,n=o.computedReportItemValue,p="daily"===c,l=p?1:o.type,u=(0,T.zJ)(s,l,"date","infrastructure",n),d=(0,T.zJ)(a,l,"date","infrastructure",n),g=(0,T.zJ)(s,l,"date",i,n),v=(0,T.zJ)(a,l,"date",i,n),b=this.getForecastData(s,o.computedForecastItem),m=this.getForecastData(s,o.computedForecastInfrastructureItem),y=p?f.V3:f.me;return h().createElement(h().Fragment,null,h().createElement("div",{style:O.comparison},this.getChartComparison()),h().createElement(y,{adjustContainerHeight:r,containerHeight:e,currentCostData:g,currentInfrastructureCostData:u,forecastConeData:b.forecastConeData,forecastData:b.forecastData,forecastInfrastructureConeData:m.forecastConeData,forecastInfrastructureData:m.forecastData,formatDatumValue:F.Bw,formatDatumOptions:o.formatOptions,height:t,previousCostData:v,previousInfrastructureCostData:d,showForecast:void 0!==o.computedForecastItem}))},this.getDailyTrendChart=(e,t,r=!1,s=!1)=>{const{currentReport:a,details:o,previousReport:c,trend:i}=this.props,{currentComparison:n}=this.state,p=this.getUnits(),l=i.computedReportItem,u=i.computedReportItemValue,d="daily"===n,g=d?1:i.type,v=(0,T.zJ)(a,g,"date",l,u),b=(0,T.zJ)(c,g,"date",l,u),{forecastData:m,forecastConeData:y}=this.getForecastData(a,i.computedForecastItem),w=d?f.Y0:f.Nd;return h().createElement(h().Fragment,null,h().createElement("div",{style:O.comparison},this.getChartComparison()),h().createElement(w,{adjustContainerHeight:r,containerHeight:e,currentData:v,forecastData:m,forecastConeData:y,formatDatumValue:F.Bw,formatDatumOptions:i.formatOptions,height:t,previousData:b,showForecast:void 0!==i.computedForecastItem,showSupplementaryLabel:s,showUsageLegendLabel:o.showUsageLegendLabel,units:p}))},this.getForecastData=(e,t="cost")=>{const{forecast:r,trend:s}=this.props,{currentComparison:a}=this.state,o="daily"===a?1:s.type;let c,i;if(t){const s=(0,R.cloneDeep)(r);if(s&&(s.data=[]),r&&e&&e.data){const a=e.meta&&e.meta.total&&e.meta.total[t]?e.meta.total[t].total.value:0,c=e.data.filter((e=>e.values.length)),i=c[c.length-1]?c[c.length-1].date:void 0;if(r&&r.data){const e=new Date(i),t=e.getMonth()+1;for(const a of r.data){const r=new Date(a.date),o=r.getMonth()+1;r>e&&t===o&&s.data.push(a)}}0===o&&s.data.unshift({date:i,values:[{date:i,cost:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:"USD"}},infrastructure:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:"USD"}},supplementary:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:"USD"}}}]})}c=(0,T.nB)(s,o,t),i=(0,T.Qw)(s,o,t)}return{forecastData:c,forecastConeData:i}},this.getTrendChart=(e,t,r=!1,s=!1)=>{const{currentReport:a,details:o,previousReport:c,t:i,trend:n}=this.props,p=this.getUnits(),l=i(n.titleKey,{units:i(`units.${p}`)}),u=n.computedReportItem,d=n.computedReportItemValue,g=(0,T.zJ)(a,n.type,"date",u,d),v=(0,T.zJ)(c,n.type,"date",u,d),{forecastData:b,forecastConeData:m}=this.getForecastData(a,n.computedForecastItem);return h().createElement(f.Nd,{adjustContainerHeight:r,containerHeight:e,currentData:g,forecastData:b,forecastConeData:m,formatDatumValue:F.Bw,formatDatumOptions:n.formatOptions,height:t,previousData:v,showForecast:void 0!==n.computedForecastItem,showSupplementaryLabel:s,showUsageLegendLabel:o.showUsageLegendLabel,title:l,units:p})},this.getUsageChart=(e,t=!1)=>{const{currentReport:r,previousReport:s,t:a,trend:o}=this.props,c=this.getUnits(),i=a(o.titleKey,{units:a(`units.${c}`)}),n=(0,T.zJ)(r,o.type,"date","request"),p=(0,T.zJ)(s,o.type,"date","request"),l=(0,T.zJ)(r,o.type,"date","usage"),u=(0,T.zJ)(s,o.type,"date","usage");return h().createElement(f.I0,{adjustContainerHeight:t,containerHeight:A.containerUsageHeight,currentRequestData:n,currentUsageData:l,formatDatumValue:F.Bw,formatDatumOptions:o.formatOptions,height:e,previousRequestData:p,previousUsageData:u,title:i})},this.getDetails=()=>{const{chartType:e,currentReport:t,details:r,reportType:s,trend:a}=this.props,o=a.computedReportItem||"cost",c=a.computedReportItemValue||"total",i=this.getUnits();return h().createElement(f.rN,{chartType:e,computedReportItem:o,computedReportItemValue:c,costLabel:this.getDetailsLabel(r.costKey,i),formatOptions:r.formatOptions,formatValue:F.Bw,report:t,reportType:s,requestLabel:this.getDetailsLabel(r.requestKey,i),showTooltip:r.showTooltip,showUnits:r.showUnits,showUsageFirst:r.showUsageFirst,units:r.units,usageFormatOptions:r.usageFormatOptions,usageLabel:this.getDetailsLabel(r.usageKey,i)})},this.getDetailsLabel=(e,t)=>{const{t:r}=this.props;return e?r(e,{units:r(`units.${t}`)}):void 0},this.getDetailsLink=()=>{const{currentTab:e,details:t}=this.props;return t.viewAllPath?h().createElement(P.Link,{to:this.buildDetailsLink(e),onClick:this.handleInsightsNavClick},this.getDetailsLinkTitle(e)):null},this.getDetailsLinkTitle=e=>{const{getIdKeyForTab:t,t:r}=this.props;return r("group_by.all",{groupBy:t(e)||""})},this.getHorizontalLayout=()=>{const{containerAltHeight:e=A.containerAltHeight,chartAltHeight:t=A.chartAltHeight,currentReportFetchStatus:r,details:s}=this.props;return h().createElement(f.j0,{detailsLink:this.getDetailsLink(),status:r,subTitle:this.getSubTitle(),tabs:this.getTabs(),title:this.getTitle()},this.getDetails(),this.getChart(e,t,s.adjustContainerHeight))},this.getSubTitle=()=>{const{t:e}=this.props,t=new Date,r=(0,w.getMonth)(t),s=(0,w.format)(t,"d"),a=(0,w.format)((0,w.startOfMonth)(t),"d");return e("dashboard.widget_subtitle",{count:(0,w.getDate)(t),endDate:s,month:r,startDate:a})},this.getTab=(e,t)=>{const{getIdKeyForTab:r,tabsReport:a,tabsReportFetchStatus:o}=this.props,c=r(e);return h().createElement(s.Tab,{eventKey:t,key:`${r(e)}-tab`,title:h().createElement(s.TabTitleText,null,this.getTabTitle(e))},h().createElement("div",{style:O.tabItems},h().createElement(f.mZ,{idKey:c,key:`${c}-items`,report:a,status:o},(({items:t})=>t.map((t=>this.getTabItem(e,t)))))))},this.getTabItem=(e,t)=>{const{availableTabs:r,details:s,getIdKeyForTab:a,tabsReport:o,topItems:c,trend:i}=this.props,{activeTabKey:n}=this.state,p=a(e),l=a(r[n]),u=i.computedReportItem||"cost",d=i.computedReportItemValue||"total";let g;const v=o&&o.meta&&o.meta.total;return"usage"===u?v&&o.meta.total.usage&&(g=o.meta.total.usage.value):v&&o.meta.total[u]&&o.meta.total[u][d]&&(g=o.meta.total[u][d].value),l===p?h().createElement(f.EH,{key:`${t.id}-item`,formatOptions:c.formatOptions,formatValue:F.Bw,label:t.label?t.label.toString():"",totalValue:g,units:s.units?s.units:this.getUnits(),value:t[u][d].value}):null},this.getTabs=()=>{const{availableTabs:e}=this.props;return h().createElement(s.Tabs,{isFilled:!0,activeKey:this.state.activeTabKey,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e,t))))},this.getTabTitle=e=>{const{getIdKeyForTab:t,t:r}=this.props;return r("group_by.top",{groupBy:t(e)||""})},this.getTitle=()=>{const{t:e,titleKey:t}=this.props,r=new Date,s=(0,w.getMonth)(r);return e(t,{endDate:(0,w.format)(r,"Do"),month:s,startDate:(0,w.format)((0,w.startOfMonth)(r),"Do")})},this.getUnits=()=>{const{currentReport:e,details:t,trend:r}=this.props,s=r.computedReportItem||"cost",a=r.computedReportItemValue||"total";if(t.units)return t.units;let o;const c=e&&e.meta&&e.meta.total;return o="usage"===s?c&&e.meta.total.usage?(0,F.dM)(e.meta.total.usage.units):"":c&&e.meta.total[s]&&e.meta.total[s][a]?(0,F.dM)(e.meta.total[s][a].units):"",o},this.getVerticalLayout=()=>{const{availableTabs:e,currentReportFetchStatus:t,details:r}=this.props;return h().createElement(f.iu,{detailsLink:this.getDetailsLink(),status:t,subTitle:this.getSubTitle(),title:this.getTitle()},this.getDetails(),this.getChart(A.containerTrendHeight,A.chartHeight,r.adjustContainerHeight),Boolean(e)&&h().createElement("div",{style:O.tabs},this.getTabs()))},this.handleComparisonClick=e=>{this.setState({currentComparison:e})},this.handleInsightsNavClick=()=>{const{details:e}=this.props;e.appNavId&&insights.chrome.appNavClick({id:e.appNavId,secondaryNav:!0})},this.handleTabClick=(e,t)=>{const{availableTabs:r,id:s,updateTab:a}=this.props;a(s,r[t]),this.setState({activeTabKey:t})}}componentDidMount(){const{availableTabs:e,fetchForecasts:t,fetchReports:r,id:s,trend:a,updateTab:o,widgetId:c}=this.props;e&&o(s,e[0]),r&&r(c),void 0!==a.computedForecastItem&&t(c)}render(){const{details:e}=this.props;return e.showHorizontal?this.getHorizontalLayout():this.getVerticalLayout()}}var V=r(26335),j=r(90203);const W=e=>{switch(e){case"services":return"service";case"accounts":return"account";case"regions":return"region";case"instance_type":return"instance_type"}},Z=(0,b.X1)(((e,{widgetId:t})=>{const r=m.jh.selectWidget(e,t),s=m.jh.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:W,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Q={fetchForecasts:m.k4.v4,fetchReports:m.k4.a4,updateTab:m.k4.as},k=(0,g.withTranslation)()((0,v.connect)(Z,Q)(_)),L=(0,b.X1)(((e,t)=>({DashboardWidget:k,selectWidgets:m.jh.selectWidgets(e),widgets:m.jh.selectCurrentWidgets(e)}))),U=(0,g.withTranslation)()((0,v.connect)(L,{})(d));var z=r(67119);const K=e=>{switch(e){case"services":return"service";case"accounts":return"account";case"regions":return"region";case"instance_type":return"instance_type"}},H=(0,b.X1)(((e,{widgetId:t})=>{const r=z.Cv.selectWidget(e,t),s=z.Cv.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:K,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),X={fetchForecasts:z.Kf.v4,fetchReports:z.Kf.a4,updateTab:z.Kf.as},J=(0,g.withTranslation)()((0,v.connect)(H,X)(_)),x=(0,b.X1)(((e,t)=>({DashboardWidget:J,selectWidgets:z.Cv.selectWidgets(e),widgets:z.Cv.selectCurrentWidgets(e)}))),B=(0,g.withTranslation)()((0,v.connect)(x,{})(d));var $=r(49016);const N=e=>{switch(e){case"service_names":return"service_name";case"subscription_guids":return"subscription_guid";case"resource_locations":return"resource_location";case"instance_type":return"instance_type"}},q=(0,b.X1)(((e,{widgetId:t})=>{const r=$.$I.selectWidget(e,t),s=$.$I.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:N,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),G={fetchForecasts:$._S.v4,fetchReports:$._S.a4,updateTab:$._S.as},M=(0,g.withTranslation)()((0,v.connect)(q,G)(_)),Y=(0,b.X1)(((e,t)=>({DashboardWidget:M,selectWidgets:$.$I.selectWidgets(e),widgets:$.$I.selectCurrentWidgets(e)}))),ee=(0,g.withTranslation)()((0,v.connect)(Y,{})(d));var te=r(31554);const re=e=>{switch(e){case"service_names":return"service_name";case"subscription_guids":return"subscription_guid";case"resource_locations":return"resource_location";case"instance_type":return"instance_type"}},se=(0,b.X1)(((e,{widgetId:t})=>{const r=te.rj.selectWidget(e,t),s=te.rj.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:re,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),ae={fetchForecasts:te.oc.v4,fetchReports:te.oc.a4,updateTab:te.oc.as},oe=(0,g.withTranslation)()((0,v.connect)(se,ae)(_)),ce=(0,b.X1)(((e,t)=>({DashboardWidget:oe,selectWidgets:te.rj.selectWidgets(e),widgets:te.rj.selectCurrentWidgets(e)}))),ie=(0,g.withTranslation)()((0,v.connect)(ce,{})(d));var ne=r(79522);const pe=e=>{switch(e){case"services":return"service";case"projects":return"project";case"regions":return"region";case"instance_type":return"instance_type"}},le=(0,b.X1)(((e,{widgetId:t})=>{const r=ne.oS.selectWidget(e,t),s=ne.oS.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:pe,currentQuery:s.current,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),ue={fetchForecasts:ne.n5.v4,fetchReports:ne.n5.a4,updateTab:ne.n5.as},he=(0,g.withTranslation)()((0,v.connect)(le,ue)(_)),de=(0,b.X1)(((e,t)=>({DashboardWidget:he,selectWidgets:ne.oS.selectWidgets(e),widgets:ne.oS.selectCurrentWidgets(e)}))),ge=(0,g.withTranslation)()((0,v.connect)(de,{})(d));var ve=r(75836);const be=e=>{switch(e){case"services":return"service";case"projects":return"project";case"regions":return"region";case"instance_type":return"instance_type"}},me=(0,b.X1)(((e,{widgetId:t})=>{const r=ve.Pi.selectWidget(e,t),s=ve.Pi.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:be,currentQuery:s.current,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),ye={fetchForecasts:ve.lj.v4,fetchReports:ve.lj.a4,updateTab:ve.lj.as},Te=(0,g.withTranslation)()((0,v.connect)(me,ye)(_)),fe=(0,b.X1)(((e,t)=>({DashboardWidget:Te,selectWidgets:ve.Pi.selectWidgets(e),widgets:ve.Pi.selectCurrentWidgets(e)}))),we=(0,g.withTranslation)()((0,v.connect)(fe,{})(d));var Re=r(83123);const Pe=e=>{switch(e){case"accounts":return"account";case"regions":return"region";case"services":return"service"}},Fe=(0,b.X1)(((e,{widgetId:t})=>{const r=Re.qN.selectWidget(e,t),s=Re.qN.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Pe,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Ce={fetchForecasts:Re.BV.v4,fetchReports:Re.BV.a4,updateTab:Re.BV.as},Se=(0,g.withTranslation)()((0,v.connect)(Fe,Ce)(_)),De=(0,b.X1)(((e,t)=>({DashboardWidget:Se,selectWidgets:Re.qN.selectWidgets(e),widgets:Re.qN.selectCurrentWidgets(e)}))),Ie=(0,g.withTranslation)()((0,v.connect)(De,{})(d));var Ee=r(17563);const Ae=e=>{switch(e){case"clusters":return"cluster";case"nodes":return"node";case"projects":return"project"}},Oe=(0,b.X1)(((e,{widgetId:t})=>{const r=Ee.nH.selectWidget(e,t),s=Ee.nH.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Ae,chartAltHeight:250,containerAltHeight:250,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),_e={fetchForecasts:Ee.U6.v4,fetchReports:Ee.U6.a4,updateTab:Ee.U6.as},Ve=(0,g.withTranslation)()((0,v.connect)(Oe,_e)(_)),je=(0,b.X1)(((e,t)=>({DashboardWidget:Ve,selectWidgets:Ee.nH.selectWidgets(e),widgets:Ee.nH.selectCurrentWidgets(e)}))),We=(0,g.withTranslation)()((0,v.connect)(je,{})(d));var Ze=r(77e3);const Qe=e=>{switch(e){case"clusters":return"cluster";case"nodes":return"node";case"projects":return"project"}},ke=(0,b.X1)(((e,{widgetId:t})=>{const r=Ze.xX.selectWidget(e,t),s=Ze.xX.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Qe,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:V.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Le={fetchForecasts:Ze.T3.v4,fetchReports:Ze.T3.a4,updateTab:Ze.T3.as},Ue=(0,g.withTranslation)()((0,v.connect)(ke,Le)(_)),ze=(0,b.X1)(((e,t)=>({DashboardWidget:Ue,selectWidgets:Ze.xX.selectWidgets(e),widgets:Ze.xX.selectCurrentWidgets(e)}))),Ke=(0,g.withTranslation)()((0,v.connect)(ze,{})(d));var He=r(2891);const Xe=e=>{switch(e){case"clusters":return"cluster";case"nodes":return"node";case"projects":return"project"}},Je=(0,b.X1)(((e,{widgetId:t})=>{const r=He.b2.selectWidget(e,t),s=He.b2.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Xe,currentQuery:s.current,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),previousReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:j.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:j.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),xe={fetchReports:He.K5.a4,updateTab:He.K5.as},Be=(0,g.withTranslation)()((0,v.connect)(Je,xe)(_)),$e=(0,b.X1)(((e,t)=>({DashboardWidget:Be,selectWidgets:He.b2.selectWidgets(e),widgets:He.b2.selectCurrentWidgets(e)}))),Ne=(0,g.withTranslation)()((0,v.connect)($e,{})(d));var qe=r(94329),Ge=r(79910),Me=r(33965),Ye=r(17918),et=r(98499);const tt={infoIcon:{fontSize:Ye.ZP.value},infoTitle:{fontWeight:"bold"},perspective:{marginTop:et.ZP.value},tabs:{marginTop:et.ZP.value}},rt=e=>{switch(e){case"infrastructure":return"infrastructure";case"ocp":return"ocp"}},st=[{label:"overview.perspective.all",value:"all"},{label:"overview.perspective.supplementary",value:"supplementary"}],at=[{label:"overview.perspective.all_cloud",value:"all_cloud"}],ot=[{label:"overview.perspective.aws",value:"aws"}],ct=[{label:"overview.perspective.aws_cloud",value:"aws_cloud"}],it=[{label:"overview.perspective.azure",value:"azure"}],nt=[{label:"overview.perspective.azure_cloud",value:"azure_cloud"}],pt=[{label:"overview.perspective.gcp",value:"gcp"}],lt=[{label:"overview.perspective.ibm",value:"ibm"}],ut=[{label:"overview.perspective.ocp_usage",value:"ocp_usage"}];class ht extends h().Component{constructor(){super(...arguments),this.defaultState={activeTabKey:0},this.state=Object.assign({},this.defaultState),this.getAvailableTabs=()=>{const e=[],t=this.isAwsAvailable(),r=this.isAzureAvailable(),s=this.isGcpAvailable(),a=this.isIbmAvailable(),o=this.isOcpAvailable(),c=this.isOcpCloudAvailable();return o&&e.push({contentRef:h().createRef(),tab:"ocp"}),(t||r||s||a||c)&&e.push({contentRef:h().createRef(),tab:"infrastructure"}),e},this.getCurrentTab=()=>{const{activeTabKey:e}=this.state,t=this.isAwsAvailable(),r=this.isAzureAvailable(),s=this.isGcpAvailable(),a=this.isIbmAvailable(),o=this.isOcpAvailable(),c=this.isOcpCloudAvailable();return o&&!(t||r||s||a||c)?"ocp":!o&&(t||r||s||a||c)?"infrastructure":0===e?"ocp":"infrastructure"},this.getDefaultInfrastructurePerspective=()=>{const e=this.isAwsAvailable(),t=this.isAzureAvailable(),r=this.isGcpAvailable(),s=this.isIbmAvailable();return this.isOcpAvailable()?"all_cloud":e?"aws":t?"azure":r?"gcp":s?"ibm":void 0},this.getDefaultOcpPerspective=()=>{if(this.isOcpAvailable())return"all"},this.getPerspective=()=>{const{currentInfrastructurePerspective:e,currentOcpPerspective:t}=this.state,r=this.isAwsAvailable(),s=this.isAzureAvailable(),a=this.isGcpAvailable(),o=this.isIbmAvailable(),c=this.isOcpAvailable();if(!(r||s||a||c))return null;const i=[];"infrastructure"===this.getCurrentTab()?(c&&i.push(...at),r&&i.push(...ot),c&&r&&i.push(...ct),a&&i.push(...pt),o&&i.push(...lt),s&&i.push(...it),c&&s&&i.push(...nt),c&&i.push(...ut)):i.push(...st);const n="infrastructure"===this.getCurrentTab()?e:t;return h().createElement(l.X,{currentItem:n||i[0].value,onItemClicked:this.handlePerspectiveClick,options:i})},this.getTab=(e,t,r)=>h().createElement(s.Tab,{eventKey:r,key:`${rt(e)}-tab`,tabContentId:`tab-${r}`,tabContentRef:t,title:h().createElement(s.TabTitleText,null,this.getTabTitle(e))}),this.getTabContent=e=>e.map(((e,t)=>h().createElement(s.TabContent,{eventKey:t,key:`${rt(e.tab)}-tabContent`,id:`tab-${t}`,ref:e.contentRef},this.getTabItem(e.tab,t)))),this.getTabItem=(e,t)=>{const{awsProviders:r,azureProviders:s,gcpProviders:a,ibmProviders:o,ocpProviders:c}=this.props,{activeTabKey:i,currentInfrastructurePerspective:p,currentOcpPerspective:l}=this.state,u=h().createElement(h().Fragment,null),d=h().createElement(n.Z,{showReload:!1});if(i!==t)return u;const g=rt(e);if("infrastructure"===g)return"all_cloud"===p?(0,qe.g8)(c)||(0,qe.rL)(c)?h().createElement(Ie,null):d:"aws"===p?(0,qe.g8)(r)||(0,qe.rL)(r)?h().createElement(B,null):d:"aws_cloud"===p?(0,qe.g8)(r)||(0,qe.rL)(r)?h().createElement(U,null):d:"gcp"===p?(0,qe.g8)(a)||(0,qe.rL)(a)?h().createElement(ge,null):d:"ibm"===p?(0,qe.g8)(o)||(0,qe.rL)(o)?h().createElement(we,null):d:"azure"===p?(0,qe.g8)(s)||(0,qe.rL)(s)?h().createElement(ie,null):d:"azure_cloud"===p?(0,qe.g8)(s)||(0,qe.rL)(s)?h().createElement(ee,null):d:"ocp_usage"===p?(0,qe.g8)(c)||(0,qe.rL)(c)?h().createElement(Ne,null):d:(0,qe.g8)(c)||(0,qe.rL)(c)?h().createElement(Ie,null):d;if("ocp"===g){const e=(0,qe.g8)(c)||(0,qe.rL)(c);return"all"===l?e?h().createElement(We,null):d:"supplementary"===l?e?h().createElement(Ke,null):d:e?h().createElement(We,null):d}return u},this.getTabs=e=>{const{activeTabKey:t}=this.state;return h().createElement(s.Tabs,{activeKey:t,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e.tab,e.contentRef,t))))},this.getTabTitle=e=>{const{t}=this.props;return"infrastructure"===e?t("overview.infrastructure"):"ocp"===e?t("overview.ocp"):void 0},this.handlePerspectiveClick=e=>{const t=this.getCurrentTab();this.setState(Object.assign(Object.assign({},"infrastructure"===t&&{currentInfrastructurePerspective:e}),"ocp"===t&&{currentOcpPerspective:e}))},this.handleTabClick=(e,t)=>{const{activeTabKey:r}=this.state;r!==t&&this.setState({activeTabKey:t})},this.isAwsAvailable=()=>{const{awsProviders:e,userAccess:t}=this.props,r=t&&t.data.find((e=>"aws"===e.type));return r&&r.access&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isAzureAvailable=()=>{const{azureProviders:e,userAccess:t}=this.props,r=t&&t.data.find((e=>"azure"===e.type));return r&&r.access&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isGcpAvailable=()=>{const{gcpProviders:e,gcpUserAccess:t}=this.props;return t&&!0===t.data&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isIbmAvailable=()=>{const{ibmProviders:e,ibmUserAccess:t}=this.props;return t&&!0===t.data&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isOcpAvailable=()=>{const{ocpProviders:e,userAccess:t}=this.props,r=t&&t.data.find((e=>"ocp"===e.type));return r&&r.access&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isOcpCloudAvailable=()=>this.isAwsAvailable()&&this.isOcpAvailable()}componentDidMount(){this.setState({currentInfrastructurePerspective:this.getDefaultInfrastructurePerspective(),currentOcpPerspective:this.getDefaultOcpPerspective()})}componentDidUpdate(e){const{awsProviders:t,azureProviders:r,gcpProviders:s,ibmProviders:a,ocpProviders:o,userAccess:c}=this.props;e.userAccess===c&&e.awsProviders===t&&e.azureProviders===r&&e.gcpProviders===s&&e.ibmProviders===a&&e.ocpProviders===o||this.setState({currentInfrastructurePerspective:this.getDefaultInfrastructurePerspective(),currentOcpPerspective:this.getDefaultOcpPerspective()})}render(){const{awsProvidersFetchStatus:e,azureProvidersFetchStatus:t,gcpProvidersFetchStatus:r,ibmProvidersFetchStatus:o,ocpProvidersFetchStatus:c,userAccessFetchStatus:n,t:l}=this.props,u=this.getAvailableTabs(),d=1===e||1===t||1===r||1===o||1===c||1===n,g=!this.isAwsAvailable()&&2===e,v=!this.isAzureAvailable()&&2===t,b=!this.isGcpAvailable()&&2===r,m=!this.isIbmAvailable()&&2===o,y=!this.isOcpAvailable()&&2===c,T=g&&v&&b&&m&&y,f=l("cost_management_overview");return T?h().createElement(p.Z,{title:f}):d?h().createElement(i.Z,{title:f}):h().createElement(h().Fragment,null,h().createElement("section",{className:"pf-l-page-header pf-c-page-header pf-l-page__main-section pf-c-page__main-section pf-m-light headerOverride}"},h().createElement("header",{className:"pf-u-display-flex pf-u-justify-content-space-between pf-u-align-items-center"},h().createElement(s.Title,{headingLevel:"h2",size:"2xl"},l("cost_management_overview"),h().createElement("span",{style:tt.infoIcon},h().createElement(s.Popover,{"aria-label":l("ocp_details.supplementary_aria_label"),enableFlip:!0,bodyContent:h().createElement(h().Fragment,null,h().createElement("p",{style:tt.infoTitle},l("overview.ocp_cloud")),h().createElement("p",null,l("overview.ocp_cloud_desc")),h().createElement("br",null),h().createElement("p",{style:tt.infoTitle},l("overview.ocp")),h().createElement("p",null,l("overview.ocp_desc")),h().createElement("br",null),h().createElement("p",{style:tt.infoTitle},l("overview.gcp")),h().createElement("p",null,l("overview.gcp_desc")),h().createElement("br",null),h().createElement("p",{style:tt.infoTitle},l("overview.ibm")),h().createElement("p",null,l("overview.ibm_desc")),h().createElement("br",null),h().createElement("p",{style:tt.infoTitle},l("overview.aws")),h().createElement("p",null,l("overview.aws_desc")),h().createElement("br",null),h().createElement("p",{style:tt.infoTitle},l("overview.azure")),h().createElement("p",null,l("overview.azure_desc")))},h().createElement(s.Button,{variant:s.ButtonVariant.plain},h().createElement(a.iC,null)))))),h().createElement("div",{style:tt.tabs},this.getTabs(u)),h().createElement("div",{style:tt.perspective},this.getPerspective())),h().createElement("section",{className:"pf-l-page__main-section pf-c-page__main-section","page-type":"cost-management-overview"},this.getTabContent(u)))}}const dt=(0,b.X1)(((e,t)=>{const r=(0,o.H)(Ge.JL),s=Ge.aX.selectProviders(e,"aws",r),a=Ge.aX.selectProvidersFetchStatus(e,"aws",r),i=(0,o.H)(Ge.u5),n=Ge.aX.selectProviders(e,"azure",i),p=Ge.aX.selectProvidersFetchStatus(e,"azure",i),l=(0,o.H)(Ge.U6),u=Ge.aX.selectProviders(e,"gcp",l),h=Ge.aX.selectProvidersFetchStatus(e,"gcp",l),d=(0,o.H)(Ge.t8),g=Ge.aX.selectProviders(e,"gcp",d),v=Ge.aX.selectProvidersFetchStatus(e,"gcp",d),b=(0,o.H)(Ge.Vp),m=Ge.aX.selectProviders(e,"ocp",b),y=Ge.aX.selectProvidersFetchStatus(e,"ocp",b),T=(0,c.T)(Me.BD),f=Me.JO.selectUserAccess(e,"",T),w=Me.JO.selectUserAccessError(e,"",T),R=Me.JO.selectUserAccessFetchStatus(e,"",T),P=(0,c.T)(Me.rR),F=Me.JO.selectUserAccess(e,"gcp",P),C=Me.JO.selectUserAccessError(e,"gcp",P),S=Me.JO.selectUserAccessFetchStatus(e,"gcp",P),D=(0,c.T)(Me.HC);return{awsProviders:s,awsProvidersFetchStatus:a,awsProvidersQueryString:r,azureProviders:n,azureProvidersFetchStatus:p,azureProvidersQueryString:i,gcpProviders:u,gcpProvidersFetchStatus:h,gcpProvidersQueryString:l,gcpUserAccess:F,gcpUserAccessError:C,gcpUserAccessFetchStatus:S,gcpUserAccessQueryString:P,ibmProviders:g,ibmProvidersFetchStatus:v,ibmProvidersQueryString:d,ibmUserAccess:Me.JO.selectUserAccess(e,"gcp",D),ibmUserAccessError:Me.JO.selectUserAccessError(e,"gcp",D),ibmUserAccessFetchStatus:Me.JO.selectUserAccessFetchStatus(e,"gcp",D),ibmUserAccessQueryString:D,ocpProviders:m,ocpProvidersFetchStatus:y,ocpProvidersQueryString:b,userAccess:f,userAccessError:w,userAccessFetchStatus:R,userAccessQueryString:T}})),gt=(0,g.withTranslation)()((0,v.connect)(dt)(ht))}}]);
//# sourceMappingURL=802beeacb5cd6157d4b1.bundle.js.map