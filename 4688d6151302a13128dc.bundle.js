(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[3758],{48716:(e,t,a)=>{"use strict";a.d(t,{Z:()=>g});var s=a(22122),n=a(96156),r=a(81253),o=a(97522),i=a.n(o),l=a(45697),c=a.n(l),d=a(94184),p=a.n(d),m=a(72466),u=function(e){var t=e.className,a=e.children,o=(0,r.Z)(e,["className","children"]),l=p()(t,"pf-l-page-header","pf-c-page-header","pf-l-page__main-section","pf-c-page__main-section");return i().createElement(m.Z.Consumer,null,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light",t=p()((0,n.Z)({},"pf-m-".concat(e,"-200"),"dark"===e),(0,n.Z)({},"pf-m-light","light"===e));return i().createElement("section",(0,s.Z)({},o,{className:"".concat(l," ").concat(t),"widget-type":"InsightsPageHeader"}),a)}))};const g=u;u.propTypes={children:c().any.isRequired,className:c().string}},39173:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var s=a(97522),n=a.n(s),r=a(45697),o=a.n(r),i=a(94184),l=a.n(i),c=a(60485),d=function(e){var t=e.className,a=e.title,s=l()(t);return n().createElement(c.D,{headingLevel:"h1",size:"2xl",className:s,"widget-type":"InsightsPageHeaderTitle"}," ",a," ")};const p=d;d.propTypes={title:o().node.isRequired,className:o().string}},70876:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>_t});var s=a(9947),n=a(38424),r=a(60485),o=a(75106),i=a(79770),l=a(3235),c=a(16177),d=a(48716),p=a(39173),m=a(32203),u=a(70401),g=a(2079),h=a(21005),E=a(56787),_=a(80737),b=a(99355),v=a(84457),P=a(62394),y=a(20546),f=a(97522),C=a.n(f),O=a(57827),S=a(86588),k=a(94377),M=a(87932),D=a(46462),x=a(901),R=a(80939),Z=a(98499);const w={card:{minHeight:"130px",marginLeft:Z.ZP.value,marginRight:Z.ZP.value},cardBody:{fontSize:R.ZP.value,textAlign:"center"}};var F=a(8745),T=a(47173),j=a(49739),q=a(83826),L=a(43547),z=a(68774),$=a(68340),I=a(83115),W=a(43627),N=a(65802),A=a(92607),B=a(46836);class H extends C().Component{constructor(e){super(e),this.state={markup:(0,x.Bw)(Number(this.props.current.markup.value),"markup",{fractionDigits:2})||"0.00"}}render(){const{error:e,current:t,onClose:a,updateCostModel:s,isLoading:n,t:o}=this.props;return C().createElement(F.u,{title:o("cost_models_details.edit_markup"),isOpen:!0,onClose:()=>a({name:"updateMarkup",isOpen:!1}),variant:"small",actions:[C().createElement(T.zx,{key:"proceed",variant:"primary",onClick:()=>{const e=Object.assign(Object.assign({},t),{source_uuids:t.sources.map((e=>e.uuid)),source_type:"OpenShift Container Platform"===t.source_type?"OCP":"AWS",markup:{value:this.state.markup,unit:"percent"}});s(t.uuid,e,"updateMarkup")},isDisabled:isNaN(Number(this.state.markup))||Number(this.state.markup)===Number(t.markup.value||0)||n},o("cost_models_details.add_rate_modal.save")),C().createElement(T.zx,{key:"cancel",variant:"link",onClick:()=>a({name:"updateMarkup",isOpen:!1}),isDisabled:n},o("cost_models_details.add_rate_modal.cancel"))]},C().createElement(j.K,{hasGutter:!0},C().createElement(q.v,null,e&&C().createElement(L.b,{variant:"danger",title:`${e}`})),C().createElement(q.v,null,C().createElement(r.D,{headingLevel:"h2",size:"md"},o("cost_models_details.table.columns.name"))),C().createElement(q.v,null,C().createElement(z.D,null,C().createElement($.x,{component:$.q.h6},t.name))),C().createElement(q.v,null,C().createElement(I.l,null,C().createElement(W.c,{label:o("cost_models_wizard.markup.markup_label"),fieldId:"markup-input-box",helperTextInvalid:o("cost_models_wizard.markup.invalid_markup_text"),validated:isNaN(Number(this.state.markup))?"error":"default"},C().createElement(N.B,{style:{width:"150px"}},C().createElement(A.oi,{type:"text","aria-label":o("cost_models_wizard.markup.markup_label"),id:"markup-input-box",value:this.state.markup,onChange:e=>{const t=Number(e),a=e.split("").findIndex((e=>"."===e));!isNaN(t)&&a>-1&&e.length-a-1>2?this.setState({markup:(0,x.Bw)(t,"markup",{fractionDigits:2})}):this.setState({markup:e})},validated:isNaN(Number(this.state.markup))?"error":"default"}),C().createElement(B.O,{style:{borderLeft:"0"}},"%")))))))}}const K=(0,S.connect)((0,k.X1)((e=>({isLoading:M.E6.updateProcessing(e),error:M.E6.updateError(e)}))),{onClose:M.F0.setCostModelDialog,updateCostModel:M.F0.updateCostModel},((e,t,a)=>Object.assign(Object.assign(Object.assign({},e),t),a)))((0,O.withTranslation)()(H)),X=(0,S.connect)((0,k.X1)((e=>{const{updateMarkup:t}=M.E6.isDialogOpen(e)("markup");return{isUpdateDialogOpen:t,costModelDialog:M.E6.isDialogOpen(e)("markup"),isWritePermission:D.c5.isCostModelWritePermission(e)}})),{setCostModelDialog:M.F0.setCostModelDialog})((0,O.withTranslation)()((({isWritePermission:e,setCostModelDialog:t,current:a,isUpdateDialogOpen:s,t:n})=>{const[r,o]=C().useState(!1),i=a&&a.markup&&a.markup.value?(0,x.Bw)(Number(a.markup.value),"markup",{fractionDigits:2}):"0.0";return C().createElement(C().Fragment,null,s&&C().createElement(K,{current:a}),C().createElement(m.Z,{style:w.card},C().createElement(u.O,null,C().createElement(g.Z,null,n("cost_models_details.description_markup")),C().createElement(h.T,null,C().createElement(E.L,{toggle:C().createElement(_.a,{onToggle:o}),isOpen:r,onSelect:()=>o(!1),position:b.ir.right,isPlain:!0,dropdownItems:[C().createElement(y.j,{key:"edit",isDisabled:!e},C().createElement(v.h,{isDisabled:!e,onClick:()=>t({isOpen:!0,name:"updateMarkup"}),component:"button"},n("cost_models_details.edit_markup_action")))]}))),C().createElement(P.e,{isFilled:!0}),C().createElement(P.e,{style:w.cardBody},i,"%"),C().createElement(P.e,{isFilled:!0})))})));var U=a(72936),G=a(49345),J=a(35472),V=a(52643),Q=a(84812),Y=a(78919),ee=a(1595),te=a(59867),ae=a(20167),se=a(55483),ne=a(52413),re=a(77656),oe=a(66555),ie=a(39574),le=a(85218),ce=a(60477),de=a(99627),pe=a(35842),me=a(96085);const ue=(0,S.connect)((e=>{const t=M.E6.costModels(e);let a=null;return t.length>0&&(a=t[0]),{costModel:a,isOpen:M.E6.isDialogOpen(e)("rate").addRate,updateError:M.E6.updateError(e),isProcessing:M.E6.updateProcessing(e),metricsHash:de.qw.metrics(e)}}),(e=>({onClose:()=>{e(M.F0.setCostModelDialog({name:"addRate",isOpen:!1}))},updateCostModel:(t,a)=>M.F0.updateCostModel(t,a,"addRate")(e)})),((e,t)=>{const{uuid:a,rates:s}=e.costModel;return{isOpen:e.isOpen,metricsHash:e.metricsHash,rates:s,updateError:e.updateError,isProcessing:e.isProcessing,onClose:t.onClose,onProceed:s=>{const n=(0,pe.L3)(e.metricsHash,e.costModel,s);t.updateCostModel(a,n)}}}))((({isOpen:e,isProcessing:t,onProceed:a,onClose:s,updateError:n,metricsHash:r,rates:o})=>{const i=(0,pe.bF)(r),l=C().useMemo((()=>(0,pe.Cw)(i)),[i.errors,i.rateKind]);return C().useEffect((()=>{i.reset(Object.assign(Object.assign({},me.Pv),{otherTiers:o}))}),[e]),C().createElement(O.Translation,null,(o=>C().createElement(F.u,{title:o("cost_models_details.add_rate_modal.title"),isOpen:e,onClose:s,variant:"large",actions:[C().createElement(T.zx,{key:"add-rate",variant:T.Wu.primary,isDisabled:!l||t,onClick:()=>{a(i)}},o("cost_models_details.add_rate")),C().createElement(T.zx,{key:"cancel",variant:T.Wu.link,isDisabled:t,onClick:s},o("cost_models_details.add_rate_modal.cancel"))]},C().createElement(I.l,null,n&&C().createElement(L.b,{variant:"danger",title:`${n}`}),C().createElement(pe.HJ,{metricsHash:r,rateFormData:i})))))}));var ge=a(19694);const he=(0,O.withTranslation)()((({t:e,onClose:t,onProceed:a,title:s,body:n,actionText:o,isProcessing:i=!1,isOpen:l=!1,isSmall:c=!1,error:d=""})=>{const p=C().createElement(T.zx,{key:"cancel",variant:"link",onClick:t,isDisabled:i},e("dialog.cancel")),m=C().createElement(T.zx,{key:"proceed",variant:"danger",onClick:a,isDisabled:i},o),u=C().createElement(T.zx,{key:"close",variant:"primary",onClick:t,isDisabled:i},e("dialog.close")),g=""!==o?[m,p]:[u];return C().createElement(F.u,{"aria-label":s,header:C().createElement(r.D,{headingLevel:"h1",size:r.H["2xl"]},C().createElement(ge.LP,{color:"orange"})," ",s),isOpen:l,onClose:t,actions:g,variant:c?"small":"default"},d&&C().createElement(L.b,{variant:"danger",title:`${d}`}),n)}));var Ee=a(51508);const _e=(0,S.connect)((e=>{const t=M.E6.costModels(e);let a=null;return t.length>0&&(a=t[0]),{costModel:a,isOpen:M.E6.isDialogOpen(e)("rate").updateRate,updateError:M.E6.updateError(e),isProcessing:M.E6.updateProcessing(e),metricsHash:de.qw.metrics(e)}}),(e=>({onClose:()=>{e(M.F0.setCostModelDialog({name:"updateRate",isOpen:!1}))},updateCostModel:(t,a)=>{M.F0.updateCostModel(t,a,"updateRate")(e)}})),((e,t,a)=>{const{uuid:s,rates:n}=e.costModel;return{rate:e.costModel&&e.costModel.rates&&e.costModel.rates[a.index]?e.costModel.rates[a.index]:null,otherRates:n,metricsHash:e.metricsHash,onClose:t.onClose,isOpen:e.isOpen,isProcessing:e.isProcessing,updateError:e.updateError,onProceed:n=>{const r=(0,pe.L3)(e.metricsHash,e.costModel,n,a.index);t.updateCostModel(s,r)}}}))((({rate:e,otherRates:t,metricsHash:a,onClose:s,isOpen:n,isProcessing:r,updateError:o,onProceed:i})=>{const{t:l}=(0,O.useTranslation)(),c=(0,pe.bF)(a,e,t),d=C().useMemo((()=>(0,pe.Cw)(c)),[c]),p=C().useMemo((()=>(0,pe.uD)(e,c)),[c]);return C().useEffect((()=>{c.reset((0,pe.Pz)(e,void 0,e&&e.tag_rates?t.filter((t=>t.metric.name!==e.metric.name||t.cost_type!==e.cost_type||t.tag_rates.tag_key!==e.tag_rates.tag_key)):t))}),[n]),C().createElement(F.u,{title:l("cost_models_details.edit_rate"),isOpen:n,onClose:s,variant:"large",actions:[C().createElement(T.zx,{key:"proceed",variant:"primary",onClick:()=>{i(c)},isDisabled:!d||r||!p},l("cost_models_details.add_rate_modal.save")),C().createElement(T.zx,{key:"cancel",variant:"link",onClick:s,isDisabled:r},l("cost_models_details.add_rate_modal.cancel"))]},C().createElement(j.K,{hasGutter:!0},o&&C().createElement(q.v,null,C().createElement(L.b,{variant:"danger",title:`${o}`})),C().createElement(q.v,null,C().createElement(Ee.l,null,C().createElement(pe.HJ,{metricsHash:a,rateFormData:c})))))}));class be extends C().Component{constructor(){super(...arguments),this.state={deleteRate:null,index:-1,pagination:{perPage:10,page:1}}}render(){const{t:e,fetchStatus:t,fetchError:a,isDialogOpen:i,metricsHash:l,isWritePermission:c}=this.props,d=Object.keys(l).map((e=>({label:e,value:e}))),p=d.reduce(((e,t)=>{const a=Object.keys(l[t.value]).filter((t=>!e.map((e=>e.value)).includes(t))).map((e=>({label:e,value:e})));return[...e,...a]}),[]),m=C().createElement("b",null,"dummyChild"),u=this.props.costModel,g=this.state.deleteRate?`${this.state.deleteRate.metric.label_metric}-${this.state.deleteRate.metric.label_measurement} (${this.state.deleteRate.metric.label_measurement_unit})`:"";return C().createElement(C().Fragment,null,C().createElement(ue,null),C().createElement(_e,{index:this.state.index}),C().createElement(he,{isSmall:!0,isOpen:i.deleteRate,title:e("dialog.rate.title"),onClose:()=>{this.props.setDialogOpen({name:"deleteRate",isOpen:!1}),this.setState({deleteRate:null})},isProcessing:this.props.isLoading,onProceed:()=>{const{index:e}=this.state,{current:t}=this.props,a=Object.assign(Object.assign({},t),{source_uuids:t.sources.map((e=>e.uuid)),source_type:"OCP",rates:[...t.rates.slice(0,e),...t.rates.slice(e+1)]});this.props.updateCostModel(t.uuid,a,"deleteRate")},body:C().createElement(C().Fragment,null,C().createElement(O.Trans,{i18nKey:"dialog.rate.body",components:[m,m],values:{metric:g,cm:u}}),this.props.assignees&&this.props.assignees.length>0&&C().createElement(C().Fragment,null,e("dialog.rate.assigned"),C().createElement(U.aV,null,this.props.assignees.map((e=>C().createElement(G.H,{key:e},e)))))),actionText:e("dialog.deleteRate")}),C().createElement(re.j,{initialFilters:{primary:"metrics",metrics:[],measurements:[]}},(({search:i,setSearch:l,onRemove:m,onSelect:u,onClearAll:g})=>{const h=(this.state.pagination.page-1)*this.state.pagination.perPage,E=this.state.pagination.page*this.state.pagination.perPage,_=this.props.current.rates.filter((e=>0===i.metrics.length||i.metrics.includes(e.metric.label_metric))).filter((e=>0===i.measurements.length||i.measurements.includes(e.metric.label_measurement))),b=_.slice(h,E);return C().createElement(C().Fragment,null,C().createElement(oe.Q,{primary:C().createElement(ce.J,{isDisabled:0===this.props.current.rates.length,primary:i.primary,setPrimary:e=>l({primary:e}),options:[{label:e("toolbar.pricelist.metric"),value:"metrics"},{label:e("toolbar.pricelist.measurement"),value:"measurements"}]}),selected:i.primary,secondaries:[{component:C().createElement(le.n,{isDisabled:0===this.props.current.rates.length,placeholderText:e("toolbar.pricelist.measurement_placeholder"),selections:i.measurements,setSelections:e=>u("measurements",e),options:p}),name:"measurements",onRemove:m,filters:i.measurements},{component:C().createElement(le.n,{isDisabled:0===this.props.current.rates.length,placeholderText:e("toolbar.pricelist.metric_placeholder"),selections:i.metrics,setSelections:e=>u("metrics",e),options:d}),name:"metrics",onRemove:m,filters:i.metrics}],button:C().createElement(T.zx,{isDisabled:!c,onClick:()=>this.props.setDialogOpen({name:"addRate",isOpen:!0})},e("toolbar.pricelist.add_rate")),onClear:g,pagination:C().createElement(J.t,{isCompact:!0,itemCount:_.length,perPage:this.state.pagination.perPage,page:this.state.pagination.page,onSetPage:(e,t)=>this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:t})}),onPerPageSelect:(e,t)=>this.setState({pagination:{page:1,perPage:t}})})}),2!==t&&C().createElement(ne.G,null),2===t&&Boolean(a)&&C().createElement(ae.Z,null),2===t&&0===b.length&&(0!==i.metrics.length||0!==i.measurements.length)&&C().createElement(se.c,{filter:e("cost_models_wizard.price_list.toolbar_top_results_aria_label")}),2===t&&0===b.length&&0===i.measurements.length&&0===i.metrics.length&&C().createElement(V.b,null,C().createElement(s.u,null,C().createElement(n.k,{icon:te.Yw}),C().createElement(r.D,{headingLevel:"h2",size:"lg"},e("cost_models_details.empty_state_rate.title")),C().createElement(o.B,null,e("cost_models_details.empty_state_rate.description")))),2===t&&b.length>0&&C().createElement(C().Fragment,null,C().createElement(ie.y,{t:e,tiers:b,actions:[{title:e("cost_models_wizard.price_list.update_button"),isDisabled:!c,style:c?void 0:{pointerEvents:"auto"},tooltip:c?void 0:C().createElement("div",null,e("cost_models.read_only_tooltip")),onClick:(e,t,a)=>{this.setState({deleteRate:null,index:a.data.index+h}),this.props.setDialogOpen({name:"updateRate",isOpen:!0})}},{title:e("cost_models_wizard.price_list.delete_button"),isDisabled:!c,style:c?{}:{pointerEvents:"auto"},tooltip:c?void 0:C().createElement("div",null,e("cost_models.read_only_tooltip")),onClick:(e,t,a)=>{const s=a.data.index;this.setState({deleteRate:b[s],index:s+h}),this.props.setDialogOpen({name:"deleteRate",isOpen:!0})}}]}),C().createElement(Q.o,{id:"price-list-toolbar-bottom"},C().createElement(Y.c,null,C().createElement(ee.E,{variant:ee.A.pagination},C().createElement(J.t,{itemCount:_.length,perPage:this.state.pagination.perPage,page:this.state.pagination.page,onSetPage:(e,t)=>this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:t})}),onPerPageSelect:(e,t)=>this.setState({pagination:{page:1,perPage:t}}),variant:"bottom"}))))))})))}}const ve=(0,S.connect)((0,k.X1)((e=>({isLoading:M.E6.updateProcessing(e),error:M.E6.updateError(e),isDialogOpen:M.E6.isDialogOpen(e)("rate"),fetchError:M.E6.error(e),fetchStatus:M.E6.status(e),metricsHash:de.qw.metrics(e),costTypes:de.qw.costTypes(e),isWritePermission:D.c5.isCostModelWritePermission(e)}))),{updateCostModel:M.F0.updateCostModel,setDialogOpen:M.F0.setCostModelDialog})((0,O.withTranslation)()(be));var Pe=a(50693),ye=a(16475),fe=a(88485),Ce=a(62226),Oe=a(83255),Se=a(6934),ke=a(22860),Me=a(27916),De=a(10209),xe=a(39887),Re=a(35248),Ze=a(71070);const we=({id:e,placeholder:t="",value:a,onChange:s,onSearch:n})=>C().createElement(N.B,null,C().createElement(A.oi,{value:a,placeholder:t,id:e,onChange:s,onKeyPress:e=>{"Enter"===e.key&&""!==a&&n(e)}}),C().createElement(B.O,{style:{borderLeft:"0"}},C().createElement(Ze.W1,null))),Fe=(0,O.withTranslation)()((({t:e,filterInputProps:t,paginationProps:a,filter:s})=>C().createElement(Q.o,{id:"assign-sources-toolbar",clearAllFilters:s.onClearAll},C().createElement(Y.c,null,C().createElement(ee.E,{variant:"search-filter"},C().createElement(Re.p,{deleteChip:s.onRemove,chips:s.query.name,categoryName:"name"},C().createElement(we,Object.assign({placeholder:e("cost_models_wizard.source_table.filter_placeholder")},t)))),C().createElement(ee.E,{variant:"pagination"},C().createElement(J.t,{isCompact:a.isCompact,itemCount:a.itemCount,page:a.page,perPage:a.perPage,onSetPage:a.onSetPage,onPerPageSelect:a.onPerPageSelect}))))));class Te extends C().Component{render(){const{costModel:e}=this.props;if(this.props.isLoadingSources)return C().createElement(ne.G,null);if(this.props.fetchingSourcesError)return C().createElement(Me.fv,null);const t=this.props.providers.map((t=>{const a=!!this.props.checked[t.uuid]&&this.props.checked[t.uuid].selected,s=void 0===t.cost_models?this.props.t("cost_models_wizard.source_table.default_cost_model"):t.cost_models.map((e=>e.name)).join(","),n=t.cost_models.length&&void 0===t.cost_models.find((t=>t.name===e.name))?C().createElement(xe.a,{key:t.uuid,text:this.props.t("cost_models_wizard.warning_source",{cost_model:s})}):null;return{cells:[C().createElement("div",{key:t.uuid},t.name," ",n),s||""],selected:a,disableSelection:t.cost_models.length>0}})),a={"OpenShift Container Platform":"OCP","Microsoft Azure":"AZURE","Amazon Web Services":"AWS"}[e.source_type];return C().createElement(C().Fragment,null,C().createElement(Fe,{filter:{onClearAll:()=>this.props.fetch(`source_type=${a}&limit=${this.props.pagination.perPage}`),onRemove:(e,t)=>{const s=(0,De.fg)({name:this.props.query.name?this.props.query.name.split(","):[]})(e,t);this.props.fetch(`source_type=${a}${s.name?`&name=${s.name.join(",")}`:""}&offset=0&limit=${this.props.pagination.perPage}`)},query:{name:this.props.query.name?this.props.query.name.split(","):[]}},filterInputProps:{id:"assign-sources-modal-toolbar",onChange:e=>this.props.updateFilter({currentFilterType:"name",currentFilterValue:e}),value:this.props.currentFilter.value,onSearch:()=>{const e=this.props.query.name?this.props.query.name.split(","):[],t=(0,De.xZ)({name:e})("name",this.props.currentFilter.value);this.props.fetch(`source_type=${a}&name=${t.name.join(",")}&limit=${this.props.pagination.perPage}&offset=0`)}},paginationProps:{isCompact:!0,itemCount:this.props.pagination.count,perPage:this.props.pagination.perPage,page:this.props.pagination.page,onPerPageSelect:(e,t)=>{this.props.fetch(`source_type=${a}&limit=${t}&offset=0&${this.props.query.name?`name=${this.props.query.name}`:""}`)},onSetPage:(e,t)=>{this.props.fetch(`source_type=${a}&limit=${this.props.pagination.perPage}&offset=${this.props.pagination.perPage*(t-1)}&${this.props.query.name?`name=${this.props.query.name}`:""}`)}}}),t.length>0&&C().createElement(Oe.i,{"aria-label":this.props.t("cost_models_details.add_source"),cells:[this.props.t("name"),this.props.t("cost_models_wizard.source_table.column_cost_model")],rows:t,onSelect:(e,t,a)=>{if(-1!==a)this.props.setState(Object.assign(Object.assign({},this.props.checked),{[this.props.providers[a].uuid]:{selected:t,meta:this.props.providers[a]}}));else{const e=this.props.providers.reduce(((e,a)=>{const s=!!this.props.checked[a.uuid]&&this.props.checked[a.uuid].selected,n=a.cost_models.length>0;return Object.assign(Object.assign({},e),{[a.uuid]:{selected:n?s:t,meta:a}})}),{});this.props.setState(e)}}},C().createElement(Se.x,null),C().createElement(ke.R,null)),0===t.length&&C().createElement(se.c,{subTitle:this.props.t("no_match_found_state.desc")}),C().createElement(Q.o,{id:"costmodels_details.sources_pagination_datatoolbar"},C().createElement(Y.c,{style:{flexDirection:"row-reverse"},"aria-label":this.props.t("cost_models_details.sources_pagination_bottom")},C().createElement(ee.E,{variant:"pagination"},C().createElement(J.t,{itemCount:this.props.pagination.count,isDisabled:this.props.isLoadingSources,perPage:this.props.pagination.perPage,page:this.props.pagination.page,onPerPageSelect:(e,t)=>{this.props.fetch(`limit=${t}&offset=0&${this.props.query.name?`name=${this.props.query.name}`:""}`)},onSetPage:(e,t)=>{this.props.fetch(`limit=${this.props.pagination.perPage}&offset=${this.props.pagination.perPage*(t-1)}&${this.props.query.name?`name=${this.props.query.name}`:""}`)}})))))}}const je=(0,S.connect)((0,k.X1)((e=>({currentFilter:{name:Ce.vc.currentFilterType(e),value:Ce.vc.currentFilterValue(e)}}))),{updateFilter:Ce.lk.updateFilterToolbar})((0,O.withTranslation)()(Te)),qe={"OpenShift Container Platform":"OCP","Microsoft Azure":"AZURE","Amazon Web Services":"AWS"};class Le extends C().Component{constructor(){super(...arguments),this.state={checked:{}}}componentDidMount(){const{costModel:{source_type:e},fetch:t}=this.props;t(`type=${qe[e]}&limit=10&offset=0`)}componentDidUpdate(e){if(!0===e.isLoadingSources&&!1===this.props.isLoadingSources){const e=this.props.providers.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.uuid]:{selected:this.props.costModel.sources.some((e=>e.uuid===t.uuid)),meta:t}})),{});this.setState({checked:e})}}render(){const{isUpdateInProgress:e,onClose:t,isOpen:a,onSave:s,t:n,costModel:r,updateApiError:o}=this.props;return C().createElement(F.u,{isOpen:a,title:n("cost_models_details.assign_sources"),onClose:t,variant:"large",actions:[C().createElement(T.zx,{key:"save",isDisabled:e||this.props.isLoadingSources||null!==this.props.fetchingSourcesError,onClick:()=>{s(Object.keys(this.state.checked).filter((e=>this.state.checked[e].selected)))}},n("cost_models_details.action_assign")),C().createElement(T.zx,{key:"cancel",variant:"link",isDisabled:e,onClick:t},n("cost_models_wizard.cancel_button"))]},C().createElement(j.K,null,C().createElement(q.v,null,Boolean(o)&&C().createElement(L.b,{variant:"danger",title:`${o}`})),C().createElement(q.v,null,C().createElement(Pe.r,null,C().createElement(ye.P,{span:2},C().createElement(z.D,null,C().createElement($.x,{component:$.q.h6},n("name")))),C().createElement(ye.P,{span:10},C().createElement(z.D,null,C().createElement($.x,{component:$.q.p},this.props.costModel.name))),C().createElement(ye.P,{span:2},C().createElement(z.D,null,C().createElement($.x,{component:$.q.h6},n("cost_models_wizard.general_info.source_type_label")))),C().createElement(ye.P,{span:10},C().createElement(z.D,null,C().createElement($.x,{component:$.q.p},this.props.costModel.source_type))))),C().createElement(q.v,null,C().createElement(je,{fetch:this.props.fetch,fetchingSourcesError:this.props.fetchingSourcesError,isLoadingSources:this.props.isLoadingSources,providers:this.props.providers,pagination:this.props.pagination,query:this.props.query,costModel:r,checked:this.state.checked,setState:e=>{this.setState({checked:e})}}))))}}const ze=(0,S.connect)((0,k.X1)((e=>({pagination:Ce.vc.pagination(e),query:Ce.vc.query(e),providers:Ce.vc.sources(e),isLoadingSources:1===Ce.vc.status(e),isUpdateInProgress:M.E6.updateProcessing(e),updateApiError:M.E6.updateError(e),fetchingSourcesError:Ce.vc.error(e)?(0,fe.L)(Ce.vc.error(e)):null}))),{fetch:Ce.lk.fetchSources})((0,O.withTranslation)()(Le));var $e=a(85111),Ie=a(80963),We=a(84273);const Ne=(0,S.connect)((e=>({canWrite:D.c5.isCostModelWritePermission(e),costModels:M.E6.costModels(e)})),void 0,((e,t,a)=>{const s=(n=e.canWrite,r=a.showDeleteDialog,n?[{title:"cost_models_details.action_unassign",onClick:(e,t)=>r(t)}]:[{style:{pointerEvents:"auto"},tooltip:"cost_models.read_only_tooltip",isDisabled:!0,title:"cost_models_details.action_unassign"}]);var n,r;return{"aria-label":"sources-table",cells:["name"],rows:e.costModels.length>0?e.costModels[0].sources.map((e=>[e.name])):[],actions:s}}))(We.T),Ae=({id:e,placeholder:t="",value:a,onChange:s,onSearch:n})=>C().createElement(N.B,null,C().createElement(A.oi,{value:a,placeholder:t,id:e,onChange:s,onKeyPress:e=>{"Enter"===e.key&&""!==a&&n(e)}}),C().createElement(B.O,{style:{borderLeft:"0"}},C().createElement(Ze.W1,null))),Be=({filterInputProps:e,paginationProps:t,filter:a,actionButtonProps:s})=>C().createElement(Q.o,{id:"assign-sources-toolbar",clearAllFilters:a.onClearAll},C().createElement(Y.c,null,C().createElement(ee.E,{variant:"search-filter"},C().createElement(Re.p,{deleteChip:a.onRemove,chips:a.query.name,categoryName:a.categoryNames.name},C().createElement(Ae,Object.assign({},e)))),C().createElement(ee.E,null,C().createElement(y.j,{isDisabled:s.isDisabled},C().createElement(T.zx,Object.assign({},s)))),C().createElement(ee.E,{variant:"pagination"},C().createElement(J.t,{isCompact:t.isCompact,itemCount:t.itemCount,page:t.page,perPage:t.perPage,onSetPage:t.onSetPage,onPerPageSelect:t.onPerPageSelect})))),He={emptyState:{display:"flex",flexDirection:"row",justifyContent:"center"}};class Ke extends C().Component{constructor(){super(...arguments),this.state={query:{name:[]},currentFilter:"",pagination:{page:1,perPage:10}}}render(){const{pagination:{page:e,perPage:t}}=this.state,{onAdd:a,t:i,rows:l,isWritePermission:c}=this.props,d=l.filter((e=>!this.state.query.name||this.state.query.name.every((t=>e.includes(t))))).map((e=>[e])),p=d.slice((e-1)*t,e*t);return C().createElement(C().Fragment,null,C().createElement(Be,{actionButtonProps:{isDisabled:!c,onClick:a,children:i("toolbar.sources.assign_sources")},filter:{onClearAll:()=>this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:1}),query:{name:[]}}),onRemove:(e,t)=>{this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:1}),query:(0,De.fg)(this.state.query)("name",t)})},query:this.state.query,categoryNames:{name:i("name")}},paginationProps:{isCompact:!0,itemCount:d.length,perPage:t,page:e,onSetPage:(e,t)=>this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:t})}),onPerPageSelect:(e,t)=>this.setState({pagination:{page:1,perPage:t}})},filterInputProps:{id:"sources-tab-toolbar",onChange:e=>this.setState({currentFilter:e}),onSearch:()=>{this.setState({query:(0,De.xZ)(this.state.query)("name",this.state.currentFilter),currentFilter:"",pagination:Object.assign(Object.assign({},this.state.pagination),{page:1})})},value:this.state.currentFilter,placeholder:i("toolbar.sources.filter_placeholder")}}),p.length>0&&C().createElement(Ne,{showDeleteDialog:e=>{this.props.onDelete(p[e])}}),0===l.length&&C().createElement("div",{style:He.emptyState},C().createElement(s.u,null,C().createElement(n.k,{icon:$e.bk}),C().createElement(r.D,{headingLevel:"h2",size:"lg"},i("cost_models_details.empty_state_source.title")),C().createElement(o.B,null,i("cost_models_details.empty_state_source.description")))),0===d.length&&l.length>0&&C().createElement(se.c,{filter:this.state.currentFilter,subTitle:i("no_match_found_state.desc")}),C().createElement(Ie.N,{id:"costmodels_details_filter_datatoolbar","aria-label":"cost_models_details.sources_filter_controller",variant:"bottom",itemCount:d.length,perPage:t,page:e,onSetPage:(e,t)=>this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:t})}),onPerPageSelect:(e,t)=>this.setState({pagination:{page:1,perPage:t}})}))}}const Xe=(0,S.connect)((0,k.X1)((e=>({isWritePermission:D.c5.isCostModelWritePermission(e)}))))((0,O.withTranslation)()(Ke));class Ue extends C().Component{constructor(){super(...arguments),this.state={dialogSource:null}}render(){const{setDialogOpen:e,isLoading:t,sources:a,costModel:s,t:n,isDialogOpen:r}=this.props;return C().createElement(C().Fragment,null,r.addSource&&C().createElement(ze,{costModel:s,isOpen:!0,onClose:()=>e({name:"addSource",isOpen:!1}),onSave:e=>{this.props.updateCostModel(s.uuid,Object.assign(Object.assign({},s),{source_type:"OpenShift Container Platform"===s.source_type?"OCP":"AWS",source_uuids:e}),"addSource")}}),C().createElement(he,{isSmall:!0,isOpen:r.deleteSource,title:n("dialog.delete_source_from_cost_model_title",{source:this.state.dialogSource,cost_model:s.name}),onClose:()=>{e({name:"deleteSource",isOpen:!1}),this.setState({dialogSource:null})},isProcessing:t,onProceed:()=>{const e=Object.assign(Object.assign({},s),{source_type:"OpenShift Container Platform"===s.source_type?"OCP":"AWS",source_uuids:a.filter((e=>e.name!==this.state.dialogSource)).map((e=>e.uuid))});this.props.updateCostModel(s.uuid,e,"deleteSource")},body:n("dialog.delete_source_from_cost_model_body",{source:this.state.dialogSource,cost_model:s.name}),actionText:n("dialog.deleteSource")}),C().createElement(Xe,{onDeleteText:n("cost_models_details.action_unassign"),onDelete:t=>{this.setState({dialogSource:t[0]}),e({name:"deleteSource",isOpen:!0})},onAdd:()=>e({name:"addSource",isOpen:!0}),rows:a.map((e=>e.name))}))}}const Ge=(0,S.connect)((0,k.X1)((e=>({isLoading:M.E6.updateProcessing(e),isDialogOpen:M.E6.isDialogOpen(e)("sources")}))),{setDialogOpen:M.F0.setCostModelDialog,updateCostModel:M.F0.updateCostModel})((0,O.withTranslation)()(Ue));var Je=a(73466),Ve=a(81787),Qe=a(49382),Ye=a(32412),et=a(48196);const tt={headerDescription:{width:"97%",wordWrap:"break-word"},content:{paddingTop:Z.ZP.value,height:"182vh"},costmodelsContainer:{marginLeft:Z.ZP.value,marginRight:Z.ZP.value,backgroundColor:Qe.ZP.value,paddingBottom:Ye.ZP.value,paddingTop:Ye.ZP.value},headerCostModel:{padding:Z.ZP.var,paddingBottom:0,backgroundColor:Qe.ZP.value},title:{paddingBottom:et.ZP.var}};var at=a(64029),st=a(32835),nt=a(79851),rt=a(34512),ot=a(90832),it=a(48099),lt=a(29873);const ct={headerDescription:{width:"97%",wordWrap:"break-word"},content:{paddingTop:Z.ZP.value,height:"182vh"},costmodelsContainer:{marginLeft:Z.ZP.value,marginRight:Z.ZP.value,paddingBottom:Ye.ZP.value,paddingTop:Ye.ZP.value,paddingLeft:Z.ZP.value,paddingRight:Z.ZP.value},tableContainer:{marginLeft:Z.ZP.value,marginRight:Z.ZP.value},paginationContainer:{paddingBottom:Ye.ZP.value,paddingTop:Ye.ZP.value,paddingLeft:Z.ZP.value,paddingRight:Z.ZP.value,marginLeft:Z.ZP.value,marginRight:Z.ZP.value,marginBottom:Z.ZP.value,backgroundColor:Qe.ZP.value},toolbarContainer:{paddingBottom:Ye.ZP.value,paddingTop:Ye.ZP.value,marginLeft:Z.ZP.value,marginRight:Z.ZP.value,backgroundColor:Qe.ZP.value},header:{padding:Z.ZP.var,backgroundColor:Qe.ZP.var},headerCostModel:{padding:Z.ZP.value,paddingBottom:0,backgroundColor:Qe.ZP.var},breadcrumb:{paddingBottom:Ye.ZP.var},title:{paddingBottom:et.ZP.var},sourceTypeTitle:{paddingBottom:Ye.ZP.var}};var dt=a(23393);class pt extends C().Component{constructor(e){super(e);const t=this.props.costModel[0];this.state={name:t.name,description:t.description}}render(){const{updateCostModel:e,updateError:t,costModel:a,isProcessing:s,setDialogOpen:n,t:r}=this.props,o=a[0];return C().createElement(F.u,{title:r("cost_models_details.edit_cost_model"),isOpen:!0,onClose:()=>n({name:"updateCostModel",isOpen:!1}),variant:"small",actions:[C().createElement(T.zx,{key:"proceed",variant:"primary",onClick:()=>{const{uuid:t,sources:a}=o,s=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a}(o,["uuid","sources"]);e(t,Object.assign(Object.assign({},s),{source_uuids:a.map((e=>e.uuid)),name:this.state.name,description:this.state.description,source_type:"OpenShift Container Platform"===o.source_type?"OCP":"AWS"}),"updateCostModel")},isDisabled:s||this.state.name===o.name&&this.state.description===o.description},r("cost_models_details.save_button")),C().createElement(T.zx,{key:"cancel",variant:"secondary",onClick:()=>n({name:"updateCostModel",isOpen:!1}),isDisabled:s},r("dialog.cancel"))]},C().createElement(C().Fragment,null,t&&C().createElement(L.b,{variant:"danger",title:`${t}`}),C().createElement(I.l,null,C().createElement(W.c,{label:r("name"),isRequired:!0,fieldId:"name"},C().createElement(A.oi,{isRequired:!0,type:"text",id:"name",name:"name",value:this.state.name,onChange:e=>this.setState({name:e})})),C().createElement(W.c,{label:r("description"),fieldId:"description"},C().createElement(dt.Kx,{type:"text",id:"description",name:"description",value:this.state.description,onChange:e=>this.setState({description:e})})))))}}const mt=(0,O.withTranslation)()((0,S.connect)((0,k.X1)((e=>({costModel:M.E6.costModels(e),isProcessing:M.E6.updateProcessing(e),updateError:M.E6.updateError(e)}))),{setDialogOpen:M.F0.setCostModelDialog,updateCostModel:M.F0.updateCostModel})(pt));var ut=a(57954),gt=a(97828);const ht=(0,S.connect)((0,k.X1)((e=>({isDialogOpen:M.E6.isDialogOpen(e)("costmodel"),isDeleteProcessing:M.E6.deleteProcessing(e),deleteError:M.E6.deleteError(e),isWritePermission:D.c5.isCostModelWritePermission(e)}))),{setDialogOpen:M.F0.setCostModelDialog,deleteCostModel:M.F0.deleteCostModel})((0,O.withTranslation)()((({t:e,tabRefs:t,tabIndex:a,onSelectTab:s,setDialogOpen:n,isDialogOpen:o,deleteError:i,isDeleteProcessing:l,deleteCostModel:c,current:d,isWritePermission:p,historyObject:m})=>{const[u,g]=C().useState(!1),h=(0,gt.e)(window.location.pathname);return C().createElement(C().Fragment,null,o.updateCostModel&&C().createElement(mt,null),C().createElement(he,{isSmall:!0,isOpen:o.deleteCostModel,title:e("dialog.delete_cost_model_title"),onClose:()=>n({name:"deleteCostModel",isOpen:!1}),error:i,isProcessing:l,onProceed:()=>{c(d.uuid,"deleteCostModel",m)},body:C().createElement(C().Fragment,null,0===d.sources.length&&e("dialog.delete_cost_model_body_green",{cost_model:d.name}),d.sources.length>0&&C().createElement(C().Fragment,null,e("dialog.delete_cost_model_body_red",{cost_model:d.name}),C().createElement("br",null),C().createElement("br",null),e("dialog.delete_cost_model_body_red_costmodel_delete"),C().createElement("br",null),C().createElement(U.aV,null,d.sources.map((e=>C().createElement(G.H,{key:`${e.uuid}`},e.name)))))),actionText:0===d.sources.length?e("dialog.deleteCostModel"):""}),C().createElement("header",{style:ct.headerCostModel},C().createElement(at.a,{style:ct.breadcrumb},C().createElement(st.g,{to:`${h}${ut.Hb.costModels}`},e("cost_models_details.cost_model.cost_models")),C().createElement(st.g,{isActive:!0},d.name)),C().createElement(nt.P,null,C().createElement(rt.J,{style:ct.headerDescription},C().createElement(r.D,{headingLevel:"h2",style:ct.title,size:"2xl"},d.name),d.description&&C().createElement(r.D,{headingLevel:"h2",style:ct.title,size:"md"},d.description),C().createElement(r.D,{headingLevel:"h2",style:ct.sourceTypeTitle,size:"md"},e("cost_models_details.cost_model.source_type"),": ",d.source_type),"OpenShift Container Platform"===d.source_type?C().createElement(ot.m,{activeKey:a,onSelect:(e,t)=>s(t)},C().createElement(it.O,{eventKey:0,title:C().createElement(lt.T,null,"Price list"),tabContentId:"refPriceList",tabContentRef:t[0]}),C().createElement(it.O,{eventKey:1,title:C().createElement(lt.T,null,"Markup"),tabContentId:"refMarkup",tabContentRef:t[1]}),C().createElement(it.O,{eventKey:2,title:C().createElement(lt.T,null,"Sources"),tabContentId:"refSources",tabContentRef:t[2]})):C().createElement(ot.m,{activeKey:a,onSelect:(e,t)=>s(t)},C().createElement(it.O,{eventKey:0,title:C().createElement(lt.T,null,"Markup"),tabContentId:"refMarkup",tabContentRef:t[0]}),C().createElement(it.O,{eventKey:1,title:C().createElement(lt.T,null,"Sources"),tabContentId:"refSources",tabContentRef:t[1]}))),C().createElement(rt.J,null,C().createElement(E.L,{toggle:C().createElement(_.a,{onToggle:g}),isOpen:u,onSelect:()=>g(!1),isPlain:!0,position:"right",dropdownItems:[C().createElement(y.j,{key:"edit",isDisabled:!p},C().createElement(v.h,{isDisabled:!p,onClick:()=>n({isOpen:!0,name:"updateCostModel"})},e("cost_models_details.action_edit"))),C().createElement(y.j,{key:"delete",isDisabled:!p},C().createElement(v.h,{isDisabled:!p,onClick:()=>n({isOpen:!0,name:"deleteCostModel"})},e("cost_models_details.action_delete")))]})))))})));class Et extends C().Component{constructor(e){super(e),this.tabRefs=[C().createRef(),C().createRef(),C().createRef()],this.state={tabIndex:0}}componentDidMount(){this.props.fetchRbac(),this.props.fetchMetrics(),this.props.fetchCostModels(`uuid=${this.props.match.params.uuid}`)}render(){const{costModels:e,metricsStatus:t,rbacStatus:a,costModelStatus:m,rbacError:u,costModelError:g,metricsError:h}=this.props;if(2!==t||2!==a||2!==m)return C().createElement(O.Translation,null,(e=>C().createElement(Je.Z,{title:e("cost_models_details.header.title")})));if(h||u||g)return null!==g&&"detail: Invalid provider uuid"===(0,fe.L)(g)?C().createElement(O.Translation,null,(e=>C().createElement(C().Fragment,null,C().createElement(d.Z,null,C().createElement(p.Z,{title:e("cost_models_details.header.title")})),C().createElement(c.Z,null,C().createElement(s.u,null,C().createElement(n.k,{icon:l.g_}),C().createElement(r.D,{headingLevel:"h2",size:"lg"},e("cost_models_details.empty_state_bad_uuid.title")),C().createElement(o.B,null,e("cost_models_details.empty_state_bad_uuid.description",{uuid:this.props.match.params.uuid}))))))):C().createElement(O.Translation,null,(e=>C().createElement(Ve.Z,{title:e("cost_models_details.header.title")})));const E=e[0],_=E.sources;return C().createElement("div",null,C().createElement(ht,{historyObject:this.props.history,current:E,tabRefs:this.tabRefs,tabIndex:this.state.tabIndex,onSelectTab:e=>this.setState({tabIndex:e})}),C().createElement("div",{style:tt.content},"OpenShift Container Platform"===E.source_type?C().createElement(C().Fragment,null,C().createElement(i.I,{eventKey:0,id:"refPriceList",ref:this.tabRefs[0],hidden:0!==this.state.tabIndex},C().createElement("div",{style:tt.costmodelsContainer},C().createElement(ve,{costModel:E.name,assignees:_.map((e=>e.name)),current:E}))),C().createElement(i.I,{eventKey:1,id:"refMarkup",ref:this.tabRefs[1],hidden:1!==this.state.tabIndex},C().createElement(X,{current:E})),C().createElement(i.I,{eventKey:2,id:"refSources",ref:this.tabRefs[2],hidden:2!==this.state.tabIndex},C().createElement("div",{style:tt.costmodelsContainer},C().createElement(Ge,{costModel:E,sources:_})))):C().createElement(C().Fragment,null,C().createElement(i.I,{eventKey:0,id:"refMarkup",ref:this.tabRefs[0],hidden:0!==this.state.tabIndex},C().createElement(X,{current:E})),C().createElement(i.I,{eventKey:1,id:"refSources",ref:this.tabRefs[1],hidden:1!==this.state.tabIndex},C().createElement("div",{style:tt.costmodelsContainer},C().createElement(Ge,{costModel:E,sources:_}))))))}}const _t=(0,S.connect)((0,k.X1)((e=>({costModels:M.E6.costModels(e),costModelError:M.E6.error(e),costModelStatus:M.E6.status(e),metricsHash:de.qw.metrics(e),maxRate:de.qw.maxRate(e),costTypes:de.qw.costTypes(e),metricsError:de.qw.metricsState(e).error,metricsStatus:de.qw.status(e),rbacError:D.c5.selectRbacState(e).error,rbacStatus:D.c5.selectRbacState(e).status}))),{fetchMetrics:de.Wg.fetchMetrics,fetchRbac:D.O9.fetchRbac,fetchCostModels:M.F0.fetchCostModels})(Et)},73466:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var s=a(16177),n=a(48716),r=a(39173),o=a(52413),i=a(97522),l=a.n(i);const c=(0,a(55399).withRouter)((({title:e})=>l().createElement(l().Fragment,null,e&&l().createElement(n.Z,null,l().createElement(r.Z,{title:e})),l().createElement(s.Z,null,l().createElement(o.G,null)))))},81787:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var s=a(16177),n=a(48716),r=a(39173),o=a(20167),i=a(97522),l=a.n(i);const c=(0,a(55399).withRouter)((({title:e})=>l().createElement(l().Fragment,null,e&&l().createElement(n.Z,null,l().createElement(r.Z,{title:e})),l().createElement(s.Z,null,l().createElement(o.Z,null)))))}}]);
//# sourceMappingURL=4688d6151302a13128dc.bundle.js.map