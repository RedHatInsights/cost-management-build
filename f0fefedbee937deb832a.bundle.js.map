{"version":3,"sources":["webpack://koku-ui/./src/api/queries/query.ts","webpack://koku-ui/./src/federatedEntry.tsx","webpack://koku-ui/./src/store/providers/providersActions.ts","webpack://koku-ui/./src/store/providers/providersReducer.ts","webpack://koku-ui/./src/store/userAccess/userAccessActions.ts","webpack://koku-ui/./src/store/userAccess/userAccessReducer.ts"],"names":["logicalAndPrefix","tagPrefix","breakdownDescKey","breakdownTitleKey","orgUnitIdKey","orgUnitNameKey","tagKey","getQueryRoute","query","stringify","encode","indices","getQuery","prefix","logicalOrPrefix","hasMultipleBys","param","keys","Object","length","key","Array","isArray","indexOf","addGroupByPrefix","_newQuery","filter_by","newQuery","assign","JSON","parse","newKey","addFilterByPrifix","group_by","addGroupByPrifix","undefined","filter","push","convertFilterBy","parseQuery","index","filterByKey","substring","parseFilterByPrefix","groupByKey","parseGroupByPrefix","ignoreQueryPrefix","version","store","Provider","NotificationsPortal","basename","window","location","pathname","fetchProvidersRequest","createAction","fetchProvidersSuccess","fetchProvidersFailure","fetchProviders","reportType","dispatch","meta","reportId","then","res","data","catch","err","defaultState","byId","Map","errors","fetchStatus","providersReducer","state","action","type","getType","set","payload","fetchUserAccessRequest","fetchUserAccessSuccess","fetchUserAccessFailure","fetchUserAccess","userAccessReducer"],"mappings":"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","file":"f0fefedbee937deb832a.bundle.js","sourcesContent":["import { parse, stringify } from 'qs';\nexport const logicalOrPrefix = 'or:'; // logical OR prefix for group_by\nexport const logicalAndPrefix = 'and:'; // logical AND prefix for group_by\nexport const tagPrefix = 'tag:'; // Tag prefix for group_by\nexport const breakdownDescKey = 'breakdown_desc'; // Used to display a description in the breakdown header\nexport const breakdownGroupByKey = 'breakdown_group_by'; // Used to display a breadcrumb in the breakdown header\nexport const breakdownTitleKey = 'breakdown_title'; // Used to display a title in the breakdown header\nexport const orgUnitIdKey = 'org_unit_id'; // Org unit ID for group_by\nexport const orgUnitNameKey = 'org_unit_name'; // Org unit name for group_by\nexport const tagKey = 'tag'; // Tag key prefix for group_by\n// Adds group_by prefix -- https://github.com/project-koku/koku-ui/issues/704\nexport function addFilterByPrifix(query, prefix = logicalOrPrefix) {\n    if (!(query && query.filter_by)) {\n        return query;\n    }\n    const newQuery = Object.assign(Object.assign({}, JSON.parse(JSON.stringify(query))), { filter_by: {} });\n    for (const key of Object.keys(query.filter_by)) {\n        // Prefix may be set externally\n        const newKey = key.indexOf(logicalOrPrefix) === -1 && key.indexOf(logicalAndPrefix) === -1 ? `${prefix}${key}` : key;\n        newQuery.filter_by[newKey] = query.filter_by[key];\n    }\n    return newQuery;\n}\n// Adds group_by prefix -- https://github.com/project-koku/koku-ui/issues/704\nexport function addGroupByPrifix(query, prefix = logicalOrPrefix) {\n    if (!(query && query.group_by)) {\n        return query;\n    }\n    const newQuery = Object.assign(Object.assign({}, JSON.parse(JSON.stringify(query))), { group_by: {} });\n    for (const key of Object.keys(query.group_by)) {\n        newQuery.group_by[`${prefix}${key}`] = query.group_by[key];\n    }\n    return newQuery;\n}\n// Converts filter_by props to filter props\nexport function convertFilterBy(query) {\n    if (!(query && query.filter_by)) {\n        return query;\n    }\n    const newQuery = Object.assign(Object.assign({}, JSON.parse(JSON.stringify(query))), { filter_by: undefined });\n    for (const key of Object.keys(query.filter_by)) {\n        if (!newQuery.filter) {\n            newQuery.filter = {};\n        }\n        if (newQuery.filter[key]) {\n            if (!Array.isArray(newQuery.filter[key])) {\n                newQuery.filter[key] = newQuery.filter[key] !== '*' ? [newQuery.filter[key]] : [];\n            }\n            newQuery.filter[key].push(query.filter_by[key]);\n        }\n        else {\n            newQuery.filter[key] = query.filter_by[key];\n        }\n    }\n    return newQuery;\n}\n// Returns query without group_by prefix\nexport function getQueryRoute(query) {\n    return stringify(query, { encode: false, indices: false });\n}\n// Returns query and adds group_by prefix\nexport function getQuery(query, prefix = logicalOrPrefix) {\n    // Workaround for https://github.com/project-koku/koku/issues/1596\n    const hasMultipleBys = param => {\n        if (query && query[param]) {\n            const keys = Object.keys(query[param]);\n            if (keys && keys.length > 1) {\n                return true;\n            }\n            else {\n                // Find a tag (#1596) or group_by with multiple keys\n                for (const key of keys) {\n                    if ((Array.isArray(query[param][key]) && query[param][key].length > 1) || key.indexOf(tagPrefix) !== -1) {\n                        return true;\n                    }\n                }\n            }\n        }\n    };\n    // Skip adding logical OR/AND prefix for a single group_by / filter_by params\n    const addGroupByPrefix = hasMultipleBys('group_by');\n    const addFilterByPrefix = hasMultipleBys('filter_by');\n    const _newQuery = addFilterByPrefix ? addFilterByPrifix(query, prefix) : query;\n    const newQuery = addGroupByPrefix ? addGroupByPrifix(_newQuery, prefix) : _newQuery;\n    return stringify(convertFilterBy(newQuery), { encode: false, indices: false });\n}\n// Returns query without filter_by prefix\nexport function parseFilterByPrefix(query, prefix = logicalOrPrefix) {\n    if (!(query && query.filter_by)) {\n        return query;\n    }\n    const newQuery = Object.assign(Object.assign({}, JSON.parse(JSON.stringify(query))), { filter_by: {} });\n    for (const key of Object.keys(query.filter_by)) {\n        const index = key.indexOf(prefix);\n        const filterByKey = index !== -1 ? key.substring(index + prefix.length) : key;\n        newQuery.filter_by[filterByKey] = query.filter_by[key];\n    }\n    return newQuery;\n}\n// Returns query without group_by prefix -- https://github.com/project-koku/koku-ui/issues/704\nexport function parseGroupByPrefix(query, prefix = logicalOrPrefix) {\n    if (!(query && query.group_by)) {\n        return query;\n    }\n    const newQuery = Object.assign(Object.assign({}, JSON.parse(JSON.stringify(query))), { group_by: {} });\n    for (const key of Object.keys(query.group_by)) {\n        const index = key.indexOf(prefix);\n        const groupByKey = index !== -1 ? key.substring(index + prefix.length) : key;\n        newQuery.group_by[groupByKey] = query.group_by[key];\n    }\n    return newQuery;\n}\nexport function parseQuery(query) {\n    const newQuery = parse(query, { ignoreQueryPrefix: true });\n    return parseFilterByPrefix(parseGroupByPrefix(newQuery));\n}\n","import { NotificationsPortal } from '@redhat-cloud-services/frontend-components-notifications';\nimport { initApi } from 'api/api';\nimport React from 'react';\nimport { Provider } from 'react-redux';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport { getBaseName } from 'utils/getBaseName';\nimport App from './app';\nimport { configureStore } from './store';\nrequire.resolve('@patternfly/patternfly/patternfly-addons.css');\nimport './styles/global.css';\ninitApi({\n    version: 'v1',\n});\nconst store = configureStore({\n// session: {\n//   token: getToken(),\n// },\n});\nexport default () => (React.createElement(Provider, { store: store },\n    React.createElement(NotificationsPortal, null),\n    React.createElement(Router, { basename: getBaseName(window.location.pathname) },\n        React.createElement(App, null))));\n","import { fetchProviders as apiGetProviders } from 'api/providers';\nimport { createAction } from 'typesafe-actions';\nimport { getReportId } from './providersCommon';\nexport const fetchProvidersRequest = createAction('providers/fetch/request')();\nexport const fetchProvidersSuccess = createAction('providers/fetch/success')();\nexport const fetchProvidersFailure = createAction('providers/fetch/failure')();\nexport function fetchProviders(reportType, query) {\n    return dispatch => {\n        const meta = {\n            reportId: getReportId(reportType, query),\n        };\n        dispatch(fetchProvidersRequest(meta));\n        return apiGetProviders(query)\n            .then(res => {\n            dispatch(fetchProvidersSuccess(res.data, meta));\n        })\n            .catch(err => {\n            dispatch(fetchProvidersFailure(err, meta));\n        });\n    };\n}\nexport const clearProviderFailure = createAction('providers/clear/failure');\n","import { getType } from 'typesafe-actions';\nimport { fetchProvidersFailure, fetchProvidersRequest, fetchProvidersSuccess } from './providersActions';\nexport const defaultState = {\n    byId: new Map(),\n    errors: new Map(),\n    fetchStatus: new Map(),\n};\nexport function providersReducer(state = defaultState, action) {\n    switch (action.type) {\n        case getType(fetchProvidersRequest):\n            return Object.assign(Object.assign({}, state), { fetchStatus: new Map(state.fetchStatus).set(action.payload.reportId, 1 /* inProgress */) });\n        case getType(fetchProvidersSuccess):\n            return Object.assign(Object.assign({}, state), { fetchStatus: new Map(state.fetchStatus).set(action.meta.reportId, 2 /* complete */), byId: new Map(state.byId).set(action.meta.reportId, Object.assign({}, action.payload)), errors: new Map(state.errors).set(action.meta.reportId, null) });\n        case getType(fetchProvidersFailure):\n            return Object.assign(Object.assign({}, state), { fetchStatus: new Map(state.fetchStatus).set(action.meta.reportId, 2 /* complete */), errors: new Map(state.errors).set(action.meta.reportId, action.payload) });\n        default:\n            return state;\n    }\n}\n","import { fetchUserAccess as apiGetUserAccess } from 'api/userAccess';\nimport { createAction } from 'typesafe-actions';\nimport { getReportId } from './userAccessCommon';\nexport const fetchUserAccessRequest = createAction('userAccess/fetch/request')();\nexport const fetchUserAccessSuccess = createAction('userAccess/fetch/success')();\nexport const fetchUserAccessFailure = createAction('userAccess/fetch/failure')();\nexport function fetchUserAccess(reportType, query) {\n    return dispatch => {\n        const meta = {\n            reportId: getReportId(reportType, query),\n        };\n        dispatch(fetchUserAccessRequest(meta));\n        return apiGetUserAccess(query)\n            .then(res => {\n            dispatch(fetchUserAccessSuccess(res.data, meta));\n        })\n            .catch(err => {\n            dispatch(fetchUserAccessFailure(err, meta));\n        });\n    };\n}\nexport const clearuserAccessFailure = createAction('userAccess/clear/failure');\n","import { getType } from 'typesafe-actions';\nimport { fetchUserAccessFailure, fetchUserAccessRequest, fetchUserAccessSuccess } from './userAccessActions';\nexport const defaultState = {\n    byId: new Map(),\n    errors: new Map(),\n    fetchStatus: new Map(),\n};\nexport function userAccessReducer(state = defaultState, action) {\n    switch (action.type) {\n        case getType(fetchUserAccessRequest):\n            return Object.assign(Object.assign({}, state), { fetchStatus: new Map(state.fetchStatus).set(action.payload.reportId, 1 /* inProgress */) });\n        case getType(fetchUserAccessSuccess):\n            return Object.assign(Object.assign({}, state), { fetchStatus: new Map(state.fetchStatus).set(action.meta.reportId, 2 /* complete */), byId: new Map(state.byId).set(action.meta.reportId, Object.assign({}, action.payload)), errors: new Map(state.errors).set(action.meta.reportId, null) });\n        case getType(fetchUserAccessFailure):\n            return Object.assign(Object.assign({}, state), { fetchStatus: new Map(state.fetchStatus).set(action.meta.reportId, 2 /* complete */), errors: new Map(state.errors).set(action.meta.reportId, action.payload) });\n        default:\n            return state;\n    }\n}\n"],"sourceRoot":""}