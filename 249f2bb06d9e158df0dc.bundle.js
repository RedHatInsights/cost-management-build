(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[9831],{16679:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});const a=r(64146).Z},81787:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var a=r(16177),s=r(48716),n=r(39173),o=r(20167),i=r(97522),l=r.n(i);const c=(0,r(55399).withRouter)((({title:e})=>l().createElement(l().Fragment,null,e&&l().createElement(s.Z,null,l().createElement(n.Z,{title:e})),l().createElement(a.Z,null,l().createElement(o.Z,null)))))},17824:(e,t,r)=>{"use strict";r.d(t,{k:()=>M});var a=r(84457),s=r(56787),n=r(99355),o=r(75728),i=r(9571),l=r(35248),c=r(65802),u=r(92607),p=r(47173),h=r(1211),d=r(64403),g=r(92694),m=r(1595),y=r(84812),b=r(78919),f=r(12466),v=r(33109),_=r(1657),S=r(8755),C=r(71070),E=r(45997),O=r(17230),k=r(97522),T=r.n(k),D=r(57827),B=r(19853),w=r(49382),x=r(98499),R=r(32412);const P={export:{marginRight:R.ZP.value},toolbarContainer:{backgroundColor:w.ZP.value,paddingBottom:R.ZP.value,paddingTop:R.ZP.value,marginLeft:x.ZP.value,marginRight:x.ZP.value}};const V={tag:{}};class j extends T().Component{constructor(){super(...arguments),this.defaultState={categoryInput:"",filters:(0,O.cloneDeep)(V),isBulkSelectOpen:!1,isCategoryDropdownOpen:!1,isOrgUnitSelectExpanded:!1,isTagValueDropdownOpen:!1,isTagKeySelectExpanded:!1,isTagValueSelectExpanded:!1,tagKeyValueInput:""},this.state=Object.assign({},this.defaultState),this.getDefaultCategory=()=>{const{categoryOptions:e,groupBy:t,query:r}=this.props;if(!e)return"name";if(r&&r.group_by&&r.group_by[E.dV])return E.dV;for(const r of e)if(t===r.key||t&&-1!==t.indexOf(E.P)&&r.key===E.up)return r.key;return e[0].key},this.getActiveFilters=e=>{const t=(0,O.cloneDeep)(V);return e&&e.filter_by&&Object.keys(e.filter_by).forEach((r=>{const a=Array.isArray(e.filter_by[r])?[...e.filter_by[r]]:[e.filter_by[r]];-1!==r.indexOf(E.P)?t.tag[r.substring(E.P.length)]=a:t[r]=a})),t},this.onDelete=(e,t)=>{const r=e&&e.key?e.key:e,a=t&&t.key?t.key:t;r?this.setState((e=>(e.filters.tag[r]?e.filters.tag[r]=e.filters.tag[r].filter((e=>e!==a)):e.filters[r]&&(e.filters[r]=e.filters[r].filter((e=>e!==a))),{filters:e.filters})),(()=>{const{filters:e}=this.state,t=e.tag[r]?`${E.P}${r}`:r;this.props.onFilterRemoved(t,a)})):this.setState({filters:(0,O.cloneDeep)(V)},(()=>{this.props.onFilterRemoved(null)}))},this.getBulkSelect=()=>{const{isAllSelected:e,isBulkSelectDisabled:t,isDisabled:r,itemsPerPage:l,itemsTotal:c,selectedItems:u,t:p}=this.props,{isBulkSelectOpen:h}=this.state,d=e?c:u?u.length:0,g=d>0,m=!(!e&&d!==c||!(c>0))||!!g&&null,y=[T().createElement(a.h,{key:"item-1",onClick:()=>this.onBulkSelectClicked("none")},p("toolbar.bulk_select.select_none")),T().createElement(a.h,{key:"item-2",onClick:()=>this.onBulkSelectClicked("page")},p("toolbar.bulk_select.select_page",{value:l})),T().createElement(a.h,{key:"item-3",onClick:()=>this.onBulkSelectClicked("all")},p("toolbar.bulk_select.select_all",{value:c}))];return T().createElement(s.L,{onSelect:this.onBulkSelect,position:n.ir.left,toggle:T().createElement(o.Z,{isDisabled:r||t,splitButtonItems:[T().createElement(i.o,{id:"bulk-select",key:"bulk-select","aria-label":p(g?"toolbar.bulk_select.aria_deselect":"toolbar.bulk_select.aria_select"),isChecked:m,onClick:()=>{g?this.onBulkSelectClicked("none"):this.onBulkSelectClicked("all")}})],onToggle:this.onBulkSelectToggle},0!==d&&T().createElement(T().Fragment,null,d," selected")),isOpen:h,dropdownItems:y})},this.onBulkSelectClicked=e=>{const{onBulkSelected:t}=this.props;t&&t(e)},this.onBulkSelect=()=>{this.setState({isBulkSelectOpen:!this.state.isBulkSelectOpen})},this.onBulkSelectToggle=e=>{this.setState({isBulkSelectOpen:e})},this.getCurrentCategoryOption=()=>{const{categoryOptions:e}=this.props,{currentCategory:t}=this.state;if(e){for(const r of e)if(t===r.key)return r;return e[0]}},this.onCategoryClick=e=>{this.setState({currentCategory:e})},this.onCategorySelect=()=>{this.setState({categoryInput:"",currentTagKey:void 0,isCategoryDropdownOpen:!this.state.isCategoryDropdownOpen})},this.onCategoryToggle=e=>{this.setState({isCategoryDropdownOpen:e})},this.getCategoryInput=e=>{const{isDisabled:t,t:r}=this.props,{currentCategory:a,filters:s,categoryInput:n}=this.state;return T().createElement(l.p,{categoryName:e,chips:s[e.key],deleteChip:this.onDelete,key:e.key,showToolbarItem:a===e.key},T().createElement(c.B,null,T().createElement(u.oi,{isDisabled:t,name:`${e.key}-input`,id:`${e.key}-input`,type:"search","aria-label":r(`filter_by.${e.key}.input_aria_label`),onChange:this.onCategoryInputChange,value:n,placeholder:r(`filter_by.${e.key}.placeholder`),onKeyDown:t=>this.onCategoryInput(t,e.key)}),T().createElement(p.zx,{isDisabled:t,variant:p.Wu.control,"aria-label":r(`filter_by.${e.key}.button_aria_label`),onClick:t=>this.onCategoryInput(t,e.key)},T().createElement(C.W1,null))))},this.getDefaultCategoryOptions=()=>{const{t:e}=this.props;return[{name:e("filter_by.values.name"),key:"name"}]},this.onCategoryInputChange=e=>{this.setState({categoryInput:e})},this.onCategoryInput=(e,t)=>{const{categoryInput:r,currentCategory:a}=this.state;e.key&&"Enter"!==e.key||""===r.trim()||this.setState((e=>{const s=e.filters[t];return{filters:Object.assign(Object.assign({},e.filters),{[a]:s&&s.includes(r)?s:s?[...s,r]:[r]}),categoryInput:""}}),(()=>{this.props.onFilterAdded(a,r)}))},this.getOrgUnitSelect=()=>{const{isDisabled:e,t}=this.props,{currentCategory:r,filters:a,isOrgUnitSelectExpanded:s}=this.state,n=this.getOrgUnitOptions().map((e=>({id:e.key,toString:()=>e.name,compareTo:e=>!!a[E.dV]&&a[E.dV].find((t=>t===e.id))}))),o=[],i=[];return a[E.dV]&&Array.isArray(a[E.dV])&&a[E.dV].map((e=>{const t=n.find((t=>t.id===e));t&&(i.push(t),o.push({key:t.id,node:t.toString()}))})),T().createElement(l.p,{categoryName:{key:E.dV,name:t("filter_by.values.org_unit_id")},chips:o,deleteChip:this.onDelete,key:E.dV,showToolbarItem:r===E.dV},T().createElement(h.P,{isDisabled:e,className:"selectOverride",variant:d.TM.checkbox,"aria-label":t("filter_by.org_unit.aria_label"),onToggle:this.onOrgUnitToggle,onSelect:this.onOrgUnitSelect,selections:i,isOpen:s,placeholderText:t("filter_by.org_unit.placeholder")},n.map((e=>T().createElement(g.$,{description:e.id,key:e.id,value:e})))))},this.onOrgUnitSelect=(e,t)=>{const r=e.target.checked;this.setState((e=>{const a=e.filters[E.dV]?e.filters[E.dV]:[];return{filters:Object.assign(Object.assign({},e.filters),{tag:Object.assign({},e.filters.tag),[E.dV]:r?[...a,t.id]:a.filter((e=>e!==t.id))})}}),(()=>{r?this.props.onFilterAdded(E.dV,t.id):this.onDelete(E.dV,t.id)}))},this.onOrgUnitToggle=e=>{this.setState({isOrgUnitSelectExpanded:e})},this.getTagKeySelect=()=>{const{isDisabled:e,t}=this.props,{currentCategory:r,currentTagKey:a,isTagKeySelectExpanded:s}=this.state;if(r!==E.up)return null;const n=this.getTagKeyOptions().map((e=>T().createElement(g.$,{key:e.key,value:e.key})));return T().createElement(m.E,null,T().createElement(h.P,{isDisabled:e,variant:d.TM.typeahead,"aria-label":t("filter_by.tag_key.aria_label"),onClear:this.onTagKeyClear,onToggle:this.onTagKeyToggle,onSelect:this.onTagKeySelect,isOpen:s,placeholderText:t("filter_by.tag_key.placeholder"),selections:a},n))},this.onTagKeyClear=()=>{this.setState({currentTagKey:void 0,isTagKeySelectExpanded:!1})},this.onTagKeySelect=(e,t)=>{this.setState({currentTagKey:t,isTagKeySelectExpanded:!this.state.isTagKeySelectExpanded})},this.onTagKeyToggle=e=>{this.setState({isTagKeySelectExpanded:e})},this.getTagValueSelect=e=>{const{isDisabled:t,t:r}=this.props,{currentCategory:a,currentTagKey:s,filters:n,isTagValueSelectExpanded:o,tagKeyValueInput:i}=this.state,m=this.getTagValueOptions().map((e=>T().createElement(g.$,{key:e.key,value:e.key})));return T().createElement(l.p,{categoryName:e,chips:n.tag[e.key],deleteChip:this.onDelete,key:e.key,showToolbarItem:a===E.up&&s===e.key},m.length<50?T().createElement(h.P,{isDisabled:t,variant:d.TM.checkbox,"aria-label":r("filter_by.tag_value.aria_label"),onToggle:this.onTagValueToggle,onSelect:this.onTagValueSelect,selections:n.tag[e.key]?n.tag[e.key]:[],isOpen:o,placeholderText:r("filter_by.tag_value.placeholder")},m):T().createElement(c.B,null,T().createElement(u.oi,{isDisabled:t,name:"tagkeyvalue-input",id:"tagkeyvalue-input",type:"search","aria-label":r("filter_by.tag_value.aria_label"),onChange:this.onTagValueInputChange,value:i,placeholder:r("filter_by.tag_value.input_placeholder"),onKeyDown:e=>this.onTagValueInput(e)}),T().createElement(p.zx,{isDisabled:t,variant:p.Wu.control,"aria-label":r("filter_by.tag_value.button_aria_label"),onClick:e=>this.onTagValueInput(e)},T().createElement(C.W1,null))))},this.onTagValueInputChange=e=>{this.setState({tagKeyValueInput:e})},this.onTagValueInput=e=>{const{currentTagKey:t,tagKeyValueInput:r}=this.state;e.key&&"Enter"!==e.key||""===r.trim()||this.setState((e=>{const a=e.filters.tag[t]?e.filters.tag[t]:[];return{filters:Object.assign(Object.assign({},e.filters),{tag:Object.assign(Object.assign({},e.filters.tag),{[t]:[...a,r]})}),tagKeyValueInput:""}}),(()=>{this.props.onFilterAdded(`${E.P}${t}`,r)}))},this.onTagValueSelect=(e,t)=>{const{currentTagKey:r}=this.state,a=e.target.checked;this.setState((e=>{const s=e.filters.tag[r]?e.filters.tag[r]:[];return{filters:Object.assign(Object.assign({},e.filters),{tag:Object.assign(Object.assign({},e.filters.tag),{[r]:a?[...s,t]:s.filter((e=>e!==t))})})}}),(()=>{a?this.props.onFilterAdded(`${E.P}${r}`,t):this.onDelete(r,t)}))},this.onTagValueToggle=e=>{this.setState({isTagValueSelectExpanded:e})},this.getExportButton=()=>{const{isDisabled:e,isExportDisabled:t}=this.props;return T().createElement(m.E,null,T().createElement(p.zx,{isDisabled:e||t,onClick:this.handleExportClicked,variant:p.Wu.plain},T().createElement(_.Hy,null)))},this.handleExportClicked=()=>{this.props.onExportClicked()}}componentDidMount(){this.setState({currentCategory:this.getDefaultCategory()})}componentDidUpdate(e){const{categoryOptions:t,groupBy:r,orgReport:a,query:s,tagReport:n}=this.props;(t!==e.categoryOptions||r!==e.groupBy||s&&!(0,B.X)(s,e.query)||a&&!(0,B.X)(a,e.orgReport)||n&&!(0,B.X)(n,e.tagReport))&&this.setState((()=>{const a=this.getActiveFilters(s);return t!==e.categoryOptions||e.groupBy!==r?{categoryInput:"",currentCategory:this.getDefaultCategory(),currentOrgUnit:"",currentTagKey:"",tagKeyValueInput:"",filters:a}:{filters:a}}))}getCategoryDropdown(){const{categoryOptions:e,isDisabled:t}=this.props,{isCategoryDropdownOpen:r}=this.state;return e?T().createElement(m.E,null,T().createElement(s.L,{onSelect:this.onCategorySelect,position:n.ir.left,toggle:T().createElement(o.Z,{isDisabled:t,onToggle:this.onCategoryToggle,style:{width:"100%"}},T().createElement(S.k1,null)," ",this.getCurrentCategoryOption().name),isOpen:r,dropdownItems:e&&e.map((e=>T().createElement(a.h,{key:e.key,onClick:()=>this.onCategoryClick(e.key)},e.name))),style:{width:"100%"}})):null}getOrgUnitOptions(){const{orgReport:e}=this.props;let t=[];if(!e||!e.data)return t;const r=e.data.sort(((e,t)=>e[E.iP]<t[E.iP]?-1:e[E.iP]>t[E.iP]?1:0)),a=r.filter((e=>0===e.level)),s=r.filter((e=>0!==e.level));return a.map((e=>{const t=r.find((t=>t[E.dV]===e[E.dV]));s.unshift(t)})),s.length>0&&(t=s.map((e=>({key:e[E.dV],name:e[E.iP]})))),t}getTagKeyOptions(){const{tagReport:e}=this.props;let t=[],r=[];if(!e||!e.data)return r;let a=!1;for(const t of e.data)if(t.hasOwnProperty("key")){a=!0;break}if(a){const r=e.data.map((e=>{var{type:t}=e;return function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]])}return r}(e,["type"])}));t=(0,O.uniqBy)(r,"key")}else t=(0,O.uniq)(e.data);return t.length>0&&(r=t.map((e=>{const t=a?e.key:e;return{key:t,name:t}}))),r}getTagValueOptions(){const{tagReport:e}=this.props,{currentTagKey:t}=this.state;let r=[];e&&e.data&&(r=[...new Set([...e.data])]);let a=[];if(r.length>0)for(const e of r)if(t===e.key&&e.values){a=e.values.map((e=>({key:e,name:e})));break}return a}render(){const{categoryOptions:e,dateRange:t,pagination:r,showBulkSelect:a,showExport:s,showFilter:n,style:o}=this.props,i=e||this.getDefaultCategoryOptions();return T().createElement("div",{style:o||P.toolbarContainer},T().createElement(y.o,{id:"details-toolbar",clearAllFilters:this.onDelete,collapseListedFiltersBreakpoint:"xl"},T().createElement(b.c,null,T().createElement(f.R,{breakpoint:"xl",toggleIcon:T().createElement(S.k1,null)},a&&T().createElement(m.E,{variant:"bulk-select"},this.getBulkSelect()),n&&T().createElement(v.k,{variant:"filter-group"},this.getCategoryDropdown(),this.getTagKeySelect(),this.getTagKeyOptions().map((e=>this.getTagValueSelect(e))),this.getOrgUnitSelect(),i&&i.filter((e=>e.key!==E.up&&e.key!==E.dV)).map((e=>this.getCategoryInput(e)))),Boolean(s)&&T().createElement(v.k,null,this.getExportButton()),t&&T().createElement(v.k,null,t)),T().createElement(m.E,{alignment:{default:"alignRight"},variant:"pagination"},r))))}}const M=(0,D.withTranslation)()(j)},46774:(e,t,r)=>{"use strict";r.d(t,{X:()=>L});var a=r(8745),s=r(47173),n=r(83115),o=r(43627),i=r(92504),l=r(45997),c=r(36234),u=r(17230),p=r(97522),h=r.n(p),d=r(57827),g=r(86588),m=r(94377),y=r(21492),b=r(76821),f=r(32412),v=r(48196),_=r(73861);const S={form:{marginLeft:v.ZP.var},modal:{input:{marginRight:_.ZP.var},ul:{marginLeft:v.ZP.var}},title:{marginBottom:f.ZP.var}};var C=r(93562),E=r.n(C);const O="cost";class k extends h().Component{constructor(e,t){super(e,t),this.defaultState={fetchReportClicked:!1},this.state=Object.assign({},this.defaultState),this.getExport=()=>{const{report:e,reportFetchStatus:t}=this.props;e&&2===t&&(E()(e.data,this.getFileName(),"text/csv"),this.handleClose())},this.getFileName=()=>{const{groupBy:e,reportPathsType:t,resolution:r,t:a,timeScope:s}=this.props,n=new Date,o=(new Date).setMonth(n.getMonth()-1),i=(0,c.format)(n,"MMMM_yyyy"),l=(0,c.format)(o-1,"MMMM_yyyy");return`${a("export.file.name",{provider:t,groupBy:e,resolution:r,date:s&&-2===s?l:i})}.csv`},this.handleClose=()=>{this.setState(Object.assign({},this.defaultState),(()=>{this.props.onClose(!1)}))},this.handleFetchReport=()=>{const{exportReport:e,queryString:t,reportPathsType:r}=this.props;e(r,O,t),this.setState({fetchReportClicked:!0},(()=>{this.getExport()}))}}componentDidUpdate(e){const{report:t}=this.props,{fetchReportClicked:r}=this.state;e.report!==t&&r&&this.getExport()}render(){const{reportFetchStatus:e,t}=this.props;return h().createElement(s.zx,Object.assign({},(0,b.g_)(b._q.export.submit_btn),{isDisabled:1===e,key:"confirm",onClick:this.handleFetchReport,variant:s.Wu.primary}),t("export.confirm"))}}const T=(0,m.X1)(((e,t)=>{const{groupBy:r,isAllItems:a,items:s,query:n,reportPathsType:o,resolution:i,timeScope:c}=t,u=(()=>{const e=Object.assign(Object.assign({},JSON.parse(JSON.stringify(n))),{filter:{limit:void 0,offset:void 0,resolution:i||void 0,time_scope_value:c||void 0},filter_by:{},order_by:void 0,perspective:void 0,dateRange:void 0});if(n.filter_by)for(const t of Object.keys(n.filter_by))void 0===e.filter_by[t]&&(e.filter_by[t]=[]),e.filter_by[t].push(n.filter_by[t]);if(a)r===l.dV&&(void 0===e.filter_by[l.dV]&&(e.filter_by[l.dV]=[]),e.filter_by[l.dV].push(n.group_by[l.dV]));else if(r===l.dV)for(const t of s){const r="organizational_unit"===t.type?l.dV:t.type;void 0===e.filter_by[r]&&(e.filter_by[r]=[]),e.filter_by[r].push(t.id)}else for(const t of s)void 0===e.filter_by[r]&&(e.filter_by[r]=[]),e.filter_by[r].push(t.id);return(0,l.pm)(e)})();return{queryString:u,report:y.$S.selectExport(e,o,O,u),reportError:y.$S.selectExportError(e,o,O,u),reportFetchStatus:y.$S.selectExportFetchStatus(e,o,O,u)}})),D={exportReport:y.HY.Hy},B=(0,g.connect)(T,D)(k),w=(0,d.withTranslation)()(B),x=[{label:"export.resolution_daily",value:"daily"},{label:"export.resolution_monthly",value:"monthly"}],R=[{label:"export.time_scope_current",value:-1},{label:"export.time_scope_previous",value:-2}];class P extends h().Component{constructor(e,t){super(e,t),this.defaultState={timeScope:-1,resolution:this.props.resolution||"monthly"},this.state=Object.assign({},this.defaultState),this.handleClose=()=>{this.setState(Object.assign({},this.defaultState),(()=>{this.props.onClose(!1)}))},this.handleMonthChange=(e,t)=>{this.setState({timeScope:Number(t.currentTarget.value)})},this.handleResolutionChange=(e,t)=>{this.setState({resolution:t.currentTarget.value})},this.handleMonthChange=this.handleMonthChange.bind(this),this.handleResolutionChange=this.handleResolutionChange.bind(this)}render(){const{groupBy:e,isAllItems:t,items:r,query:p,reportPathsType:d,showAggregateType:g=!0,showTimeScope:m=!0,t:y}=this.props,{resolution:f,timeScope:v}=this.state;let _=[...r];this.props.isOpen&&(_=r&&0===r.length&&t?[{label:y("export.all")}]:(0,u.orderBy)(_,["label"],["asc"]));let C=y("export.selected",{groupBy:e});-1!==e.indexOf(l.P)&&(C=y("export.selected_tags"));const E=new Date,O=(new Date).setMonth(E.getMonth()-1),k=(0,c.format)(E,"MMMM yyyy"),T=(0,c.format)(O-1,"MMMM yyyy");return h().createElement(a.u,{style:S.modal,isOpen:this.props.isOpen,onClose:this.handleClose,title:y("export.title"),variant:"small",actions:[h().createElement(w,{groupBy:e,isAllItems:t,items:r,key:"confirm",timeScope:m?v:void 0,onClose:this.handleClose,query:p,reportPathsType:d,resolution:f}),h().createElement(s.zx,Object.assign({},(0,b.g_)(b._q.export.cancel_btn),{key:"cancel",onClick:this.handleClose,variant:s.Wu.link}),y("export.cancel"))]},h().createElement("div",{style:S.title},h().createElement("span",null,y("export.heading",{groupBy:e}))),h().createElement(n.l,{style:S.form},g&&h().createElement(o.c,{label:y("export.aggregate_type"),fieldId:"aggregate-type"},h().createElement(h().Fragment,null,x.map(((e,t)=>h().createElement(i.Y,{key:t,id:`resolution-${t}`,isValid:void 0!==e.value,label:y(e.label),value:e.value,checked:f===e.value,name:"resolution",onChange:this.handleResolutionChange,"aria-label":y(e.label)}))))),m&&h().createElement(o.c,{label:y("export.time_scope_title"),fieldId:"timeScope"},h().createElement(h().Fragment,null,R.map(((e,t)=>h().createElement(i.Y,{key:t,id:`timeScope-${t}`,isValid:void 0!==e.value,label:y(e.label,{date:-2===e.value?T:k}),value:e.value,checked:v===e.value,name:"timeScope",onChange:this.handleMonthChange,"aria-label":y(e.label)}))))),h().createElement(o.c,{label:C,fieldId:"selected-labels"},h().createElement("ul",null,_.map(((e,t)=>h().createElement("li",{key:t},e.label)))))))}}const V=(0,m.X1)((()=>({}))),j={exportReport:y.HY.Hy},M=(0,g.connect)(V,j)(P),L=(0,d.withTranslation)()(M)},2088:(e,t,r)=>{"use strict";r.d(t,{X:()=>R});var a=r(84457),s=r(56787),n=r(75728),o=r(45997),i=r(97522),l=r.n(i),c=r(57827),u=r(86588),p=r(94377),h=r(38434),d=r(95083);const g={groupBySelector:{display:"flex",alignItems:"center"},groupBySelectorLabel:{marginBottom:0,marginRight:r(32412).ZP.var}};var m=r(1211),y=r(64403),b=r(92694);class f extends l().Component{constructor(e){super(e),this.defaultState={defaultItem:this.props.groupBy||this.props.options[0].value,isGroupByOpen:!1},this.state=Object.assign({},this.defaultState),this.getCurrentGroupBy=()=>{const{getIdKeyForGroupBy:e}=this.props,t=(0,o.mB)(location.search),r=t&&t.group_by?Object.keys(t.group_by):[];let a=e(t.group_by);for(const e of r)if(-1!==e.indexOf(o.dV)){a=t.group_by[o.dV];break}return a},this.getGroupByItems=()=>{const{orgReport:e}=this.props;if(!e||!e.data)return[];const t=e.data.sort(((e,t)=>e[o.iP]<t[o.iP]?-1:e[o.iP]>t[o.iP]?1:0)),r=t.filter((e=>0===e.level)),a=t.filter((e=>0!==e.level));return r.map((e=>{const r=t.find((t=>t[o.dV]===e[o.dV]));a.unshift(r)})),a.map((e=>({id:e[o.dV],toString:()=>e[o.iP]})))},this.handleGroupByClear=()=>{this.setState({currentItem:void 0})},this.handleGroupBySelect=(e,t)=>{const{onItemClicked:r}=this.props;this.setState({currentItem:t.id,isGroupByOpen:!1}),r&&r(`${o.dV}${t.id}`)},this.handleGroupByToggle=e=>{this.setState({isGroupByOpen:e})},this.handleGroupByClear=this.handleGroupByClear.bind(this),this.handleGroupBySelect=this.handleGroupBySelect.bind(this),this.handleGroupByToggle=this.handleGroupByToggle.bind(this)}componentDidMount(){this.setState({currentItem:this.getCurrentGroupBy()})}componentDidUpdate(e){const{groupBy:t}=this.props;e.groupBy!==t&&this.setState({currentItem:this.getCurrentGroupBy()})}render(){const{isDisabled:e=!1,t}=this.props,{currentItem:r,isGroupByOpen:a}=this.state,s=this.getGroupByItems(),n=s.find((e=>e.id===r));return l().createElement("div",{style:g.groupBySelector},l().createElement(m.P,{"aria-label":t("group_by.org_unit_aria_label"),isDisabled:e,onClear:this.handleGroupByClear,onToggle:this.handleGroupByToggle,onSelect:this.handleGroupBySelect,isOpen:a,placeholderText:t("group_by.org_unit_placeholder"),selections:n,variant:y.TM.typeahead},s.map((e=>l().createElement(b.$,{description:e.id,key:e.id,value:e})))))}}const v=(0,c.withTranslation)()(f);var _=r(17230);class S extends l().Component{constructor(e){super(e),this.defaultState={isGroupByOpen:!1},this.state=Object.assign({},this.defaultState),this.getGroupByItems=()=>{const{tagReport:e}=this.props;if(!e||!e.data)return[];let t=!1;for(const r of e.data)if(r.hasOwnProperty("key")){t=!0;break}let r=[];if(t){const t=e.data.map((e=>{var{type:t}=e;return function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]])}return r}(e,["type"])}));r=(0,_.uniqBy)(t,"key")}else r=(0,_.uniq)(e.data);return r.map((e=>{const r=t?e.key:e;return l().createElement(b.$,{key:e.key,value:r})}))},this.getCurrentGroupBy=()=>{const e=(0,o.mB)(location.search),t=e&&e.group_by?Object.keys(e.group_by):[];let r;for(const e of t)if(-1!==e.indexOf(o.P)){r=e.slice(o.P.length);break}return r},this.handleGroupByClear=()=>{this.setState({currentItem:void 0})},this.handleGroupBySelect=(e,t)=>{const{onItemClicked:r}=this.props;this.setState({currentItem:t,isGroupByOpen:!1}),r&&r(`${o.P}${t}`)},this.handleGroupByToggle=e=>{this.setState({isGroupByOpen:e})},this.handleGroupByClear=this.handleGroupByClear.bind(this),this.handleGroupBySelect=this.handleGroupBySelect.bind(this),this.handleGroupByToggle=this.handleGroupByToggle.bind(this)}componentDidMount(){this.setState({currentItem:this.getCurrentGroupBy()})}componentDidUpdate(e){const{groupBy:t}=this.props;e.groupBy!==t&&this.setState({currentItem:this.getCurrentGroupBy()})}render(){const{isDisabled:e,t}=this.props,{currentItem:r,isGroupByOpen:a}=this.state;return l().createElement("div",{style:g.groupBySelector},l().createElement(m.P,{"aria-label":t("group_by.tag_key_aria_label"),isDisabled:e,onClear:this.handleGroupByClear,onToggle:this.handleGroupByToggle,onSelect:this.handleGroupBySelect,isOpen:a,placeholderText:t("group_by.tag_key_placeholder"),selections:r,variant:y.TM.typeahead},this.getGroupByItems()))}}const C=(0,c.withTranslation)()(S),E=[{label:o.dV,value:o.dV}],O=[{label:o.up,value:o.up}],k="org",T="tag";class D extends l().Component{constructor(e,t){super(e,t),this.defaultState={defaultItem:this.props.groupBy||this.props.options[0].value,isGroupByOpen:!1,isGroupByOrgVisible:!1,isGroupByTagVisible:!1},this.state=Object.assign({},this.defaultState),this.handleGroupByClick=e=>{const{onItemClicked:t}=this.props;e===o.dV||e===o.up?this.setState({currentItem:e,isGroupByOrgVisible:e===o.dV,isGroupByTagVisible:e===o.up}):(this.setState({currentItem:e,isGroupByOrgVisible:!1,isGroupByTagVisible:!1}),t&&t(e))},this.getGroupByItems=()=>{const{options:e,orgReport:t,tagReport:r,t:s}=this.props,n=[...e];return t&&t.data&&t.data.length>0&&n.push(...E),r&&r.data&&r.data.length>0&&n.push(...O),n.map((e=>l().createElement(a.h,{component:"button",key:e.value,onClick:()=>this.handleGroupByClick(e.value)},s(`group_by.values.${e.label}`))))},this.getCurrentGroupBy=()=>{const{getIdKeyForGroupBy:e}=this.props,{defaultItem:t}=this.state,r=(0,o.mB)(location.search);if(!r||!r.group_by)return t;let a=e(r.group_by);const s=r&&r.group_by?Object.keys(r.group_by):[];for(const e of s){let t=e.indexOf(o.P);if(-1!==t){a=o.up,this.setState({isGroupByTagVisible:!0});break}if(t=e.indexOf(o.dV),-1!==t){a=o.dV,this.setState({isGroupByOrgVisible:!0});break}}return"date"!==a?a:t},this.handleGroupBySelect=()=>{this.setState({isGroupByOpen:!this.state.isGroupByOpen})},this.handleGroupByToggle=e=>{this.setState({isGroupByOpen:e})},this.handleGroupByClick=this.handleGroupByClick.bind(this),this.handleGroupBySelect=this.handleGroupBySelect.bind(this),this.handleGroupByToggle=this.handleGroupByToggle.bind(this)}componentDidMount(){const{fetchOrg:e,fetchTag:t,orgQueryString:r,orgReportPathsType:a,showOrgs:s,showTags:n,tagQueryString:o,tagReportPathsType:i}=this.props;s&&e(a,k,r),n&&t(i,T,o),this.setState({currentItem:this.getCurrentGroupBy()})}componentDidUpdate(e){const{fetchOrg:t,fetchTag:r,groupBy:a,orgQueryString:s,orgReportPathsType:n,perspective:o,showOrgs:i,showTags:l,tagQueryString:c,tagReportPathsType:u}=this.props;if(e.groupBy!==a||e.perspective!==o){let a;i&&t(n,k,s),l&&r(u,T,c),e.perspective!==o&&(a={isGroupByOrgVisible:!1,isGroupByTagVisible:!1}),this.setState(Object.assign({currentItem:this.getCurrentGroupBy()},a||{}))}}render(){const{getIdKeyForGroupBy:e,groupBy:t,isDisabled:r=!1,onItemClicked:a,orgReport:o,t:i,tagReport:c}=this.props,{currentItem:u,isGroupByOpen:p,isGroupByOrgVisible:h,isGroupByTagVisible:d}=this.state;return l().createElement("div",{style:g.groupBySelector},l().createElement("label",{style:g.groupBySelectorLabel},i("group_by.label")),l().createElement(s.L,{onSelect:this.handleGroupBySelect,toggle:l().createElement(n.Z,{isDisabled:r,onToggle:this.handleGroupByToggle},i(`group_by.values.${u}`)),isOpen:p,dropdownItems:[this.getGroupByItems()]}),Boolean(h)&&l().createElement(v,{getIdKeyForGroupBy:e,groupBy:t,isDisabled:r,onItemClicked:a,options:E,orgReport:o}),Boolean(d)&&l().createElement(C,{groupBy:t,isDisabled:r,onItemClicked:a,options:O,tagReport:c}))}}const B=(0,p.X1)(((e,{endDate:t,startDate:r,orgReportPathsType:a,tagReportPathsType:s})=>{const n=t&&r?{start_date:r,end_date:t}:{filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1}},i=(0,o.pm)(Object.assign({},n)),l=d.ux.selectTag(e,s,T,i),c=d.ux.selectTagFetchStatus(e,s,T,i),u=(0,o.pm)({});return{orgQueryString:u,orgReport:h.zE.selectOrg(e,a,k,u),orgReportFetchStatus:h.zE.selectOrgFetchStatus(e,a,k,u),tagQueryString:i,tagReport:l,tagReportFetchStatus:c}})),w={fetchOrg:h.Lp.T7,fetchTag:d.xr.Xt},x=(0,u.connect)(B,w)(D),R=(0,c.withTranslation)()(x)},80878:(e,t,r)=>{"use strict";r.d(t,{e:()=>v});var a=r(84457),s=r(56787),n=r(80737),o=r(45997),i=r(46774),l=r(97522),c=r.n(l),u=r(57827),p=r(86588),h=r(55399),d=r(94377),g=r(87932);class m extends c().Component{constructor(e,t){super(e,t),this.defaultState={isDropdownOpen:!1,isExportModalOpen:!1},this.state=Object.assign({},this.defaultState),this.getExportModal=()=>{const{groupBy:e,item:t,query:r,reportPathsType:a}=this.props,{isExportModalOpen:s}=this.state;return c().createElement(i.X,{groupBy:e,isOpen:s,items:[t],onClose:this.handleExportModalClose,query:r,reportPathsType:a})},this.handleExportModalClose=e=>{this.setState({isExportModalOpen:e})},this.handleExportModalOpen=()=>{this.setState({isExportModalOpen:!0})},this.handleOnSelect=()=>{const{isDropdownOpen:e}=this.state;this.setState({isDropdownOpen:!e})},this.handleOnToggle=e=>{this.setState({isDropdownOpen:e})},this.handleExportModalClose=this.handleExportModalClose.bind(this),this.handleExportModalOpen=this.handleExportModalOpen.bind(this),this.handleOnToggle=this.handleOnToggle.bind(this),this.handleOnSelect=this.handleOnSelect.bind(this)}render(){const{groupBy:e,isDisabled:t,showPriceListOption:r,t:i,redirectToCostModel:l,history:u,item:{source_uuid:p}}=this.props,h=[c().createElement(a.h,{component:"button",isDisabled:t,key:"export-action",onClick:this.handleExportModalOpen},i("details.actions.export"))];return r&&h.unshift(c().createElement(a.h,{component:"button",key:"price-list-action",isDisabled:t||e.includes(o.P)||0===p.length,onClick:()=>l(p[0],u)},i("details.actions.price_list"))),c().createElement(c().Fragment,null,c().createElement(s.L,{onSelect:this.handleOnSelect,toggle:c().createElement(n.a,{onToggle:this.handleOnToggle}),isOpen:this.state.isDropdownOpen,isPlain:!0,position:"right",dropdownItems:h}),this.getExportModal())}}const y=(0,d.X1)(((e,t)=>({}))),b={redirectToCostModel:g.F0.redirectToCostModelFromSourceUuid},f=(0,p.connect)(y,b)(m),v=(0,h.withRouter)((0,u.withTranslation)()(f))},19078:(e,t,r)=>{"use strict";r.d(t,{Z:()=>ue});var a=r(48099),s=r(29873),n=r(79770),o=r(90832),i=r(73466),l=r(16679),c=r(13883),u=r(81787),p=r(94329),h=r(97522),d=r.n(h),g=r(98499);const m={content:{paddingBottom:g.ZP.value,paddingLeft:g.ZP.value,paddingRight:g.ZP.value,paddingTop:g.ZP.value}};var y=r(60485),b=r(5866),f=r(45997),v=r(16001),_=r(23246),S=r(57827),C=r(86588),E=r(94377),O=r(95083),k=r(76821),T=r(23992),D=r(11331),B=r(48196);const w={dataListHeading:{fontWeight:T.ZP.value},groupByHeading:{marginBottom:g.ZP.value},tagLink:{marginLeft:B.ZP.value},tagsContainer:{marginRight:D.ZP.value,marginTop:B.ZP.value}};var x=r(8745),R=r(7388),P=r(81217),V=r(14087),j=r(27511),M=r(31765);class L extends d().Component{constructor(){super(...arguments),this.getDataListItems=()=>{const{tagReport:e}=this.props,t=[];if(e)for(const r of e.data)for(const e of r.values){const a=`${r.key}:${e}`;t.push(d().createElement(R.L,{"aria-labelledby":a,key:`${a}-item`},d().createElement(P.V,null,d().createElement(V.p,{dataListCells:[d().createElement(j.K,{key:`${a}-cell1`},d().createElement("span",{id:a},r.key)),d().createElement(j.K,{key:`${a}-cell2`},e)]}))))}return t}}render(){const{groupBy:e,groupByValue:t,t:r}=this.props,a=this.getDataListItems();return d().createElement(d().Fragment,null,d().createElement("div",null,d().createElement("span",{style:w.dataListHeading},r(`group_by.values.${e}`))),d().createElement("div",{style:w.groupByHeading},d().createElement("span",null,t)),d().createElement(M.FR,{"aria-label":"Simple data list example",isCompact:!0},d().createElement(R.L,{"aria-labelledby":"heading1"},d().createElement(P.V,null,d().createElement(V.p,{dataListCells:[d().createElement(j.K,{key:"primary content"},d().createElement("span",{id:"heading1",style:w.dataListHeading},r("tag.heading_key"))),d().createElement(j.K,{key:"secondary content"},d().createElement("span",{id:"heading2",style:w.dataListHeading},r("tag.heading_value")))]}))),a.map((e=>e))))}}const I=(0,S.withTranslation)()((0,C.connect)()(L)),Z="tag";class q extends d().Component{constructor(e){super(e),this.getTagValueCount=()=>{const{tagReport:e}=this.props;let t=0;if(e)for(const r of e.data)r.values&&(t+=r.values.length);return t},this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}componentDidMount(){const{fetchTag:e,queryString:t,tagReportPathsType:r}=this.props;e(r,Z,t)}componentDidUpdate(e){const{fetchTag:t,queryString:r,tagReportPathsType:a}=this.props;e.queryString!==r&&t(a,Z,r)}shouldComponentUpdate(e){const{groupByValue:t,isOpen:r}=this.props;return e.groupByValue!==t||e.isOpen!==r}render(){const{groupBy:e,isOpen:t,query:r,tagReport:a,t:s}=this.props,n=r&&r.filter&&r.filter.account?r.filter.account:this.props.groupByValue;return d().createElement(x.u,{isOpen:t,onClose:this.handleClose,title:s("tag.title",{value:this.getTagValueCount()}),width:"50%"},d().createElement(I,{groupBy:e,groupByValue:n,tagReport:a}))}}const G=(0,E.X1)(((e,{tagReportPathsType:t})=>{const r=(0,f.mB)(location.search),a=(0,_.OA)(r),s=a?f.dV:(0,_.VL)(r),n=a||(0,_.pe)(r),o={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},r&&r.filter_by&&r.filter_by),r&&r.filter&&r.filter.account&&{[`${f.Sq}account`]:r.filter.account}),s&&{[s]:n})},i=(0,f.pm)(o);return{groupBy:s,groupByValue:n,query:r,queryString:i,tagReport:O.ux.selectTag(e,t,Z,i),tagReportFetchStatus:O.ux.selectTagFetchStatus(e,t,Z,i)}})),F={fetchTag:O.xr.Xt},$=(0,S.withTranslation)()((0,C.connect)(G,F)(q)),U="tag";class A extends d().Component{constructor(e){super(e),this.defaultState={isOpen:!1},this.state=Object.assign({},this.defaultState),this.handleClose=e=>{this.setState({isOpen:e})},this.handleOpen=e=>(this.setState({isOpen:!0}),e.preventDefault(),!1),this.handleClose=this.handleClose.bind(this),this.handleOpen=this.handleOpen.bind(this)}componentDidMount(){const{fetchTag:e,queryString:t,tagReportPathsType:r}=this.props;e(r,U,t)}componentDidUpdate(e){const{fetchTag:t,queryString:r,tagReportPathsType:a}=this.props;e.queryString!==r&&t(a,U,r)}render(){const{id:e,tagReport:t,tagReportPathsType:r}=this.props,{isOpen:a}=this.state;let s=0;if(t)for(const e of t.data)e.values&&(s+=e.values.length);return d().createElement("div",{style:w.tagsContainer,id:e},Boolean(s>0)&&d().createElement(d().Fragment,null,d().createElement(v.lO,null),d().createElement("a",Object.assign({},(0,k.g_)(k._q.details.tag_lnk),{href:"#/",onClick:this.handleOpen,style:w.tagLink}),s)),d().createElement($,{isOpen:a,onClose:this.handleClose,tagReportPathsType:r}))}}const N=(0,E.X1)(((e,{tagReportPathsType:t})=>{const r=(0,f.mB)(location.search),a=(0,_.OA)(r),s=a?f.dV:(0,_.VL)(r),n=a||(0,_.pe)(r),o={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},r&&r.filter_by&&r.filter_by),r&&r.filter&&r.filter.account&&{[`${f.Sq}account`]:r.filter.account}),s&&{[s]:n})},i=(0,f.pm)(o);return{groupBy:s,groupByValue:n,query:r,queryString:i,tagReport:O.ux.selectTag(e,t,U,i),tagReportFetchStatus:O.ux.selectTagFetchStatus(e,t,U,i)}})),z={fetchTag:O.xr.Xt},K=(0,S.withTranslation)()((0,C.connect)(N,z)(A));var W=r(55399),Q=r(33307),H=r(901),X=r(72892),J=r(50021),Y=r(12289),ee=r(54881),te=r(40794),re=r(32412),ae=r(57640),se=r(73861);const ne={cost:{marginTop:ae.ZP.var},costLabel:{marginTop:se.ZP.var},costValue:{marginTop:0,marginBottom:0,textAlign:"right"},costLabelDate:{fontSize:ee.ZP.value,color:J.ZP.var,textAlign:"right"},header:{display:"flex",justifyContent:"space-between",paddingLeft:g.ZP.var,paddingRight:g.ZP.var,paddingTop:g.ZP.var,backgroundColor:X.ZP.var},infoDescription:{color:Y.ZP.value,fontSize:te.ZP.value},tabs:{display:"flex"},tag:{marginLeft:g.ZP.var},title:{paddingBottom:g.ZP.var,paddingTop:re.ZP.var}};class oe extends d().Component{constructor(){super(...arguments),this.buildDetailsLink=()=>{const{detailsURL:e,groupBy:t,query:r}=this.props;let a=t,s="*";r[f.dV]&&(a=f.dV,s=r[f.dV]);const n=Object.assign(Object.assign({},JSON.parse(JSON.stringify(r))),{group_by:{[a]:s}});return n.filter&&(n.filter.account=void 0,n[f.eG]=void 0,n[f.dV]=void 0,n[f.yG]=void 0),`${e}?${(0,f.IV)(n)}`},this.getTotalCost=()=>{const{report:e}=this.props,t=e&&e.meta&&e.meta.total&&e.meta.total.cost&&e.meta.total.cost.total;return(0,H.Bw)(t?e.meta.total.cost.total.value:0,t?e.meta.total.cost.total.units:"USD")}}render(){const{description:e,groupBy:t,query:r,t:a,tabs:s,tagReportPathsType:n,title:o}=this.props,i=r&&r.filter?r.filter.account:void 0,l=(0,_.OA)(r),c=i||"account"===t||"project"===t||"subscription_guid"===t,u=t||(i?"account":l?f.dV:void 0);return d().createElement("header",{style:ne.header},d().createElement("div",null,d().createElement("nav",{"aria-label":"breadcrumb",className:"breadcrumbOverride"},d().createElement("ol",{className:"pf-c-breadcrumb__list"},d().createElement("li",{className:"pf-c-breadcrumb__item"},d().createElement("span",{className:"pf-c-breadcrumb__item-divider"},d().createElement(b.fP,null)),d().createElement(W.Link,{to:this.buildDetailsLink()},a("breakdown.back_to_details",{groupBy:u,value:n}))))),d().createElement(y.D,{headingLevel:"h2",style:ne.title,size:"2xl"},a("breakdown.title",{value:o}),e&&d().createElement("div",{style:ne.infoDescription},e)),d().createElement("div",{style:ne.tabs},s,d().createElement("div",{style:ne.tag},Boolean(c)&&d().createElement(K,{id:"tags",tagReportPathsType:n})))),d().createElement("div",{style:ne.cost},d().createElement("div",{style:ne.costLabel},d().createElement(y.D,{headingLevel:"h2",style:ne.costValue,size:"4xl"},d().createElement("span",null,this.getTotalCost()))),d().createElement("div",{style:ne.costLabelDate},(0,Q.Y)(u,"breakdown.total_cost_date",0))))}}const ie=(0,S.withTranslation)()(oe),le=e=>{switch(e){case"cost-overview":return"cost-overview";case"historical-data":return"historical-data"}};class ce extends d().Component{constructor(){super(...arguments),this.defaultState={activeTabKey:0},this.state=Object.assign({},this.defaultState),this.getAvailableTabs=()=>[{contentRef:d().createRef(),tab:"cost-overview"},{contentRef:d().createRef(),tab:"historical-data"}],this.getTab=(e,t,r)=>d().createElement(a.O,{eventKey:r,key:`${le(e)}-tab`,tabContentId:`tab-${r}`,tabContentRef:t,title:d().createElement(s.T,null,this.getTabTitle(e))}),this.getTabContent=e=>e.map(((e,t)=>d().createElement(n.I,{eventKey:t,key:`${le(e.tab)}-tabContent`,id:`tab-${t}`,ref:e.contentRef},this.getTabItem(e.tab,t)))),this.getTabItem=(e,t)=>{const{costOverviewComponent:r,historicalDataComponent:a}=this.props,{activeTabKey:s}=this.state,n=d().createElement(d().Fragment,null);if(s!==t)return n;const o=le(e);return"cost-overview"===o?r:"historical-data"===o?a:n},this.getTabs=e=>{const{activeTabKey:t}=this.state;return d().createElement(o.m,{activeKey:t,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e.tab,e.contentRef,t))))},this.getTabTitle=e=>{const{t}=this.props;return"cost-overview"===e?t("breakdown.cost_overview_title"):"historical-data"===e?t("breakdown.historical_data_title"):void 0},this.handleTabClick=(e,t)=>{const{activeTabKey:r}=this.state;r!==t&&this.setState({activeTabKey:t})},this.updateReport=()=>{const{location:e,fetchReport:t,queryString:r,reportPathsType:a,reportType:s}=this.props;e.search&&t(a,s,r)}}componentDidMount(){this.updateReport()}componentDidUpdate(e){const{location:t,report:r,reportError:a,queryString:s}=this.props,n=e.queryString!==s,o=!r&&!a,i=!t.search;(n||o||i)&&this.updateReport()}render(){const{description:e,detailsURL:t,emptyStateTitle:r,groupBy:a,providers:s,providersFetchStatus:n,providerType:o,query:h,report:g,reportError:y,reportFetchStatus:b,tagReportPathsType:f,title:v}=this.props,_=this.getAvailableTabs();if(y)return d().createElement(u.Z,{title:r});if(1===n&&1===b)return d().createElement(i.Z,{title:r});if(2===n&&2===b){if(s&&s.meta&&0===s.meta.count&&2===n)return d().createElement(c.Z,{providerType:o,title:r});if(!(0,p.g8)(s))return d().createElement(l.Z,{title:v})}return d().createElement(d().Fragment,null,d().createElement(ie,{description:e,detailsURL:t,groupBy:a,query:h,report:g,tabs:this.getTabs(_),tagReportPathsType:f,title:v}),d().createElement("div",{style:m.content},this.getTabContent(_)))}}const ue=ce},44696:(e,t,r)=>{"use strict";r.d(t,{X:()=>fe});var a=r(32203),s=r(70),n=r(60485),o=r(62394),i=r(37377),l=r(47173),c=r(50693),u=r(16475),p=r(91290),h=r(45997),d=r(97522),g=r.n(d),m=r(57827),y=r(76821),b=r(31447),f=r(11331),v=r(48196);const _={clustersContainer:{marginRight:f.ZP.value,marginTop:v.ZP.value}};var S=r(8745);const C={modal:{height:"700px",width:"600px"},subTitle:{marginTop:r(91707).ZP.value,textAlign:"right"}};class E extends g().Component{render(){const{item:e}=this.props;return e.clusters?e.clusters.map(((e,t)=>g().createElement("div",{key:`cluster-${t}`},e))):null}}const O=(0,m.withTranslation)()(E);class k extends g().Component{constructor(e){super(e),this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}shouldComponentUpdate(e){const{isOpen:t,item:r}=this.props;return e.item!==r||e.isOpen!==t}render(){const{groupBy:e,isOpen:t,item:r,t:a}=this.props;return g().createElement(S.u,{className:"modalOverride",style:C.modal,isOpen:t,onClose:this.handleClose,title:a("details.clusters_modal_title",{groupBy:e,name:r.label}),width:"50%"},g().createElement(O,{item:r}))}}const T=(0,m.withTranslation)()(k);class D extends g().Component{constructor(e){super(e),this.defaultState={isOpen:!1,showAll:!1},this.state=Object.assign({},this.defaultState),this.handleClose=e=>{this.setState({isOpen:e})},this.handleOpen=e=>(this.setState({isOpen:!0}),e.preventDefault(),!1),this.handleClose=this.handleClose.bind(this),this.handleOpen=this.handleOpen.bind(this)}render(){const{groupBy:e,report:t,t:r}=this.props,{isOpen:a,showAll:s}=this.state;let n=0;const o=[],i=[],l=(0,b.R)({report:t,idKey:e}),c=l&&l.length?l[0]:void 0;if(!c)return null;for(const e of c.clusters){const t=`${o.length>0?", ":""}${e}`;s?o.push(t):n<=50&&(n+t.length>50?o.push(t.slice(0,50-n).trim().concat("...")):o.push(t)),n+=t.length,i.push(e)}return g().createElement("div",{style:_.clustersContainer},Boolean(o)&&o.map(((e,t)=>g().createElement("span",{key:t},e))),Boolean(o.length<i.length)&&g().createElement("a",Object.assign({},(0,y.g_)(y._q.details.cluster_lnk),{href:"#/",onClick:this.handleOpen}),r("details.more_clusters",{value:i.length-o.length})),g().createElement(T,{groupBy:e,isOpen:a,item:c,onClose:this.handleClose}))}}const B=(0,m.withTranslation)()(D);var w=r(10310),x=r(80469),R=r(42085),P=r(61352),V=r(15209),j=r(901),M=r(57279),L=r(23992),I=r(32412);const Z={chartHeight:150,chartWidth:350,subTitle:{fontWeight:L.ZP.value}},q={chartSkeleton:{height:"125px",marginBottom:I.ZP.value,marginTop:f.ZP.value}};class G extends g().Component{constructor(){super(...arguments),this.getLegendLabel=()=>e=>{var{values:t}=e,r=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]])}return r}(e,["values"]);return g().createElement(w.Df,Object.assign({},r,{style:[{fontWeight:Z.subTitle.fontWeight},{}],text:[t[r.index],r.text]}))},this.getSkeleton=()=>g().createElement(g().Fragment,null,g().createElement(V.O,{style:q.chartSkeleton,width:M.N.md}))}render(){const{report:e,reportFetchStatus:t,t:r}=this.props,a=e&&e.meta&&e.meta.total&&e.meta.total.cost,s=a&&e.meta.total.cost.markup,n=a&&e.meta.total.cost.raw,o=a&&e.meta.total.cost.usage,i=s?e.meta.total.cost.markup.units:"USD",l=n?e.meta.total.cost.raw.units:"USD",c=o?e.meta.total.cost.usage.units:"USD",u=s?e.meta.total.cost.markup.value:0,p=n?e.meta.total.cost.raw.value:0,h=o?e.meta.total.cost.usage.value:0,d=(0,j.Bw)(s?e.meta.total.cost.markup.value:0,i),m=(0,j.Bw)(n?e.meta.total.cost.raw.value:0,l),y=(0,j.Bw)(o?e.meta.total.cost.usage.value:0,c),b=r("breakdown.cost_chart.markup_label"),f=r("breakdown.cost_chart.raw_label"),v=r("breakdown.cost_chart.usage_label"),_=this.getLegendLabel(),S=g().createElement(x.Qk,{gutter:25,itemsPerRow:2,labelComponent:g().createElement(_,{dy:10,lineHeight:1.5,values:[m,d,y]}),rowGutter:20});return g().createElement("div",{style:{height:Z.chartHeight,width:Z.chartWidth}},1===t?this.getSkeleton():g().createElement(R.Td,{ariaDesc:r("breakdown.cost_chart.aria_desc"),ariaTitle:r("breakdown.cost_chart.aria_title"),constrainToVisibleArea:!0,data:[{x:f,y:p,units:l},{x:b,y:u,units:i},{x:v,y:h,units:c}],height:Z.chartHeight,labels:({datum:e})=>r("breakdown.cost_chart.tooltip",{name:e.x,value:(0,j.Bw)(e.y,e.units)}),legendComponent:S,legendData:[{name:f},{name:b},{name:v}],legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:0,right:225,top:20},themeColor:P.nz.green,width:Z.chartWidth}))}}const F=(0,m.withTranslation)()(G);var $=r(49734),U=r(35956),A=r(23246),N=r(86588),z=r(94377),K=r(90203);const W={mainContent:{marginTop:r(57640).ZP.value},subTitle:{textAlign:"right"}},Q="cost";class H extends g().Component{constructor(e){super(e)}componentDidMount(){const{fetchReport:e,queryString:t,reportPathsType:r}=this.props;e(r,Q,t)}componentDidUpdate(e){const{fetchReport:t,queryString:r,reportPathsType:a}=this.props;e.queryString!==r&&t(a,Q,r)}render(){const{report:e,reportGroupBy:t,reportFetchStatus:r,t:a}=this.props,s=(0,j.xG)(e&&e.meta&&e.meta.total?e.meta.total.cost.total.value:0);return g().createElement(g().Fragment,null,g().createElement("div",{style:W.subTitle},g().createElement(n.D,{headingLevel:"h2",size:"xl"},a("details.cost_value",{value:s}))),g().createElement("div",{style:W.mainContent},g().createElement(U.mZ,{idKey:t,report:e,status:r},(({items:t})=>t.map((t=>g().createElement(U.EH,{key:t.id,formatOptions:{},formatValue:j.Bw,label:t.label?t.label.toString():"",totalValue:e.meta.total.cost.total.value,units:e.meta.total.cost.total.units,value:t.cost.total.value})))))))}}const X=(0,z.X1)(((e,{reportGroupBy:t,reportPathsType:r})=>{const a=(0,h.mB)(location.search),s=(0,A.OA)(a),n=s?h.dV:(0,A.VL)(a),o=s||(0,A.pe)(a),i={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign(Object.assign({},a&&a.filter_by&&a.filter_by),a&&a.filter&&a.filter.account&&{[`${h.Sq}account`]:a.filter.account}),n&&{[n]:void 0}),n&&{[n]:o}),group_by:Object.assign({},t&&{[t]:"*"})},l=(0,h.pm)(i);return{queryString:l,report:K.ZV.selectReport(e,r,Q,l),reportFetchStatus:K.ZV.selectReportFetchStatus(e,r,Q,l)}})),J={fetchReport:K.nx.fetchReport},Y=(0,m.withTranslation)()((0,N.connect)(X,J)(H));class ee extends g().Component{constructor(e){super(e),this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}shouldComponentUpdate(e){const{groupByValue:t,isOpen:r}=this.props;return e.groupByValue!==t||e.isOpen!==r}render(){const{groupByValue:e,isOpen:t,reportGroupBy:r,reportPathsType:a,t:s}=this.props;return g().createElement(S.u,{className:"modalOverride",isOpen:t,onClose:this.handleClose,title:s("details.summary_modal_title",{groupBy:r,name:e}),variant:"large"},g().createElement(Y,{reportGroupBy:r,reportPathsType:a}))}}const te=(0,m.withTranslation)()(ee),re={card:{},skeleton:{marginTop:I.ZP.value},viewAllContainer:{marginLeft:"-15px"}};class ae extends g().Component{constructor(){super(...arguments),this.state={isBulletChartModalOpen:!1},this.getItems=()=>{const{report:e,reportGroupBy:t}=this.props;return(0,b.R)({report:e,idKey:t})},this.getSummary=()=>{const{report:e,reportGroupBy:t,reportFetchStatus:r}=this.props;return g().createElement(U.mZ,{idKey:t,report:e,status:r},(({items:t})=>t.map((t=>g().createElement(U.EH,{key:`${t.id}-item`,formatOptions:{},formatValue:j.Bw,label:t.label?t.label.toString():void 0,totalValue:e.meta.total.cost.total.value,units:e.meta.total.cost.total.units,value:t.cost.total.value})))))},this.getViewAll=()=>{const{groupBy:e,query:t,reportGroupBy:r,reportPathsType:a,t:s}=this.props,{isBulletChartModalOpen:n}=this.state;if(-1!==this.getItems().findIndex((e=>{const t=e.id;if(t&&null!==t)return"Other"===t||"Others"===t}))){const o=t&&t.filter&&t.filter.account?t.filter.account:this.props.groupByValue;return g().createElement("div",{style:re.viewAllContainer},g().createElement(l.zx,Object.assign({},(0,y.g_)(y._q.details.view_all_btn),{onClick:this.handleBulletChartModalOpen,type:l.L$.button,variant:l.Wu.link}),s("details.view_all",{groupBy:r})),g().createElement(te,{groupBy:e,groupByValue:o,isOpen:n,onClose:this.handleBulletChartModalClose,query:t,reportGroupBy:r,reportPathsType:a}))}return null},this.handleBulletChartModalClose=e=>{this.setState({isBulletChartModalOpen:e})},this.handleBulletChartModalOpen=e=>{this.setState({isBulletChartModalOpen:!0}),e.preventDefault()}}componentDidMount(){const{fetchReport:e,queryString:t,reportPathsType:r,reportType:a}=this.props;e(r,a,t)}componentDidUpdate(e){const{fetchReport:t,queryString:r,reportPathsType:a,reportType:s}=this.props;e.queryString!==r&&t(a,s,r)}render(){const{reportGroupBy:e,reportFetchStatus:t,t:r}=this.props;return g().createElement(a.Z,{style:re.card},g().createElement(s.l,null,g().createElement(n.D,{headingLevel:"h2",size:"lg"},r("breakdown.summary_title",{groupBy:e}))),g().createElement(o.e,null,1===t?g().createElement(g().Fragment,null,g().createElement(V.O,{width:M.N.md}),g().createElement(V.O,{style:re.skeleton,width:M.N.md}),g().createElement(V.O,{style:re.skeleton,width:M.N.md}),g().createElement(V.O,{style:re.skeleton,width:M.N.md})):this.getSummary()),g().createElement($.e,null,this.getViewAll()))}}const se=(0,z.X1)(((e,{reportGroupBy:t,reportPathsType:r,reportType:a})=>{const s=(0,h.mB)(location.search),n=(0,A.OA)(s),o=n?h.dV:(0,A.VL)(s),i=n||(0,A.pe)(s),l={filter:{limit:3,resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign(Object.assign({},s&&s.filter_by&&s.filter_by),s&&s.filter&&s.filter.account&&{[`${h.Sq}account`]:s.filter.account}),o&&{[o]:void 0}),o&&{[o]:i}),group_by:Object.assign({},t&&{[t]:"*"})},c=(0,h.pm)(l);return{groupBy:o,groupByValue:i,query:s,queryString:c,report:K.ZV.selectReport(e,r,a,c),reportFetchStatus:K.ZV.selectReportFetchStatus(e,r,a,c),reportPathsType:r,reportType:a}})),ne={fetchReport:K.nx.fetchReport},oe=(0,m.withTranslation)()((0,N.connect)(se,ne)(ae));r(5118);var ie=r(63754),le=r(90392),ce=r(63802),ue=r(63211);const pe={chartSkeleton:{marginBottom:I.ZP.value},capacity:{fontWeight:L.ZP.value},legendSkeleton:{marginTop:I.ZP.value}};class he extends g().Component{constructor(){super(...arguments),this.containerRef=g().createRef(),this.observer=ue.Z,this.state={width:0},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})},this.getCpuChart=()=>{const{groupBy:e,reportFetchStatus:t,report:r}=this.props,{width:a}=this.state,s="cluster"===e?this.getChartDatumWithCapacity():this.getChartDatum();return r&&0!==s.usage.length?g().createElement("div",{className:"chartOverride"},1===t?this.getSkeleton():g().createElement(g().Fragment,null,Boolean("cluster"===e)&&this.getFreeSpace(),g().createElement(ie.n,{comparativeErrorMeasureData:s.limit.value?[{tooltip:s.limit.tooltip,y:s.limit.value}]:[],comparativeErrorMeasureLegendData:s.limit.value?[{name:s.limit.legend}]:[],height:this.getChartHeight(),labels:({datum:e})=>`${e.tooltip}`,legendPosition:"bottom-left",legendItemsPerRow:this.getItemsPerRow(),maxDomain:this.isDatumEmpty(s)?100:void 0,minDomain:0,padding:{bottom:75,left:10,right:50,top:0},primarySegmentedMeasureData:s.usage.length?s.usage.map((e=>({tooltip:e.tooltip,y:e.value}))):[],primarySegmentedMeasureLegendData:s.usage.length?s.usage.map((e=>({name:e.legend}))):[],qualitativeRangeData:s.ranges.length?[{tooltip:s.ranges[0].tooltip,y:s.ranges[0].value}]:[],qualitativeRangeLegendData:s.ranges.length?[{name:s.ranges[0].legend}]:[],width:a}))):null},this.getChartHeight=()=>{const{groupBy:e}=this.props,{width:t}=this.state;return"cluster"===e?t>950?115:t>450?150:210:t>700?115:t>450?150:180},this.getItemsPerRow=()=>{const{width:e}=this.state;return e>950?4:e>700?3:e>450?2:1},this.getSkeleton=()=>g().createElement(g().Fragment,null,g().createElement(V.O,{style:pe.chartSkeleton,width:M.N.md}),g().createElement(V.O,{style:pe.legendSkeleton,width:M.N.xs})),this.isDatumEmpty=e=>{let t=!1;for(const r of e.ranges)if(r.value){t=!0;break}let r=!1;for(const t of e.usage)if(t.value){r=!0;break}return!(e.limit.value||t||r)}}componentDidMount(){const{fetchReport:e,queryString:t,reportPathsType:r,reportType:a}=this.props;e(r,a,t),this.observer=(0,ce.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){const{fetchReport:t,queryString:r,reportPathsType:a,reportType:s}=this.props;e.queryString!==this.props.queryString&&t(a,s,r)}componentWillUnmount(){this.observer&&this.observer()}getChartDatum(){const{report:e,reportType:t,t:r}=this.props,a={limit:{},ranges:[],usage:[]},s=e&&e.meta&&e.meta.total,n=s&&e.meta.total.limit&&null!==e.meta.total.limit,o=Math.trunc(n?e.meta.total.limit.value:0),i=r(`units.${(0,j.dM)(n?e.meta.total.limit.units:"")}`);a.limit={legend:r(`details.usage.${t}_limit`,{value:o,units:i}),tooltip:r(`details.usage.${t}_limit`,{value:o,units:i}),value:Math.trunc(o)};const l=s&&e.meta.total.request&&null!==e.meta.total.request,c=Math.trunc(l?e.meta.total.request.value:0),u=r(`units.${(0,j.dM)(l?e.meta.total.request.units:"")}`);a.ranges=[{legend:r(`details.usage.${t}_requests`,{value:c,units:u}),tooltip:r(`details.usage.${t}_requests`,{value:c,units:u}),value:Math.trunc(c)}];const p=s&&e.meta.total.usage&&null!==e.meta.total.usage,h=Math.trunc(p?e.meta.total.usage.value:0),d=r(`units.${(0,j.dM)(p?e.meta.total.usage.units:"")}`);return a.usage=[{legend:r(`details.usage.${t}_usage`,{value:h,units:d}),tooltip:r(`details.usage.${t}_usage`,{value:h,units:d}),value:Math.trunc(h)}],a}getChartDatumWithCapacity(){const{report:e,reportType:t,t:r}=this.props,a={limit:{},ranges:[],usage:[]},s=e&&e.meta&&e.meta.total,n=s&&e.meta.total.limit&&null!==e.meta.total.limit,o=Math.trunc(n?e.meta.total.limit.value:0),i=r(`units.${(0,j.dM)(n?e.meta.total.limit.units:"")}`);a.limit={legend:r(`details.usage.${t}_limit`,{value:o,units:i}),tooltip:r(`details.usage.${t}_limit`,{value:o,units:i}),value:Math.trunc(o)};const l=s&&e.meta.total.request&&null!==e.meta.total.request,c=Math.trunc(l?e.meta.total.capacity.value:0),u=r(`units.${(0,j.dM)(l?e.meta.total.capacity.units:"")}`);a.ranges=[{legend:r(`details.usage.${t}_capacity`,{value:c,units:u}),tooltip:r(`details.usage.${t}_capacity`,{value:c,units:u}),value:Math.trunc(c)}];const p=s&&e.meta.total.request&&null!==e.meta.total.request,h=s&&e.meta.total.usage&&null!==e.meta.total.usage,d=Math.trunc(p?e.meta.total.request.value:0),g=r(`units.${(0,j.dM)(p?e.meta.total.request.units:"")}`),m=Math.trunc(h?e.meta.total.usage.value:0),y=r(`units.${(0,j.dM)(h?e.meta.total.usage.units:"")}`);return a.usage=[{legend:r(`details.usage.${t}_usage`,{value:m,units:y}),tooltip:r(`details.usage.${t}_usage`,{value:m,units:y}),value:Math.trunc(m)},{legend:r(`details.usage.${t}_requests`,{value:d,units:g}),tooltip:r(`details.usage.${t}_requests`,{value:d,units:g}),value:Math.trunc(d)}],a}getFreeSpace(){const{report:e,reportType:t,t:r}=this.props,a=e&&e.meta&&e.meta.total,s=a&&e.meta.total.request&&null!==e.meta.total.request,n=a&&e.meta.total.request&&null!==e.meta.total.request,o=a&&e.meta.total.usage&&null!==e.meta.total.usage,i=Math.trunc(s?e.meta.total.capacity.value:0),l=Math.trunc(n?e.meta.total.request.value:0),p=r(`units.${(0,j.dM)(n?e.meta.total.request.units:"")}`),h=Math.trunc(o?e.meta.total.usage.value:0),d=r(`units.${(0,j.dM)(o?e.meta.total.usage.units:"")}`),m=i-l,y=i-h;let b=l>0?l/i*100:0;b>100&&(b=100-b);let f=i>h?h/i*100:0;return f>100&&(f=100-f),g().createElement(c.r,{hasGutter:!0},g().createElement(u.P,{md:12,lg:6},g().createElement("div",null,r(`details.usage.${t}_usage_unused_label`)),g().createElement("div",{style:pe.capacity},(0,j.Bw)(y)),g().createElement("div",null,r(`details.usage.${t}_usage_unused_units`,{percentage:(0,j.Bw)(f,d),units:d}))),g().createElement(u.P,{md:12,lg:6},g().createElement("div",null,r(`details.usage.${t}_requests_unused_label`)),g().createElement("div",{style:pe.capacity},(0,j.Bw)(m)),g().createElement("div",null,r(`details.usage.${t}_requests_unused_units`,{percentage:(0,j.Bw)(b,p),units:p}))))}render(){return g().createElement("div",{className:"chartOverride",ref:this.containerRef},this.getCpuChart())}}const de=(0,z.X1)(((e,{reportPathsType:t,reportType:r})=>{const a=(0,le.mB)(location.search),s=(0,A.VL)(a),n=(0,A.pe)(a),o={filter:{time_scope_units:"month",time_scope_value:-1,resolution:"monthly"},filter_by:Object.assign(Object.assign({},a&&a.filter_by&&a.filter_by),s&&{[s]:void 0}),group_by:Object.assign({},s&&{[s]:n})},i=(0,h.pm)(o);return{groupBy:s,report:K.ZV.selectReport(e,t,r,i),reportFetchStatus:K.ZV.selectReportFetchStatus(e,t,r,i),queryString:i}})),ge={fetchReport:K.nx.fetchReport},me=(0,m.withTranslation)()((0,N.connect)(de,ge)(he));var ye=r(57116);const be="placeholder";class fe extends g().Component{constructor(){super(...arguments),this.getClusterChart=e=>{const{groupBy:t,report:r,t:i}=this.props;let l=!1;for(const r of e.cluster.showWidgetOnGroupBy)if(r===t||r===h.P&&-1!==t.indexOf(h.P)){l=!0;break}return l?g().createElement(a.Z,null,g().createElement(s.l,null,g().createElement(n.D,{headingLevel:"h2",size:"lg"},i("breakdown.cluster_title"))),g().createElement(o.e,null,g().createElement(B,{groupBy:e.cluster.reportGroupBy,report:r}))):null},this.getCostChart=()=>{const{report:e,t}=this.props;return g().createElement(a.Z,null,g().createElement(s.l,null,g().createElement(n.D,{headingLevel:"h2",size:"lg"},t("breakdown.cost_breakdown_title"),g().createElement(i.J,{"aria-label":t("breakdown.cost_breakdown_aria_label"),enableFlip:!0,bodyContent:g().createElement(g().Fragment,null,g().createElement("p",{style:ye.W.infoTitle},t("breakdown.raw_cost_title")),g().createElement("p",null,t("breakdown.raw_cost_desc")),g().createElement("br",null),g().createElement("p",{style:ye.W.infoTitle},t("breakdown.usage_cost_title")),g().createElement("p",null,t("breakdown.usage_cost_desc")),g().createElement("br",null),g().createElement("p",{style:ye.W.infoTitle},t("breakdown.markup_title")),g().createElement("p",null,t("breakdown.markup_desc")),g().createElement("br",null),g().createElement("a",{href:t("docs.cost_model_terminology"),rel:"noreferrer",target:"_blank"},t("learn_more")))},g().createElement(l.zx,{variant:l.Wu.plain},g().createElement(p.iC,{style:ye.W.info}))))),g().createElement(o.e,null,g().createElement(F,{report:e})))},this.getCpuUsageChart=e=>{const{t}=this.props;return g().createElement(a.Z,null,g().createElement(s.l,null,g().createElement(n.D,{headingLevel:"h2",size:"lg"},t("breakdown.cpu_title"))),g().createElement(o.e,null,g().createElement(me,{reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getMemoryUsageChart=e=>{const{t}=this.props;return g().createElement(a.Z,null,g().createElement(s.l,null,g().createElement(n.D,{headingLevel:"h2",size:"lg"},t("breakdown.memory_title"))),g().createElement(o.e,null,g().createElement(me,{reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getSummaryCard=e=>{const{groupBy:t,query:r}=this.props;let a=!1;for(const s of e.reportSummary.showWidgetOnGroupBy)if(s===t||r&&r.group_by&&r.group_by[h.dV]||s===h.P&&t&&-1!==t.indexOf(h.P)){a=!0;break}return a?g().createElement(oe,{reportGroupBy:e.reportSummary.reportGroupBy,reportPathsType:e.reportPathsType,reportType:e.reportType}):e.reportSummary.usePlaceholder?be:null},this.getWidgetsColumns=()=>{const{selectWidgets:e,widgets:t}=this.props,r=[];t.map((t=>{const a=e[t],s=this.renderWidget(a);null!==s&&r.push(s)}));const a=Math.floor(r.length/2)+r.length%2,s=[],n=[];for(let e=0;e<a;e++)r[e]!==be&&s.push(r[e]),e+a<r.length&&r[e+a]!==be&&n.push(r[e+a]);return{leftColumnWidgets:s,rightColumnWidgets:n}}}renderWidget(e){switch(e.type){case"cluster":return this.getClusterChart(e);case"cost":return this.getCostChart();case"cpuUsage":return this.getCpuUsageChart(e);case"memoryUsage":return this.getMemoryUsageChart(e);case"summary":return this.getSummaryCard(e);default:return null}}render(){const{leftColumnWidgets:e,rightColumnWidgets:t}=this.getWidgetsColumns();return g().createElement(c.r,{hasGutter:!0},g().createElement(u.P,{lg:12,xl:6},g().createElement(c.r,{hasGutter:!0},e.map(((e,t)=>g().createElement(u.P,{key:`widget-${t}`},e))))),g().createElement(u.P,{lg:12,xl:6},g().createElement(c.r,{hasGutter:!0},t.map(((e,t)=>g().createElement(u.P,{key:`widget-${t}`},e))))))}}},45572:(e,t,r)=>{"use strict";r.d(t,{f:()=>ye});var a=r(32203),s=r(70),n=r(60485),o=r(62394),i=r(50693),l=r(16475),c=r(97522),u=r.n(c),p=r(15209),h=r(45997),d=r(60232),g=(r(5118),r(79941)),m=r(29296),y=r(80469),b=r(84154),f=r(48629),v=r(52109),_=r(2370),S=r(40125),C=r(63802),E=r(36234),O=r(30136),k=r.n(O),T=r(63211),D=r(27765),B=r(19960),w=r(84076),x=r(18131),R=r(24656),P=r(84615),V=r(70698),j=r(72021),M=r(80965),L=r(41534),I=r(98499),Z=r(48196);const q={currentCapacityData:{fill:"none"},currentColorScale:[M.CH.value,j.R0.value,V.t6.value,P.S7.value,L.iM.value],currentInfrastructureCostData:{fill:"none",strokeDasharray:"3,3"},currentCostData:{fill:"none"},itemsPerRow:0,previousCapacityData:{fill:"none"},previousColorScale:[D.O6.value,B.OS.value,w.iY.value,x.cQ.value,R.DD.value],previousInfrastructureCostData:{fill:"none",strokeDasharray:"3,3"},previousCostData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},G={chart:{marginTop:Z.S1.value},title:{marginLeft:"-"+I.Js.value}};class F extends u().Component{constructor(){super(...arguments),this.containerRef=u().createRef(),this.observer=T.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentCostData:e,currentInfrastructureCostData:t,previousCostData:r,previousInfrastructureCostData:a}=this.props,s="chart.cost_legend_label",n="chart.cost_infrastructure_legend_label",o="chart.cost_infrastructure_legend_tooltip",i="chart.cost_legend_tooltip",l=[{childName:"previousCost",data:r,legendItem:{name:(0,d.uL)(r,s,!0,!0,1),symbol:{fill:q.previousColorScale[0],type:"minus"},tooltip:(0,d.uL)(r,i,!1,!1,1)},style:{data:Object.assign(Object.assign({},q.previousCostData),{stroke:q.previousColorScale[0]})}},{childName:"currentCost",data:e,legendItem:{name:(0,d.uL)(e,s,!0,!1),symbol:{fill:q.currentColorScale[0],type:"minus"},tooltip:(0,d.uL)(e,i,!1,!1)},style:{data:Object.assign(Object.assign({},q.currentCostData),{stroke:q.currentColorScale[0]})}},{childName:"previousInfrastructureCost",data:a,legendItem:{name:(0,d.uL)(a,n,!0,!0,1),symbol:{fill:q.previousColorScale[1],type:"dash"},tooltip:(0,d.uL)(a,o,!1,!1,1)},style:{data:Object.assign(Object.assign({},q.previousInfrastructureCostData),{stroke:q.previousColorScale[1]})}},{childName:"currentInfrastructureCost",data:t,legendItem:{name:(0,d.uL)(t,n,!0,!1),symbol:{fill:q.currentColorScale[1],type:"dash"},tooltip:(0,d.uL)(t,o,!1,!1)},style:{data:Object.assign(Object.assign({},q.currentInfrastructureCostData),{stroke:q.currentColorScale[1]})}}],c=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:c,series:l})},this.getChart=(e,t)=>{const{hiddenSeries:r}=this.state;return u().createElement(g.A,{data:r.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatDatumValue:e,formatDatumOptions:t}=this.props,r=(0,m.f)("voronoi","cursor");return u().createElement(r,{cursorDimension:"x",labels:({datum:r})=>(0,C.zj)(r,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:120,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e}=this.props,{hiddenSeries:t,series:r,width:a}=this.state,s=e||(a>700?q.itemsPerRow:2);return u().createElement(y.Qk,{data:(0,C.oX)(r,t),height:25,gutter:20,itemsPerRow:s,name:"legend"})},this.handleLegendClick=e=>{const t=(0,C.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,C.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentCostData===this.props.currentCostData&&e.currentInfrastructureCostData===this.props.currentInfrastructureCostData&&e.previousCostData===this.props.previousCostData&&e.previousInfrastructureCostData===this.props.previousInfrastructureCostData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentInfrastructureCostData:e,previousInfrastructureCostData:t}=this.props,r=e?(0,E.getDate)((0,d.Y_)(e,!0,!0)[1]):0,a=t?(0,E.getDate)((0,d.Y_)(t,!0,!0)[1]):0;return r>0||a>0?Math.max(r,a):31}getEvents(){const{hiddenSeries:e,series:t}=this.state;return(0,b.u)({chartNames:(0,C.bC)(t),isHidden:t=>(0,C.Yt)(e,t),legendName:"legend",onLegendClick:e=>this.handleLegendClick(e.index)})}render(){const{adjustContainerHeight:e,height:t,containerHeight:r=t,padding:a={bottom:120,left:8,right:8,top:8},title:s,xAxisLabel:o,yAxisLabel:i}=this.props,{cursorVoronoiContainer:l,hiddenSeries:c,series:p,width:h}=this.state,d=(0,C.ge)(p,c),g=this.getEndDate(),m=Math.floor(g/2),y=e&&h>700?r-25:r,b=l?u().cloneElement(l,{disable:!(0,C.TW)(p,c),labelComponent:u().createElement(f.M,{legendData:(0,C.oX)(p,c,!0),title:e=>k().t("chart.day_of_month_title",{day:e.x})})}):void 0;return u().createElement("div",{className:"chartOverride",ref:this.containerRef},u().createElement(n.D,{headingLevel:"h2",style:G.title,size:"xl"},s),u().createElement("div",{style:Object.assign(Object.assign({},G.chart),{height:y})},u().createElement("div",{style:{height:t,width:h}},u().createElement(v.k,{containerComponent:b,domain:d,events:this.getEvents(),height:t,legendComponent:this.getLegend(),legendData:(0,C.oX)(p,c),legendPosition:"bottom",padding:a,theme:S.Z,width:h},p&&p.map(((e,t)=>this.getChart(e,t))),u().createElement(_.C,{label:o,style:q.xAxis,tickValues:[1,m,g]}),u().createElement(_.C,{dependentAxis:!0,label:i,style:q.yAxis})))))}}var $=r(23246),U=r(57827),A=r(86588),N=r(94377),z=r(90203),K=r(901),W=r(57279),Q=r(11331),H=r(32412);const X={chartContainer:{marginLeft:I.ZP.value},chartSkeleton:{height:"125px",marginBottom:H.ZP.value,marginTop:Q.ZP.value},costChart:{marginBottom:Z.ZP.value,marginTop:Z.ZP.value},legendSkeleton:{marginTop:H.ZP.value},trendChart:{marginBottom:Z.ZP.value,marginTop:Z.ZP.value},usageChart:{marginTop:Z.ZP.value}};class J extends u().Component{constructor(){super(...arguments),this.getSkeleton=()=>u().createElement(u().Fragment,null,u().createElement(p.O,{style:X.chartSkeleton,width:W.N.md}),u().createElement(p.O,{style:X.legendSkeleton,width:W.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:r,reportPathsType:a,reportType:s}=this.props;e(a,s,t),e(a,s,r)}componentDidUpdate(e){const{fetchReport:t,currentQueryString:r,previousQueryString:a,reportPathsType:s,reportType:n}=this.props;e.currentQueryString!==r&&t(s,n,r),e.previousQueryString!==a&&t(s,n,a)}render(){const{currentReport:e,currentReportFetchStatus:t,previousReport:r,previousReportFetchStatus:a,reportType:s,t:n}=this.props,o=(0,d.zJ)(e,0,"date","cost"),i=(0,d.zJ)(e,0,"date","infrastructure"),l=(0,d.zJ)(r,0,"date","cost"),c=(0,d.zJ)(r,0,"date","infrastructure"),p=e&&e.meta&&e.meta.total&&e.meta.total.cost?e.meta.total.cost.total.units:"USD";return u().createElement("div",{style:X.chartContainer},u().createElement("div",{style:X.costChart},1===t&&1===a?this.getSkeleton():u().createElement(F,{adjustContainerHeight:!0,containerHeight:275,currentCostData:o,currentInfrastructureCostData:i,formatDatumValue:K.Bw,formatDatumOptions:{},height:300,previousCostData:l,previousInfrastructureCostData:c,xAxisLabel:n("breakdown.historical_chart.day_of_month_label"),yAxisLabel:n(`breakdown.historical_chart.${s}_label`,{units:n(`units.${(0,K.dM)(p)}`)})})))}}const Y=(0,N.X1)(((e,{reportPathsType:t,reportType:r})=>{const a=(0,h.mB)(location.search),s=(0,$.VL)(a),n=(0,$.pe)(a),o={filter_by:Object.assign(Object.assign({},a&&a.filter_by&&a.filter_by),s&&{[s]:void 0}),group_by:Object.assign({},s&&{[s]:n})},i=Object.assign(Object.assign({},o),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),l=(0,h.pm)(i),c=Object.assign(Object.assign({},o),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),u=(0,h.pm)(c);return{currentQuery:i,currentQueryString:l,currentReport:z.ZV.selectReport(e,t,r,l),currentReportFetchStatus:z.ZV.selectReportFetchStatus(e,t,r,l),previousQuery:c,previousQueryString:u,previousReport:z.ZV.selectReport(e,t,r,u),previousReportFetchStatus:z.ZV.selectReportFetchStatus(e,t,r,u)}})),ee={fetchReport:z.nx.fetchReport},te=(0,U.withTranslation)()((0,A.connect)(Y,ee)(J)),re={currentColorScale:[M.CH.value,j.R0.value,V.t6.value,P.S7.value,L.iM.value],currentMonthData:{fill:"none"},itemsPerRow:0,previousColorScale:[D.O6.value,B.OS.value,w.iY.value,x.cQ.value,R.DD.value],previousMonthData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},ae={chart:{marginTop:Z.S1.value},title:{marginLeft:"-"+I.Js.value}};class se extends u().Component{constructor(){super(...arguments),this.containerRef=u().createRef(),this.observer=T.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentData:e,previousData:t,showUsageLegendLabel:r=!1}=this.props,a=r?"chart.usage_legend_label":"chart.cost_legend_label",s=r?"chart.usage_legend_tooltip":"chart.cost_legend_tooltip",n=[{childName:"previousCost",data:t,legendItem:{name:(0,d.uL)(t,a,!0,!0,1),symbol:{fill:re.previousColorScale[0],type:"minus"},tooltip:(0,d.uL)(t,s,!1,!1,1)},style:{data:Object.assign(Object.assign({},re.previousMonthData),{stroke:re.previousColorScale[0]})}},{childName:"currentCost",data:e,legendItem:{name:(0,d.uL)(e,a,!0,!1),symbol:{fill:re.currentColorScale[1],type:"minus"},tooltip:(0,d.uL)(e,s,!1,!1)},style:{data:Object.assign(Object.assign({},re.currentMonthData),{stroke:re.currentColorScale[1]})}}],o=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:o,series:n})},this.getChart=(e,t)=>{const{hiddenSeries:r}=this.state;return u().createElement(g.A,{data:r.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatDatumValue:e,formatDatumOptions:t}=this.props,r=(0,m.f)("voronoi","cursor");return u().createElement(r,{cursorDimension:"x",labels:({datum:r})=>(0,C.zj)(r,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:120,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e}=this.props,{hiddenSeries:t,series:r}=this.state;return u().createElement(y.Qk,{data:(0,C.oX)(r,t),height:25,gutter:20,itemsPerRow:e,name:"legend"})},this.handleLegendClick=e=>{const t=(0,C.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,C.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentData===this.props.currentData&&e.previousData===this.props.previousData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentData:e,previousData:t}=this.props,r=t?(0,E.getDate)((0,d.Y_)(t,!0,!0)[1]):0,a=e?(0,E.getDate)((0,d.Y_)(e,!0,!0)[1]):0;return a>0||r>0?Math.max(a,r):31}getEvents(){const{hiddenSeries:e,series:t}=this.state;return(0,b.u)({chartNames:(0,C.bC)(t),isHidden:t=>(0,C.Yt)(e,t),legendName:"legend",onLegendClick:e=>this.handleLegendClick(e.index)})}render(){const{height:e,containerHeight:t=e,padding:r={bottom:120,left:8,right:8,top:8},title:a,xAxisLabel:s,yAxisLabel:o}=this.props,{cursorVoronoiContainer:i,hiddenSeries:l,series:c,width:p}=this.state,h=(0,C.ge)(c,l),d=this.getEndDate(),g=Math.floor(d/2),m=i?u().cloneElement(i,{disable:!(0,C.TW)(c,l),labelComponent:u().createElement(f.M,{legendData:(0,C.oX)(c,l,!0),title:e=>k().t("chart.day_of_month_title",{day:e.x})})}):void 0;return u().createElement("div",{className:"chartOverride",ref:this.containerRef},u().createElement(n.D,{headingLevel:"h2",style:ae.title,size:"xl"},a),u().createElement("div",{style:Object.assign(Object.assign({},ae.chart),{height:t})},u().createElement("div",{style:{height:e,width:p}},u().createElement(v.k,{containerComponent:m,domain:h,events:this.getEvents(),height:e,legendComponent:this.getLegend(),legendData:(0,C.oX)(c,l),legendPosition:"bottom",padding:r,theme:S.Z,width:p},c&&c.map(((e,t)=>this.getChart(e,t))),u().createElement(_.C,{label:s,style:re.xAxis,tickValues:[1,g,d]}),u().createElement(_.C,{dependentAxis:!0,label:o,style:re.yAxis})))))}}class ne extends u().Component{constructor(){super(...arguments),this.getSkeleton=()=>u().createElement(u().Fragment,null,u().createElement(p.O,{style:X.chartSkeleton,width:W.N.md}),u().createElement(p.O,{style:X.legendSkeleton,width:W.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:r,reportPathsType:a,reportType:s}=this.props;e(a,s,t),e(a,s,r)}componentDidUpdate(e){const{fetchReport:t,currentQueryString:r,previousQueryString:a,reportPathsType:s,reportType:n}=this.props;e.currentQueryString!==r&&t(s,n,r),e.previousQueryString!==a&&t(s,n,a)}render(){const{currentReport:e,currentReportFetchStatus:t,previousReport:r,previousReportFetchStatus:a,reportType:s,t:n}=this.props,o="cost"===s,i=(0,d.zJ)(e,o?0:1,"date",o?"cost":"usage"),l=(0,d.zJ)(r,o?0:1,"date",o?"cost":"usage"),c=e&&e.meta&&e.meta.total&&e.meta.total.cost?e.meta.total.cost.total.units:"USD";let p,h=e&&e.meta&&e.meta.total&&e.meta.total.usage?e.meta.total.usage.units:void 0;return o?p=n(`breakdown.historical_chart.${s}_label`,{units:n(`units.${(0,K.dM)(c)}`)}):(h&&Number.isNaN(Number(e.meta.total.usage.units))||(h=n(`breakdown.historical_chart.${s}_label`)),p=n("breakdown.historical_chart.units_label",{units:n(`units.${(0,K.dM)(h)}`)})),u().createElement("div",{style:X.chartContainer},u().createElement("div",{style:X.trendChart},1===t&&1===a?this.getSkeleton():u().createElement(se,{containerHeight:250,currentData:i,formatDatumValue:K.Bw,formatDatumOptions:{},height:300,previousData:l,units:o?c:h,xAxisLabel:n("breakdown.historical_chart.day_of_month_label"),yAxisLabel:p})))}}const oe=(0,N.X1)(((e,{reportPathsType:t,reportType:r})=>{const a=(0,h.mB)(location.search),s=(0,$.OA)(a),n=s?h.dV:(0,$.VL)(a),o=s||(0,$.pe)(a),i={filter_by:Object.assign(Object.assign(Object.assign({},a&&a.filter_by&&a.filter_by),a&&a.filter&&a.filter.account&&{[`${h.Sq}account`]:a.filter.account}),n&&{[n]:void 0}),group_by:Object.assign({},n&&{[n]:o})},l=Object.assign(Object.assign({},i),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),c=(0,h.pm)(l),u=Object.assign(Object.assign({},i),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),p=(0,h.pm)(u);return{currentQuery:l,currentQueryString:c,currentReport:z.ZV.selectReport(e,t,r,c),currentReportFetchStatus:z.ZV.selectReportFetchStatus(e,t,r,c),previousQuery:u,previousQueryString:p,previousReport:z.ZV.selectReport(e,t,r,p),previousReportFetchStatus:z.ZV.selectReportFetchStatus(e,t,r,p)}})),ie={fetchReport:z.nx.fetchReport},le=(0,U.withTranslation)()((0,A.connect)(oe,ie)(ne)),ce={currentCapacityData:{fill:"none"},currentColorScale:[M.CH.value,j.R0.value,V.t6.value,P.S7.value,L.iM.value],currentLimitData:{fill:"none"},currentRequestData:{fill:"none",strokeDasharray:"3,3"},currentUsageData:{fill:"none"},itemsPerRow:0,previousCapacityData:{fill:"none"},previousColorScale:[D.O6.value,B.OS.value,w.iY.value,x.cQ.value,R.DD.value],previousLimitData:{fill:"none"},previousRequestData:{fill:"none",strokeDasharray:"3,3"},previousUsageData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},ue={chart:{marginTop:Z.S1.value},title:{marginLeft:"-"+I.Js.value}};class pe extends u().Component{constructor(){super(...arguments),this.containerRef=u().createRef(),this.observer=T.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentLimitData:e,currentRequestData:t,currentUsageData:r,previousLimitData:a,previousRequestData:s,previousUsageData:n}=this.props,o="chart.limit_legend_label",i="chart.limit_legend_tooltip",l="chart.requests_legend_label",c="chart.requests_legend_tooltip",u="chart.usage_legend_label",p="chart.usage_legend_tooltip",h=[{childName:"previousUsage",data:n,legendItem:{name:(0,d.Fs)(n,u,!0,!0,1),symbol:{fill:ce.previousColorScale[0],type:"minus"},tooltip:(0,d.Fs)(n,p,!1,!1,1)},style:{data:Object.assign(Object.assign({},ce.previousUsageData),{stroke:ce.previousColorScale[0]})}},{childName:"currentUsage",data:r,legendItem:{name:(0,d.Fs)(r,u,!0,!1),symbol:{fill:ce.currentColorScale[0],type:"minus"},tooltip:(0,d.Fs)(r,p,!1,!1)},style:{data:Object.assign(Object.assign({},ce.currentUsageData),{stroke:ce.currentColorScale[0]})}},{childName:"previousRequest",data:s,legendItem:{name:(0,d.Fs)(s,l,!0,!0,1),symbol:{fill:ce.previousColorScale[1],type:"dash"},tooltip:(0,d.Fs)(s,c,!1,!1,1)},style:{data:Object.assign(Object.assign({},ce.previousRequestData),{stroke:ce.previousColorScale[1]})}},{childName:"currentRequest",data:t,legendItem:{name:(0,d.Fs)(t,l,!0,!1),symbol:{fill:ce.currentColorScale[1],type:"dash"},tooltip:(0,d.Fs)(t,c,!1,!1)},style:{data:Object.assign(Object.assign({},ce.currentRequestData),{stroke:ce.currentColorScale[1]})}},{childName:"previousLimit",data:a,legendItem:{name:(0,d.Fs)(a,o,!0,!0,1),symbol:{fill:ce.previousColorScale[2],type:"minus"},tooltip:(0,d.Fs)(a,i,!1,!1,1)},style:{data:Object.assign(Object.assign({},ce.previousLimitData),{stroke:ce.previousColorScale[2]})}},{childName:"currentLimit",data:e,legendItem:{name:(0,d.Fs)(e,o,!0,!1),symbol:{fill:ce.currentColorScale[2],type:"minus"},tooltip:(0,d.Fs)(e,i,!1,!1)},style:{data:Object.assign(Object.assign({},ce.currentLimitData),{stroke:ce.currentColorScale[2]})}}],g=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:g,series:h})},this.getChart=(e,t)=>{const{hiddenSeries:r}=this.state;return u().createElement(g.A,{data:r.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatDatumValue:e,formatDatumOptions:t}=this.props,r=(0,m.f)("voronoi","cursor");return u().createElement(r,{cursorDimension:"x",labels:({datum:r})=>(0,C.zj)(r,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:130,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e}=this.props,{hiddenSeries:t,series:r,width:a}=this.state,s=e||(a>900?ce.itemsPerRow:2);return u().createElement(y.Qk,{data:(0,C.oX)(r,t),height:25,gutter:20,itemsPerRow:s,name:"legend"})},this.handleLegendClick=e=>{const t=(0,C.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,C.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentLimitData===this.props.currentLimitData&&e.currentRequestData===this.props.currentRequestData&&e.currentUsageData===this.props.currentUsageData&&e.previousLimitData===this.props.previousLimitData&&e.previousRequestData===this.props.previousRequestData&&e.previousUsageData===this.props.previousUsageData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentRequestData:e,currentUsageData:t,previousRequestData:r,previousUsageData:a}=this.props,s=e?(0,E.getDate)((0,d.Y_)(e,!0,!0)[1]):0,n=t?(0,E.getDate)((0,d.Y_)(t,!0,!0)[1]):0,o=r?(0,E.getDate)((0,d.Y_)(r,!0,!0)[1]):0,i=a?(0,E.getDate)((0,d.Y_)(a,!0,!0)[1]):0;return s>0||n>0||o>0||i>0?Math.max(s,n,o,i):31}getEvents(){const{hiddenSeries:e,series:t}=this.state;return(0,b.u)({chartNames:(0,C.bC)(t),isHidden:t=>(0,C.Yt)(e,t),legendName:"legend",onLegendClick:e=>this.handleLegendClick(e.index)})}render(){const{adjustContainerHeight:e,height:t,containerHeight:r=t,padding:a={bottom:130,left:8,right:8,top:8},title:s,xAxisLabel:o,yAxisLabel:i}=this.props,{cursorVoronoiContainer:l,hiddenSeries:c,series:p,width:h}=this.state,d=(0,C.ge)(p,c),g=this.getEndDate(),m=Math.floor(g/2),y=e&&h>900?r-50:r,b=l?u().cloneElement(l,{disable:!(0,C.TW)(p,c),labelComponent:u().createElement(f.M,{legendData:(0,C.oX)(p,c,!0),title:e=>k().t("chart.day_of_month_title",{day:e.x})})}):void 0;return u().createElement("div",{className:"chartOverride",ref:this.containerRef},u().createElement(n.D,{headingLevel:"h2",style:ue.title,size:"xl"},s),u().createElement("div",{style:Object.assign(Object.assign({},ue.chart),{height:y})},u().createElement("div",{style:{height:t,width:h}},u().createElement(v.k,{containerComponent:b,domain:d,events:this.getEvents(),height:t,legendComponent:this.getLegend(),legendData:(0,C.oX)(p,c),legendPosition:"bottom",padding:a,theme:S.Z,width:h},p&&p.map(((e,t)=>this.getChart(e,t))),u().createElement(_.C,{label:o,style:ce.xAxis,tickValues:[1,m,g]}),u().createElement(_.C,{dependentAxis:!0,label:i,style:ce.yAxis})))))}}class he extends u().Component{constructor(){super(...arguments),this.getSkeleton=()=>u().createElement(u().Fragment,null,u().createElement(p.O,{style:X.chartSkeleton,width:W.N.md}),u().createElement(p.O,{style:X.legendSkeleton,width:W.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:r,reportPathsType:a,reportType:s}=this.props;e(a,s,t),e(a,s,r)}componentDidUpdate(e){const{fetchReport:t,currentQueryString:r,previousQueryString:a,reportPathsType:s,reportType:n}=this.props;e.currentQueryString!==r&&t(s,n,r),e.previousQueryString!==a&&t(s,n,a)}render(){const{currentReport:e,currentReportFetchStatus:t,previousReport:r,previousReportFetchStatus:a,t:s}=this.props,n=(0,d.zJ)(e,1,"date","limit"),o=(0,d.zJ)(e,1,"date","request"),i=(0,d.zJ)(e,1,"date","usage"),l=(0,d.zJ)(r,1,"date","limit"),c=(0,d.zJ)(r,1,"date","request"),p=(0,d.zJ)(r,1,"date","usage"),h=e&&e.meta&&e.meta.total&&e.meta.total.usage?e.meta.total.usage.units:"";return u().createElement("div",{style:X.chartContainer},u().createElement("div",{style:X.usageChart},1===t&&1===a?this.getSkeleton():u().createElement(pe,{adjustContainerHeight:!0,containerHeight:300,currentLimitData:n,currentRequestData:o,currentUsageData:i,formatDatumValue:K.Bw,formatDatumOptions:{},height:300,previousLimitData:l,previousRequestData:c,previousUsageData:p,xAxisLabel:s("breakdown.historical_chart.day_of_month_label"),yAxisLabel:s("breakdown.historical_chart.units_label",{units:s(`units.${(0,K.dM)(h)}`)})})))}}const de=(0,N.X1)(((e,{reportPathsType:t,reportType:r})=>{const a=(0,h.mB)(location.search),s=(0,$.OA)(a),n=(0,$.VL)(a),o=(0,$.pe)(a),i="instance_type"===r||"storage"===r,l={filter_by:Object.assign(Object.assign(Object.assign(Object.assign({},a&&a.filter_by&&a.filter_by),a&&a.filter&&a.filter.account&&{[`${h.Sq}account`]:a.filter.account}),n&&{[n]:void 0}),s&&i&&{[h.dV]:s}),group_by:Object.assign(Object.assign({},s&&!i&&{[h.dV]:s}),n&&!s&&{[n]:o})},c=Object.assign(Object.assign({},l),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),u=(0,h.pm)(c),p=Object.assign(Object.assign({},l),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),d=(0,h.pm)(p);return{currentQuery:c,currentQueryString:u,currentReport:z.ZV.selectReport(e,t,r,u),currentReportFetchStatus:z.ZV.selectReportFetchStatus(e,t,r,u),previousQuery:p,previousQueryString:d,previousReport:z.ZV.selectReport(e,t,r,d),previousReportFetchStatus:z.ZV.selectReportFetchStatus(e,t,r,d)}})),ge={fetchReport:z.nx.fetchReport},me=(0,U.withTranslation)()((0,A.connect)(de,ge)(he));class ye extends u().Component{constructor(){super(...arguments),this.getCostChart=e=>{const{t}=this.props;return u().createElement(a.Z,null,u().createElement(s.l,null,u().createElement(n.D,{headingLevel:"h2",size:"lg"},t(`breakdown.historical_chart.${e.reportType}_title`))),u().createElement(o.e,null,u().createElement(te,{reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getTrendChart=e=>{const{t}=this.props;return u().createElement(a.Z,null,u().createElement(s.l,null,u().createElement(n.D,{headingLevel:"h2",size:"lg"},t(`breakdown.historical_chart.${e.reportType}_title`))),u().createElement(o.e,null,u().createElement(le,{reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getUsageChart=e=>{const{t}=this.props;return u().createElement(a.Z,null,u().createElement(s.l,null,u().createElement(n.D,{headingLevel:"h2",size:"lg"},t(`breakdown.historical_chart.${e.reportType}_title`))),u().createElement(o.e,null,u().createElement(me,{reportPathsType:e.reportPathsType,reportType:e.reportType})))}}renderWidget(e){switch(e.type){case"cost":return this.getCostChart(e);case"trend":return this.getTrendChart(e);case"usage":return this.getUsageChart(e);default:return null}}render(){const{selectWidgets:e,widgets:t}=this.props;return u().createElement(i.r,{hasGutter:!0},t.map((t=>{const r=e[t];return u().createElement(l.P,{key:`widget-${t}`},this.renderWidget(r))})))}}},57116:(e,t,r)=>{"use strict";r.d(t,{W:()=>p});var a=r(49382),s=r(33605),n=r(50021),o=r(17918),i=r(54881),l=r(98499),c=r(32412),u=r(48196);const p={cost:{display:"flex",alignItems:"center"},costLabel:{},costValue:{marginTop:0,marginBottom:0,marginRight:c.ZP.var},costLabelUnit:{fontSize:i.ZP.value,color:s.ZP.var},costLabelDate:{fontSize:i.ZP.value,color:n.ZP.var},header:{display:"flex",justifyContent:"space-between",padding:l.ZP.var,backgroundColor:a.ZP.var},info:{verticalAlign:"middle"},infoIcon:{fontSize:o.ZP.value},infoTitle:{fontWeight:"bold"},title:{paddingBottom:u.ZP.var}}},23246:(e,t,r)=>{"use strict";r.d(t,{VL:()=>s,pe:()=>n,OA:()=>o,qV:()=>i});var a=r(45997);const s=e=>(e&&e.group_by?Object.keys(e.group_by):[]).find((e=>e!==a.dV)),n=e=>{const t=s(e);return t?e.group_by[t]:void 0},o=e=>{let t;for(const r of Object.keys(e.group_by))if(r===a.dV){t=e.group_by[a.dV];break}return t},i=e=>{let t;for(const r of Object.keys(e.group_by)){const e=r.indexOf(a.P);if(-1!==e){t=r.substring(e+a.P.length);break}}return t}},88268:(e,t,r)=>{"use strict";r.d(t,{T:()=>s,Z:()=>n});var a=r(45997);const s=({basePath:e,label:t,description:r,groupBy:s,query:n})=>{const o=Object.assign(Object.assign(Object.assign({},n),r&&r!==t&&{[a.eG]:r}),{group_by:{[s]:t}});return`${e}?${(0,a.IV)(o)}`},n=({basePath:e,description:t,groupBy:r,groupByOrg:s,id:n,orgUnitId:o,query:i,title:l,type:c})=>{const u=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},JSON.parse(JSON.stringify(i))),t&&t!==l&&{[a.eG]:t}),l&&{[a.yG]:l}),s&&o&&{[a.dV]:o}),{group_by:{[r]:n}});return u.filter||(u.filter={}),"account"===c?(u.filter.account=n,u.group_by={[a.dV]:s}):"organizational_unit"===c&&(u.group_by={[a.dV]:n}),`${e}?${(0,a.IV)(u)}`}},8091:(e,t,r)=>{"use strict";r.d(t,{W:()=>a,U:()=>s});const a=(e,t,r)=>{const a=Object.assign({},JSON.parse(JSON.stringify(e)));if("*"!==r||"*"!==a.group_by[t]){if(a.filter_by[t]){let e=!1;const s=a.filter_by[t];if(Array.isArray(s)){for(const t of s)if(t===r){e=!0;break}}else e=r===a.filter_by[t];e||(a.filter_by[t]=[a.filter_by[t],r])}else a.filter_by[t]=[r];return a}},s=(e,t,r)=>{const a=Object.assign({},JSON.parse(JSON.stringify(e)));if(null===t)a.filter_by=void 0;else if(null===r)a.filter_by[t]=void 0;else if(Array.isArray(a.filter_by[t])){const s=a.filter_by[t].indexOf(r);s>-1&&(a.filter_by[t]=[...e.filter_by[t].slice(0,s),...e.filter_by[t].slice(s+1)])}else a.filter_by[t]=void 0;return a}},76821:(e,t,r)=>{"use strict";r.d(t,{g_:()=>a,_q:()=>s});const a=e=>({"data-testid":e}),s={details:{cluster_lnk:"cluster-lnk",historical_data_btn:"historical-data-btn",show_more_btn:"show-more-btn",tag_lnk:"tag-lnk",view_all_btn:"view-all-btn"},export:{cancel_btn:"cancel-btn",submit_btn:"submit-btn"},login:{alert:"alert",form:"login-form",username_input:"username-input",password_input:"password-input",submit:"submit"},masthead:{masthead:"masthead",username:"username",sidebarToggle:"sidebar-toggle",logout:"logout"},onboarding:{btn_cancel:"btn-cancel",btn_back:"btn-back",btn_continue:"btn-continue",btn_close:"btn-close",type_selector:"type-selector",type_opt_aws:"type-option-aws",type_opt_ocp:"type-option-ocp",type_opt_non:"type-option-non",name_input:"name-input",check_box_1:"check-box-1",check_box_2:"check-box-2",s3_input:"s3-input",clusterid_input:"clusterid-input",arn_input:"arn-input"},providers:{add_btn:"add-btn",bucket_input:"bucket-input",cancel_btn:"cancel-btn",empty_state_add_btn:"empty_state_add-btn",name_input:"provider-name-input",resource_name_input:"provider-resource-name-input",cluster_id_input:"provider-cluster-id-input",submit_btn:"submit-btn",type_input:"provider-type-input"},sidebar:{nav:"vertical-nav",link:"vertical-nav-link",backdrop:"sidebar-backdrop"}}},33307:(e,t,r)=>{"use strict";r.d(t,{Tf:()=>o,Y:()=>i,J4:()=>l,tw:()=>c,Gg:()=>p,vI:()=>h});var a=r(36234),s=r(30136),n=r.n(s);function o(e="no_data_for_date",t=1){const r=new Date;r.setHours(0),r.setMinutes(0),r.setSeconds(0),t&&r.setMonth(r.getMonth()-t);const s=(0,a.getMonth)(r),o=(0,a.format)(r,"d"),i=(0,a.format)((0,a.startOfMonth)(r),"d");return n().t(e,{count:(0,a.getDate)(r),endDate:o,month:s,startDate:i})}function i(e,t="for_date",r=1){const s=new Date;s.setHours(0),s.setMinutes(0),s.setSeconds(0),r&&s.setMonth(s.getMonth()-r);const o=(0,a.getMonth)(s),i=(0,a.format)(s,"d"),l=(0,a.format)((0,a.startOfMonth)(s),"d");return n().t(t,{count:(0,a.getDate)(s),endDate:i,month:o,startDate:l,value:e})}function l(e="since_date"){const t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0);const r=(0,a.getMonth)(t),s=(0,a.format)(t,"d"),o=(0,a.format)((0,a.startOfMonth)(t),"d");return n().t(e,{count:(0,a.getDate)(t),endDate:s,month:r,startDate:o})}function c(){return function(e){const t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),e&&(t.setDate(1),t.setMonth(t.getMonth()-e)),{start_date:(0,a.format)((0,a.startOfMonth)(t),"yyyy-MM-dd"),end_date:(0,a.format)(e?(0,a.endOfMonth)(t):t,"yyyy-MM-dd")}}(0)}function u(e){const t=new Date,r=new Date;return r.setDate(r.getDate()-e),{end_date:(0,a.format)(t,"yyyy-MM-dd"),start_date:(0,a.format)(r,"yyyy-MM-dd")}}function p(){return u(30)}function h(){return u(60)}},19853:(e,t,r)=>{"use strict";function a(e,t){let r=JSON.stringify(e),a=JSON.stringify(t);return r||(r=""),a||(a=""),r.split("").sort().join("")===a.split("").sort().join("")}r.d(t,{X:()=>a})}}]);
//# sourceMappingURL=249f2bb06d9e158df0dc.bundle.js.map