"use strict";(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[709],{51508:(e,t,a)=>{a.d(t,{l:()=>n});var r=a(56976),s=a(97522),l=a.n(s);const n=e=>{var{children:t}=e,a=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(a[r[s]]=e[r[s]])}return a}(e,["children"]);return l().createElement(r.Form,Object.assign({onSubmit:e=>e.preventDefault()},a),t)}},27916:(e,t,a)=>{a.d(t,{Bu:()=>m,fv:()=>p});var r=a(56976),s=a(43047),l=a(7193),n=a(93952),i=a(97522),o=a.n(i),u=a(74806),c=a(43476),g=a(62226);const d=({variant:e,actionButton:t,title:a,description:n})=>o().createElement(r.EmptyState,{variant:e},o().createElement(r.EmptyStateIcon,{icon:s.$O,color:l.ZP.value}),o().createElement(r.Title,{headingLevel:"h4",size:"lg"},a),o().createElement(r.EmptyStateBody,null,o().createElement(r.Stack,null,o().createElement(r.StackItem,null,n))),t),m=(0,u.ZP)((({intl:e,onRefresh:t})=>{const a=e.formatMessage(n.Z.CostModelsWizardSourceErrorTitle),s=e.formatMessage(n.Z.CostModelsWizardSourceErrorDescription,{url:o().createElement("a",{href:e.formatMessage(n.Z.RedHatStatusUrl),rel:"noreferrer",target:"_blank"},'"Status Page"')}),l=o().createElement(r.Button,{onClick:t},e.formatMessage(n.Z.CostModelsRefreshDialog));return o().createElement(r.Stack,{hasGutter:!0},o().createElement(r.StackItem,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.xl},e.formatMessage(n.Z.CostModelsWizardSourceTitle))),o().createElement(r.StackItem,null,o().createElement(d,{variant:r.EmptyStateVariant.large,actionButton:l,description:s,title:a})))})),p=(0,u.ZP)((0,c.connect)((e=>({query:g.vc.query(e)})),(e=>({fetch:t=>g.lk.fetchSources(t)(e)})),((e,t)=>{const{query:a}=e,{fetch:r}=t,s=Object.keys(a).reduce(((e,t)=>null===a[t]?e:""===e?`${t}=${a[t]}`:`${e}&${t}=${a[t]}`),"");return{onRefresh:()=>r(s)}}))((({intl:e,onRefresh:t})=>{const a=e.formatMessage(n.Z.CostModelsAssignSourcesErrorTitle),s=e.formatMessage(n.Z.CostModelsAssignSourcesErrorDescription,{url:o().createElement("a",{href:e.formatMessage(n.Z.RedHatStatusUrl),rel:"noreferrer",target:"_blank"},'"Status Page"')}),l=o().createElement(r.Button,{onClick:t},e.formatMessage(n.Z.CostModelsRefreshDialog));return o().createElement(d,{variant:r.EmptyStateVariant.large,actionButton:l,description:s,title:a})})))},10209:(e,t,a)=>{a.d(t,{xZ:()=>r,fg:()=>s});const r=e=>(t,a)=>Object.assign(Object.assign({},e),{[t]:e[t]?[...e[t],a]:[a]}),s=e=>(t,a)=>{if(void 0===e[t])return e;const r=e[t].filter((e=>e!==a));return 0===r.length?Object.keys(e).reduce(((a,r)=>r===t?a:Object.assign(Object.assign({},a),{[r]:e[r]})),{}):Object.assign(Object.assign({},e),{[t]:r})}},77656:(e,t,a)=>{a.d(t,{j:()=>n});const r=(e,t)=>e.filter((e=>e!==t));var s=a(97522),l=a.n(s);class n extends l().Component{constructor(e){super(e),this.state={filters:this.props.initialFilters},this.handleChange=this.handleChange.bind(this),this.onRemove=this.onRemove.bind(this),this.onSelect=this.onSelect.bind(this),this.onClearAll=this.onClearAll.bind(this)}handleChange(e){this.setState({filters:Object.assign(Object.assign({},this.state.filters),e)})}onClearAll(){this.setState({filters:Object.assign(Object.assign({},this.state.filters),{metrics:[],measurements:[]})})}onRemove(e,t){this.setState({filters:Object.assign(Object.assign({},this.state.filters),{[e]:r(this.state.filters[e],t)})})}onSelect(e,t){var a,s;this.setState({filters:Object.assign(Object.assign({},this.state.filters),{[e]:(a=this.state.filters[e],s=t,a.includes(s)?r(a,s):[...a,s])})})}render(){return this.props.children({onClearAll:this.onClearAll,onRemove:this.onRemove,onSelect:this.onSelect,setSearch:this.handleChange,search:this.state.filters})}}},95507:(e,t,a)=>{a.d(t,{j:()=>n});var r=a(97522),s=a.n(r),l=a(59805);class n extends s().Component{constructor(e){super(e),this.service=null,this.service=(0,l.kJ)(e.machine).onTransition((e=>this.setState({current:e}))),this.state={current:e.machine.initialState}}componentDidMount(){this.service.start()}componentWillUnmount(){this.service.stop()}render(){const{current:e}=this.state,{send:t}=this.service;return this.props.children({current:e,send:t})}}},18728:(e,t,a)=>{a.d(t,{q:()=>r});const r=(0,a(29122).J)({context:{selection:[]},initial:"collapsed",states:{collapsed:{on:{TOGGLE:"expanded"}},expanded:{on:{TOGGLE:"collapsed",SELECT:{target:"collapsed",actions:["assignSelection"]}}}}})},80963:(e,t,a)=>{a.d(t,{N:()=>n,Z:()=>i});var r=a(56976),s=a(97522),l=a.n(s);const n=({id:e,itemCount:t,perPage:a,page:s,variant:n,onPerPageSelect:i,onSetPage:o})=>l().createElement(r.Toolbar,{id:e},l().createElement(r.ToolbarContent,null,l().createElement(r.ToolbarItem,{variant:"pagination"},l().createElement(r.Pagination,{variant:n,itemCount:t,perPage:a,page:s,onSetPage:o,onPerPageSelect:i})))),i=n},66555:(e,t,a)=>{a.d(t,{Q:()=>o});var r=a(56976),s=a(76889),l=a(97522),n=a.n(l);const i={toolbar:{gridGap:a(32412).ZP.value}},o=({primary:e,secondaries:t,pagination:a,button:l,onClear:o,selected:u})=>n().createElement(r.Toolbar,{style:i.toolbar,clearAllFilters:o,id:"price-list-toolbar"},n().createElement(r.ToolbarContent,null,n().createElement(r.ToolbarToggleGroup,{breakpoint:"xl",toggleIcon:n().createElement(s.k1,null)},n().createElement(r.ToolbarGroup,{variant:"filter-group"},n().createElement(r.ToolbarItem,null,e),t.map((e=>n().createElement(r.ToolbarItem,{key:e.name},n().createElement(r.ToolbarFilter,{deleteChip:e.onRemove,chips:e.filters,categoryName:e.name},u===e.name?e.component:"")))))),n().createElement(r.ToolbarItem,null,l),n().createElement(r.ToolbarItem,{variant:r.ToolbarItemVariant.pagination},a)),n().createElement("hr",{className:"pf-c-divider"}))},76427:(e,t,a)=>{a.d(t,{u:()=>s});var r=a(93952);const s={description_too_long:r.Z.CostModelsDescTooLong,duplicate:r.Z.PriceListDuplicate,not_number:r.Z.PriceListNumberRate,not_positive:r.Z.PriceListPosNumberRate,rate_too_long:r.Z.CostModelsRateTooLong,required:r.Z.CostModelsRequiredField,tag_too_long:r.Z.CostModelsInfoTooLong}},23394:(e,t,a)=>{a.d(t,{HJ:()=>h,Cw:()=>_,Pz:()=>r.Pz,uD:()=>O,L3:()=>r.L3,Nl:()=>r.Nl,bF:()=>o});var r=a(96085),s=a(97522),l=a.n(s),n=a(76427);function i(e=r.Pv,t){switch(t.type){case"UPDATE_DESCRIPTION":return Object.assign(Object.assign({},e),{description:t.value,errors:Object.assign(Object.assign({},e.errors),{description:(0,r.zp)(t.value)})});case"UPDATE_METRIC":{const a=e.errors,s=e.measurement;s.isDirty&&(s.value="",a.measurement=n.u.required);let l=e.step;"initial"===l&&(l="set_metric");const i=Object.assign(Object.assign({},e),{metric:t.value,measurement:s,errors:a,step:l,calculation:t.defaultCalculation,rateKind:"Cluster"===t.value?"regular":e.rateKind}),o=(0,r.cQ)(i),u=i.otherTiers.find((e=>(0,r.lI)((0,r.Um)(e),o)));return Object.assign(Object.assign({},i),{errors:Object.assign(Object.assign({},i.errors),{tagKey:u?n.u.duplicate:null})})}case"UPDATE_MEASUREMENT":{if("initial"===e.step)return e;let a=e.step;"set_metric"===a&&(a="set_rate");const s=Object.assign(Object.assign({},e),{measurement:{value:t.value,isDirty:!0},errors:Object.assign(Object.assign({},e.errors),{measurement:null}),step:a}),l=(0,r.cQ)(s),i=s.otherTiers.find((e=>(0,r.lI)((0,r.Um)(e),l)));return Object.assign(Object.assign({},s),{errors:Object.assign(Object.assign({},s.errors),{tagKey:i?n.u.duplicate:null})})}case"UPDATE_CALCULATION":{if("set_rate"!==e.step)return e;const a=Object.assign(Object.assign({},e),{calculation:t.value}),s=(0,r.cQ)(a),l=a.otherTiers.find((e=>(0,r.lI)((0,r.Um)(e),s)));return Object.assign(Object.assign({},a),{errors:Object.assign(Object.assign({},a.errors),{tagKey:l?n.u.duplicate:null})})}case"TOGGLE_RATE_KIND":return"set_rate"!==e.step?e:Object.assign(Object.assign({},e),{rateKind:"regular"===e.rateKind?"tagging":"regular"});case"UPDATE_REGULAR":return Object.assign(Object.assign({},e),{tieredRates:[{value:t.value,isDirty:!0}],errors:Object.assign(Object.assign({},e.errors),{tieredRates:(0,r.MD)(t.value)})});case"UPDATE_TAG_KEY":{if("set_rate"!==e.step||"tagging"!==e.rateKind)return e;const a=Object.assign(Object.assign({},e),{taggingRates:Object.assign(Object.assign({},e.taggingRates),{tagKey:{value:t.value,isDirty:!0}}),errors:Object.assign(Object.assign({},e.errors),{tagKey:(0,r.eU)(t.value)})}),s=(0,r.cQ)(a),l=a.otherTiers.find((e=>(0,r.lI)((0,r.Um)(e),s)));return Object.assign(Object.assign({},a),{errors:Object.assign(Object.assign({},a.errors),{tagKey:l?n.u.duplicate:a.errors.tagKey})})}case"UPDATE_TAG_DEFAULT":return"set_rate"!==e.step&&"tagging"!==e.rateKind?e:Object.assign(Object.assign({},e),{taggingRates:Object.assign(Object.assign({},e.taggingRates),{defaultTag:e.taggingRates.defaultTag===t.index?null:t.index})});case"UPDATE_TAG":{if("set_rate"!==e.step||"tagging"!==e.rateKind)return e;let a=e.errors.tagValues[t.index],s=e.errors.tagValueValues[t.index],l=e.errors.tagDescription[t.index],n=e.taggingRates.tagValues[t.index].isDirty,i=e.taggingRates.tagValues[t.index].isTagValueDirty;if(void 0!==t.payload.value){const{value:e}=t.payload;a=(0,r.MD)(e),n=!0}return void 0!==t.payload.tagValue&&(s=(0,r.eU)(t.payload.tagValue),i=!0),void 0!==t.payload.description&&(l=(0,r.zp)(t.payload.description)),Object.assign(Object.assign({},e),{taggingRates:Object.assign(Object.assign({},e.taggingRates),{tagValues:[...e.taggingRates.tagValues.slice(0,t.index),Object.assign(Object.assign(Object.assign({},e.taggingRates.tagValues[t.index]),t.payload),{isDirty:n,isTagValueDirty:i}),...e.taggingRates.tagValues.slice(t.index+1)]}),errors:Object.assign(Object.assign({},e.errors),{tagDescription:[...e.errors.tagDescription.slice(0,t.index),l,...e.errors.tagDescription.slice(t.index+1)],tagValueValues:[...e.errors.tagValueValues.slice(0,t.index),s,...e.errors.tagValueValues.slice(t.index+1)],tagValues:[...e.errors.tagValues.slice(0,t.index),a,...e.errors.tagValues.slice(t.index+1)]})})}case"REMOVE_TAG":return"set_rate"!==e.step||"tagging"!==e.rateKind?e:Object.assign(Object.assign({},e),{errors:Object.assign(Object.assign({},e.errors),{tagValues:[...e.errors.tagValues.slice(0,t.index),...e.errors.tagValues.slice(t.index+1)],tagValueValues:[...e.errors.tagValueValues.slice(0,t.index),...e.errors.tagValueValues.slice(t.index+1)]}),taggingRates:Object.assign(Object.assign({},e.taggingRates),{defaultTag:e.taggingRates.defaultTag===t.index?null:e.taggingRates.defaultTag>t.index?e.taggingRates.defaultTag-1:e.taggingRates.defaultTag,tagValues:[...e.taggingRates.tagValues.slice(0,t.index),...e.taggingRates.tagValues.slice(t.index+1)]})});case"ADD_TAG":return"set_rate"!==e.step||"tagging"!==e.rateKind?e:Object.assign(Object.assign({},e),{errors:Object.assign(Object.assign({},e.errors),{tagValues:[...e.errors.tagValues,n.u.required],tagDescription:[...e.errors.tagDescription,null]}),taggingRates:Object.assign(Object.assign({},e.taggingRates),{tagValues:[...e.taggingRates.tagValues,Object.assign({},r.fP.tagValues[0])]})});case"RESET_FORM":return t.payload;default:return e}}function o(e,t,a=[]){const s=(0,r.Pz)(t,void 0,a),[n,o]=l().useReducer(i,s);return Object.assign(Object.assign({},n),{reset:e=>o({type:"RESET_FORM",payload:e}),setDescription:e=>o({type:"UPDATE_DESCRIPTION",value:e}),setMetric:t=>o({type:"UPDATE_METRIC",value:t,defaultCalculation:(0,r.Bk)(e,t)}),setMeasurement:e=>o({type:"UPDATE_MEASUREMENT",value:e}),setCalculation:e=>o({type:"UPDATE_CALCULATION",value:e}),setRegular:e=>o({type:"UPDATE_REGULAR",value:e}),toggleTaggingRate:()=>o({type:"TOGGLE_RATE_KIND"}),setTagKey:e=>o({type:"UPDATE_TAG_KEY",value:e}),removeTag:e=>o({type:"REMOVE_TAG",index:e}),addTag:()=>o({type:"ADD_TAG"}),updateTag:(e,t)=>o({type:"UPDATE_TAG",index:t,payload:e}),updateDefaultTag:e=>o({type:"UPDATE_TAG_DEFAULT",index:e})})}var u=a(56976),c=a(7081),g=a(32004),d=a(93952),m=a(74806),p=a(99291);const b={currency:{fontWeight:a(23992).ZP.value}},v=(0,m.ZP)((({currencyUnits:e="USD",fieldId:t,helperTextInvalid:a=d.Z.PriceListPosNumberRate,intl:r=g.N,label:s=d.Z.Rate,onBlur:n,onChange:i,style:o,validated:c,value:m})=>l().createElement(u.FormGroup,{isRequired:!0,style:o,fieldId:t,label:null!==s&&"object"==typeof s?r.formatMessage(s):s,helperTextInvalid:null!==a&&"object"==typeof a?r.formatMessage(a):a,validated:c},l().createElement(u.InputGroup,null,l().createElement(u.InputGroupText,{style:b.currency},r.formatMessage(d.Z.CurrencyUnits,{units:e})),l().createElement(u.TextInput,{onBlur:n,isRequired:!0,type:"text","aria-label":r.formatMessage(d.Z.CostModelsWizardRateAriaLabel),id:t,placeholder:(0,p.MV)(0,e,{minimumFractionDigits:2,maximumFractionDigits:2}),value:m,onChange:i,onKeyDown:e=>{13!==e.keyCode&&187!==e.keyCode||e.preventDefault()},validated:c}))))),f=(0,m.ZP)((({"aria-label":e,helperTextInvalid:t,id:a,intl:r=g.N,isDisabled:s=!1,isInvalid:n=!1,isRequired:i=!1,label:o,onChange:c,options:d,style:m,value:p})=>l().createElement(u.FormGroup,{isRequired:i,style:m,fieldId:a,label:null!==o&&"object"==typeof o?r.formatMessage(o):o,helperTextInvalid:null!==t&&"object"==typeof t?r.formatMessage(t):t,validated:n?"error":"default"},l().createElement(u.FormSelect,{isRequired:i,isDisabled:s,value:p,onChange:c,"aria-label":e,id:a,validated:n?"error":"default"},d.map((e=>l().createElement(u.FormSelectOption,{key:`${e.value}`,value:e.value,label:"object"==typeof e.label?r.formatMessage(e.label):e.label,isDisabled:e.isDisabled}))))))),y=(0,m.ZP)((({id:e,intl:t=g.N,label:a,isRequired:r,helperTextInvalid:s,onChange:n,onBlur:i,placeholder:o,style:c,validated:d,value:m})=>l().createElement(u.FormGroup,{isRequired:r,style:c,fieldId:e,label:null!==a&&"object"==typeof a?t.formatMessage(a):a,helperTextInvalid:null!==s&&"object"==typeof s?t.formatMessage(s):s,validated:d},l().createElement(u.TextInput,{validated:d,value:m,onChange:n,id:e,onBlur:i,isRequired:r,placeholder:o}))));var T=a(71415);const E=(0,m.ZP)((({currencyUnits:e,defaultTag:t,errors:a,intl:r=g.N,tagValues:s,updateDefaultTag:n,removeTag:i,updateTag:o})=>{const c={width:"200px"},m={height:"100%",position:"relative",top:"50%"};return l().createElement(l().Fragment,null,s.map(((g,p)=>l().createElement(u.Split,{hasGutter:!0,key:p},l().createElement(u.SplitItem,{style:m},r.formatMessage(d.Z.EqualsSymbol)),l().createElement(u.SplitItem,null,l().createElement(y,{isRequired:!0,style:c,id:`tagValue_${p}`,label:d.Z.CostModelsTagRateTableValue,placeholder:r.formatMessage(d.Z.CostModelsEnterTagValue),value:g.tagValue,onChange:e=>o({tagValue:e},p),validated:s[p].isTagValueDirty&&a.tagValueValues[p]?"error":"default",helperTextInvalid:a.tagValueValues[p]})),l().createElement(u.SplitItem,null,l().createElement(v,{currencyUnits:e,fieldId:`rate_${p}`,helperTextInvalid:a.tagValues[p],onChange:e=>o({value:e},p),style:c,validated:s[p].isDirty&&a.tagValues[p]?"error":"default",value:g.value})),l().createElement(u.SplitItem,null,l().createElement(y,{style:c,id:`desc_${p}`,label:d.Z.Description,validated:a.tagDescription[p]?"error":"default",value:g.description,onChange:e=>o({description:e},p),helperTextInvalid:a.tagDescription[p]})),l().createElement(u.SplitItem,null,l().createElement(u.FormGroup,{fieldId:`isDefault_${p}`,label:r.formatMessage(d.Z.CostModelsTagRateTableDefault)},l().createElement(u.Checkbox,{id:`isDefault_${p}`,isChecked:t===p,onChange:()=>n(p)}))),l().createElement(u.SplitItem,null,l().createElement(u.FormGroup,{fieldId:"__irrelevant",label:l().createElement("div",null," ")},l().createElement(u.Button,{"data-testid":`remove_tag_${p}`,variant:u.ButtonVariant.plain,isDisabled:1===s.length,onClick:()=>i(p)},l().createElement(T.$_,null))))))))})),h=(0,m.ZP)((({currencyUnits:e,intl:t=g.N,metricsHash:a,rateFormData:r})=>{const{addTag:s,calculation:n,description:i,errors:o,measurement:{value:m,isDirty:b},metric:T,rateKind:h,removeTag:_,setCalculation:O,setDescription:R,setMeasurement:j,setMetric:D,setRegular:C,setTagKey:V,step:M,taggingRates:{tagKey:{value:S,isDirty:x},defaultTag:Z,tagValues:I},tieredRates:{0:{value:P,isDirty:k}},toggleTaggingRate:A,updateDefaultTag:K,updateTag:U}=r,G=e=>{const a=e.replace(/ /g,"_").toLowerCase();return t.formatMessage(d.Z.MetricValues,{value:a})||e},L=(e,a)=>{const r=a.replace(/-/g,"_").toLowerCase(),s=t.formatMessage(d.Z.Units,{units:(0,p.ZV)(r)});return t.formatMessage(d.Z.MeasurementValues,{value:e.toLowerCase(),units:s||a,count:2})||e},N=l().useMemo((()=>Object.keys(a)),[a]),q=l().useMemo((()=>N.includes(T)?Object.keys(a[T]):[]),[N,T]),F={width:"360px"};return l().createElement(l().Fragment,null,l().createElement(y,{style:F,id:"description",label:d.Z.Description,value:i,validated:o.description?"error":"default",helperTextInvalid:o.description,onChange:R}),l().createElement(u.Grid,{hasGutter:!0},l().createElement(u.GridItem,{span:6},l().createElement(f,{isRequired:!0,style:F,id:"metric",label:d.Z.Metric,value:T,onChange:D,options:[{label:d.Z.Select,value:"",isDisabled:!0},...N.map((e=>({label:G(e),value:e,isDisabled:!1})))]})),"initial"===M?null:l().createElement(u.GridItem,{span:6},l().createElement(f,{isRequired:!0,helperTextInvalid:o.measurement,isInvalid:o.measurement&&b,style:F,id:"measurement",label:d.Z.Measurement,value:m,onChange:j,options:[{label:d.Z.Select,value:"",isDisabled:!0},...q.map((e=>({label:L(e,a[T][e].label_measurement_unit),value:e,isDisabled:!1})))]}))),"set_rate"===M?l().createElement(l().Fragment,null,l().createElement(l().Fragment,null,l().createElement(u.FormGroup,{isInline:!0,style:F,fieldId:"calculation",label:t.formatMessage(d.Z.CalculationType)},l().createElement(u.Radio,{name:"calculation",id:"calculation_infra",label:t.formatMessage(d.Z.Infrastructure),isChecked:"Infrastructure"===n,onChange:()=>O("Infrastructure")}),l().createElement(u.Radio,{name:"calculation",id:"calculation_suppl",label:t.formatMessage(d.Z.Supplementary),isChecked:"Supplementary"===n,onChange:()=>O("Supplementary")})),"Cluster"!==T?l().createElement(u.Switch,{"aria-label":t.formatMessage(d.Z.CostModelsEnterTagRate),label:t.formatMessage(d.Z.CostModelsEnterTagRate),isChecked:"tagging"===h,onChange:A}):null),"regular"===h?l().createElement(v,{currencyUnits:e,fieldId:"regular-rate",helperTextInvalid:o.tieredRates,onChange:C,style:F,validated:o.tieredRates&&k?"error":"default",value:P}):l().createElement(l().Fragment,null,l().createElement(y,{isRequired:!0,style:F,value:S,onChange:V,id:"tag-key",label:d.Z.CostModelsFilterTagKey,placeholder:t.formatMessage(d.Z.CostModelsEnterTagKey),validated:o.tagKey&&x?"error":"default",helperTextInvalid:o.tagKey}),l().createElement(E,{currencyUnits:e,defaultTag:Z,errors:{tagValues:o.tagValues,tagValueValues:o.tagValueValues,tagDescription:o.tagDescription},removeTag:_,tagValues:I,updateDefaultTag:K,updateTag:U}),l().createElement(u.Button,{"data-testid":"add_more",style:{paddingLeft:"0",textAlign:"left"},variant:u.ButtonVariant.link,onClick:s},l().createElement(c.wl,null)," ",t.formatMessage(d.Z.CostModelsAddTagValues)))):null)}));function _(e){return"tagging"===e.rateKind?null===e.errors.description&&null===e.errors.measurement&&e.errors.tagValues.every((e=>null===e))&&e.errors.tagValueValues.every((e=>null===e))&&e.errors.tagDescription.every((e=>null===e))&&null===e.errors.tagKey:null===e.errors.description&&null===e.errors.measurement&&null===e.errors.tieredRates}function O(e,t){if(!e)return!0;if(e.description!==t.description)return!0;if(e.metric.label_metric!==t.metric)return!0;if(e.metric.label_measurement!==t.measurement.value)return!0;if(e.cost_type!==t.calculation)return!0;const a=e.tiered_rates?"regular":"tagging";if(a!==t.rateKind)return!0;if("regular"===a&&Number(e.tiered_rates[0].value)!==Number(t.tieredRates[0].value))return!0;if("tagging"===a){const a=e.tag_rates;if(a.tag_key!==t.taggingRates.tagKey.value)return!0;if(a.tag_values.length!==t.taggingRates.tagValues.length)return!0;if(a.tag_values.some(((e,a)=>{const r=t.taggingRates.tagValues[a],s=t.taggingRates.defaultTag===a;return e.tag_value!==r.tagValue||Number(e.value)!==Number(r.value)||e.description!==r.description||e.default!==s})))return!0}return!1}},96085:(e,t,a)=>{a.d(t,{fP:()=>n,Pv:()=>i,MD:()=>o,Bk:()=>u,Pz:()=>c,L3:()=>g,Nl:()=>d,Um:()=>m,cQ:()=>p,lI:()=>b,tT:()=>v,zp:()=>f,eU:()=>y});var r=a(98975),s=a(99291),l=a(76427);const n={tagKey:{value:"",isDirty:!1},defaultTag:null,tagValues:[{tagValue:"",value:"",description:"",isDirty:!1,isTagValueDirty:!1}]},i={otherTiers:[],step:"initial",description:"",metric:"",measurement:{value:"",isDirty:!1},calculation:"",rateKind:"regular",tieredRates:[{value:"",isDirty:!1}],taggingRates:Object.assign({},n),errors:{description:null,measurement:l.u.required,tieredRates:l.u.required,tagValues:[l.u.required],tagDescription:[null],tagKey:l.u.required,tagValueValues:[l.u.required]}},o=e=>0===e.length?l.u.required:(0,s.dI)(e)?Number((0,s.E3)(e))<0?l.u.not_positive:(0,s.cR)(e)>10?l.u.rate_too_long:null:l.u.not_number;function u(e,t){let a=Object.keys(e);return a.includes(t)?(a=Object.keys(e[t]),0===a.length?"":e[t][a[0]].default_cost_type):""}function c(e,t=i,a){const r=a||t.otherTiers;if(!e)return Object.assign(Object.assign({},t),{otherTiers:r});const o=e.tiered_rates?"regular":"tagging";let u=[{value:"",isDirty:!0}];const c=Object.assign({},n),g={description:null,measurement:null,tieredRates:null,tagValues:[null],tagKey:null,tagValueValues:[null],tagDescription:[null]};if("tagging"===o){const t=e.tag_rates;c.tagKey={value:t.tag_key,isDirty:!0};const a=t.tag_values.findIndex((e=>e.default));c.defaultTag=-1===a?null:a,c.tagValues=t.tag_values.map((e=>({tagValue:e.tag_value,value:(0,s.zs)(e.value,e.unit),description:e.description,isDirty:!1,isTagValueDirty:!1}))),g.tieredRates=l.u.required,g.tagValueValues=new Array(t.tag_values.length).fill(null),g.tagValues=new Array(t.tag_values.length).fill(null),g.tagDescription=new Array(t.tag_values.length).fill(null)}return"regular"===o&&(u=e.tiered_rates.map((e=>({value:(0,s.zs)(e.value,e.unit),isDirty:!0}))),g.tagValues=[l.u.required],g.tagValueValues=[l.u.required]),{otherTiers:r,step:"set_rate",description:e.description,metric:e.metric.label_metric,measurement:{value:e.metric.label_measurement,isDirty:!0},calculation:e.cost_type,rateKind:o,tieredRates:u,taggingRates:c,errors:g}}const g=(e,t,a,r=-1)=>{r<0&&(r=t.rates.length);const s=d(a,e,t.currency,!0);return{name:t.name,source_type:"OCP",description:t.description,distribution:t.distribution,source_uuids:t.sources.map((e=>e.uuid)),markup:{value:t.markup.value,unit:"percent"},rates:[...t.rates.slice(0,r),s,...t.rates.slice(r+1)]}},d=(e,t,a="USD",r=!1)=>{const l="tagging"===e.rateKind?"tag_rates":"tiered_rates",n="tagging"===e.rateKind?{tag_key:e.taggingRates.tagKey.value,tag_values:e.taggingRates.tagValues.map(((t,l)=>({tag_value:t.tagValue,unit:a,value:r?(0,s.E3)(t.value):t.value,description:t.description,default:l===e.taggingRates.defaultTag})))}:e.tieredRates.map((e=>({value:r?(0,s.E3)(e.value):e.value,unit:a,usage:{unit:a}}))),i=t[e.metric][e.measurement.value];return{description:e.description,metric:{metric:i.metric,name:i.metric,label_metric:i.label_metric,label_measurement:i.label_measurement,label_measurement_unit:i.label_measurement_unit,source_type:"OpenShift Cluster Platform",default_cost_type:i.default_cost_type},cost_type:e.calculation,[l]:n}},m=e=>{const t=e.tag_rates&&e.tag_rates.tag_key?e.tag_rates.tag_key:null;return{metric:e.metric.label_metric,measurement:e.metric.label_measurement,tagKey:t,costType:e.cost_type}},p=e=>{const t=e.taggingRates&&e.taggingRates.tagKey?e.taggingRates.tagKey.value:null;return{metric:e.metric,measurement:e.measurement?e.measurement.value:null,tagKey:t,costType:e.calculation}},b=(e,t)=>e.metric===t.metric&&e.measurement===t.measurement&&e.costType===t.costType&&e.tagKey===t.tagKey;function v(e,t,a,s){const l=s(e),n=s(t);return a===r.SortByDirection.asc?l>n?1:l<n?-1:0:l>n?-1:l<n?1:0}const f=e=>e.length>500?l.u.description_too_long:null,y=e=>0===e.length?l.u.required:e.length>100?l.u.tag_too_long:null},39574:(e,t,a)=>{a.d(t,{y:()=>d});var r=a(98975),s=a(32004),l=a(93952),n=a(97522),i=a.n(n),o=a(74806),u=a(99291),c=a(96085);const g=(0,o.ZP)((({isNormalized:e=!1,intl:t=s.N,tagRates:a})=>{const n=[t.formatMessage(l.Z.CostModelsTagRateTableKey),t.formatMessage(l.Z.CostModelsTagRateTableValue),t.formatMessage(l.Z.Rate),t.formatMessage(l.Z.Description),t.formatMessage(l.Z.CostModelsTagRateTableDefault)],o=a&&a.tag_values.map(((r,s)=>{const n=Number(e?(0,u.E3)(r.value.toString()):r.value);return{cells:[0===s?a.tag_key:"",r.tag_value,(0,u.NJ)(n,r.unit),r.description,r.default?t.formatMessage(l.Z.Yes):t.formatMessage(l.Z.No)]}}));return i().createElement(r.Table,{"aria-label":t.formatMessage(l.Z.CostModelsTagRateTableAriaLabel),borders:!1,cells:n,gridBreakPoint:r.TableGridBreakpoint.grid2xl,rows:o,variant:r.TableVariant.compact},i().createElement(r.TableHeader,null),i().createElement(r.TableBody,null))})),d=(0,o.ZP)((({actions:e,intl:t=s.N,isCompact:a,isNormalized:n=!1,tiers:o})=>{const[d,m]=i().useState({}),[p,b]=i().useState({});let v=0;const f=o.sort(((e,t)=>{const a=1===p.index?e=>e.metric.label_metric:2===p.index?e=>e.metric.label_measurement:()=>"";return(0,c.tT)(e,t,p.direction,a)})).reduce(((e,a,r)=>{const s=a.tiered_rates?"regular":"tagging";let o=[];"tagging"===s&&(o=[{compoundParent:4,parent:r+v,cells:[{title:i().createElement(g,{isNormalized:n,tagRates:a.tag_rates}),props:{colSpan:6,className:"pf-m-no-padding"}}]}],v+=1);const c="tagging"===s?d[r+v-1]||!1:void 0,m=a.tiered_rates?a.tiered_rates[0].value:0,p=Number(n?(0,u.E3)(m.toString()):m);return[...e,{data:{index:r,hasChildren:"tagging"===s},cells:[a.description||"",a.metric.label_metric,`${a.metric.label_measurement} (${a.metric.label_measurement_unit})`,a.cost_type,{title:"regular"===s?(0,u.NJ)(p,a.tiered_rates[0].unit):t.formatMessage(l.Z.Various),props:{isOpen:c,style:{padding:"tagging"===s?"":"1.5rem 1rem"}}}]},...o]}),[]),y=[{title:t.formatMessage(l.Z.Description)},Object.assign({title:t.formatMessage(l.Z.Metric)},f.length&&{transforms:[r.sortable]}),Object.assign({title:t.formatMessage(l.Z.Measurement)},f.length&&{transforms:[r.sortable]}),{title:t.formatMessage(l.Z.CalculationType)},{title:t.formatMessage(l.Z.Rate),cellTransforms:[r.compoundExpand]}];return i().createElement(r.Table,{onSort:(e,t,a)=>{b({index:t,direction:a})},sortBy:p,"aria-label":t.formatMessage(l.Z.CostModelsWizardCreatePriceList),variant:a?r.TableVariant.compact:void 0,rows:f,cells:y,actionResolver:t=>t.compoundParent?[]:e,onExpand:(e,t,a,r)=>{m(Object.assign(Object.assign({},d),{[t]:!r}))}},i().createElement(r.TableHeader,null),i().createElement(r.TableBody,null))}))},20546:(e,t,a)=>{a.d(t,{j:()=>n});var r=a(56976),s=a(97522),l=a.n(s);const n=({children:e,tooltip:t="You have read only permissions",isDisabled:a})=>a?l().createElement(r.Tooltip,{isContentLeftAligned:!0,content:l().createElement("div",null,t)},l().createElement("div",null,e)):e},85218:(e,t,a)=>{a.d(t,{n:()=>o});var r=a(56976),s=a(95507),l=a(18728),n=a(97522),i=a.n(n);const o=({options:e,placeholderText:t,setSelections:a,selections:n,isDisabled:o})=>i().createElement(s.j,{machine:l.q.withConfig({actions:{assignSelection:(e,t)=>{a(t.selection)}}})},(({send:a,current:s})=>i().createElement(r.Select,{isDisabled:o,variant:r.SelectVariant.checkbox,placeholderText:t,selections:n,isOpen:s.matches("expanded"),onSelect:(e,t)=>a({type:"SELECT",selection:t}),onToggle:()=>a({type:"TOGGLE"})},e.map((e=>i().createElement(r.SelectOption,{key:e.value,value:e.value},e.label))))))},60477:(e,t,a)=>{a.d(t,{J:()=>u});var r=a(56976),s=a(76889),l=a(95507),n=a(18728),i=a(97522),o=a.n(i);const u=({setPrimary:e,primary:t,options:a,isDisabled:i})=>o().createElement(l.j,{machine:n.q.withConfig({actions:{assignSelection:(t,a)=>{e(a.selection)}}})},(({current:e,send:l})=>o().createElement(r.Select,{isDisabled:i,toggleIcon:o().createElement(s.k1,null),isOpen:e.matches("expanded"),selections:t,onSelect:(e,t)=>l({type:"SELECT",selection:t}),onToggle:()=>l({type:"TOGGLE"})},a.map((e=>o().createElement(r.SelectOption,{key:e.value,value:e.value},e.label))))))},39887:(e,t,a)=>{a.d(t,{a:()=>i});var r=a(56976),s=a(98048),l=a(97522),n=a.n(l);const i=({text:e})=>n().createElement(r.Tooltip,{content:e,enableFlip:!0},n().createElement(s.T6,{color:"orange"}))},4705:(e,t,a)=>{a.d(t,{W:()=>l});var r=a(17918),s=a(80939);const l={card:{minHeight:250},cardDescription:{fontSize:r.ZP.value},cardBody:{fontSize:s.ZP.value,textAlign:"center"},exampleMargin:{marginLeft:30},inputField:{borderLeft:0,width:175},markupRadio:{marginBottom:6},markupRadioContainer:{marginTop:6},rateContainer:{marginLeft:20},percent:{borderLeft:0},sign:{borderRight:0}}}}]);
//# sourceMappingURL=943cf58b5e47a0f9ff75.bundle.js.map