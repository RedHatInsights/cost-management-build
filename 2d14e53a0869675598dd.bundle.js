(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{168:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"a",function(){return o});const n=(e,t,a={})=>{const n=t&&t.split("-")[0].toLowerCase(),l=e||0;switch(n){case"usd":return o(l,n,a);case"gb":return i(l,n,a);default:return r(l,n,a)}},r=(e,t,{fractionDigits:a}={})=>e.toFixed(a),o=(e,t,{fractionDigits:a=2}={})=>{let n=e;return e||(n=0),n.toLocaleString("en",{style:"currency",currency:"USD",minimumFractionDigits:a,maximumFractionDigits:a})},i=(e,t,{fractionDigits:a=2}={})=>e.toFixed(a)},172:function(e,t,a){"use strict";a.d(t,"a",function(){return o}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return l});var n=a(205);const r=["services","accounts","instance_types","regions"];function o({report:e,idKey:t,labelKey:a=t,sortKey:r="total",sortDirection:o=0}){return Object(n.a)(i({report:e,idKey:t,labelKey:a,sortDirection:o,sortKey:r}),{key:r,direction:o})}function i({report:e,idKey:t,labelKey:a=t}){if(!e)return[];const n={},o=e=>{e.values&&e.values.forEach(e=>{const r=e.total,o=e[t];let i=e[a];"account"===a&&e.account_alias&&(i=e.account_alias),n[o]?n[o]=Object.assign({},n[o],{total:n[o].total+r}):n[o]={id:o,total:r,label:i,units:e.units}}),r.forEach(t=>{if(e[t])return e[t].forEach(o)})};return e.data.forEach(o),Object.values(n)}function l(e={}){return e.account?"account":e.instance_type?"instance_type":e.region?"region":e.service?"service":"date"}},184:function(e,t,a){"use strict";a.d(t,"c",function(){return u}),a.d(t,"a",function(){return m}),a.d(t,"b",function(){return p});var n=a(258),r=a.n(n),o=a(256),i=a.n(o),l=a(255),s=a.n(l),c=a(172);function u(e,t=1,a="date"){if(!e)return[];const n=Object(c.a)({report:e,idKey:a,sortKey:"id",sortDirection:1});return 1===t?n.map(e=>d(e.total,e,a)):2===t?n.map(e=>d(e.total,e,a)):n.reduce((e,t)=>{const n=e.length?e[e.length-1].y:0;return[...e,d(n+t.total,t,a)]},[])}function d(e,t,a="date"){return{x:"date"===a?i()(t.id):t.label,y:parseFloat(e.toFixed(2)),key:t.id,name:t.id,units:t.units}}function m(e){const[t,a]=function(e){if(!e.length){const e=new Date;return[s()(e),e]}return[new Date(e[0].key+"T00:00:00"),new Date(e[e.length-1].key+"T00:00:00")]}(e),n=r()(t,"MMM"),o=i()(t),l=i()(a);return`${n} ${i()(t)}${o!==l?` - ${l}`:""}`}function p(e,t,a,n="date"){if(!e.key)return"";if("date"===n){return`${r()(e.key,"MMM D YYYY")}: ${t(e.y,e.units,a)}`}return e.key.toString()}},185:function(e,t,a){"use strict";a.d(t,"a",function(){return n}),a.d(t,"b",function(){return r});const n=e=>({"data-testid":e}),r={export:{cancel_btn:"cancel-btn",submit_btn:"submit-btn"},login:{alert:"alert",form:"login-form",username_input:"username-input",password_input:"password-input",submit:"submit"},masthead:{masthead:"masthead",username:"username",sidebarToggle:"sidebar-toggle",logout:"logout"},providers:{add_btn:"add-btn",bucket_input:"bucket-input",cancel_btn:"cancel-btn",name_input:"provider-name-input",resource_name_input:"provider-resource-name-input",submit_btn:"submit-btn",type_input:"provider-type-input"},sidebar:{nav:"vertical-nav",link:"vertical-nav-link",backdrop:"sidebar-backdrop"}}},205:function(e,t,a){"use strict";function n(e,t){if("string"==typeof e)return e;return e[t.key]}function r(e,t){const{direction:a=0}=t||{};return[...e].sort((e,r)=>{const o=n(0===a?e:r,t),i=n(0===a?r:e,t);return o>i?-1:o<i?1:0})}a.d(t,"a",function(){return r})},210:function(e,t,a){"use strict";var n=a(560),r=a(0),o=a.n(r);const i=n.a.create({legend:{display:"flex",alignItems:"center"}}),l=({children:e,style:t})=>{const a=Boolean(t)&&Boolean(t.legend)?t.legend:i.legend;return o.a.createElement("div",{className:Object(n.b)(a)},e)};var s=a(127);const c={padding:8,group:{data:{strokeWidth:2,fillOpacity:.4}},tooltipText:{fontSize:"14px",fill:s.m.value},tooltipFlyout:{fill:s.l.value},previousMonth:{data:{fill:s.K.value,stroke:s.J.value}},currentMonth:{data:{fill:s.B.value,stroke:s.C.value}}},u=(n.a.create({reportSummaryTrend:{":not(foo) svg":{overflow:"visible"},":not(foo) text":{fontSize:"12px",length:"12px"}}}),n.a.create({legendItem:{display:"flex",alignItems:"center",fontSize:s.s.value,color:s.k.var,marginRight:s.F.value},color:{height:10,width:10,marginRight:s.G.value,borderWidth:s.h.value,borderStyle:"solid"},currentColor:{backgroundColor:c.currentMonth.data.fill,borderColor:c.currentMonth.data.stroke},previousColor:{backgroundColor:c.previousMonth.data.fill,borderColor:c.previousMonth.data.stroke}}));var d=a(184);const m=({data:e,isCurrent:t,idKey:a="date",index:r,style:i})=>{if(!e||0===e.length)return o.a.createElement("div",null);const l=Boolean(i)&&Boolean(i.legendItem)?i.legendItem:u.legendItem;if("date"===a){const a=Object(d.a)(e);return o.a.createElement("div",{className:Object(n.b)(l)},o.a.createElement("div",{className:Object(n.b)(u.color,t?u.currentColor:u.previousColor)}),a)}return o.a.createElement("div",{key:e[r].key,className:Object(n.b)(l)},o.a.createElement("div",{className:Object(n.b)(u.color,t?u.currentColor:u.previousColor)}),e[r].key)},p=n.a.create({chartTitle:{fontSize:s.s.value,marginBottom:s.G.value}}),b=({children:e})=>o.a.createElement("div",{className:Object(n.b)(p.chartTitle)},e);a.d(t,"a",function(){return l}),a.d(t,"b",function(){return m}),a.d(t,"c",function(){return b})},343:function(e,t,a){"use strict";var n=a(566),r=a(589),o=a(563),i=a(562),l=a(560),s=a(592),c=a(590),u=a(593),d=a(0),m=a.n(d),p=a(127);const b=l.a.create({reportSummary:{height:"100%"},subtitle:{fontSize:p.s.value,color:p.k.var}}),h=({children:e,subTitle:t,title:a})=>m.a.createElement(u.a,{className:Object(l.b)(b.reportSummary)},m.a.createElement(c.a,null,m.a.createElement(i.b,{size:"lg"},a),Boolean(t)&&m.a.createElement("p",{className:Object(l.b)(b.subtitle)},t)),m.a.createElement(s.a,null,e));var g=a(31),v=a(26),f=a(37),y=a(33),E=a(11),k=a(25),O=a(185),j=a(186);const w=l.a.create({banner:{height:60,color:p.j.var,marginBottom:p.H.value,padding:`0 ${p.H.value}`,display:"flex",alignItems:"center",justifyContent:"space-between"},content:{padding:`0 ${p.H.value}`}}),x=j["b"]`
  min-height: 100%;
  padding-bottom: ${p.E.var};
  background-color: rgba(0, 0, 0, 0.5);
  ${p.j.name}: ${p.m.value};
  ${p.k.name}: ${p.n.value};

  & .pf-c-card {
    ${p.j.name}: ${p.m.value};
    ${p.k.name}: ${p.n.value};
    ${p.a.name}: rgba(0, 0, 0, 0.5);
  }
`,C=j["b"]`
  & ul {
    list-style-type: initial;
    margin-left: 20px;
  }
`;var T=a(39),S=a(598);const D=n.c,_=e=>m.a.createElement(D,Object.assign({component:S.a,variant:"link"},e));var K=a(591);const N=l.a.create({reportSummary:{height:"100%"},subtitle:{fontSize:p.s.value,color:p.k.var}}),B=Object(g.c)()(({title:e,subTitle:t,detailsLink:a,children:n,status:r,t:o})=>m.a.createElement(u.a,{className:Object(l.b)(N.reportSummary)},m.a.createElement(c.a,null,m.a.createElement(i.b,{size:"lg"},e),Boolean(t)&&m.a.createElement("p",{className:Object(l.b)(N.subtitle)},t)),m.a.createElement(s.a,null,1===r?`${o("loading")}...`:n),Boolean(a)&&m.a.createElement(K.a,null,a))),I=l.a.create({reportSummaryDetails:{marginBottom:p.F.value,display:"flex",alignItems:"flex-end"},value:{color:p.j.var,marginRight:p.G.value,fontSize:p.o.value},text:{paddingBottom:14,lineHeight:p.w.value,fontSize:p.s.value}}),M=({label:e,formatValue:t,formatOptions:a,report:n})=>{let r="----";return n&&(r=n.total?t(n.total.value,n.total.units,a):0),m.a.createElement("div",{className:Object(l.b)(I.reportSummaryDetails)},m.a.createElement("div",{className:Object(l.b)(I.value)},r),m.a.createElement("div",{className:Object(l.b)(I.text)},m.a.createElement("div",null,e)))},$=l.a.create({progressBar:{height:10,backgroundColor:"rgba(0, 123, 186, 0.2)",marginTop:p.G.value,marginBottom:p.E.value},bar:{height:"100%",backgroundColor:p.C.value}}),R=({progress:e})=>{const t=Math.min(Math.max(0,e),100);return m.a.createElement("div",{className:Object(l.b)($.progressBar)},m.a.createElement("div",{className:Object(l.b)($.bar),style:{width:`${t}%`}}))},z=l.a.create({reportSummaryItem:{":not(:last-child)":{marginBottom:p.F.value}},info:{display:"flex",fontSize:p.s.value,justifyContent:"space-between"},test:{":not(foo) svg":{overflow:"visible"}}}),F=({label:e,value:t,totalValue:a,formatValue:n,units:r,formatOptions:o})=>{const i=a?t/a*100:0;return m.a.createElement("li",{className:Object(l.b)(z.reportSummaryItem)},m.a.createElement("div",{className:Object(l.b)(z.info)},m.a.createElement("div",null,e),m.a.createElement("div",null,n(t,r,o)," (",i.toFixed(2),"%)")),m.a.createElement(R,{progress:i}))};F.defaultProps={formatValue:e=>e};var L=a(172);class W extends m.a.Component{shouldComponentUpdate(e){return e.report!==this.props.report}getItems(){const{report:e,idKey:t,labelKey:a}=this.props,n=Object(L.a)({report:e,idKey:t,labelKey:a}),r=n.findIndex(e=>"Other"===e.id);return-1!==r?[...n.slice(0,r),...n.slice(r+1),n[r]]:n}render(){const{report:e,children:t}=this.props;if(!e)return null;const a=this.getItems();return m.a.createElement("ul",null,t({items:a}))}}var V=a(210),A=a(184),P=a(559),G=a(574),Q=a(573),H=a(578);const J={padding:8,group:{data:{strokeWidth:2,fillOpacity:.4}},tooltipText:{fontSize:"14px",fill:p.m.value},tooltipFlyout:{fill:p.l.value},previousMonth:{data:{fill:p.K.value,stroke:p.J.value}},currentMonth:{data:{fill:p.B.value,stroke:p.C.value}}},U=l.a.create({reportSummaryTrend:{":not(foo) svg":{overflow:"visible"},":not(foo) text":{fontSize:"12px",length:"12px"}}});class Y extends m.a.Component{constructor(){super(...arguments),this.containerRef=m.a.createRef(),this.state={width:0},this.getTooltipLabel=(e=>{const{formatDatumValue:t,formatDatumOptions:a}=this.props;return Object(A.b)(e,t,a,"date")}),this.handleResize=(()=>{this.setState({width:this.containerRef.current.clientWidth})})}shouldComponentUpdate(e){return!(!e.current||!e.previous)}componentDidMount(){setTimeout(()=>{this.setState({width:this.containerRef.current.clientWidth}),window.addEventListener("resize",this.handleResize)})}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}render(){const{title:e,current:t,previous:a,height:n,type:r}=this.props,o=Object(A.c)(t,r),i=Object(A.c)(a,r);return m.a.createElement("div",{className:Object(l.b)(U.reportSummaryTrend),ref:this.containerRef},m.a.createElement(Q.a,{padding:J.padding,style:J.group,height:n,width:this.state.width,domainPadding:{y:[0,8]},containerComponent:m.a.createElement(H.a,{voronoiDimension:"x",title:e,responsive:!1,labels:this.getTooltipLabel,labelComponent:m.a.createElement(P.a,{cornerRadius:0,style:J.tooltipText,flyoutStyle:J.tooltipFlyout})})},Boolean(i.length)&&m.a.createElement(G.a,{style:J.previousMonth,data:i}),Boolean(o.length)&&m.a.createElement(G.a,{style:J.currentMonth,data:o})),m.a.createElement(V.c,null,e),m.a.createElement(V.a,null,m.a.createElement(V.b,{isCurrent:!0,data:o}),m.a.createElement(V.b,{data:i})))}}const q=e=>m.a.createElement("div",{style:{marginBottom:16}},m.a.createElement(Y,Object.assign({height:75},e))),X=({data:e})=>{const t="function"==typeof e.content?e.content(e):e.content;return m.a.createElement("div",{role:"tabpanel"},t)},Z=l.a.create({tabItem:{position:"relative",flexGrow:1,textAlign:"center",fontSize:p.r.value,padding:p.G.value,cursor:"pointer",marginBottom:p.F.value,marginTop:p.F.value},selected:{backgroundImage:`linear-gradient(to top, ${p.C.value} 2px, transparent 2px)`}});class ee extends m.a.Component{constructor(){super(...arguments),this.handleClick=(()=>{const{onSelect:e,data:t}=this.props;e(t.id)})}render(){const{data:e,isSelected:t}=this.props;return m.a.createElement("div",{role:"tab",onClick:this.handleClick,"aria-selected":t,tabIndex:t?0:-1,className:Object(l.b)(Z.tabItem,t&&Z.selected)},e.label)}}const te=l.a.create({tabNavigation:{display:"flex",alignItems:"flex-end",marginBottom:p.F.value}});class ae extends m.a.Component{constructor(){super(...arguments),this.handleKeyDown=(e=>{if(!["ArrowRight","ArrowLeft"].includes(e.key))return;const{selected:t,tabs:a,onChange:n}=this.props,r="ArrowRight"===e.key?1:-1,o=a.findIndex(e=>e.id===t.id)+r;o<0||o>a.length-1||n(a[o].id)})}render(){const{tabs:e,selected:t,onChange:a}=this.props;return m.a.createElement("div",{role:"tablist",className:Object(l.b)(te.tabNavigation),onKeyDown:this.handleKeyDown},e.map(e=>m.a.createElement(ee,{onSelect:a,key:e.id,data:e,isSelected:e.id===t.id})))}}const ne=({selected:e,tabs:t,onChange:a})=>{const n=t.find(t=>t.id===e);return m.a.createElement("div",null,m.a.createElement(ae,{tabs:t,selected:n,onChange:a}),m.a.createElement(X,{data:n}))};var re=a(258),oe=a.n(re),ie=a(256),le=a.n(ie),se=a(415),ce=a.n(se),ue=a(255),de=a.n(ue),me=a(9),pe=a(168);const be=e=>{switch(e){case"services":return"service";case"accounts":return"account";case"regions":return"region";case"instance_type":return"instance_type"}};const he=Object(f.a)((e,{widgetId:t})=>{const a=y.c.selectWidget(e,t),n=y.c.selectWidgetQueries(e,t);return Object.assign({},a,{currentQuery:n.current,previousQuery:n.previous,tabsQuery:n.tabs,current:me.c.selectReport(e,a.reportType,n.current),previous:me.c.selectReport(e,a.reportType,n.previous),tabs:me.c.selectReport(e,a.reportType,n.tabs),status:me.c.selectReportFetchStatus(e,a.reportType,n.current)})}),ge={fetchReports:y.a.fetchWidgetReports,updateTab:y.a.changeWidgetTab},ve=Object(g.c)()(Object(v.b)(he,ge)(class extends m.a.Component{constructor(){super(...arguments),this.getTabTitle=(e=>{const{t:t}=this.props;return t("group_by.top",{groupBy:be(e)||""})}),this.getDetailsLinkTitle=(e=>{const{t:t}=this.props;return t("group_by.all",{groupBy:be(e)||""})}),this.buildDetailsLink=(()=>{const{currentQuery:e}=this.props,t=Object(T.b)(e).group_by;return`/cost?${Object(T.a)({group_by:t,order_by:{total:"desc"}})}`}),this.renderTab=(e=>{const{tabs:t,topItems:a}=this.props,n=e.id;return m.a.createElement(W,{idKey:be(n),report:t},({items:e})=>e.map(e=>m.a.createElement(F,{key:e.id,formatOptions:a.formatOptions,formatValue:pe.b,label:e.label,totalValue:t.total.value,units:e.units,value:e.total})))}),this.handleTabChange=(e=>{this.props.updateTab(this.props.id,e)})}componentDidMount(){const{fetchReports:e,widgetId:t}=this.props;e(t)}render(){const{t:e,titleKey:t,trend:a,details:n,current:r,previous:o,availableTabs:i,currentTab:l,reportType:s,status:c}=this.props,u=new Date,d=ce()(u),p=oe()(u,"Do"),b=oe()(de()(u),"Do"),h=e(t,{endDate:p,month:d,startDate:b}),g=e("dashboard_page.widget_subtitle",{endDate:p,month:d,startDate:b,count:le()(u)}),v=e(n.labelKey,{context:n.labelKeyContext}),f="cost"===s&&m.a.createElement(_,{to:this.buildDetailsLink()},this.getDetailsLinkTitle(l)),y=e(a.titleKey);return m.a.createElement(B,{title:h,subTitle:g,detailsLink:f,status:c},m.a.createElement(M,{report:r,formatValue:pe.b,label:v,formatOptions:n.formatOptions}),m.a.createElement(q,{type:a.type,title:y,current:r,previous:o,formatDatumValue:pe.b,formatDatumOptions:a.formatOptions}),m.a.createElement(ne,{tabs:i.map(e=>({id:e,label:this.getTabTitle(e),content:this.renderTab})),selected:l,onChange:this.handleTabChange}))}})),fe=Object(f.a)(e=>({providers:E.c.selectProviders(e),providersFetchStatus:E.c.selectProvidersFetchStatus(e),widgets:y.c.selectCurrentWidgets(e)})),ye=Object(g.c)()(Object(v.b)(fe,{openProvidersModal:k.a.openProvidersModal})(({t:e,openProvidersModal:t,providers:a,providersFetchStatus:s,widgets:c})=>m.a.createElement("div",{className:x},m.a.createElement("header",{className:Object(l.b)(w.banner)},m.a.createElement(i.b,{size:i.a.lg},e("dashboard_page.title")),m.a.createElement(n.c,Object.assign({},Object(O.a)(O.b.providers.add_btn),{onClick:t,type:n.a.submit,variant:n.b.secondary}),e("providers.add_account"))),m.a.createElement("div",{className:Object(l.b)(w.content)},Boolean(a&&a.count>0&&2===s)?m.a.createElement(o.a,{gutter:"md"},c.map(e=>m.a.createElement(r.a,{xl:4,lg:6,key:e},m.a.createElement(ve,{widgetId:e})))):m.a.createElement(o.a,{className:Object(l.b)(C),gutter:"md"},m.a.createElement(r.a,null,m.a.createElement(h,{title:e("dashboard_page.empty_state_title")},"View the",m.a.createElement("a",{target:"_blank",href:"https://koku.readthedocs.io/en/latest/providers.html#adding-an-aws-account"}," ","Koku documentation"," "),"and learn how to configure your AWS account to allow Koku access. Then, click",m.a.createElement("a",{href:"javascript:void(0)",onClick:t}," ","Add Account")," ","to configure.")))))));t.a=ye},596:function(e,t,a){"use strict";a.r(t),function(e){var n=a(40),r=a(343);t.default=Object(n.hot)(e)(r.a)}.call(this,a(38)(e))}}]);
//# sourceMappingURL=2d14e53a0869675598dd.bundle.js.map