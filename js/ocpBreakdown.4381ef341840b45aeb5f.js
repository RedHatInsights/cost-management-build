"use strict";(self.webpackChunkcostManagement=self.webpackChunkcostManagement||[]).push([[8141],{68919:(t,e,r)=>{r.r(e),r.d(e,{default:()=>lt});var o=r(1326),s=r(84717),i=r(39333),a=r(6456),n=r(50081),c=r(97027),l=r(92950),p=r.n(l),m=r(74806),u=r(36613),g=r(91919),d=r(7110),b=r(45402),f=r(1032),y=r(1156),h=r(22369),R=r(62331),E=r(15920),S=r(20997),v=r(15829),F=r(68025),P=r(14483),C=r(5842),D=r(69735),j=r(73903);const O=(0,y.X1)(((t,{title:e})=>({selectWidgets:j.cm.selectWidgets(t),widgets:j.cm.selectCurrentWidgets(t),title:e}))),Z=(0,u.connect)(O,{})(D.X);var _=r(16577),T=r(70982);const w=(0,y.X1)(((t,e)=>({selectWidgets:T.P2.selectWidgets(t),widgets:T.P2.selectCurrentWidgets(t)}))),z=(0,u.connect)(w,{})(_.f);var B=r(90154),M=r(52016),L=r(89256),V=r(2136);const x=L.v.recommendations,W=L.N.ros;class I extends p().Component{constructor(){super(...arguments),this.defaultState={},this.state=Object.assign({},this.defaultState),this.updateReport=()=>{const{fetchReport:t,reportQueryString:e}=this.props;t(x,W,e)}}componentDidMount(){this.updateReport()}render(){const{intl:t,report:e}=this.props,r=e&&e.meta?e.meta.count:0;return p().createElement(B.Badge,{screenReaderText:t.formatMessage(c.Z.optimizationsDetails,{count:r})},r)}}const X=(0,y.X1)(((t,{router:e})=>{const r=(0,M.mB)(e.location.search),o=(0,b.VL)(r),s=(0,b.pe)(r),a=Object.assign({},o&&{[o]:s}),n=(0,i.pm)(a);return{report:V.R0.selectRos(t,x,W,n),reportError:V.R0.selectRosError(t,x,W,n),reportFetchStatus:V.R0.selectRosFetchStatus(t,x,W,n),reportQueryString:n}})),Q={fetchReport:V.Ze.fetchRosReport},k=(0,m.ZP)((0,C.E)((0,u.connect)(X,Q)(I)));var H=r(86896),q=r(39836),A=r(41882),J=r(38274),G=r(479),N=r(46955),K=r(54467),U=r(25391),Y=r(32924);const $={limit:10,offset:0,order_by:{last_reported:"desc"}},tt=L.N.ros,et=L.v.recommendations,rt=()=>{const[t,e]=(0,l.useState)(Object.assign({},$)),r=(0,H.Z)(),{closeOptimizationsDrawer:o,report:s,reportError:i,reportFetchStatus:a,reportQueryString:n}=ot({query:t}),m=(t=!1,e=!1)=>{const o=s&&s.meta?s.meta.count:0,i=s&&s.meta?s.meta.limit:$.limit,a=s&&s.meta?s.meta.offset:$.offset,n=Math.trunc(a/i+1);return p().createElement(B.Pagination,{isCompact:!e,isDisabled:t,itemCount:o,onPerPageSelect:(t,e)=>u(e),onSetPage:(t,e)=>g(e),page:n,perPage:i,titles:{paginationTitle:r.formatMessage(c.Z.paginationTitle,{title:r.formatMessage(c.Z.openShift),placement:e?"bottom":"top"})},variant:e?B.PaginationVariant.bottom:B.PaginationVariant.top,widgetId:"exports-pagination"+(e?"-bottom":"")})},u=r=>{const s=Y.Lk(t,r,!0);e(s),o()},g=r=>{const i=Y.F4(t,s,r,!0);e(i),o()},d=0===(s&&s.meta?s.meta.count:0),b=r.formatMessage(c.Z.optimizations),f=s&&s.meta&&s.meta.count>0;return i?p().createElement(N.W,{title:b}):t.filter_by||f||a!==y.iF.complete?p().createElement(p().Fragment,null,(()=>{const r=s&&s.meta?s.meta.limit:0,i=s&&s.meta?s.meta.count:0,a=0===i;return p().createElement(A.IH,{isDisabled:a,itemsPerPage:r,itemsTotal:i,onFilterAdded:r=>(r=>{const s=Y.JA(t,r);e(s),o()})(r),onFilterRemoved:r=>(r=>{const s=Y.vI(t,r);e(s),o()})(r),pagination:m(a),query:t})})(),a===y.iF.inProgress?p().createElement(J.g,{body:r.formatMessage(c.Z.optimizationsLoadingStateDesc),heading:r.formatMessage(c.Z.optimizationsLoadingStateTitle)}):p().createElement(p().Fragment,null,p().createElement(A.Hy,{filterBy:t.filter_by,isLoading:a===y.iF.inProgress,onSort:(r,s)=>((r,s)=>{const i=Y.K8(t,r,s);e(i),o()})(r,s),orderBy:t.order_by,report:s,reportQueryString:n}),p().createElement("div",{style:K.W.pagination},m(d,!0)))):p().createElement(G.Y,null)},ot=({query:t})=>{const e=(0,u.useDispatch)(),r=(()=>{const t=(0,q.useLocation)();return(0,i.mB)(t.search)})(),o=(0,b.VL)(r),s=(0,b.pe)(r),a=(0,U.H)(t)||(0,U.H)($),n=(0,U.j)(t)||(0,U.j)($),c=Object.assign(Object.assign(Object.assign({},o&&{[o]:s}),t.filter_by),{limit:t.limit,offset:t.offset,order_by:a,order_how:n}),p=(0,i.pm)(c),m=(0,u.useSelector)((t=>V.R0.selectRos(t,et,tt,p))),g=(0,u.useSelector)((t=>V.R0.selectRosFetchStatus(t,et,tt,p))),d=(0,u.useSelector)((t=>V.R0.selectRosError(t,et,tt,p)));return(0,l.useEffect)((()=>{d||g===y.iF.inProgress||e(V.Ze.fetchRosReport(et,tt,p))}),[t]),{closeOptimizationsDrawer:S.Aw.Zv,report:m,reportError:d,reportFetchStatus:g,reportQueryString:p}},st=(0,F.dI)(g._.ocpDetails.path),it=a.C.cost,at=a.K.ocp,nt=(0,y.X1)(((t,{intl:e,router:r})=>{const a=(0,i.mB)(r.location.search),l=(0,i.fU)(a),m=(0,b.VL)(a),u=(0,b.pe)(a),g=h.iJ.selectIsCostDistributionFeatureEnabled(t),d="project"===m&&g?(0,v.vn)():void 0,y=(0,v.zC)(),S=Object.assign({},a),F={currency:y,filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},l&&l.filter_by&&l.filter_by),a&&a.isPlatformCosts&&{category:P.rx}),m&&"*"!==u&&{[m]:void 0}),exclude:Object.assign({},l&&l.exclude&&l.exclude),group_by:Object.assign({},m&&{[m]:u})},C=(0,i.pm)(F),D=E.ZV.selectReport(t,at,it,C),j=E.ZV.selectReportError(t,at,it,C),O=E.ZV.selectReportFetchStatus(t,at,it,C),_=(0,s.H)(R.NT),T=R.aX.selectProviders(t,o.l.all,_),w=R.aX.selectProvidersFetchStatus(t,o.l.all,_),B=a[P.yG]?a[P.yG]:u;return{costDistribution:d,costOverviewComponent:p().createElement(Z,{costDistribution:d,currency:y,groupBy:m,isCostDistributionFeatureEnabled:h.iJ.selectIsCostDistributionFeatureEnabled(t),isPlatformCosts:a&&a.isPlatformCosts,report:D,title:B}),currency:y,description:a[P.eG],detailsURL:st,emptyStateTitle:e.formatMessage(c.Z.ocpDetailsTitle),groupBy:m,groupByValue:u,historicalDataComponent:p().createElement(z,{costDistribution:d,currency:y}),isOptimizationsTab:void 0!==a.optimizationsTab,isRosFeatureEnabled:h.iJ.selectIsRosFeatureEnabled(t),optimizationsBadgeComponent:p().createElement(k,null),optimizationsComponent:"project"===m&&"*"!==u?p().createElement(rt,null):void 0,providers:(0,f.BV)(T,o.l.ocp),providersFetchStatus:w,providerType:o.l.ocp,query:S,report:D,reportError:j,reportFetchStatus:O,reportType:it,reportPathsType:at,reportQueryString:C,showCostDistribution:"project"===m,tagPathsType:n.L.ocp,title:B}})),ct={closeOptimizationsDrawer:S.Aw.Zv,fetchReport:E.nx.fetchReport},lt=(0,m.ZP)((0,C.E)((0,u.connect)(nt,ct)(d.C)))}}]);
//# sourceMappingURL=../sourcemaps/ocpBreakdown.d91cad53ef734f779bea2ef5a5052f97.js.map