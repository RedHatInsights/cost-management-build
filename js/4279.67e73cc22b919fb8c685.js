"use strict";(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[4279],{55672:(e,t,a)=>{a.d(t,{J:()=>r.Z});var r=a(83819)},47947:(e,t,a)=>{a.d(t,{W:()=>c});var r=a(90154),s=a(89376),n=a(39173),i=a(15984),o=a(92950),l=a.n(o);const c=({title:e})=>l().createElement(l().Fragment,null,e&&l().createElement(s.Z,null,l().createElement(n.Z,{title:e})),l().createElement(r.PageSection,null,l().createElement(i.Z,null)))},55246:(e,t,a)=>{a.d(t,{C:()=>ce});var r=a(90154),s=a(97027),n=a(92950),i=a.n(n),o=a(74806),l=a(52471),c=a(55672),u=a(2985),p=a(47947),h=a(19727),m=a(86482),g=a(1156),d=a(5842),y=a(98499);const f={content:{paddingBottom:y.ZP.value,paddingLeft:y.ZP.value,paddingRight:y.ZP.value,paddingTop:y.ZP.value}};var v=a(71973),b=a(39333),C=a(77760),T=a(39836),S=a(91919),E=a(6450),O=a(11058),Z=a(55785),D=a(50081),L=a(37269),R=a(48949),P=a(14483),k=a(23992),x=a(11331),j=a(48196);const M={dataListHeading:{fontWeight:k.ZP.value},groupByHeading:{marginBottom:y.ZP.value},tagLink:{marginLeft:j.ZP.value},tagsContainer:{marginRight:x.ZP.value,marginTop:j.ZP.value}};var w=a(54583);class _ extends i().Component{constructor(){super(...arguments),this.getDataListItems=()=>{const{tagReport:e}=this.props,t=[];if(e)for(const a of e.data)for(const e of a.values){const s=`${a.key}:${e}`;t.push(i().createElement(r.DataListItem,{"aria-labelledby":s,key:`${s}-item`},i().createElement(r.DataListItemRow,null,i().createElement(r.DataListItemCells,{dataListCells:[i().createElement(r.DataListCell,{key:`${s}-cell1`},i().createElement("span",{id:s},a.key)),i().createElement(r.DataListCell,{key:`${s}-cell2`},e)]}))))}return t}}render(){const{groupBy:e,groupByValue:t,intl:a}=this.props,n=this.getDataListItems();return i().createElement(i().Fragment,null,i().createElement("div",null,i().createElement("span",{style:M.dataListHeading},a.formatMessage(s.Z.groupByValues,{value:e,count:1}))),i().createElement("div",{style:M.groupByHeading},i().createElement("span",null,t)),i().createElement(r.DataList,{"aria-label":a.formatMessage(s.Z.tagNames),isCompact:!0},i().createElement(r.DataListItem,{"aria-labelledby":"heading1"},i().createElement(r.DataListItemRow,null,i().createElement(r.DataListItemCells,{dataListCells:[i().createElement(r.DataListCell,{key:"primary content"},i().createElement("span",{id:"heading1",style:M.dataListHeading},a.formatMessage(s.Z.tagHeadingKey))),i().createElement(r.DataListCell,{key:"secondary content"},i().createElement("span",{id:"heading2",style:M.dataListHeading},a.formatMessage(s.Z.tagHeadingValue)))]}))),n.map((e=>e))))}}const B=(0,o.ZP)((0,C.connect)()(_)),V=D.Q.tag;class N extends i().Component{constructor(e){super(e),this.getTagValueCount=()=>{const{tagReport:e}=this.props;let t=0;if(e)for(const a of e.data)a.values&&(t+=a.values.length);return t},this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}componentDidMount(){const{fetchTag:e,tagReportPathsType:t,tagQueryString:a}=this.props;e(t,V,a)}componentDidUpdate(e){const{fetchTag:t,tagReportPathsType:a,tagQueryString:r}=this.props;e.tagQueryString!==r&&t(a,V,r)}shouldComponentUpdate(e){const{groupByValue:t,isOpen:a}=this.props;return e.groupByValue!==t||e.isOpen!==a}render(){const{groupBy:e,intl:t,isOpen:a,query:n,tagReport:o}=this.props,l=n&&n.filter&&n.filter.account?n.filter.account:this.props.groupByValue;return i().createElement(r.Modal,{isOpen:a,onClose:this.handleClose,title:t.formatMessage(s.Z.tagHeadingTitle,{value:this.getTagValueCount()}),width:"50%"},i().createElement(B,{groupBy:e,groupByValue:this.props.isPlatformCosts?P.rx:l,tagReport:o}))}}const U=(0,g.X1)(((e,{router:t,tagReportPathsType:a})=>{const r=(0,b.mB)(t.location.search),s=(0,L.OA)(r),n=s?P.dV:(0,L.VL)(r),i=s||(0,L.pe)(r),o=r&&r.filter_by?r.filter_by:{};for(const e of Object.keys(o))-1!==e.indexOf(P.P)&&(o[e]=void 0);const l={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},o),r&&r.filter&&r.filter.account&&{[`${P.Sq}account`]:r.filter.account}),r&&r.filter&&r.filter.category&&{category:r.filter.category})},c=(0,b.pm)(Object.assign(Object.assign({},l),{filter_by:Object.assign(Object.assign({},l.filter_by),n&&"*"!==i&&-1===n.indexOf(P.P)&&{[n]:i})})),u=R.ux.selectTag(e,a,V,c),p=R.ux.selectTagFetchStatus(e,a,V,c);return{groupBy:n,groupByValue:i,isPlatformCosts:(0,w.yW)(r),query:l,tagReport:u,tagReportFetchStatus:p,tagQueryString:c}})),F={fetchTag:R.xr.Xt},z=(0,o.ZP)((0,d.E)((0,C.connect)(U,F)(N))),Q=D.Q.tag;class I extends i().Component{constructor(e){super(e),this.defaultState={isOpen:!1},this.state=Object.assign({},this.defaultState),this.handleClose=e=>{this.setState({isOpen:e})},this.handleOpen=e=>(this.setState({isOpen:!0}),e.preventDefault(),!1),this.handleClose=this.handleClose.bind(this),this.handleOpen=this.handleOpen.bind(this)}componentDidMount(){const{fetchTag:e,tagReportPathsType:t,tagQueryString:a}=this.props;e(t,Q,a)}componentDidUpdate(e){const{fetchTag:t,tagReportPathsType:a,tagQueryString:r}=this.props;e.tagQueryString!==r&&t(a,Q,r)}render(){const{id:e,tagReport:t,tagReportPathsType:a}=this.props,{isOpen:r}=this.state;let s=0;if(t)for(const e of t.data)e.values&&(s+=e.values.length);return i().createElement("div",{style:M.tagsContainer,id:e},Boolean(s>0)&&i().createElement(i().Fragment,null,i().createElement(Z.lO,null),i().createElement("a",{"data-testid":"tag-lnk",href:"#/",onClick:this.handleOpen,style:M.tagLink},s)),i().createElement(z,{isOpen:r,onClose:this.handleClose,tagReportPathsType:a}))}}const A=(0,g.X1)(((e,{router:t,tagReportPathsType:a})=>{const r=(0,b.mB)(t.location.search),s=(0,L.OA)(r),n=s?P.dV:(0,L.VL)(r),i=s||(0,L.pe)(r),o=r&&r.filter_by?r.filter_by:{};for(const e of Object.keys(o))-1!==e.indexOf(P.P)&&(o[e]=void 0);const l={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},o),r&&r.filter&&r.filter.account&&{[`${P.Sq}account`]:r.filter.account}),r&&r.filter&&r.filter.category&&{category:r.filter.category})},c=(0,b.pm)(Object.assign(Object.assign({},l),{filter_by:Object.assign(Object.assign({},l.filter_by),n&&"*"!==i&&-1===n.indexOf(P.P)&&{[n]:i})}));return{groupBy:n,groupByValue:i,query:l,tagReport:R.ux.selectTag(e,a,Q,c),tagReportFetchStatus:R.ux.selectTagFetchStatus(e,a,Q,c),tagQueryString:c}})),q={fetchTag:R.xr.Xt},W=(0,o.ZP)((0,d.E)((0,C.connect)(A,q)(I)));var G=a(45087),H=a(91778),$=a(68025),J=a(72892),X=a(12289),K=a(40794),Y=a(32412),ee=a(57640),te=a(43789);const ae={cost:{marginTop:ee.ZP.var},costLabel:{marginTop:te.ZP.var},costValue:{marginTop:0,marginBottom:0,textAlign:"right"},costLabelDate:{textAlign:"right"},costType:{marginTop:Y.ZP.var},header:{backgroundColor:J.ZP.var,paddingLeft:y.ZP.var,paddingRight:y.ZP.var,paddingTop:y.ZP.var},headerContent:{display:"flex",justifyContent:"space-between"},headerContentRight:{display:"flex"},infoDescription:{color:X.ZP.value,fontSize:K.ZP.value},tabs:{display:"flex"},tag:{marginLeft:y.ZP.var},title:{paddingBottom:y.ZP.var,paddingTop:te.ZP.var}};class re extends i().Component{constructor(){super(...arguments),this.buildDetailsLink=e=>{const{groupBy:t,isOptimizationsPath:a,query:r}=this.props;let s=t,n="*";r[P.dV]&&(s=P.dV,n=r[P.dV]);const i=Object.assign(Object.assign({},JSON.parse(JSON.stringify(r))),{group_by:{[s]:n}});return i.filter&&(i.filter.account=void 0,i.filter.category=void 0,i[P.eG]=void 0,i[P.yG]=void 0,i[P.dV]=void 0),a&&(i[P.yG]=void 0,i.group_by=void 0,i.recommendations=void 0),`${e}?${(0,b.IV)(i)}`},this.getBackToLink=e=>{const{detailsURL:t,intl:a,isOptimizationsPath:r,tagReportPathsType:n}=this.props;return r?i().createElement(T.Link,{to:this.buildDetailsLink((0,$.dI)(S._.optimizations.path))},a.formatMessage(s.Z.breakdownBackToOptimizations)):i().createElement(T.Link,{to:this.buildDetailsLink(t)},a.formatMessage(s.Z.breakdownBackToDetails,{value:a.formatMessage(s.Z.breakdownBackToTitles,{value:n}),groupBy:e}))},this.getTotalCost=()=>{const{report:e}=this.props,t=e&&e.meta&&e.meta.total&&e.meta.total.cost&&e.meta.total.cost.total;return(0,H.xG)(t?e.meta.total.cost.total.value:0,t?e.meta.total.cost.total.units:"USD")}}render(){const{costType:e,currency:t,description:a,groupBy:n,intl:o,onCostTypeSelected:l,onCurrencySelected:c,query:u,showCostType:p=!1,tabs:h,tagReportPathsType:m,title:g}=this.props,d=u&&u.filter?u.filter.account:void 0,y=(0,L.OA)(u),f=(0,L.qV)(u),b=d||"account"===n||"gcp_project"===n||"payer_tenant_id"===n||"project"===n||"subscription_guid"===n,C=d?"account":f?"tag":y?P.dV:n;return i().createElement("header",{style:ae.header},i().createElement("div",{style:ae.headerContent},i().createElement("nav",{"aria-label":o.formatMessage(s.Z.breakdownBackToDetailsAriaLabel),className:"breadcrumbOverride"},i().createElement("ol",{className:"pf-c-breadcrumb__list"},i().createElement("li",{className:"pf-c-breadcrumb__item"},i().createElement("span",{className:"pf-c-breadcrumb__item-divider"},i().createElement(v.fP,null)),this.getBackToLink(C)))),i().createElement("div",{style:ae.headerContentRight},i().createElement(E.F,{currency:t,onSelect:c}))),i().createElement("div",{style:ae.headerContent},i().createElement("div",{style:ae.title},i().createElement(r.Title,{headingLevel:"h1",size:r.TitleSizes["2xl"]},o.formatMessage(s.Z.breakdownTitle,{value:g}),a&&i().createElement("div",{style:ae.infoDescription},a)),p&&i().createElement("div",{style:ae.costType},i().createElement(O.T,{onSelect:l,costType:e}))),i().createElement("div",{style:ae.cost},i().createElement("div",{style:ae.costLabel},i().createElement(r.Title,{headingLevel:"h2",style:ae.costValue,size:r.TitleSizes["4xl"]},i().createElement("span",null,this.getTotalCost()))),i().createElement("div",{style:ae.costLabelDate},(0,G.Y$)(o.formatMessage(s.Z.groupByValuesTitleCase,{value:C,count:2}))))),i().createElement("div",null,i().createElement("div",{style:ae.tabs},h,i().createElement("div",{style:ae.tag},Boolean(b)&&i().createElement(W,{id:"tags",tagReportPathsType:m})))))}}const se=(0,g.X1)(((e,{router:t})=>({isOptimizationsPath:void 0!==(0,b.mB)(t.location.search).optimizationsPath}))),ne=(0,o.ZP)((0,d.E)((0,C.connect)(se,{})(re)));var ie;!function(e){e.costOverview="cost-overview",e.historicalData="historical-data",e.optimizations="optimizations"}(ie||(ie={}));const oe=e=>{switch(e){case ie.costOverview:return"cost-overview";case ie.historicalData:return"historical-data";case ie.optimizations:return"optimizations"}};class le extends i().Component{constructor(){super(...arguments),this.defaultState={activeTabKey:this.props.isOptimizationsTab?2:0},this.state=Object.assign({},this.defaultState),this.getAvailableTabs=()=>{const{costOverviewComponent:e,historicalDataComponent:t,isRosFeatureEnabled:a,optimizationsBadgeComponent:r,optimizationsComponent:s}=this.props,n=[];return e&&n.push({contentRef:i().createRef(),tab:ie.costOverview}),t&&n.push({contentRef:i().createRef(),tab:ie.historicalData}),s&&a&&n.push({badge:r,contentRef:i().createRef(),tab:ie.optimizations}),n},this.getTab=(e,t,a,s)=>i().createElement(r.Tab,{eventKey:s,key:`${oe(e)}-tab`,tabContentId:`tab-${s}`,tabContentRef:t,title:i().createElement(i().Fragment,null,i().createElement(r.TabTitleText,null,this.getTabTitle(e)),a&&i().createElement("span",null,a))}),this.getTabContent=e=>e.map(((e,t)=>i().createElement(r.TabContent,{eventKey:t,key:`${oe(e.tab)}-tabContent`,id:`tab-${t}`,ref:e.contentRef},this.getTabItem(e.tab,t)))),this.getTabItem=(e,t)=>{const{costOverviewComponent:a,historicalDataComponent:r,optimizationsComponent:s}=this.props,{activeTabKey:n}=this.state,o=i().createElement(i().Fragment,null);if(n!==t)return o;const l=oe(e);return l===ie.costOverview?a:l===ie.historicalData?r:l===ie.optimizations?s:o},this.getTabs=e=>{const{activeTabKey:t}=this.state;return i().createElement(r.Tabs,{activeKey:t,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e.tab,e.contentRef,e.badge,t))))},this.getTabTitle=e=>{const{intl:t}=this.props;return e===ie.costOverview?t.formatMessage(s.Z.breakdownCostOverviewTitle):e===ie.historicalData?t.formatMessage(s.Z.breakdownHistoricalDataTitle):e===ie.optimizations?t.formatMessage(s.Z.optimizations):void 0},this.handleTabClick=(e,t)=>{const{closeOptimizationsDrawer:a}=this.props,{activeTabKey:r}=this.state;r!==t&&this.setState({activeTabKey:t},(()=>{a&&a()}))},this.updateReport=()=>{const{fetchReport:e,reportPathsType:t,reportType:a,reportQueryString:r}=this.props;e(t,a,r)}}componentDidMount(){this.updateReport()}componentDidUpdate(e){const{report:t,reportError:a,reportQueryString:r,router:s}=this.props,n=e.reportQueryString!==r,i=!t&&!a,o=!s.location.search;(n||i||o)&&this.updateReport()}render(){const{costType:e,currency:t,description:a,detailsURL:r,emptyStateTitle:s,groupBy:n,providers:o,providersFetchStatus:d,providerType:y,query:v,report:b,reportError:C,reportFetchStatus:T,router:S,showCostType:E,tagReportPathsType:O,title:Z}=this.props,D=this.getAvailableTabs();if(C)return i().createElement(p.W,{title:s});if(d===g.iF.inProgress&&T===g.iF.inProgress)return i().createElement(l.g,{title:s});if(d===g.iF.complete&&T===g.iF.complete){if(o&&o.meta&&0===o.meta.count&&d===g.iF.complete)return i().createElement(u.L,{providerType:y,title:s});if(!(0,m.g8)(o))return i().createElement(c.J,{title:Z})}return i().createElement(i().Fragment,null,i().createElement(ne,{costType:e,currency:t,description:a,detailsURL:r,groupBy:n,onCostTypeSelected:e=>(0,h.jl)(v,S,e),onCurrencySelected:e=>(0,h._s)(v,S,e),query:v,report:b,showCostType:E,tabs:this.getTabs(D),tagReportPathsType:O,title:Z}),i().createElement("div",{style:f.content},this.getTabContent(D)))}}const ce=(0,o.ZP)((0,d.E)(le))},67709:(e,t,a)=>{a.d(t,{X:()=>me});var r=a(90154),s=a(91290),n=a(97027),i=a(92950),o=a.n(i),l=a(74806),c=a(69511),u=a(11331),p=a(48196);const h={clustersContainer:{marginRight:u.ZP.value,marginTop:p.ZP.value}};class m extends o().Component{render(){const{clusters:e=[]}=this.props;return 0===e.length?null:e.map(((e,t)=>o().createElement("div",{key:`cluster-${t}`},e)))}}const g=(0,l.ZP)(m),d={modal:{height:"700px",width:"600px"},subTitle:{marginTop:a(91707).ZP.value,textAlign:"right"}};class y extends o().Component{constructor(e){super(e),this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}shouldComponentUpdate(e){const{clusters:t,isOpen:a}=this.props;return e.clusters!==t||e.isOpen!==a}render(){const{clusters:e,groupBy:t,intl:a,isOpen:s,title:i}=this.props;return o().createElement(r.Modal,{className:"modalOverride",style:d.modal,isOpen:s,onClose:this.handleClose,title:a.formatMessage(n.Z.detailsClustersModalTitle,{groupBy:t,name:i}),width:"50%"},o().createElement(g,{clusters:e}))}}const f=(0,l.ZP)(y);class v extends o().Component{constructor(e){super(e),this.defaultState={isOpen:!1,showAll:!1},this.state=Object.assign({},this.defaultState),this.handleClose=e=>{this.setState({isOpen:e})},this.handleOpen=e=>(this.setState({isOpen:!0}),e.preventDefault(),!1),this.handleClose=this.handleClose.bind(this),this.handleOpen=this.handleOpen.bind(this)}render(){const{groupBy:e,intl:t,report:a,title:s}=this.props,{isOpen:i,showAll:l}=this.state,u=[],p=[],m=(0,c.R)({report:a,idKey:e}),g=[];if(m.map((e=>{e.clusters&&e.clusters.map((e=>{g.includes(e)||g.push(e)}))})),0===g.length)return null;g.sort(((e,t)=>e<t?-1:e>t?1:0));for(const e of g){let t=u.length>0?`, ${e}`:e;l?u.push(t):u.length<2&&(t.length>45?(t=t.slice(0,45).trim().concat("..."),u.push(o().createElement(r.Tooltip,{content:e,enableFlip:!0},o().createElement("span",null,t)))):u.push(t)),p.push(e)}return o().createElement("div",{style:h.clustersContainer},Boolean(u)&&u.map(((e,t)=>o().createElement("span",{key:t},e))),Boolean(u.length<p.length)&&o().createElement("a",{"data-testid":"cluster-lnk",href:"#/",onClick:this.handleOpen},t.formatMessage(n.Z.detailsMoreClusters,{value:p.length-u.length})),o().createElement(f,{clusters:g,groupBy:e,isOpen:i,onClose:this.handleClose,title:s}))}}const b=(0,l.ZP)(v);var C=a(10310),T=a(80469),S=a(34502),E=a(30950),O=a(1156),Z=a(91778),D=a(20513),L=a(23992),R=a(32412);const P={chartHeight:150,chartWidth:475,subTitle:{fontWeight:L.ZP.value}},k={chartSkeleton:{height:"125px",marginBottom:R.ZP.value,marginTop:u.ZP.value}};class x extends o().Component{constructor(){super(...arguments),this.getLegendLabel=()=>e=>{var{values:t}=e,a=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(a[r[s]]=e[r[s]])}return a}(e,["values"]);return o().createElement(C.Df,Object.assign({},a,{style:[{fontWeight:P.subTitle.fontWeight},{}],text:[t[a.index],a.text]}))},this.getSkeleton=()=>o().createElement(o().Fragment,null,o().createElement(r.Skeleton,{style:k.chartSkeleton,width:D.N.md}))}render(){const{name:e,report:t,reportFetchStatus:a,intl:r}=this.props,s=t&&t.meta&&t.meta.total&&t.meta.total.cost,i=s&&t.meta.total.cost.markup,l=s&&t.meta.total.cost.raw,c=s&&t.meta.total.cost.usage,u=i?t.meta.total.cost.markup.units:"USD",p=l?t.meta.total.cost.raw.units:"USD",h=c?t.meta.total.cost.usage.units:"USD",m=i?t.meta.total.cost.markup.value:0,g=l?t.meta.total.cost.raw.value:0,d=c?t.meta.total.cost.usage.value:0,y=(0,Z.xG)(i?t.meta.total.cost.markup.value:0,u),f=(0,Z.xG)(l?t.meta.total.cost.raw.value:0,p),v=(0,Z.xG)(c?t.meta.total.cost.usage.value:0,h),b=r.formatMessage(n.Z.markupTitle),C=r.formatMessage(n.Z.rawCostTitle),D=r.formatMessage(n.Z.usageCostTitle),L=this.getLegendLabel(),R=o().createElement(T.Qk,{gutter:80,itemsPerRow:2,labelComponent:o().createElement(L,{dy:10,lineHeight:1.5,values:[f,y,v]}),rowGutter:20});return o().createElement("div",{style:{height:P.chartHeight,width:P.chartWidth}},a===O.iF.inProgress?this.getSkeleton():o().createElement(S.Td,{ariaDesc:r.formatMessage(n.Z.breakdownCostChartAriaDesc),ariaTitle:r.formatMessage(n.Z.breakdownCostBreakdownTitle),constrainToVisibleArea:!0,data:[{x:C,y:g,units:p},{x:b,y:m,units:u},{x:D,y:d,units:h}],height:P.chartHeight,labels:({datum:e})=>r.formatMessage(n.Z.breakdownCostChartTooltip,{name:e.x,value:(0,Z.xG)(e.y,e.units)}),legendComponent:R,legendData:[{name:C},{name:b},{name:D}],legendOrientation:"vertical",legendPosition:"right",name:e,padding:{bottom:20,left:0,right:275,top:20},themeColor:E.nz.green,width:P.chartWidth}))}}const j=(0,l.ZP)(x);var M=a(39333),w=a(77760),_=a(38470),B=a(6456),V=a(37269),N=a(15920),U=a(14483),F=a(5842);const z={mainContent:{marginTop:a(57640).ZP.value},subTitle:{textAlign:"right"}},Q=B.C.cost;class I extends o().Component{constructor(e){super(e)}componentDidMount(){const{fetchReport:e,reportPathsType:t,reportQueryString:a}=this.props;e(t,Q,a)}componentDidUpdate(e){const{fetchReport:t,reportPathsType:a,reportQueryString:r}=this.props;e.reportQueryString!==r&&t(a,Q,r)}render(){const{intl:e,report:t,reportGroupBy:a,reportFetchStatus:s}=this.props,i=t&&t.meta&&t.meta.total,l=(0,Z.xG)(i?t.meta.total.cost.total.value:0,i?t.meta.total.cost.total.units:"USD");return o().createElement(o().Fragment,null,o().createElement("div",{style:z.subTitle},o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.xl},e.formatMessage(n.Z.detailsCostValue,{value:l}))),o().createElement("div",{style:z.mainContent},o().createElement(_.mZ,{idKey:a,report:t,status:s},(({items:e})=>e.map((e=>o().createElement(_.EH,{key:e.id,formatOptions:{},label:e.label?e.label.toString():"",totalValue:t.meta.total.cost.total.value,units:t.meta.total.cost.total.units,value:e.cost.total.value})))))))}}const A=(0,O.X1)(((e,{costType:t,currency:a,reportGroupBy:r,reportPathsType:s,router:n})=>{const i=(0,M.mB)(n.location.search),o=(0,V.OA)(i),l=o?U.dV:(0,V.VL)(i),c=o||(0,V.pe)(i),u={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign(Object.assign({},i&&i.filter_by&&i.filter_by),i&&i.filter&&i.filter.account&&{[`${U.Sq}account`]:i.filter.account}),i&&i.filter&&i.filter.category&&{category:i.filter.category}),l&&{[l]:c}),exclude:Object.assign({},i&&i.exclude&&i.exclude),group_by:Object.assign({},r&&{[r]:"*"})},p=(0,M.pm)(Object.assign(Object.assign({},u),{cost_type:t,currency:a,filter_by:Object.assign(Object.assign({},u.filter_by),l&&"*"!==c&&{[l]:void 0})}));return{report:N.ZV.selectReport(e,s,Q,p),reportFetchStatus:N.ZV.selectReportFetchStatus(e,s,Q,p),reportQueryString:p}})),q={fetchReport:N.nx.fetchReport},W=(0,l.ZP)((0,F.E)((0,w.connect)(A,q)(I)));class G extends o().Component{constructor(e){super(e),this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}shouldComponentUpdate(e){const{groupByValue:t,isOpen:a}=this.props;return e.groupByValue!==t||e.isOpen!==a}render(){const{costType:e,currency:t,groupByValue:a,intl:s,isOpen:i,reportGroupBy:l,reportPathsType:c}=this.props;return o().createElement(r.Modal,{className:"modalOverride",isOpen:i,onClose:this.handleClose,title:s.formatMessage(n.Z.detailsSummaryModalTitle,{groupBy:l,name:a}),variant:"large"},o().createElement(W,{costType:e,currency:t,reportGroupBy:l,reportPathsType:c}))}}const H=(0,l.ZP)(G),$={card:{},skeleton:{marginTop:R.ZP.value},viewAllContainer:{marginLeft:"-15px"}};class J extends o().Component{constructor(){super(...arguments),this.state={isBulletChartModalOpen:!1},this.getItems=()=>{const{report:e,reportGroupBy:t}=this.props;return(0,c.R)({report:e,idKey:t})},this.getSummary=()=>{const{report:e,reportGroupBy:t,reportFetchStatus:a}=this.props;return o().createElement(_.mZ,{idKey:t,report:e,status:a},(({items:t})=>t.map((t=>o().createElement(_.EH,{formatOptions:{},key:`${t.id}-item`,label:t.label?t.label.toString():void 0,totalValue:e.meta.total.cost.total.value,units:e.meta.total.cost.total.units,value:t.cost.total.value})))))},this.getViewAll=()=>{const{costType:e,currency:t,groupBy:a,intl:s,isPlatformCosts:i,query:l,reportGroupBy:c,reportPathsType:u}=this.props,{isBulletChartModalOpen:p}=this.state;if(-1!==this.getItems().findIndex((e=>{const t=e.id;if(t&&null!==t)return"Other"===t||"Others"===t}))){const h=l&&l.filter&&l.filter.account?l.filter.account:this.props.groupByValue;return o().createElement("div",{style:$.viewAllContainer},o().createElement(r.Button,{ouiaId:"view-all-btn",onClick:this.handleBulletChartModalOpen,type:r.ButtonType.button,variant:r.ButtonVariant.link},s.formatMessage(n.Z.detailsViewAll,{value:c})),o().createElement(H,{costType:e,currency:t,groupBy:a,groupByValue:i?U.rx:h,isOpen:p,onClose:this.handleBulletChartModalClose,query:l,reportGroupBy:c,reportPathsType:u}))}return null},this.handleBulletChartModalClose=e=>{this.setState({isBulletChartModalOpen:e})},this.handleBulletChartModalOpen=e=>{this.setState({isBulletChartModalOpen:!0}),e.preventDefault()}}componentDidMount(){const{fetchReport:e,reportPathsType:t,reportType:a,reportQueryString:r}=this.props;e(t,a,r)}componentDidUpdate(e){const{costType:t,currency:a,fetchReport:r,reportPathsType:s,reportType:n,reportQueryString:i}=this.props;e.reportQueryString===i&&e.costType===t&&e.currency===a||r(s,n,i)}render(){const{intl:e,isPlatformCosts:t,reportGroupBy:a,reportFetchStatus:s}=this.props,i=e.formatMessage(n.Z.breakdownSummaryTitle,{value:t?U.rx.toLowerCase():a});return o().createElement(r.Card,{style:$.card},o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},i)),o().createElement(r.CardBody,null,s===O.iF.inProgress?o().createElement(o().Fragment,null,o().createElement(r.Skeleton,{width:D.N.md}),o().createElement(r.Skeleton,{style:$.skeleton,width:D.N.md}),o().createElement(r.Skeleton,{style:$.skeleton,width:D.N.md}),o().createElement(r.Skeleton,{style:$.skeleton,width:D.N.md})):this.getSummary()),o().createElement(r.CardFooter,null,this.getViewAll()))}}const X=(0,O.X1)(((e,{costType:t,currency:a,reportGroupBy:r,reportPathsType:s,reportType:n,router:i})=>{const o=(0,M.mB)(i.location.search),l=(0,V.OA)(o),c=l?U.dV:(0,V.VL)(o),u=l||(0,V.pe)(o),p={filter:{limit:3,resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},o&&o.filter_by&&o.filter_by),o&&o.filter&&o.filter.account&&{[`${U.Sq}account`]:o.filter.account}),o&&o.filter&&o.filter.category&&{category:o.filter.category}),exclude:Object.assign({},o&&o.exclude&&o.exclude),group_by:Object.assign({},r&&{[r]:"*"})},h=(0,M.pm)(Object.assign(Object.assign({},p),{cost_type:t,currency:a,filter_by:Object.assign(Object.assign({},p.filter_by),c&&"*"!==u&&{[c]:u})}));return{groupBy:c,groupByValue:u,query:p,report:N.ZV.selectReport(e,s,n,h),reportFetchStatus:N.ZV.selectReportFetchStatus(e,s,n,h),reportQueryString:h}})),K={fetchReport:N.nx.fetchReport},Y=(0,l.ZP)((0,F.E)((0,w.connect)(X,K)(J)));var ee=a(762),te=a(79112),ae=a(45351),re=a(43902);const se={chartSkeleton:{marginBottom:R.ZP.value},capacity:{fontWeight:L.ZP.value},legendSkeleton:{marginTop:R.ZP.value}};class ne extends o().Component{constructor(){super(...arguments),this.containerRef=o().createRef(),this.observer=re.Z,this.state={width:0},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})},this.getChart=()=>{const{groupBy:e,name:t,reportFetchStatus:a,report:r}=this.props,{width:s}=this.state,n=this.getChartDatum();return r&&0!==n.usage.length?o().createElement("div",{className:"chartOverride"},a===O.iF.inProgress?this.getSkeleton():o().createElement(o().Fragment,null,Boolean("cluster"===e)&&this.getFreeSpace(),o().createElement(ee.n,{comparativeErrorMeasureData:n.limit.value?[{tooltip:n.limit.tooltip,y:n.limit.value}]:[],comparativeErrorMeasureLegendData:n.limit.value?[{name:n.limit.legend}]:[],height:this.getChartHeight(),labels:({datum:e})=>`${e.tooltip}`,legendPosition:"bottom-left",legendItemsPerRow:this.getItemsPerRow(),maxDomain:this.isDatumEmpty(n)?100:void 0,minDomain:0,name:t,padding:{bottom:75,left:10,right:50,top:0},primarySegmentedMeasureData:n.usage.length?n.usage.map((e=>({tooltip:e.tooltip,y:e.value}))):[],primarySegmentedMeasureLegendData:n.usage.length?n.usage.map((e=>({name:e.legend}))):[],qualitativeRangeData:n.ranges.length?[{tooltip:n.ranges[0].tooltip,y:n.ranges[0].value}]:[],qualitativeRangeLegendData:n.ranges.length?[{name:n.ranges[0].legend}]:[],width:s}))):null},this.getChartHeight=()=>{const{groupBy:e}=this.props,{width:t}=this.state;return"cluster"===e?t>950?115:t>450?150:210:t>700?115:t>450?150:180},this.getItemsPerRow=()=>{const{width:e}=this.state;return e>950?4:e>700?3:e>450?2:1},this.getSkeleton=()=>o().createElement(o().Fragment,null,o().createElement(r.Skeleton,{style:se.chartSkeleton,width:D.N.md}),o().createElement(r.Skeleton,{style:se.legendSkeleton,width:D.N.xs})),this.isDatumEmpty=e=>{let t=!1;for(const a of e.ranges)if(a.value){t=!0;break}let a=!1;for(const t of e.usage)if(t.value){a=!0;break}return!(e.limit.value||t||a)}}componentDidMount(){const{fetchReport:e,reportPathsType:t,reportType:a,reportQueryString:r}=this.props;e(t,a,r),this.observer=(0,ae.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){const{fetchReport:t,reportPathsType:a,reportType:r,reportQueryString:s}=this.props;e.reportQueryString!==this.props.reportQueryString&&t(a,r,s)}componentWillUnmount(){this.observer&&this.observer()}getChartDatum(){const{groupBy:e,report:t,intl:a,reportType:r}=this.props,s={limit:{},ranges:[],usage:[]},i=t&&t.meta&&t.meta.total,o=i&&t.meta.total.limit&&null!==t.meta.total.limit,l=Math.trunc(o?t.meta.total.limit.value:0),c=a.formatMessage(n.Z.units,{units:(0,Z.ZV)(o?t.meta.total.limit.units:void 0)});if(s.limit={legend:a.formatMessage(n.Z.detailsUsageLimit,{value:l,units:c}),tooltip:a.formatMessage(n.Z.detailsUsageLimit,{value:l,units:c}),value:Math.trunc(l)},"cluster"===e||r===B.C.volume){const e=i&&t.meta.total.capacity&&null!==t.meta.total.capacity,r=Math.trunc(e?t.meta.total.capacity.value:0),o=a.formatMessage(n.Z.units,{units:(0,Z.ZV)(e?t.meta.total.capacity.units:void 0)});s.ranges=[{legend:a.formatMessage(n.Z.detailsUsageCapacity,{value:r,units:o}),tooltip:a.formatMessage(n.Z.detailsUsageCapacity,{value:r,units:o}),value:Math.trunc(r)}]}const u=i&&t.meta.total.request&&null!==t.meta.total.request,p=i&&t.meta.total.usage&&null!==t.meta.total.usage,h=Math.trunc(u?t.meta.total.request.value:0),m=a.formatMessage(n.Z.units,{units:(0,Z.ZV)(u?t.meta.total.request.units:void 0)}),g=Math.trunc(p?t.meta.total.usage.value:0),d=a.formatMessage(n.Z.units,{units:(0,Z.ZV)(p?t.meta.total.usage.units:void 0)});return s.usage=[{legend:a.formatMessage(n.Z.detailsUsageUsage,{value:g,units:d}),tooltip:a.formatMessage(n.Z.detailsUsageUsage,{value:g,units:d}),value:Math.trunc(g)},{legend:a.formatMessage(n.Z.detailsUsageRequests,{value:h,units:m}),tooltip:a.formatMessage(n.Z.detailsUsageRequests,{value:h,units:m}),value:Math.trunc(h)}],s}getFreeSpace(){const{report:e,intl:t}=this.props,a=e&&e.meta&&e.meta.total,s=a&&e.meta.total.capacity&&null!==e.meta.total.capacity,i=a&&e.meta.total.request&&null!==e.meta.total.request,l=a&&e.meta.total.usage&&null!==e.meta.total.usage,c=Math.trunc(s?e.meta.total.capacity.value:0),u=Math.trunc(i?e.meta.total.request.value:0),p=t.formatMessage(n.Z.units,{units:(0,Z.ZV)(i?e.meta.total.request.units:void 0)}),h=Math.trunc(l?e.meta.total.usage.value:0),m=t.formatMessage(n.Z.units,{units:(0,Z.ZV)(l?e.meta.total.usage.units:void 0)}),g=c-u,d=c-h;let y=u>0?u/c*100:0;y>100&&(y=100-y);let f=c>h?h/c*100:0;return f>100&&(f=100-f),o().createElement(r.Grid,{hasGutter:!0},o().createElement(r.GridItem,{md:12,lg:6},o().createElement("div",null,t.formatMessage(n.Z.detailsUnusedUsageLabel)),o().createElement("div",{style:se.capacity},(0,Z.bM)(d,m)),o().createElement("div",null,t.formatMessage(n.Z.detailsUnusedUnits,{percentage:(0,Z.rl)(f,{minimumFractionDigits:0,maximumFractionDigits:0}),units:m}))),o().createElement(r.GridItem,{md:12,lg:6},o().createElement("div",null,t.formatMessage(n.Z.detailsUnusedRequestsLabel)),o().createElement("div",{style:se.capacity},(0,Z.bM)(g,p)),o().createElement("div",null,t.formatMessage(n.Z.detailsUnusedUnits,{percentage:(0,Z.rl)(y,{minimumFractionDigits:0,maximumFractionDigits:0}),units:p}))))}render(){return o().createElement("div",{className:"chartOverride",ref:this.containerRef},this.getChart())}}const ie=(0,O.X1)(((e,{reportPathsType:t,reportType:a,router:r})=>{const s=(0,te.mB)(r.location.search),n=(0,V.VL)(s),i=(0,V.pe)(s),o={filter:{time_scope_units:"month",time_scope_value:-1,resolution:"monthly"},filter_by:Object.assign(Object.assign({},s&&s.filter_by&&s.filter_by),s&&s.filter&&{category:s.filter.category}),exclude:Object.assign({},s&&s.exclude&&s.exclude),group_by:Object.assign({},n&&{[n]:i})},l=(0,M.pm)(Object.assign(Object.assign({},o),{filter_by:Object.assign(Object.assign({},o.filter_by),n&&"*"!==i&&{[n]:void 0})}));return{groupBy:n,report:N.ZV.selectReport(e,t,a,l),reportFetchStatus:N.ZV.selectReportFetchStatus(e,t,a,l),reportQueryString:l}})),oe={fetchReport:N.nx.fetchReport},le=(0,l.ZP)((0,F.E)((0,w.connect)(ie,oe)(ne)));var ce=a(33748),ue=a(51581);const pe="placeholder";class he extends o().Component{constructor(){super(...arguments),this.getClusterChart=e=>{const{groupBy:t,intl:a,report:s,title:i}=this.props;let l=!1;for(const a of e.cluster.showWidgetOnGroupBy)if(a===t||a===U.P&&-1!==t.indexOf(U.P)){l=!0;break}return l?o().createElement(r.Card,null,o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},a.formatMessage(n.Z.clusters))),o().createElement(r.CardBody,null,o().createElement(b,{groupBy:e.cluster.reportGroupBy,report:s,title:i}))):pe},this.getCostChart=e=>{const{report:t,intl:a}=this.props;return o().createElement(r.Card,null,o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},a.formatMessage(n.Z.breakdownCostBreakdownTitle),o().createElement(r.Popover,{"aria-label":a.formatMessage(n.Z.breakdownCostBreakdownAriaLabel),enableFlip:!0,bodyContent:o().createElement(o().Fragment,null,o().createElement("p",{style:ce.W.infoTitle},a.formatMessage(n.Z.rawCostTitle)),o().createElement("p",null,a.formatMessage(n.Z.rawCostDescription)),o().createElement("br",null),o().createElement("p",{style:ce.W.infoTitle},a.formatMessage(n.Z.usageCostTitle)),o().createElement("p",null,a.formatMessage(n.Z.usageCostDescription)),o().createElement("br",null),o().createElement("p",{style:ce.W.infoTitle},a.formatMessage(n.Z.markupTitle)),o().createElement("p",null,a.formatMessage(n.Z.markupDescription)),o().createElement("br",null),o().createElement("a",{href:a.formatMessage(n.Z.docsCostModelTerminology),rel:"noreferrer",target:"_blank"},a.formatMessage(n.Z.learnMore)))},o().createElement(r.Button,{variant:r.ButtonVariant.plain},o().createElement(s.iC,{style:ce.W.info}))))),o().createElement(r.CardBody,null,o().createElement(j,{name:e.chartName,report:t})))},this.getCpuUsageChart=e=>{const{intl:t}=this.props;return o().createElement(r.Card,null,o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},t.formatMessage(n.Z.cpuTitle))),o().createElement(r.CardBody,null,o().createElement(le,{name:e.chartName,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getMemoryUsageChart=e=>{const{intl:t}=this.props;return o().createElement(r.Card,null,o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},t.formatMessage(n.Z.memoryTitle))),o().createElement(r.CardBody,null,o().createElement(le,{name:e.chartName,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getSummaryCard=e=>{const{costType:t,currency:a,groupBy:r,isPlatformCosts:s,query:n}=this.props;let i=!1;if(e.reportSummary.showWidgetOnGroupBy)for(const t of e.reportSummary.showWidgetOnGroupBy)if(t===r||n&&n.group_by&&n.group_by[U.dV]||t===U.P&&r&&-1!==r.indexOf(U.P)){i=!0;break}if(!i&&e.reportSummary.showWidgetOnCategory)for(const t of e.reportSummary.showWidgetOnCategory)if(s&&t===U.rx){i=!0;break}return i?o().createElement(Y,{costType:t,currency:a,isPlatformCosts:s,reportGroupBy:e.reportSummary.reportGroupBy,reportPathsType:e.reportPathsType,reportType:e.reportType}):e.reportSummary.usePlaceholder?pe:null},this.getVolumeUsageChart=e=>{const{intl:t}=this.props;return o().createElement(r.Card,null,o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},t.formatMessage(n.Z.volumeTitle))),o().createElement(r.CardBody,null,o().createElement(le,{name:e.chartName,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getWidgetsColumns=()=>{const{selectWidgets:e,widgets:t}=this.props,a=[];t.map((t=>{const r=e[t],s=this.renderWidget(r);null!==s&&a.push(s)}));const r=Math.floor(a.length/2)+a.length%2,s=[],n=[];for(let e=0;e<r;e++)a[e]!==pe&&s.push(a[e]),e+r<a.length&&a[e+r]!==pe&&n.push(a[e+r]);return{leftColumnWidgets:s,rightColumnWidgets:n}}}renderWidget(e){switch(e.type){case ue.S.cluster:return this.getClusterChart(e);case ue.S.cost:return this.getCostChart(e);case ue.S.cpuUsage:return this.getCpuUsageChart(e);case ue.S.memoryUsage:return this.getMemoryUsageChart(e);case ue.S.reportSummary:return this.getSummaryCard(e);case ue.S.volumeUsage:return this.getVolumeUsageChart(e);default:return null}}render(){const{leftColumnWidgets:e,rightColumnWidgets:t}=this.getWidgetsColumns();return o().createElement(r.Grid,{hasGutter:!0},o().createElement(r.GridItem,{lg:12,xl:6},o().createElement(r.Grid,{hasGutter:!0},e.map(((e,t)=>o().createElement(r.GridItem,{key:`widget-${t}`},e))))),o().createElement(r.GridItem,{lg:12,xl:6},o().createElement(r.Grid,{hasGutter:!0},t.map(((e,t)=>o().createElement(r.GridItem,{key:`widget-${t}`},e))))))}}const me=(0,l.ZP)(he)},87935:(e,t,a)=>{a.d(t,{f:()=>fe});var r=a(90154),s=a(6456),n=a(97027),i=a(92950),o=a.n(i),l=a(74806),c=a(41829),u=a(39333),p=a(77760),h=a(4996),m=a(21094),g=a(2311),d=a(80469),y=a(84154),f=a(48629),v=a(52109),b=a(2370),C=a(55855),T=a(58395),S=a(45351),E=a(43902),O=a(27765),Z=a(19960),D=a(84076),L=a(18131),R=a(24656),P=a(84615),k=a(70698),x=a(72021),j=a(21768),M=a(41534),w=a(98499),_=a(48196);const B={currentCapacityData:{fill:"none"},currentColorScale:[j.CH.value,x.R0.value,k.t6.value,P.S7.value,M.iM.value],currentInfrastructureCostData:{fill:"none",strokeDasharray:"3,3"},currentCostData:{fill:"none"},itemsPerRow:0,previousCapacityData:{fill:"none"},previousColorScale:[O.O6.value,Z.OS.value,D.iY.value,L.cQ.value,R.DD.value],previousInfrastructureCostData:{fill:"none",strokeDasharray:"3,3"},previousCostData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},V={chart:{marginTop:_.S1.value},title:{marginLeft:"-"+w.Js.value}};class N extends o().Component{constructor(){super(...arguments),this.containerRef=o().createRef(),this.observer=E.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentCostData:e,previousCostData:t}=this.props,a=n.Z.chartCostLegendLabel,r=n.Z.chartCostLegendTooltip,s=[{childName:"previousCost",data:t,legendItem:{name:(0,h.uL)(t,a,!0,!0,1,n.Z.chartCostLegendNoDataLabel),symbol:{fill:B.previousColorScale[0],type:"minus"},tooltip:(0,h.ml)(t,r,!1,!1,1)},style:{data:Object.assign(Object.assign({},B.previousCostData),{stroke:B.previousColorScale[0]})}},{childName:"currentCost",data:e,legendItem:{name:(0,h.uL)(e,a,!0,!1,0,n.Z.chartCostLegendNoDataLabel),symbol:{fill:B.currentColorScale[0],type:"minus"},tooltip:(0,h.ml)(e,r,!1,!1)},style:{data:Object.assign(Object.assign({},B.currentCostData),{stroke:B.currentColorScale[0]})}}],i=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:i,series:s})},this.getChart=(e,t)=>{const{hiddenSeries:a}=this.state;return o().createElement(m.A,{data:a.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatter:e,formatOptions:t}=this.props,a=(0,g.f)("voronoi","cursor");return o().createElement(a,{cursorDimension:"x",labels:({datum:a})=>(0,S.zj)(a,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:120,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e,name:t=""}=this.props,{hiddenSeries:a,series:r,width:s}=this.state,n=e||(s>725?B.itemsPerRow:2);return o().createElement(d.Qk,{data:(0,S.oX)(r,a),height:25,gutter:20,itemsPerRow:n,name:`${t}-legend`})},this.handleLegendClick=e=>{const t=(0,S.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,S.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentCostData===this.props.currentCostData&&e.currentInfrastructureCostData===this.props.currentInfrastructureCostData&&e.previousCostData===this.props.previousCostData&&e.previousInfrastructureCostData===this.props.previousInfrastructureCostData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentInfrastructureCostData:e,previousInfrastructureCostData:t}=this.props,a=e?(0,C.Z)((0,h.Y_)(e,!0,!0)[1]):0,r=t?(0,C.Z)((0,h.Y_)(t,!0,!0)[1]):0;return a>0||r>0?Math.max(a,r):31}getEvents(){const{name:e=""}=this.props,{hiddenSeries:t,series:a}=this.state,r=(0,y.u)({chartNames:(0,S.bC)(a),isHidden:e=>(0,S.Yt)(t,e),legendName:`${e}-legend`,onLegendClick:e=>this.handleLegendClick(e.index)});return r}render(){const{adjustContainerHeight:e,height:t,containerHeight:a=t,intl:s,name:i,padding:l={bottom:120,left:8,right:8,top:8},title:c,xAxisLabel:u,yAxisLabel:p}=this.props,{cursorVoronoiContainer:h,hiddenSeries:m,series:g,width:d}=this.state,y=(0,S.ge)(g,m),C=this.getEndDate(),E=Math.floor(C/2),O=e&&d>725?a-25:a,Z=h?o().cloneElement(h,{disable:!(0,S.TW)(g,m),labelComponent:o().createElement(f.M,{legendData:(0,S.oX)(g,m,!0),title:e=>s.formatMessage(n.Z.chartDayOfTheMonth,{day:e.x})})}):void 0;return o().createElement("div",{className:"chartOverride",ref:this.containerRef},o().createElement(r.Title,{headingLevel:"h2",style:V.title,size:r.TitleSizes.xl},c),o().createElement("div",{style:Object.assign(Object.assign({},V.chart),{height:O})},o().createElement("div",{style:{height:t,width:d},"data-testid":"historical-chart-wrapper"},o().createElement(v.k,{containerComponent:Z,domain:y,events:this.getEvents(),height:t,legendComponent:this.getLegend(),legendData:(0,S.oX)(g,m),legendPosition:"bottom",name:i,padding:l,theme:T.Z,width:d},g&&g.map(((e,t)=>this.getChart(e,t))),o().createElement(b.C,{label:u,style:B.xAxis,tickValues:[1,E,C]}),o().createElement(b.C,{dependentAxis:!0,label:p,style:B.yAxis})))))}}const U=(0,l.ZP)(N);var F=a(37269),z=a(1156),Q=a(15920),I=a(91778),A=a(5842),q=a(20513),W=a(11331),G=a(32412);const H={chartContainer:{marginLeft:w.ZP.value},chartSkeleton:{height:"125px",marginBottom:G.ZP.value,marginTop:W.ZP.value},costChart:{marginBottom:_.ZP.value,marginTop:_.ZP.value},legendSkeleton:{marginTop:G.ZP.value},trendChart:{marginBottom:_.ZP.value,marginTop:_.ZP.value},usageChart:{marginTop:_.ZP.value}};class $ extends o().Component{constructor(){super(...arguments),this.getSkeleton=()=>o().createElement(o().Fragment,null,o().createElement(r.Skeleton,{style:H.chartSkeleton,width:q.N.md}),o().createElement(r.Skeleton,{style:H.legendSkeleton,width:q.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:a,reportPathsType:r,reportType:s}=this.props;e(r,s,t),e(r,s,a)}componentDidUpdate(e){const{fetchReport:t,costType:a,currency:r,currentQueryString:s,previousQueryString:n,reportPathsType:i,reportType:o}=this.props;e.currentQueryString===s&&e.costType===a&&e.currency===r||t(i,o,s),e.previousQueryString===n&&e.costType===a&&e.currency===r||t(i,o,n)}render(){const{chartName:e,currentReport:t,currentReportFetchStatus:a,previousReport:r,previousReportFetchStatus:s,intl:i}=this.props,l=(0,h.zJ)(t,h.yZ.cumulative,"date","cost"),c=(0,h.zJ)(t,h.yZ.cumulative,"date","infrastructure"),u=(0,h.zJ)(r,h.yZ.cumulative,"date","cost"),p=(0,h.zJ)(r,h.yZ.cumulative,"date","infrastructure"),m=t&&t.meta&&t.meta.total&&t.meta.total.cost?t.meta.total.cost.total.units:"USD",g=i.formatMessage(n.Z.currencyUnits,{units:m});return o().createElement("div",{style:H.chartContainer},o().createElement("div",{style:H.costChart},a===z.iF.inProgress&&s===z.iF.inProgress?this.getSkeleton():o().createElement(U,{adjustContainerHeight:!0,containerHeight:275,currentCostData:l,currentInfrastructureCostData:c,formatOptions:{},formatter:I.bM,height:300,name:e,previousCostData:u,previousInfrastructureCostData:p,xAxisLabel:i.formatMessage(n.Z.historicalChartDayOfMonthLabel),yAxisLabel:i.formatMessage(n.Z.historicalChartCostLabel,{units:g})})))}}const J=(0,z.X1)(((e,{costType:t,currency:a,reportPathsType:r,reportType:s,router:n})=>{const i=(0,u.mB)(n.location.search),o=(0,F.VL)(i),l=(0,F.pe)(i),c={filter_by:Object.assign(Object.assign({},i&&i.filter_by&&i.filter_by),i&&i.filter&&{category:i.filter.category}),exclude:Object.assign({},i&&i.exclude&&i.exclude),group_by:Object.assign({},o&&{[o]:l})},p=Object.assign(Object.assign({},c),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),h=(0,u.pm)(Object.assign(Object.assign({},p),{cost_type:t,currency:a,filter_by:Object.assign(Object.assign({},p.filter_by),o&&"*"!==l&&{[o]:void 0})})),m=Object.assign(Object.assign({},c),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),g=(0,u.pm)(Object.assign(Object.assign({},m),{cost_type:t,currency:a,filter_by:Object.assign(Object.assign({},m.filter_by),o&&"*"!==l&&{[o]:void 0})}));return{currentQuery:p,currentQueryString:h,currentReport:Q.ZV.selectReport(e,r,s,h),currentReportFetchStatus:Q.ZV.selectReportFetchStatus(e,r,s,h),previousQuery:m,previousQueryString:g,previousReport:Q.ZV.selectReport(e,r,s,g),previousReportFetchStatus:Q.ZV.selectReportFetchStatus(e,r,s,g)}})),X={fetchReport:Q.nx.fetchReport},K=(0,l.ZP)((0,A.E)((0,p.connect)(J,X)($))),Y={currentColorScale:[j.CH.value,x.R0.value,k.t6.value,P.S7.value,M.iM.value],currentMonthData:{fill:"none"},itemsPerRow:0,previousColorScale:[O.O6.value,Z.OS.value,D.iY.value,L.cQ.value,R.DD.value],previousMonthData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},ee={chart:{marginTop:_.S1.value},title:{marginLeft:"-"+w.Js.value}};class te extends o().Component{constructor(){super(...arguments),this.containerRef=o().createRef(),this.observer=E.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentData:e,previousData:t,showUsageLegendLabel:a=!1}=this.props,r=a?n.Z.chartUsageLegendLabel:n.Z.chartCostLegendLabel,s=a?n.Z.chartUsageLegendTooltip:n.Z.chartCostLegendTooltip,i=[{childName:"previousCost",data:t,legendItem:{name:(0,h.uL)(t,r,!0,!0,1,n.Z.chartUsageLegendNoDataLabel),symbol:{fill:Y.previousColorScale[0],type:"minus"},tooltip:(0,h.ml)(t,s,!1,!1,1)},style:{data:Object.assign(Object.assign({},Y.previousMonthData),{stroke:Y.previousColorScale[0]})}},{childName:"currentCost",data:e,legendItem:{name:(0,h.uL)(e,r,!0,!1,0,n.Z.chartUsageLegendNoDataLabel),symbol:{fill:Y.currentColorScale[1],type:"minus"},tooltip:(0,h.ml)(e,s,!1,!1)},style:{data:Object.assign(Object.assign({},Y.currentMonthData),{stroke:Y.currentColorScale[1]})}}],o=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:o,series:i})},this.getChart=(e,t)=>{const{hiddenSeries:a}=this.state;return o().createElement(m.A,{data:a.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatter:e,formatOptions:t}=this.props,a=(0,g.f)("voronoi","cursor");return o().createElement(a,{cursorDimension:"x",labels:({datum:a})=>(0,S.zj)(a,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:120,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e,name:t=""}=this.props,{hiddenSeries:a,series:r}=this.state;return o().createElement(d.Qk,{data:(0,S.oX)(r,a),height:25,gutter:20,itemsPerRow:e,name:`${t}-legend`})},this.handleLegendClick=e=>{const t=(0,S.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,S.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentData===this.props.currentData&&e.previousData===this.props.previousData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentData:e,previousData:t}=this.props,a=t?(0,C.Z)((0,h.Y_)(t,!0,!0)[1]):0,r=e?(0,C.Z)((0,h.Y_)(e,!0,!0)[1]):0;return r>0||a>0?Math.max(r,a):31}getEvents(){const{name:e=""}=this.props,{hiddenSeries:t,series:a}=this.state,r=(0,y.u)({chartNames:(0,S.bC)(a),isHidden:e=>(0,S.Yt)(t,e),legendName:`${e}-legend`,onLegendClick:e=>this.handleLegendClick(e.index)});return r}render(){const{height:e,containerHeight:t=e,intl:a,name:s,padding:i={bottom:120,left:8,right:8,top:8},title:l,xAxisLabel:c,yAxisLabel:u}=this.props,{cursorVoronoiContainer:p,hiddenSeries:h,series:m,width:g}=this.state,d=(0,S.ge)(m,h),y=this.getEndDate(),C=Math.floor(y/2),E=p?o().cloneElement(p,{disable:!(0,S.TW)(m,h),labelComponent:o().createElement(f.M,{legendData:(0,S.oX)(m,h,!0),title:e=>a.formatMessage(n.Z.chartDayOfTheMonth,{day:e.x})})}):void 0;return o().createElement("div",{className:"chartOverride",ref:this.containerRef},o().createElement(r.Title,{headingLevel:"h2",style:ee.title,size:r.TitleSizes.xl},l),o().createElement("div",{style:Object.assign(Object.assign({},ee.chart),{height:t})},o().createElement("div",{style:{height:e,width:g},"data-testid":"historical-chart-wrapper"},o().createElement(v.k,{containerComponent:E,domain:d,events:this.getEvents(),height:e,legendComponent:this.getLegend(),legendData:(0,S.oX)(m,h),legendPosition:"bottom",name:s,padding:i,theme:T.Z,width:g},m&&m.map(((e,t)=>this.getChart(e,t))),o().createElement(b.C,{label:c,style:Y.xAxis,tickValues:[1,C,y]}),o().createElement(b.C,{dependentAxis:!0,label:u,style:Y.yAxis})))))}}const ae=(0,l.ZP)(te);var re=a(14483);class se extends o().Component{constructor(){super(...arguments),this.getSkeleton=()=>o().createElement(o().Fragment,null,o().createElement(r.Skeleton,{style:H.chartSkeleton,width:q.N.md}),o().createElement(r.Skeleton,{style:H.legendSkeleton,width:q.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:a,reportPathsType:r,reportType:s}=this.props;e(r,s,t),e(r,s,a)}componentDidUpdate(e){const{fetchReport:t,costType:a,currency:r,currentQueryString:s,previousQueryString:n,reportPathsType:i,reportType:o}=this.props;e.currentQueryString===s&&e.costType===a&&e.currency===r||t(i,o,s),e.previousQueryString===n&&e.costType===a&&e.currency===r||t(i,o,n)}render(){const{chartName:e,currentReport:t,currentReportFetchStatus:a,previousReport:r,previousReportFetchStatus:i,reportType:l,intl:c}=this.props,u=l===s.C.cost,p=(0,h.zJ)(t,u?h.yZ.cumulative:h.yZ.rolling,"date",u?"cost":"usage"),m=(0,h.zJ)(r,u?h.yZ.cumulative:h.yZ.rolling,"date",u?"cost":"usage"),g=t&&t.meta&&t.meta.total&&t.meta.total.cost?t.meta.total.cost.total.units:"USD",d=t&&t.meta&&t.meta.total&&t.meta.total.usage?t.meta.total.usage.units:void 0;let y;if(u){const e=c.formatMessage(n.Z.currencyUnits,{units:g});y=c.formatMessage(n.Z.historicalChartCostLabel,{units:e})}else if(d&&Number.isNaN(Number(t.meta.total.usage.units)))y=c.formatMessage(n.Z.units,{units:(0,I.ZV)(d)});else{const e=c.formatMessage(n.Z.historicalChartUsageLabel,{value:l});y=c.formatMessage(n.Z.units,{units:(0,I.ZV)(e)})}return o().createElement("div",{style:H.chartContainer},o().createElement("div",{style:H.trendChart},a===z.iF.inProgress&&i===z.iF.inProgress?this.getSkeleton():o().createElement(ae,{containerHeight:250,currentData:p,formatOptions:{},formatter:I.bM,height:300,name:e,previousData:m,units:u?g:d,xAxisLabel:c.formatMessage(n.Z.historicalChartDayOfMonthLabel),yAxisLabel:y})))}}const ne=(0,z.X1)(((e,{costType:t,currency:a,reportPathsType:r,reportType:s,router:n})=>{const i=(0,u.mB)(n.location.search),o=(0,F.OA)(i),l=o?re.dV:(0,F.VL)(i),c=o||(0,F.pe)(i),p={filter_by:Object.assign(Object.assign(Object.assign({},i&&i.filter_by&&i.filter_by),i&&i.filter&&i.filter.account&&{[`${re.Sq}account`]:i.filter.account}),i&&i.filter&&i.filter.category&&{category:i.filter.category}),exclude:Object.assign({},i&&i.exclude&&i.exclude),group_by:Object.assign({},l&&{[l]:c})},h=Object.assign(Object.assign({},p),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),m=(0,u.pm)(Object.assign(Object.assign({},h),{cost_type:t,currency:a,filter_by:Object.assign(Object.assign({},h.filter_by),l&&"*"!==c&&{[l]:void 0})})),g=Object.assign(Object.assign({},p),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),d=(0,u.pm)(Object.assign(Object.assign({},g),{cost_type:t,currency:a,filter_by:Object.assign(Object.assign({},g.filter_by),l&&"*"!==c&&{[l]:void 0})}));return{currentQuery:h,currentQueryString:m,currentReport:Q.ZV.selectReport(e,r,s,m),currentReportFetchStatus:Q.ZV.selectReportFetchStatus(e,r,s,m),previousQuery:g,previousQueryString:d,previousReport:Q.ZV.selectReport(e,r,s,d),previousReportFetchStatus:Q.ZV.selectReportFetchStatus(e,r,s,d)}})),ie={fetchReport:Q.nx.fetchReport},oe=(0,l.ZP)((0,A.E)((0,p.connect)(ne,ie)(se))),le={currentCapacityData:{fill:"none"},currentColorScale:[j.CH.value,x.R0.value,k.t6.value,P.S7.value,M.iM.value],currentLimitData:{fill:"none"},currentRequestData:{fill:"none",strokeDasharray:"3,3"},currentUsageData:{fill:"none"},itemsPerRow:0,previousCapacityData:{fill:"none"},previousColorScale:[O.O6.value,Z.OS.value,D.iY.value,L.cQ.value,R.DD.value],previousLimitData:{fill:"none"},previousRequestData:{fill:"none",strokeDasharray:"3,3"},previousUsageData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},ce={chart:{marginTop:_.S1.value},title:{marginLeft:"-"+w.Js.value}};class ue extends o().Component{constructor(){super(...arguments),this.containerRef=o().createRef(),this.observer=E.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentLimitData:e,currentRequestData:t,currentUsageData:a,previousLimitData:r,previousRequestData:s,previousUsageData:i}=this.props,o=n.Z.chartLimitLegendLabel,l=n.Z.chartLimitLegendTooltip,c=n.Z.chartRequestsLegendLabel,u=n.Z.chartRequestsLegendTooltip,p=n.Z.chartUsageLegendLabel,m=n.Z.chartUsageLegendTooltip,g=[{childName:"previousUsage",data:i,legendItem:{name:(0,h.Fs)(i,p,!0,!0,1,n.Z.chartUsageLegendNoDataLabel),symbol:{fill:le.previousColorScale[0],type:"minus"},tooltip:(0,h.I6)(i,m,!1,!1,1)},style:{data:Object.assign(Object.assign({},le.previousUsageData),{stroke:le.previousColorScale[0]})}},{childName:"currentUsage",data:a,legendItem:{name:(0,h.Fs)(a,p,!0,!1,0,n.Z.chartUsageLegendNoDataLabel),symbol:{fill:le.currentColorScale[0],type:"minus"},tooltip:(0,h.I6)(a,m,!1,!1)},style:{data:Object.assign(Object.assign({},le.currentUsageData),{stroke:le.currentColorScale[0]})}},{childName:"previousRequest",data:s,legendItem:{name:(0,h.Fs)(s,c,!0,!0,1,n.Z.chartRequestsLegendNoDataLabel),symbol:{fill:le.previousColorScale[1],type:"dash"},tooltip:(0,h.I6)(s,u,!1,!1,1)},style:{data:Object.assign(Object.assign({},le.previousRequestData),{stroke:le.previousColorScale[1]})}},{childName:"currentRequest",data:t,legendItem:{name:(0,h.Fs)(t,c,!0,!1,0,n.Z.chartRequestsLegendNoDataLabel),symbol:{fill:le.currentColorScale[1],type:"dash"},tooltip:(0,h.I6)(t,u,!1,!1)},style:{data:Object.assign(Object.assign({},le.currentRequestData),{stroke:le.currentColorScale[1]})}},{childName:"previousLimit",data:r,legendItem:{name:(0,h.Fs)(r,o,!0,!0,1,n.Z.chartLimitLegendNoDataLabel),symbol:{fill:le.previousColorScale[2],type:"minus"},tooltip:(0,h.I6)(r,l,!1,!1,1)},style:{data:Object.assign(Object.assign({},le.previousLimitData),{stroke:le.previousColorScale[2]})}},{childName:"currentLimit",data:e,legendItem:{name:(0,h.Fs)(e,o,!0,!1,0,n.Z.chartLimitLegendNoDataLabel),symbol:{fill:le.currentColorScale[2],type:"minus"},tooltip:(0,h.I6)(e,l,!1,!1)},style:{data:Object.assign(Object.assign({},le.currentLimitData),{stroke:le.currentColorScale[2]})}}],d=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:d,series:g})},this.getChart=(e,t)=>{const{hiddenSeries:a}=this.state;return o().createElement(m.A,{data:a.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatter:e,formatOptions:t}=this.props,a=(0,g.f)("voronoi","cursor");return o().createElement(a,{cursorDimension:"x",labels:({datum:a})=>(0,S.zj)(a,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:130,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e,name:t=""}=this.props,{hiddenSeries:a,series:r,width:s}=this.state,n=e||(s>925?le.itemsPerRow:2);return o().createElement(d.Qk,{data:(0,S.oX)(r,a),height:25,gutter:20,itemsPerRow:n,name:`${t}-legend`})},this.handleLegendClick=e=>{const t=(0,S.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,S.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentLimitData===this.props.currentLimitData&&e.currentRequestData===this.props.currentRequestData&&e.currentUsageData===this.props.currentUsageData&&e.previousLimitData===this.props.previousLimitData&&e.previousRequestData===this.props.previousRequestData&&e.previousUsageData===this.props.previousUsageData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentRequestData:e,currentUsageData:t,previousRequestData:a,previousUsageData:r}=this.props,s=e?(0,C.Z)((0,h.Y_)(e,!0,!0)[1]):0,n=t?(0,C.Z)((0,h.Y_)(t,!0,!0)[1]):0,i=a?(0,C.Z)((0,h.Y_)(a,!0,!0)[1]):0,o=r?(0,C.Z)((0,h.Y_)(r,!0,!0)[1]):0;return s>0||n>0||i>0||o>0?Math.max(s,n,i,o):31}getEvents(){const{name:e=""}=this.props,{hiddenSeries:t,series:a}=this.state,r=(0,y.u)({chartNames:(0,S.bC)(a),isHidden:e=>(0,S.Yt)(t,e),legendName:`${e}-legend`,onLegendClick:e=>this.handleLegendClick(e.index)});return r}render(){const{adjustContainerHeight:e,height:t,containerHeight:a=t,intl:s,name:i,padding:l={bottom:130,left:8,right:8,top:8},title:c,xAxisLabel:u,yAxisLabel:p}=this.props,{cursorVoronoiContainer:h,hiddenSeries:m,series:g,width:d}=this.state,y=(0,S.ge)(g,m),C=this.getEndDate(),E=Math.floor(C/2),O=e&&d>925?a-50:a,Z=h?o().cloneElement(h,{disable:!(0,S.TW)(g,m),labelComponent:o().createElement(f.M,{legendData:(0,S.oX)(g,m,!0),title:e=>s.formatMessage(n.Z.chartDayOfTheMonth,{day:e.x})})}):void 0;return o().createElement("div",{className:"chartOverride",ref:this.containerRef},o().createElement(r.Title,{headingLevel:"h2",style:ce.title,size:r.TitleSizes.xl},c),o().createElement("div",{style:Object.assign(Object.assign({},ce.chart),{height:O})},o().createElement("div",{style:{height:t,width:d},"data-testid":"historical-chart-wrapper"},o().createElement(v.k,{containerComponent:Z,domain:y,events:this.getEvents(),height:t,legendComponent:this.getLegend(),legendData:(0,S.oX)(g,m),legendPosition:"bottom",name:i,padding:l,theme:T.Z,width:d},g&&g.map(((e,t)=>this.getChart(e,t))),o().createElement(b.C,{label:u,style:le.xAxis,tickValues:[1,E,C]}),o().createElement(b.C,{dependentAxis:!0,label:p,style:le.yAxis})))))}}const pe=(0,l.ZP)(ue);class he extends o().Component{constructor(){super(...arguments),this.getSkeleton=()=>o().createElement(o().Fragment,null,o().createElement(r.Skeleton,{style:H.chartSkeleton,width:q.N.md}),o().createElement(r.Skeleton,{style:H.legendSkeleton,width:q.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:a,reportPathsType:r,reportType:s}=this.props;e(r,s,t),e(r,s,a)}componentDidUpdate(e){const{fetchReport:t,currentQueryString:a,previousQueryString:r,reportPathsType:s,reportType:n}=this.props;e.currentQueryString!==a&&t(s,n,a),e.previousQueryString!==r&&t(s,n,r)}render(){const{chartName:e,currentReport:t,currentReportFetchStatus:a,previousReport:r,previousReportFetchStatus:s,intl:i}=this.props,l=(0,h.zJ)(t,h.yZ.rolling,"date","limit"),c=(0,h.zJ)(t,h.yZ.rolling,"date","request"),u=(0,h.zJ)(t,h.yZ.rolling,"date","usage"),p=(0,h.zJ)(r,h.yZ.rolling,"date","limit"),m=(0,h.zJ)(r,h.yZ.rolling,"date","request"),g=(0,h.zJ)(r,h.yZ.rolling,"date","usage"),d=t&&t.meta&&t.meta.total&&t.meta.total.usage?t.meta.total.usage.units:"";return o().createElement("div",{style:H.chartContainer},o().createElement("div",{style:H.usageChart},a===z.iF.inProgress&&s===z.iF.inProgress?this.getSkeleton():o().createElement(pe,{adjustContainerHeight:!0,containerHeight:300,currentLimitData:l,currentRequestData:c,currentUsageData:u,formatter:I.bM,formatOptions:{},height:300,name:e,previousLimitData:p,previousRequestData:m,previousUsageData:g,xAxisLabel:i.formatMessage(n.Z.historicalChartDayOfMonthLabel),yAxisLabel:i.formatMessage(n.Z.units,{units:(0,I.ZV)(d)})})))}}const me=(0,z.X1)(((e,{reportPathsType:t,reportType:a,router:r})=>{const n=(0,u.mB)(r.location.search),i=(0,F.OA)(n),o=(0,F.VL)(n),l=(0,F.pe)(n),c=a===s.C.instanceType||a===s.C.storage,p={filter_by:Object.assign(Object.assign(Object.assign(Object.assign({},n&&n.filter_by&&n.filter_by),n&&n.filter&&n.filter.account&&{[`${re.Sq}account`]:n.filter.account}),n&&n.filter&&n.filter.category&&{category:n.filter.category}),i&&c&&{[re.dV]:i}),exclude:Object.assign({},n&&n.exclude&&n.exclude),group_by:Object.assign(Object.assign({},i&&!c&&{[re.dV]:i}),o&&!i&&{[o]:l})},h=Object.assign(Object.assign({},p),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),m=(0,u.pm)(Object.assign(Object.assign({},h),{filter_by:Object.assign(Object.assign({},h.filter_by),o&&"*"!==l&&{[o]:void 0})})),g=Q.ZV.selectReport(e,t,a,m),d=Q.ZV.selectReportFetchStatus(e,t,a,m),y=Object.assign(Object.assign({},p),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),f=(0,u.pm)(Object.assign(Object.assign({},y),{filter_by:Object.assign(Object.assign({},y.filter_by),o&&"*"!==l&&{[o]:void 0})}));return{currentQuery:h,currentQueryString:m,currentReport:g,currentReportFetchStatus:d,previousQuery:y,previousQueryString:f,previousReport:Q.ZV.selectReport(e,t,a,f),previousReportFetchStatus:Q.ZV.selectReportFetchStatus(e,t,a,f)}})),ge={fetchReport:Q.nx.fetchReport},de=(0,l.ZP)((0,A.E)((0,p.connect)(me,ge)(he)));class ye extends o().Component{constructor(){super(...arguments),this.getTitleKey=(e,t)=>e===s.K.azure?t===s.C.instanceType?"virtual_machine":t:t===s.C.instanceType?"instance_type":t,this.getCostChart=e=>{const{costType:t,currency:a,intl:s}=this.props;return o().createElement(r.Card,null,o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},s.formatMessage(n.Z.historicalChartTitle,{value:this.getTitleKey(e.reportPathsType,e.reportType)}))),o().createElement(r.CardBody,null,o().createElement(K,{chartName:e.chartName,costType:t,currency:a,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getTrendChart=e=>{const{costType:t,currency:a,intl:s}=this.props;return o().createElement(r.Card,null,o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},s.formatMessage(n.Z.historicalChartTitle,{value:this.getTitleKey(e.reportPathsType,e.reportType)}))),o().createElement(r.CardBody,null,o().createElement(oe,{chartName:e.chartName,costType:t,currency:a,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getUsageChart=e=>{const{intl:t}=this.props;return o().createElement(r.Card,null,o().createElement(r.CardTitle,null,o().createElement(r.Title,{headingLevel:"h2",size:r.TitleSizes.lg},t.formatMessage(n.Z.historicalChartTitle,{value:this.getTitleKey(e.reportPathsType,e.reportType)}))),o().createElement(r.CardBody,null,o().createElement(de,{chartName:e.chartName,reportPathsType:e.reportPathsType,reportType:e.reportType})))}}renderWidget(e){switch(e.type){case c.b.cost:return this.getCostChart(e);case c.b.trend:return this.getTrendChart(e);case c.b.usage:return this.getUsageChart(e);default:return null}}render(){const{selectWidgets:e,widgets:t}=this.props;return o().createElement(r.Grid,{hasGutter:!0},t.map((t=>{const a=e[t];return o().createElement(r.GridItem,{key:`widget-${t}`},this.renderWidget(a))})))}}const fe=(0,l.ZP)(ye)},33748:(e,t,a)=>{a.d(t,{W:()=>c});var r=a(49382),s=a(33605),n=a(17918),i=a(54881),o=a(98499),l=a(48196);const c={costValue:{marginTop:o.ZP.var,marginBottom:0},costLabelUnit:{fontSize:i.ZP.value,color:s.ZP.var},dateTitle:{textAlign:"end"},header:{backgroundColor:r.ZP.var,padding:o.ZP.var},headerContent:{display:"flex",justifyContent:"space-between"},headerContentLeft:{display:"flex",minHeight:"90px"},headerContentRight:{display:"flex"},info:{verticalAlign:"middle"},infoIcon:{fontSize:n.ZP.value},infoTitle:{fontWeight:"bold"},title:{paddingBottom:l.ZP.var}}},19727:(e,t,a)=>{a.d(t,{$3:()=>o,$9:()=>u,_s:()=>n,jl:()=>i,q7:()=>l,xh:()=>c,yB:()=>p});var r=a(9256),s=a(10066);const n=(e,t,a,r=!1)=>{const n=Object.assign({},JSON.parse(JSON.stringify(e)));t.navigate((0,s.Z)(n,t.location,r),{replace:!0})},i=(e,t,a,r=!1)=>{const n=Object.assign({},JSON.parse(JSON.stringify(e)));t.navigate((0,s.Z)(n,t.location,r),{replace:!0})},o=(e,t,a)=>{const n=(0,r.oQ)(e,a);t.navigate((0,s.Z)(n,t.location,!0),{replace:!0})},l=(e,t,a)=>{const n=(0,r.cJ)(e,a);t.navigate((0,s.Z)(n,t.location,!0),{replace:!0})},c=(e,t,a)=>{const r=Object.assign({},JSON.parse(JSON.stringify(e)));r.filter=Object.assign(Object.assign({},e.filter),{limit:a});const n=(0,s.Z)(r,t.location,!0);t.navigate(n,{replace:!0})},u=(e,t,a,r)=>{const n=a&&a.meta&&a.meta.filter&&a.meta.filter.limit?a.meta.filter.limit:10,i=r*n-n,o=Object.assign({},JSON.parse(JSON.stringify(e)));o.filter=Object.assign(Object.assign({},e.filter),{offset:i});const l=(0,s.Z)(o,t.location);t.navigate(l,{replace:!0})},p=(e,t,a,r,n=undefined)=>{const i=Object.assign({},JSON.parse(JSON.stringify(e)));i.order_by={},i.order_by[a]=r?"asc":"desc",n&&(i.order_by.date=n);const o=(0,s.Z)(i,t.location);t.navigate(o,{replace:!0})}},10066:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(39333);const s=(e,t,a=!1)=>(a&&(e.filter=Object.assign(Object.assign({},e.filter),{offset:0})),`${t.pathname}?${(0,r.IV)(e)}`)}}]);
//# sourceMappingURL=../sourcemaps/4279.ef752b10b36ce0b11c717bb3db13b827.js.map