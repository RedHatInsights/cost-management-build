"use strict";(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[160],{62423:(e,t,r)=>{r.d(t,{e:()=>f});var a=r(54653),s=r(39333),n=r(97027),o=r(92950),i=r.n(o),l=r(74806),c=r(78741),u=r(16550),p=r(40493),h=r(1156),m=r(58613);class d extends i().Component{constructor(e,t){super(e,t),this.defaultState={isDropdownOpen:!1,isExportModalOpen:!1},this.state=Object.assign({},this.defaultState),this.getExportModal=()=>{const{groupBy:e,item:t,reportPathsType:r,reportQueryString:a}=this.props,{isExportModalOpen:s}=this.state;return i().createElement(p.X,{count:1,groupBy:e,isOpen:s,items:[t],onClose:this.handleExportModalClose,reportPathsType:r,reportQueryString:a})},this.handleExportModalClose=e=>{this.setState({isExportModalOpen:e})},this.handleExportModalOpen=()=>{this.setState({isExportModalOpen:!0})},this.handleOnSelect=()=>{const{isDropdownOpen:e}=this.state;this.setState({isDropdownOpen:!e})},this.handleOnToggle=e=>{this.setState({isDropdownOpen:e})},this.handleExportModalClose=this.handleExportModalClose.bind(this),this.handleExportModalOpen=this.handleExportModalOpen.bind(this),this.handleOnToggle=this.handleOnToggle.bind(this),this.handleOnSelect=this.handleOnSelect.bind(this)}render(){const{groupBy:e,isDisabled:t,showPriceListOption:r,intl:o,redirectToCostModel:l,history:c,item:{source_uuid:u}}=this.props,p=[i().createElement(a.DropdownItem,{component:"button",isDisabled:t,key:"export-action",onClick:this.handleExportModalOpen},o.formatMessage(n.Z.detailsActionsExport))];return r&&p.unshift(i().createElement(a.DropdownItem,{component:"button",key:"price-list-action",isDisabled:t||e.includes(s.P)||0===u.length,onClick:()=>l(u[0],c)},o.formatMessage(n.Z.detailsActionsPriceList))),i().createElement(i().Fragment,null,i().createElement(a.Dropdown,{onSelect:this.handleOnSelect,toggle:i().createElement(a.KebabToggle,{onToggle:this.handleOnToggle}),isOpen:this.state.isDropdownOpen,isPlain:!0,position:"right",dropdownItems:p}),this.getExportModal())}}const g=(0,h.X1)(((e,t)=>({}))),y={redirectToCostModel:m.F0.redirectToCostModelFromSourceUuid},v=(0,c.connect)(g,y)(d),f=(0,l.ZP)((0,u.EN)(v))},64727:(e,t,r)=>{r.d(t,{Z:()=>ne});var a=r(54653),s=r(97027),n=r(92950),o=r.n(n),i=r(74806),l=r(52471),c=r(55672),u=r(2985),p=r(47947),h=r(89662),m=r(86482),d=r(1156),g=r(98499);const y={content:{paddingBottom:g.ZP.value,paddingLeft:g.ZP.value,paddingRight:g.ZP.value,paddingTop:g.ZP.value}};var v=r(71973),f=r(39333),b=r(78741),C=r(73727),T=r(6450),S=r(11058),E=r(55785),O=r(50081),Z=r(37269),D=r(81278),x=r(23992),P=r(11331),L=r(48196);const R={dataListHeading:{fontWeight:x.ZP.value},groupByHeading:{marginBottom:g.ZP.value},tagLink:{marginLeft:L.ZP.value},tagsContainer:{marginRight:P.ZP.value,marginTop:L.ZP.value}};class k extends o().Component{constructor(){super(...arguments),this.getDataListItems=()=>{const{tagReport:e}=this.props,t=[];if(e)for(const r of e.data)for(const e of r.values){const s=`${r.key}:${e}`;t.push(o().createElement(a.DataListItem,{"aria-labelledby":s,key:`${s}-item`},o().createElement(a.DataListItemRow,null,o().createElement(a.DataListItemCells,{dataListCells:[o().createElement(a.DataListCell,{key:`${s}-cell1`},o().createElement("span",{id:s},r.key)),o().createElement(a.DataListCell,{key:`${s}-cell2`},e)]}))))}return t}}render(){const{category:e,groupBy:t,groupByValue:r,intl:n}=this.props,i=this.getDataListItems();return o().createElement(o().Fragment,null,o().createElement("div",null,o().createElement("span",{style:R.dataListHeading},n.formatMessage(s.Z.groupByValues,{value:t,count:1}))),o().createElement("div",{style:R.groupByHeading},o().createElement("span",null,e||r)),o().createElement(a.DataList,{"aria-label":n.formatMessage(s.Z.tagNames),isCompact:!0},o().createElement(a.DataListItem,{"aria-labelledby":"heading1"},o().createElement(a.DataListItemRow,null,o().createElement(a.DataListItemCells,{dataListCells:[o().createElement(a.DataListCell,{key:"primary content"},o().createElement("span",{id:"heading1",style:R.dataListHeading},n.formatMessage(s.Z.tagHeadingKey))),o().createElement(a.DataListCell,{key:"secondary content"},o().createElement("span",{id:"heading2",style:R.dataListHeading},n.formatMessage(s.Z.tagHeadingValue)))]}))),i.map((e=>e))))}}const M=(0,i.ZP)((0,b.connect)()(k)),w=O.Q.tag;class B extends o().Component{constructor(e){super(e),this.getTagValueCount=()=>{const{tagReport:e}=this.props;let t=0;if(e)for(const r of e.data)r.values&&(t+=r.values.length);return t},this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}componentDidMount(){const{fetchTag:e,tagReportPathsType:t,tagQueryString:r}=this.props;e(t,w,r)}componentDidUpdate(e){const{fetchTag:t,tagReportPathsType:r,tagQueryString:a}=this.props;e.tagQueryString!==a&&t(r,w,a)}shouldComponentUpdate(e){const{groupByValue:t,isOpen:r}=this.props;return e.groupByValue!==t||e.isOpen!==r}render(){const{category:e,groupBy:t,isOpen:r,query:n,tagReport:i,intl:l}=this.props,c=n&&n.filter&&n.filter.account?n.filter.account:this.props.groupByValue;return o().createElement(a.Modal,{isOpen:r,onClose:this.handleClose,title:l.formatMessage(s.Z.tagHeadingTitle,{value:this.getTagValueCount()}),width:"50%"},o().createElement(M,{category:e,groupBy:t,groupByValue:c,tagReport:i}))}}const j=(0,d.X1)(((e,{tagReportPathsType:t})=>{const r=(0,f.mB)(location.search),a=(0,Z.OA)(r),s=a?f.dV:(0,Z.VL)(r),n=a||(0,Z.pe)(r),o=r&&r.filter_by?r.filter_by:{};for(const e of Object.keys(o))-1!==e.indexOf(f.P)&&(o[e]=void 0);const i={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},o),r&&r.filter&&r.filter.account&&{[`${f.Sq}account`]:r.filter.account}),s&&-1===s.indexOf(f.P)&&{[s]:n})},l=(0,f.pm)(i),c=D.ux.selectTag(e,t,w,l),u=D.ux.selectTagFetchStatus(e,t,w,l);return{category:r.category,groupBy:s,groupByValue:n,query:i,tagReport:c,tagReportFetchStatus:u,tagQueryString:l}})),_={fetchTag:D.xr.Xt},V=(0,i.ZP)((0,b.connect)(j,_)(B)),U=O.Q.tag;class F extends o().Component{constructor(e){super(e),this.defaultState={isOpen:!1},this.state=Object.assign({},this.defaultState),this.handleClose=e=>{this.setState({isOpen:e})},this.handleOpen=e=>(this.setState({isOpen:!0}),e.preventDefault(),!1),this.handleClose=this.handleClose.bind(this),this.handleOpen=this.handleOpen.bind(this)}componentDidMount(){const{fetchTag:e,tagReportPathsType:t,tagQueryString:r}=this.props;e(t,U,r)}componentDidUpdate(e){const{fetchTag:t,tagReportPathsType:r,tagQueryString:a}=this.props;e.tagQueryString!==a&&t(r,U,a)}render(){const{id:e,tagReport:t,tagReportPathsType:r}=this.props,{isOpen:a}=this.state;let s=0;if(t)for(const e of t.data)e.values&&(s+=e.values.length);return o().createElement("div",{style:R.tagsContainer,id:e},Boolean(s>0)&&o().createElement(o().Fragment,null,o().createElement(E.lO,null),o().createElement("a",{"data-testid":"tag-lnk",href:"#/",onClick:this.handleOpen,style:R.tagLink},s)),o().createElement(V,{isOpen:a,onClose:this.handleClose,tagReportPathsType:r}))}}const N=(0,d.X1)(((e,{tagReportPathsType:t})=>{const r=(0,f.mB)(location.search),a=(0,Z.OA)(r),s=a?f.dV:(0,Z.VL)(r),n=a||(0,Z.pe)(r),o=r&&r.filter_by?r.filter_by:{};for(const e of Object.keys(o))-1!==e.indexOf(f.P)&&(o[e]=void 0);const i={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},o),r&&r.filter&&r.filter.account&&{[`${f.Sq}account`]:r.filter.account}),s&&-1===s.indexOf(f.P)&&{[s]:n})},l=(0,f.pm)(i);return{groupBy:s,groupByValue:n,query:i,tagReport:D.ux.selectTag(e,t,U,l),tagReportFetchStatus:D.ux.selectTagFetchStatus(e,t,U,l),tagQueryString:l}})),I={fetchTag:D.xr.Xt},Q=(0,i.ZP)((0,b.connect)(N,I)(F));var z=r(78898),A=r(45087),q=r(91778),W=r(72892),G=r(12289),$=r(40794),H=r(32412),X=r(57640),J=r(43789);const K={cost:{marginTop:X.ZP.var},costLabel:{marginTop:J.ZP.var},costValue:{marginTop:0,marginBottom:0,textAlign:"right"},costLabelDate:{textAlign:"right"},costType:{marginTop:H.ZP.var},header:{backgroundColor:W.ZP.var,paddingLeft:g.ZP.var,paddingRight:g.ZP.var,paddingTop:g.ZP.var},headerContent:{display:"flex",justifyContent:"space-between"},headerContentRight:{display:"flex"},infoDescription:{color:G.ZP.value,fontSize:$.ZP.value},tabs:{display:"flex"},tag:{marginLeft:g.ZP.var},title:{paddingBottom:g.ZP.var,paddingTop:J.ZP.var}};class Y extends o().Component{constructor(){super(...arguments),this.buildDetailsLink=()=>{const{detailsURL:e,groupBy:t,query:r}=this.props;let a=t,s="*";r[f.dV]&&(a=f.dV,s=r[f.dV]);const n=Object.assign(Object.assign({},JSON.parse(JSON.stringify(r))),{group_by:{[a]:s}});return n.filter&&(n.filter.account=void 0,n[f.eG]=void 0,n[f.dV]=void 0,n[f.yG]=void 0),`${e}?${(0,f.IV)(n)}`},this.getTotalCost=()=>{const{report:e}=this.props,t=e&&e.meta&&e.meta.total&&e.meta.total.cost&&e.meta.total.cost.total;return(0,q.xG)(t?e.meta.total.cost.total.value:0,t?e.meta.total.cost.total.units:"USD")}}render(){const{costType:e,currency:t,description:r,groupBy:n,intl:i,isCurrencyFeatureEnabled:l,onCostTypeSelected:c,onCurrencySelected:u,query:p,showCostType:h=!1,tabs:m,tagReportPathsType:d,title:g}=this.props,y=p&&p.filter?p.filter.account:void 0,b=(0,Z.OA)(p),E=(0,Z.qV)(p),O=y||"account"===n||"project"===n||"gcp_project"===n||"subscription_guid"===n,D=y?"account":E?"tag":b?f.dV:n;return o().createElement("header",{style:K.header},o().createElement("div",{style:K.headerContent},o().createElement("nav",{"aria-label":i.formatMessage(s.Z.breakdownBackToDetailsAriaLabel),className:"breadcrumbOverride"},o().createElement("ol",{className:"pf-c-breadcrumb__list"},o().createElement("li",{className:"pf-c-breadcrumb__item"},o().createElement("span",{className:"pf-c-breadcrumb__item-divider"},o().createElement(v.fP,null)),o().createElement(C.rU,{to:this.buildDetailsLink()},i.formatMessage(s.Z.breakdownBackToDetails,{value:i.formatMessage(s.Z.breakdownBackToTitles,{value:d}),groupBy:D}))))),o().createElement("div",{style:K.headerContentRight},l&&o().createElement(T.F,{currency:t,onSelect:u}))),o().createElement("div",{style:K.headerContent},o().createElement("div",{style:K.title},o().createElement(a.Title,{headingLevel:"h1",size:a.TitleSizes["2xl"]},i.formatMessage(s.Z.breakdownTitle,{value:g}),r&&o().createElement("div",{style:K.infoDescription},r)),h&&o().createElement("div",{style:K.costType},o().createElement(S.T,{onSelect:c,costType:e}))),o().createElement("div",{style:K.cost},o().createElement("div",{style:K.costLabel},o().createElement(a.Title,{headingLevel:"h2",style:K.costValue,size:a.TitleSizes["4xl"]},o().createElement("span",null,this.getTotalCost()))),o().createElement("div",{style:K.costLabelDate},(0,A.Y$)(i.formatMessage(s.Z.groupByValuesTitleCase,{value:D,count:2}))))),o().createElement("div",null,o().createElement("div",{style:K.tabs},m,o().createElement("div",{style:K.tag},Boolean(O)&&o().createElement(Q,{id:"tags",tagReportPathsType:d})))))}}const ee=(0,d.X1)((e=>({isCurrencyFeatureEnabled:z.iJ.selectIsCurrencyFeatureEnabled(e)}))),te=(0,i.ZP)((0,b.connect)(ee,{})(Y));var re;!function(e){e.costOverview="cost-overview",e.historicalData="historical-data"}(re||(re={}));const ae=e=>{switch(e){case re.costOverview:return"cost-overview";case re.historicalData:return"historical-data"}};class se extends o().Component{constructor(){super(...arguments),this.defaultState={activeTabKey:0},this.state=Object.assign({},this.defaultState),this.getAvailableTabs=()=>[{contentRef:o().createRef(),tab:re.costOverview},{contentRef:o().createRef(),tab:re.historicalData}],this.getTab=(e,t,r)=>o().createElement(a.Tab,{eventKey:r,key:`${ae(e)}-tab`,tabContentId:`tab-${r}`,tabContentRef:t,title:o().createElement(a.TabTitleText,null,this.getTabTitle(e))}),this.getTabContent=e=>e.map(((e,t)=>o().createElement(a.TabContent,{eventKey:t,key:`${ae(e.tab)}-tabContent`,id:`tab-${t}`,ref:e.contentRef},this.getTabItem(e.tab,t)))),this.getTabItem=(e,t)=>{const{costOverviewComponent:r,historicalDataComponent:a}=this.props,{activeTabKey:s}=this.state,n=o().createElement(o().Fragment,null);if(s!==t)return n;const i=ae(e);return i===re.costOverview?r:i===re.historicalData?a:n},this.getTabs=e=>{const{activeTabKey:t}=this.state;return o().createElement(a.Tabs,{activeKey:t,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e.tab,e.contentRef,t))))},this.getTabTitle=e=>{const{intl:t}=this.props;return e===re.costOverview?t.formatMessage(s.Z.breakdownCostOverviewTitle):e===re.historicalData?t.formatMessage(s.Z.breakdownHistoricalDataTitle):void 0},this.handleTabClick=(e,t)=>{const{activeTabKey:r}=this.state;r!==t&&this.setState({activeTabKey:t})},this.updateReport=()=>{const{location:e,fetchReport:t,reportPathsType:r,reportType:a,reportQueryString:s}=this.props;e.search&&t(r,a,s)}}componentDidMount(){this.updateReport()}componentDidUpdate(e){const{location:t,report:r,reportError:a,reportQueryString:s}=this.props,n=e.reportQueryString!==s,o=!r&&!a,i=!t.search;(n||o||i)&&this.updateReport()}render(){const{costType:e,currency:t,description:r,detailsURL:a,emptyStateTitle:s,groupBy:n,history:i,providers:g,providersFetchStatus:v,providerType:f,query:b,report:C,reportError:T,reportFetchStatus:S,showCostType:E,tagReportPathsType:O,title:Z}=this.props,D=this.getAvailableTabs();if(T)return o().createElement(p.W,{title:s});if(v===d.iF.inProgress&&S===d.iF.inProgress)return o().createElement(l.g,{title:s});if(v===d.iF.complete&&S===d.iF.complete){if(g&&g.meta&&0===g.meta.count&&v===d.iF.complete)return o().createElement(u.L,{providerType:f,title:s});if(!(0,m.g8)(g))return o().createElement(c.J,{title:Z})}return o().createElement(o().Fragment,null,o().createElement(te,{costType:e,currency:t,description:r,detailsURL:a,groupBy:n,onCostTypeSelected:e=>(0,h.jl)(i,b,e),onCurrencySelected:e=>(0,h._s)(i,b,e),query:b,report:C,showCostType:E,tabs:this.getTabs(D),tagReportPathsType:O,title:Z}),o().createElement("div",{style:y.content},this.getTabContent(D)))}}const ne=(0,i.ZP)(se)},67709:(e,t,r)=>{r.d(t,{X:()=>pe});var a=r(54653),s=r(91290),n=r(39333),o=r(97027),i=r(92950),l=r.n(i),c=r(74806),u=r(69511),p=r(11331),h=r(48196);const m={clustersContainer:{marginRight:p.ZP.value,marginTop:h.ZP.value}};class d extends l().Component{render(){const{item:e}=this.props;return e.clusters?e.clusters.map(((e,t)=>l().createElement("div",{key:`cluster-${t}`},e))):null}}const g=(0,c.ZP)(d),y={modal:{height:"700px",width:"600px"},subTitle:{marginTop:r(91707).ZP.value,textAlign:"right"}};class v extends l().Component{constructor(e){super(e),this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}shouldComponentUpdate(e){const{isOpen:t,item:r}=this.props;return e.item!==r||e.isOpen!==t}render(){const{category:e,groupBy:t,isOpen:r,item:s,intl:n}=this.props;return l().createElement(a.Modal,{className:"modalOverride",style:y.modal,isOpen:r,onClose:this.handleClose,title:n.formatMessage(o.Z.detailsClustersModalTitle,{groupBy:t,name:e||s.label}),width:"50%"},l().createElement(g,{item:s}))}}const f=(0,c.ZP)(v);class b extends l().Component{constructor(e){super(e),this.defaultState={isOpen:!1,showAll:!1},this.state=Object.assign({},this.defaultState),this.handleClose=e=>{this.setState({isOpen:e})},this.handleOpen=e=>(this.setState({isOpen:!0}),e.preventDefault(),!1),this.handleClose=this.handleClose.bind(this),this.handleOpen=this.handleOpen.bind(this)}render(){const{category:e,groupBy:t,report:r,intl:a}=this.props,{isOpen:s,showAll:n}=this.state;let i=0;const c=[],p=[],h=(0,u.R)({report:r,idKey:t}),d=h&&h.length?h[0]:void 0;if(!d)return null;for(const e of d.clusters){const t=`${c.length>0?", ":""}${e}`;n?c.push(t):i<=50&&(i+t.length>50?c.push(t.slice(0,50-i).trim().concat("...")):c.push(t)),i+=t.length,p.push(e)}return l().createElement("div",{style:m.clustersContainer},Boolean(c)&&c.map(((e,t)=>l().createElement("span",{key:t},e))),Boolean(c.length<p.length)&&l().createElement("a",{"data-testid":"cluster-lnk",href:"#/",onClick:this.handleOpen},a.formatMessage(o.Z.detailsMoreClusters,{value:p.length-c.length})),l().createElement(f,{category:e,groupBy:t,isOpen:s,item:d,onClose:this.handleClose}))}}const C=(0,c.ZP)(b);var T=r(10310),S=r(80469),E=r(34502),O=r(30950),Z=r(1156),D=r(91778),x=r(20513),P=r(23992),L=r(32412);const R={chartHeight:150,chartWidth:475,subTitle:{fontWeight:P.ZP.value}},k={chartSkeleton:{height:"125px",marginBottom:L.ZP.value,marginTop:p.ZP.value}};class M extends l().Component{constructor(){super(...arguments),this.getLegendLabel=()=>e=>{var{values:t}=e,r=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]])}return r}(e,["values"]);return l().createElement(T.Df,Object.assign({},r,{style:[{fontWeight:R.subTitle.fontWeight},{}],text:[t[r.index],r.text]}))},this.getSkeleton=()=>l().createElement(l().Fragment,null,l().createElement(a.Skeleton,{style:k.chartSkeleton,width:x.N.md}))}render(){const{name:e,report:t,reportFetchStatus:r,intl:a}=this.props,s=t&&t.meta&&t.meta.total&&t.meta.total.cost,n=s&&t.meta.total.cost.markup,i=s&&t.meta.total.cost.raw,c=s&&t.meta.total.cost.usage,u=n?t.meta.total.cost.markup.units:"USD",p=i?t.meta.total.cost.raw.units:"USD",h=c?t.meta.total.cost.usage.units:"USD",m=n?t.meta.total.cost.markup.value:0,d=i?t.meta.total.cost.raw.value:0,g=c?t.meta.total.cost.usage.value:0,y=(0,D.xG)(n?t.meta.total.cost.markup.value:0,u),v=(0,D.xG)(i?t.meta.total.cost.raw.value:0,p),f=(0,D.xG)(c?t.meta.total.cost.usage.value:0,h),b=a.formatMessage(o.Z.markupTitle),C=a.formatMessage(o.Z.rawCostTitle),T=a.formatMessage(o.Z.usageCostTitle),x=this.getLegendLabel(),P=l().createElement(S.Qk,{gutter:80,itemsPerRow:2,labelComponent:l().createElement(x,{dy:10,lineHeight:1.5,values:[v,y,f]}),rowGutter:20});return l().createElement("div",{style:{height:R.chartHeight,width:R.chartWidth}},r===Z.iF.inProgress?this.getSkeleton():l().createElement(E.Td,{ariaDesc:a.formatMessage(o.Z.breakdownCostChartAriaDesc),ariaTitle:a.formatMessage(o.Z.breakdownCostBreakdownTitle),constrainToVisibleArea:!0,data:[{x:C,y:d,units:p},{x:b,y:m,units:u},{x:T,y:g,units:h}],height:R.chartHeight,labels:({datum:e})=>a.formatMessage(o.Z.breakdownCostChartTooltip,{name:e.x,value:(0,D.xG)(e.y,e.units)}),legendComponent:P,legendData:[{name:C},{name:b},{name:T}],legendOrientation:"vertical",legendPosition:"right",name:e,padding:{bottom:20,left:0,right:275,top:20},themeColor:O.nz.green,width:R.chartWidth}))}}const w=(0,c.ZP)(M);var B=r(78741),j=r(38470),_=r(6456),V=r(37269),U=r(68091);const F={mainContent:{marginTop:r(57640).ZP.value},subTitle:{textAlign:"right"}},N=_.C.cost;class I extends l().Component{constructor(e){super(e)}componentDidMount(){const{fetchReport:e,reportPathsType:t,reportQueryString:r}=this.props;e(t,N,r)}componentDidUpdate(e){const{fetchReport:t,reportPathsType:r,reportQueryString:a}=this.props;e.reportQueryString!==a&&t(r,N,a)}render(){const{intl:e,report:t,reportGroupBy:r,reportFetchStatus:s}=this.props,n=t&&t.meta&&t.meta.total,i=(0,D.xG)(n?t.meta.total.cost.total.value:0,n?t.meta.total.cost.total.units:"USD");return l().createElement(l().Fragment,null,l().createElement("div",{style:F.subTitle},l().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.xl},e.formatMessage(o.Z.detailsCostValue,{value:i}))),l().createElement("div",{style:F.mainContent},l().createElement(j.mZ,{idKey:r,report:t,status:s},(({items:e})=>e.map((e=>l().createElement(j.EH,{key:e.id,formatOptions:{},label:e.label?e.label.toString():"",totalValue:t.meta.total.cost.total.value,units:t.meta.total.cost.total.units,value:e.cost.total.value})))))))}}const Q=(0,Z.X1)(((e,{costType:t,currency:r,reportGroupBy:a,reportPathsType:s})=>{const o=(0,n.mB)(location.search),i=(0,V.OA)(o),l=i?n.dV:(0,V.VL)(o),c=i||(0,V.pe)(o),u={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign(Object.assign({},o&&o.filter_by&&o.filter_by),o&&o.filter&&o.filter.account&&{[`${n.Sq}account`]:o.filter.account}),l&&{[l]:void 0}),l&&{[l]:c}),exclude:Object.assign({},o&&o.exclude&&o.exclude),group_by:Object.assign({},a&&{[a]:"*"})},p=(0,n.pm)(Object.assign(Object.assign({},u),{cost_type:t,currency:r}));return{report:U.ZV.selectReport(e,s,N,p),reportFetchStatus:U.ZV.selectReportFetchStatus(e,s,N,p),reportQueryString:p}})),z={fetchReport:U.nx.fetchReport},A=(0,c.ZP)((0,B.connect)(Q,z)(I));class q extends l().Component{constructor(e){super(e),this.handleClose=()=>{this.props.onClose(!1)},this.handleClose=this.handleClose.bind(this)}shouldComponentUpdate(e){const{groupByValue:t,isOpen:r}=this.props;return e.groupByValue!==t||e.isOpen!==r}render(){const{costType:e,currency:t,groupByValue:r,intl:s,isOpen:n,reportGroupBy:i,reportPathsType:c}=this.props;return l().createElement(a.Modal,{className:"modalOverride",isOpen:n,onClose:this.handleClose,title:s.formatMessage(o.Z.detailsSummaryModalTitle,{groupBy:i,name:r}),variant:"large"},l().createElement(A,{costType:e,currency:t,reportGroupBy:i,reportPathsType:c}))}}const W=(0,c.ZP)(q),G={card:{},skeleton:{marginTop:L.ZP.value},viewAllContainer:{marginLeft:"-15px"}};class $ extends l().Component{constructor(){super(...arguments),this.state={isBulletChartModalOpen:!1},this.getItems=()=>{const{report:e,reportGroupBy:t}=this.props;return(0,u.R)({report:e,idKey:t})},this.getSummary=()=>{const{report:e,reportGroupBy:t,reportFetchStatus:r}=this.props;return l().createElement(j.mZ,{idKey:t,report:e,status:r},(({items:t})=>t.map((t=>l().createElement(j.EH,{formatOptions:{},key:`${t.id}-item`,label:t.label?t.label.toString():void 0,totalValue:e.meta.total.cost.total.value,units:e.meta.total.cost.total.units,value:t.cost.total.value})))))},this.getViewAll=()=>{const{costType:e,currency:t,groupBy:r,query:s,reportGroupBy:n,reportPathsType:i,intl:c}=this.props,{isBulletChartModalOpen:u}=this.state;if(-1!==this.getItems().findIndex((e=>{const t=e.id;if(t&&null!==t)return"Other"===t||"Others"===t}))){const p=s&&s.filter&&s.filter.account?s.filter.account:this.props.groupByValue;return l().createElement("div",{style:G.viewAllContainer},l().createElement(a.Button,{ouiaId:"view-all-btn",onClick:this.handleBulletChartModalOpen,type:a.ButtonType.button,variant:a.ButtonVariant.link},c.formatMessage(o.Z.detailsViewAll,{value:n})),l().createElement(W,{costType:e,currency:t,groupBy:r,groupByValue:p,isOpen:u,onClose:this.handleBulletChartModalClose,query:s,reportGroupBy:n,reportPathsType:i}))}return null},this.handleBulletChartModalClose=e=>{this.setState({isBulletChartModalOpen:e})},this.handleBulletChartModalOpen=e=>{this.setState({isBulletChartModalOpen:!0}),e.preventDefault()}}componentDidMount(){const{fetchReport:e,reportPathsType:t,reportType:r,reportQueryString:a}=this.props;e(t,r,a)}componentDidUpdate(e){const{costType:t,currency:r,fetchReport:a,reportPathsType:s,reportType:n,reportQueryString:o}=this.props;e.reportQueryString===o&&e.costType===t&&e.currency===r||a(s,n,o)}render(){const{category:e,reportGroupBy:t,reportFetchStatus:r,intl:s}=this.props;return l().createElement(a.Card,{style:G.card},l().createElement(a.CardTitle,null,l().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},s.formatMessage(o.Z.breakdownSummaryTitle,{value:e||t}))),l().createElement(a.CardBody,null,r===Z.iF.inProgress?l().createElement(l().Fragment,null,l().createElement(a.Skeleton,{width:x.N.md}),l().createElement(a.Skeleton,{style:G.skeleton,width:x.N.md}),l().createElement(a.Skeleton,{style:G.skeleton,width:x.N.md}),l().createElement(a.Skeleton,{style:G.skeleton,width:x.N.md})):this.getSummary()),l().createElement(a.CardFooter,null,this.getViewAll()))}}const H=(0,Z.X1)(((e,{costType:t,currency:r,reportGroupBy:a,reportPathsType:s,reportType:o})=>{const i=(0,n.mB)(location.search),l=(0,V.OA)(i),c=l?n.dV:(0,V.VL)(i),u=l||(0,V.pe)(i),p={filter:{limit:3,resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign(Object.assign({},i&&i.filter_by&&i.filter_by),i&&i.filter&&i.filter.account&&{[`${n.Sq}account`]:i.filter.account}),c&&{[c]:void 0}),c&&{[c]:u}),exclude:Object.assign({},i&&i.exclude&&i.exclude),group_by:Object.assign({},a&&{[a]:"*"})},h=(0,n.pm)(Object.assign(Object.assign({},p),{cost_type:t,currency:r}));return{groupBy:c,groupByValue:u,query:p,report:U.ZV.selectReport(e,s,o,h),reportFetchStatus:U.ZV.selectReportFetchStatus(e,s,o,h),reportPathsType:s,reportType:o,reportQueryString:h}})),X={fetchReport:U.nx.fetchReport},J=(0,c.ZP)((0,B.connect)(H,X)($));var K=r(762),Y=r(79112),ee=r(45351),te=r(43902);const re={chartSkeleton:{marginBottom:L.ZP.value},capacity:{fontWeight:P.ZP.value},legendSkeleton:{marginTop:L.ZP.value}};class ae extends l().Component{constructor(){super(...arguments),this.containerRef=l().createRef(),this.observer=te.Z,this.state={width:0},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})},this.getChart=()=>{const{groupBy:e,name:t,reportFetchStatus:r,report:a}=this.props,{width:s}=this.state,n=this.getChartDatum();return a&&0!==n.usage.length?l().createElement("div",{className:"chartOverride"},r===Z.iF.inProgress?this.getSkeleton():l().createElement(l().Fragment,null,Boolean("cluster"===e)&&this.getFreeSpace(),l().createElement(K.n,{comparativeErrorMeasureData:n.limit.value?[{tooltip:n.limit.tooltip,y:n.limit.value}]:[],comparativeErrorMeasureLegendData:n.limit.value?[{name:n.limit.legend}]:[],height:this.getChartHeight(),labels:({datum:e})=>`${e.tooltip}`,legendPosition:"bottom-left",legendItemsPerRow:this.getItemsPerRow(),maxDomain:this.isDatumEmpty(n)?100:void 0,minDomain:0,name:t,padding:{bottom:75,left:10,right:50,top:0},primarySegmentedMeasureData:n.usage.length?n.usage.map((e=>({tooltip:e.tooltip,y:e.value}))):[],primarySegmentedMeasureLegendData:n.usage.length?n.usage.map((e=>({name:e.legend}))):[],qualitativeRangeData:n.ranges.length?[{tooltip:n.ranges[0].tooltip,y:n.ranges[0].value}]:[],qualitativeRangeLegendData:n.ranges.length?[{name:n.ranges[0].legend}]:[],width:s}))):null},this.getChartHeight=()=>{const{groupBy:e}=this.props,{width:t}=this.state;return"cluster"===e?t>950?115:t>450?150:210:t>700?115:t>450?150:180},this.getItemsPerRow=()=>{const{width:e}=this.state;return e>950?4:e>700?3:e>450?2:1},this.getSkeleton=()=>l().createElement(l().Fragment,null,l().createElement(a.Skeleton,{style:re.chartSkeleton,width:x.N.md}),l().createElement(a.Skeleton,{style:re.legendSkeleton,width:x.N.xs})),this.isDatumEmpty=e=>{let t=!1;for(const r of e.ranges)if(r.value){t=!0;break}let r=!1;for(const t of e.usage)if(t.value){r=!0;break}return!(e.limit.value||t||r)}}componentDidMount(){const{fetchReport:e,reportPathsType:t,reportType:r,reportQueryString:a}=this.props;e(t,r,a),this.observer=(0,ee.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){const{fetchReport:t,reportPathsType:r,reportType:a,reportQueryString:s}=this.props;e.reportQueryString!==this.props.reportQueryString&&t(r,a,s)}componentWillUnmount(){this.observer&&this.observer()}getChartDatum(){const{groupBy:e,report:t,intl:r,reportType:a}=this.props,s={limit:{},ranges:[],usage:[]},n=t&&t.meta&&t.meta.total,i=n&&t.meta.total.limit&&null!==t.meta.total.limit,l=Math.trunc(i?t.meta.total.limit.value:0),c=r.formatMessage(o.Z.units,{units:(0,D.ZV)(i?t.meta.total.limit.units:void 0)});if(s.limit={legend:r.formatMessage(o.Z.detailsUsageLimit,{value:l,units:c}),tooltip:r.formatMessage(o.Z.detailsUsageLimit,{value:l,units:c}),value:Math.trunc(l)},"cluster"===e||a===_.C.volume){const e=n&&t.meta.total.capacity&&null!==t.meta.total.capacity,a=Math.trunc(e?t.meta.total.capacity.value:0),i=r.formatMessage(o.Z.units,{units:(0,D.ZV)(e?t.meta.total.capacity.units:void 0)});s.ranges=[{legend:r.formatMessage(o.Z.detailsUsageCapacity,{value:a,units:i}),tooltip:r.formatMessage(o.Z.detailsUsageCapacity,{value:a,units:i}),value:Math.trunc(a)}]}const u=n&&t.meta.total.request&&null!==t.meta.total.request,p=n&&t.meta.total.usage&&null!==t.meta.total.usage,h=Math.trunc(u?t.meta.total.request.value:0),m=r.formatMessage(o.Z.units,{units:(0,D.ZV)(u?t.meta.total.request.units:void 0)}),d=Math.trunc(p?t.meta.total.usage.value:0),g=r.formatMessage(o.Z.units,{units:(0,D.ZV)(p?t.meta.total.usage.units:void 0)});return s.usage=[{legend:r.formatMessage(o.Z.detailsUsageUsage,{value:d,units:g}),tooltip:r.formatMessage(o.Z.detailsUsageUsage,{value:d,units:g}),value:Math.trunc(d)},{legend:r.formatMessage(o.Z.detailsUsageRequests,{value:h,units:m}),tooltip:r.formatMessage(o.Z.detailsUsageRequests,{value:h,units:m}),value:Math.trunc(h)}],s}getFreeSpace(){const{report:e,intl:t}=this.props,r=e&&e.meta&&e.meta.total,s=r&&e.meta.total.capacity&&null!==e.meta.total.capacity,n=r&&e.meta.total.request&&null!==e.meta.total.request,i=r&&e.meta.total.usage&&null!==e.meta.total.usage,c=Math.trunc(s?e.meta.total.capacity.value:0),u=Math.trunc(n?e.meta.total.request.value:0),p=t.formatMessage(o.Z.units,{units:(0,D.ZV)(n?e.meta.total.request.units:void 0)}),h=Math.trunc(i?e.meta.total.usage.value:0),m=t.formatMessage(o.Z.units,{units:(0,D.ZV)(i?e.meta.total.usage.units:void 0)}),d=c-u,g=c-h;let y=u>0?u/c*100:0;y>100&&(y=100-y);let v=c>h?h/c*100:0;return v>100&&(v=100-v),l().createElement(a.Grid,{hasGutter:!0},l().createElement(a.GridItem,{md:12,lg:6},l().createElement("div",null,t.formatMessage(o.Z.detailsUnusedUsageLabel)),l().createElement("div",{style:re.capacity},(0,D.bM)(g,m)),l().createElement("div",null,t.formatMessage(o.Z.detailsUnusedUnits,{percentage:(0,D.rl)(v,{minimumFractionDigits:0,maximumFractionDigits:0}),units:m}))),l().createElement(a.GridItem,{md:12,lg:6},l().createElement("div",null,t.formatMessage(o.Z.detailsUnusedRequestsLabel)),l().createElement("div",{style:re.capacity},(0,D.bM)(d,p)),l().createElement("div",null,t.formatMessage(o.Z.detailsUnusedUnits,{percentage:(0,D.rl)(y,{minimumFractionDigits:0,maximumFractionDigits:0}),units:p}))))}render(){return l().createElement("div",{className:"chartOverride",ref:this.containerRef},this.getChart())}}const se=(0,Z.X1)(((e,{reportPathsType:t,reportType:r})=>{const a=(0,Y.mB)(location.search),s=(0,V.VL)(a),o=(0,V.pe)(a),i={filter:{time_scope_units:"month",time_scope_value:-1,resolution:"monthly"},filter_by:Object.assign(Object.assign({},a&&a.filter_by&&a.filter_by),s&&{[s]:void 0}),exclude:Object.assign({},a&&a.exclude&&a.exclude),group_by:Object.assign({},s&&{[s]:o})},l=(0,n.pm)(Object.assign({},i));return{groupBy:s,report:U.ZV.selectReport(e,t,r,l),reportFetchStatus:U.ZV.selectReportFetchStatus(e,t,r,l),reportQueryString:l}})),ne={fetchReport:U.nx.fetchReport},oe=(0,c.ZP)((0,B.connect)(se,ne)(ae));var ie=r(33748),le=r(51581);const ce="placeholder";class ue extends l().Component{constructor(){super(...arguments),this.getClusterChart=e=>{const{category:t,groupBy:r,report:s,intl:i}=this.props;let c=!1;for(const t of e.cluster.showWidgetOnGroupBy)if(t===r||t===n.P&&-1!==r.indexOf(n.P)){c=!0;break}return c?l().createElement(a.Card,null,l().createElement(a.CardTitle,null,l().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},i.formatMessage(o.Z.clusters))),l().createElement(a.CardBody,null,l().createElement(C,{category:t,groupBy:e.cluster.reportGroupBy,report:s}))):ce},this.getCostChart=e=>{const{report:t,intl:r}=this.props;return l().createElement(a.Card,null,l().createElement(a.CardTitle,null,l().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},r.formatMessage(o.Z.breakdownCostBreakdownTitle),l().createElement(a.Popover,{"aria-label":r.formatMessage(o.Z.breakdownCostBreakdownAriaLabel),enableFlip:!0,bodyContent:l().createElement(l().Fragment,null,l().createElement("p",{style:ie.W.infoTitle},r.formatMessage(o.Z.rawCostTitle)),l().createElement("p",null,r.formatMessage(o.Z.rawCostDescription)),l().createElement("br",null),l().createElement("p",{style:ie.W.infoTitle},r.formatMessage(o.Z.usageCostTitle)),l().createElement("p",null,r.formatMessage(o.Z.usageCostDescription)),l().createElement("br",null),l().createElement("p",{style:ie.W.infoTitle},r.formatMessage(o.Z.markupTitle)),l().createElement("p",null,r.formatMessage(o.Z.markupDescription)),l().createElement("br",null),l().createElement("a",{href:r.formatMessage(o.Z.docsCostModelTerminology),rel:"noreferrer",target:"_blank"},r.formatMessage(o.Z.learnMore)))},l().createElement(a.Button,{variant:a.ButtonVariant.plain},l().createElement(s.iC,{style:ie.W.info}))))),l().createElement(a.CardBody,null,l().createElement(w,{name:e.chartName,report:t})))},this.getCpuUsageChart=e=>{const{intl:t}=this.props;return l().createElement(a.Card,null,l().createElement(a.CardTitle,null,l().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},t.formatMessage(o.Z.cpuTitle))),l().createElement(a.CardBody,null,l().createElement(oe,{name:e.chartName,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getMemoryUsageChart=e=>{const{intl:t}=this.props;return l().createElement(a.Card,null,l().createElement(a.CardTitle,null,l().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},t.formatMessage(o.Z.memoryTitle))),l().createElement(a.CardBody,null,l().createElement(oe,{name:e.chartName,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getSummaryCard=e=>{const{category:t,costType:r,currency:a,groupBy:s,query:o}=this.props;let i=!1;if(e.reportSummary.showWidgetOnGroupBy)for(const t of e.reportSummary.showWidgetOnGroupBy)if(t===s||o&&o.group_by&&o.group_by[n.dV]||t===n.P&&s&&-1!==s.indexOf(n.P)){i=!0;break}if(!i&&e.reportSummary.showWidgetOnCategory)for(const r of e.reportSummary.showWidgetOnCategory)if(r===t){i=!0;break}return i?l().createElement(J,{category:t,costType:r,currency:a,reportGroupBy:e.reportSummary.reportGroupBy,reportPathsType:e.reportPathsType,reportType:e.reportType}):e.reportSummary.usePlaceholder?ce:null},this.getVolumeUsageChart=e=>{const{intl:t}=this.props;return l().createElement(a.Card,null,l().createElement(a.CardTitle,null,l().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},t.formatMessage(o.Z.volumeTitle))),l().createElement(a.CardBody,null,l().createElement(oe,{name:e.chartName,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getWidgetsColumns=()=>{const{selectWidgets:e,widgets:t}=this.props,r=[];t.map((t=>{const a=e[t],s=this.renderWidget(a);null!==s&&r.push(s)}));const a=Math.floor(r.length/2)+r.length%2,s=[],n=[];for(let e=0;e<a;e++)r[e]!==ce&&s.push(r[e]),e+a<r.length&&r[e+a]!==ce&&n.push(r[e+a]);return{leftColumnWidgets:s,rightColumnWidgets:n}}}renderWidget(e){switch(e.type){case le.S.cluster:return this.getClusterChart(e);case le.S.cost:return this.getCostChart(e);case le.S.cpuUsage:return this.getCpuUsageChart(e);case le.S.memoryUsage:return this.getMemoryUsageChart(e);case le.S.reportSummary:return this.getSummaryCard(e);case le.S.volumeUsage:return this.getVolumeUsageChart(e);default:return null}}render(){const{leftColumnWidgets:e,rightColumnWidgets:t}=this.getWidgetsColumns();return l().createElement(a.Grid,{hasGutter:!0},l().createElement(a.GridItem,{lg:12,xl:6},l().createElement(a.Grid,{hasGutter:!0},e.map(((e,t)=>l().createElement(a.GridItem,{key:`widget-${t}`},e))))),l().createElement(a.GridItem,{lg:12,xl:6},l().createElement(a.Grid,{hasGutter:!0},t.map(((e,t)=>l().createElement(a.GridItem,{key:`widget-${t}`},e))))))}}const pe=(0,c.ZP)(ue)},90302:(e,t,r)=>{r.d(t,{W:()=>l});var a=r(49382),s=r(12289),n=r(40794),o=r(11331),i=r(43789);const l={costColumn:{textAlign:"right"},defaultLabel:{minWidth:"63px"},emptyState:{backgroundColor:a.ZP.value,display:"flex",justifyContent:"center",paddingTop:o.ZP.value,height:"35vh",width:"100%"},infoArrow:{position:"relative"},infoArrowDesc:{bottom:i.ZP.value},infoDescription:{color:s.ZP.value,fontSize:n.ZP.value},nameColumn:{width:"1%"}}},90569:(e,t,r)=>{r.d(t,{w:()=>d});var a=r(54653),s=r(52636),n=r(14844),o=r(79112),i=r(97027),l=r(92950),c=r.n(l),u=r(74806),p=r(92165),h=r(90302);class m extends c().Component{constructor(e){super(e),this.getEmptyState=()=>{const{intl:e}=this.props,t=(0,o.mB)(location.search);if(t.filter_by)for(const e of Object.values(t.filter_by))if("*"!==e)return c().createElement(p.c,{filter:e,showMargin:!1});return c().createElement(a.EmptyState,null,c().createElement(a.EmptyStateIcon,{icon:s.Xk}),c().createElement(a.EmptyStateBody,null,e.formatMessage(i.Z.detailsEmptyState)))},this.getSortBy=e=>{const{columns:t}=this.props,r=t[e].orderBy,a=(0,o.mB)(location.search),s=a&&a.order_by&&a.order_by[r];return s?{index:e,direction:s}:{}},this.getSortParams=e=>({sortBy:this.getSortBy(e),onSort:this.handleOnSort,columnIndex:e}),this.handleOnSelect=(e,t,r)=>{const{onSelected:a,rows:s}=this.props;let n,o=[];-1===r?n=s.map((e=>(e.selected=t,e))):(n=[...s],n[r].selected=t,o=[n[r].item]),this.setState({rows:s},(()=>{a&&a(o,t)}))},this.handleOnSort=(e,t,r)=>{const{columns:a,onSort:s}=this.props;s&&s(a[t].orderBy,r===n.SortByDirection.asc)},this.handleOnSelect=this.handleOnSelect.bind(this),this.handleOnSort=this.handleOnSort.bind(this)}render(){const{columns:e,intl:t,isLoading:r,rows:s}=this.props;return c().createElement(c().Fragment,null,c().createElement(n.TableComposable,{"aria-label":t.formatMessage(i.Z.dataTableAriaLabel),gridBreakPoint:"grid-2xl"},c().createElement(n.Thead,null,c().createElement(n.Tr,null,e.map(((e,t)=>c().createElement(n.Th,{key:`col-${t}-${e.value}`,modifier:"nowrap",sort:e.isSortable?this.getSortParams(t):void 0,style:e.style},e.name))))),c().createElement(n.Tbody,null,r?c().createElement(n.Tr,null,c().createElement(n.Td,{colSpan:100},c().createElement(a.Bullseye,null,c().createElement("div",{style:{textAlign:"center"}},c().createElement(a.Spinner,{size:"xl"}))))):s.map(((t,r)=>c().createElement(n.Tr,{key:`row-${r}`},t.cells.map(((a,s)=>0===s?c().createElement(n.Td,{dataLabel:e[s].name,key:`cell-${s}-${r}`,modifier:"nowrap",select:{disable:t.selectionDisabled,isSelected:t.selected,onSelect:(e,t)=>this.handleOnSelect(e,t,r),rowIndex:r}}):c().createElement(n.Td,{dataLabel:e[s].name,key:`cell-${r}-${s}`,modifier:"nowrap",isActionCell:s===t.cells.length-1},a.value)))))))),Boolean(0===s.length)&&c().createElement("div",{style:h.W.emptyState},this.getEmptyState()))}}const d=(0,u.ZP)(m)},87935:(e,t,r)=>{r.d(t,{f:()=>ge});var a=r(54653),s=r(6456),n=r(97027),o=r(92950),i=r.n(o),l=r(74806),c=r(41829),u=r(39333),p=r(78741),h=r(60553),m=r(21094),d=r(2311),g=r(80469),y=r(84154),v=r(48629),f=r(52109),b=r(2370),C=r(55855),T=r(58395),S=r(45351),E=r(43902),O=r(27765),Z=r(19960),D=r(84076),x=r(18131),P=r(24656),L=r(84615),R=r(70698),k=r(72021),M=r(21768),w=r(41534),B=r(98499),j=r(48196);const _={currentCapacityData:{fill:"none"},currentColorScale:[M.CH.value,k.R0.value,R.t6.value,L.S7.value,w.iM.value],currentInfrastructureCostData:{fill:"none",strokeDasharray:"3,3"},currentCostData:{fill:"none"},itemsPerRow:0,previousCapacityData:{fill:"none"},previousColorScale:[O.O6.value,Z.OS.value,D.iY.value,x.cQ.value,P.DD.value],previousInfrastructureCostData:{fill:"none",strokeDasharray:"3,3"},previousCostData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},V={chart:{marginTop:j.S1.value},title:{marginLeft:"-"+B.Js.value}};class U extends i().Component{constructor(){super(...arguments),this.containerRef=i().createRef(),this.observer=E.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentCostData:e,previousCostData:t}=this.props,r=n.Z.chartCostLegendLabel,a=n.Z.chartCostLegendTooltip,s=[{childName:"previousCost",data:t,legendItem:{name:(0,h.uL)(t,r,!0,!0,1,n.Z.chartCostLegendNoDataLabel),symbol:{fill:_.previousColorScale[0],type:"minus"},tooltip:(0,h.ml)(t,a,!1,!1,1)},style:{data:Object.assign(Object.assign({},_.previousCostData),{stroke:_.previousColorScale[0]})}},{childName:"currentCost",data:e,legendItem:{name:(0,h.uL)(e,r,!0,!1,0,n.Z.chartCostLegendNoDataLabel),symbol:{fill:_.currentColorScale[0],type:"minus"},tooltip:(0,h.ml)(e,a,!1,!1)},style:{data:Object.assign(Object.assign({},_.currentCostData),{stroke:_.currentColorScale[0]})}}],o=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:o,series:s})},this.getChart=(e,t)=>{const{hiddenSeries:r}=this.state;return i().createElement(m.A,{data:r.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatter:e,formatOptions:t}=this.props,r=(0,d.f)("voronoi","cursor");return i().createElement(r,{cursorDimension:"x",labels:({datum:r})=>(0,S.zj)(r,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:120,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e,name:t=""}=this.props,{hiddenSeries:r,series:a,width:s}=this.state,n=e||(s>725?_.itemsPerRow:2);return i().createElement(g.Qk,{data:(0,S.oX)(a,r),height:25,gutter:20,itemsPerRow:n,name:`${t}-legend`})},this.handleLegendClick=e=>{const t=(0,S.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,S.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentCostData===this.props.currentCostData&&e.currentInfrastructureCostData===this.props.currentInfrastructureCostData&&e.previousCostData===this.props.previousCostData&&e.previousInfrastructureCostData===this.props.previousInfrastructureCostData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentInfrastructureCostData:e,previousInfrastructureCostData:t}=this.props,r=e?(0,C.Z)((0,h.Y_)(e,!0,!0)[1]):0,a=t?(0,C.Z)((0,h.Y_)(t,!0,!0)[1]):0;return r>0||a>0?Math.max(r,a):31}getEvents(){const{name:e=""}=this.props,{hiddenSeries:t,series:r}=this.state;return(0,y.u)({chartNames:(0,S.bC)(r),isHidden:e=>(0,S.Yt)(t,e),legendName:`${e}-legend`,onLegendClick:e=>this.handleLegendClick(e.index)})}render(){const{adjustContainerHeight:e,height:t,containerHeight:r=t,intl:s,name:o,padding:l={bottom:120,left:8,right:8,top:8},title:c,xAxisLabel:u,yAxisLabel:p}=this.props,{cursorVoronoiContainer:h,hiddenSeries:m,series:d,width:g}=this.state,y=(0,S.ge)(d,m),C=this.getEndDate(),E=Math.floor(C/2),O=e&&g>725?r-25:r,Z=h?i().cloneElement(h,{disable:!(0,S.TW)(d,m),labelComponent:i().createElement(v.M,{legendData:(0,S.oX)(d,m,!0),title:e=>s.formatMessage(n.Z.chartDayOfTheMonth,{day:e.x})})}):void 0;return i().createElement("div",{className:"chartOverride",ref:this.containerRef},i().createElement(a.Title,{headingLevel:"h2",style:V.title,size:a.TitleSizes.xl},c),i().createElement("div",{style:Object.assign(Object.assign({},V.chart),{height:O})},i().createElement("div",{style:{height:t,width:g},"data-testid":"historical-chart-wrapper"},i().createElement(f.k,{containerComponent:Z,domain:y,events:this.getEvents(),height:t,legendComponent:this.getLegend(),legendData:(0,S.oX)(d,m),legendPosition:"bottom",name:o,padding:l,theme:T.Z,width:g},d&&d.map(((e,t)=>this.getChart(e,t))),i().createElement(b.C,{label:u,style:_.xAxis,tickValues:[1,E,C]}),i().createElement(b.C,{dependentAxis:!0,label:p,style:_.yAxis})))))}}const F=(0,l.ZP)(U);var N=r(37269),I=r(1156),Q=r(68091),z=r(91778),A=r(20513),q=r(11331),W=r(32412);const G={chartContainer:{marginLeft:B.ZP.value},chartSkeleton:{height:"125px",marginBottom:W.ZP.value,marginTop:q.ZP.value},costChart:{marginBottom:j.ZP.value,marginTop:j.ZP.value},legendSkeleton:{marginTop:W.ZP.value},trendChart:{marginBottom:j.ZP.value,marginTop:j.ZP.value},usageChart:{marginTop:j.ZP.value}};class $ extends i().Component{constructor(){super(...arguments),this.getSkeleton=()=>i().createElement(i().Fragment,null,i().createElement(a.Skeleton,{style:G.chartSkeleton,width:A.N.md}),i().createElement(a.Skeleton,{style:G.legendSkeleton,width:A.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:r,reportPathsType:a,reportType:s}=this.props;e(a,s,t),e(a,s,r)}componentDidUpdate(e){const{fetchReport:t,costType:r,currency:a,currentQueryString:s,previousQueryString:n,reportPathsType:o,reportType:i}=this.props;e.currentQueryString===s&&e.costType===r&&e.currency===a||t(o,i,s),e.previousQueryString===n&&e.costType===r&&e.currency===a||t(o,i,n)}render(){const{chartName:e,currentReport:t,currentReportFetchStatus:r,previousReport:a,previousReportFetchStatus:s,intl:o}=this.props,l=(0,h.zJ)(t,h.yZ.cumulative,"date","cost"),c=(0,h.zJ)(t,h.yZ.cumulative,"date","infrastructure"),u=(0,h.zJ)(a,h.yZ.cumulative,"date","cost"),p=(0,h.zJ)(a,h.yZ.cumulative,"date","infrastructure"),m=t&&t.meta&&t.meta.total&&t.meta.total.cost?t.meta.total.cost.total.units:"USD",d=o.formatMessage(n.Z.currencyUnits,{units:m});return i().createElement("div",{style:G.chartContainer},i().createElement("div",{style:G.costChart},r===I.iF.inProgress&&s===I.iF.inProgress?this.getSkeleton():i().createElement(F,{adjustContainerHeight:!0,containerHeight:275,currentCostData:l,currentInfrastructureCostData:c,formatOptions:{},formatter:z.bM,height:300,name:e,previousCostData:u,previousInfrastructureCostData:p,xAxisLabel:o.formatMessage(n.Z.historicalChartDayOfMonthLabel),yAxisLabel:o.formatMessage(n.Z.historicalChartCostLabel,{units:d})})))}}const H=(0,I.X1)(((e,{costType:t,currency:r,reportPathsType:a,reportType:s})=>{const n=(0,u.mB)(location.search),o=(0,N.VL)(n),i=(0,N.pe)(n),l={filter_by:Object.assign(Object.assign({},n&&n.filter_by&&n.filter_by),o&&{[o]:void 0}),exclude:Object.assign({},n&&n.exclude&&n.exclude),group_by:Object.assign({},o&&{[o]:i})},c=Object.assign(Object.assign({},l),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),p=(0,u.pm)(Object.assign(Object.assign({},c),{cost_type:t,currency:r})),h=Object.assign(Object.assign({},l),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),m=(0,u.pm)(Object.assign(Object.assign({},h),{cost_type:t,currency:r}));return{currentQuery:c,currentQueryString:p,currentReport:Q.ZV.selectReport(e,a,s,p),currentReportFetchStatus:Q.ZV.selectReportFetchStatus(e,a,s,p),previousQuery:h,previousQueryString:m,previousReport:Q.ZV.selectReport(e,a,s,m),previousReportFetchStatus:Q.ZV.selectReportFetchStatus(e,a,s,m)}})),X={fetchReport:Q.nx.fetchReport},J=(0,l.ZP)((0,p.connect)(H,X)($)),K={currentColorScale:[M.CH.value,k.R0.value,R.t6.value,L.S7.value,w.iM.value],currentMonthData:{fill:"none"},itemsPerRow:0,previousColorScale:[O.O6.value,Z.OS.value,D.iY.value,x.cQ.value,P.DD.value],previousMonthData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},Y={chart:{marginTop:j.S1.value},title:{marginLeft:"-"+B.Js.value}};class ee extends i().Component{constructor(){super(...arguments),this.containerRef=i().createRef(),this.observer=E.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentData:e,previousData:t,showUsageLegendLabel:r=!1}=this.props,a=r?n.Z.chartUsageLegendLabel:n.Z.chartCostLegendLabel,s=r?n.Z.chartUsageLegendTooltip:n.Z.chartCostLegendTooltip,o=[{childName:"previousCost",data:t,legendItem:{name:(0,h.uL)(t,a,!0,!0,1,n.Z.chartUsageLegendNoDataLabel),symbol:{fill:K.previousColorScale[0],type:"minus"},tooltip:(0,h.ml)(t,s,!1,!1,1)},style:{data:Object.assign(Object.assign({},K.previousMonthData),{stroke:K.previousColorScale[0]})}},{childName:"currentCost",data:e,legendItem:{name:(0,h.uL)(e,a,!0,!1,0,n.Z.chartUsageLegendNoDataLabel),symbol:{fill:K.currentColorScale[1],type:"minus"},tooltip:(0,h.ml)(e,s,!1,!1)},style:{data:Object.assign(Object.assign({},K.currentMonthData),{stroke:K.currentColorScale[1]})}}],i=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:i,series:o})},this.getChart=(e,t)=>{const{hiddenSeries:r}=this.state;return i().createElement(m.A,{data:r.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatter:e,formatOptions:t}=this.props,r=(0,d.f)("voronoi","cursor");return i().createElement(r,{cursorDimension:"x",labels:({datum:r})=>(0,S.zj)(r,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:120,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e,name:t=""}=this.props,{hiddenSeries:r,series:a}=this.state;return i().createElement(g.Qk,{data:(0,S.oX)(a,r),height:25,gutter:20,itemsPerRow:e,name:`${t}-legend`})},this.handleLegendClick=e=>{const t=(0,S.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,S.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentData===this.props.currentData&&e.previousData===this.props.previousData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentData:e,previousData:t}=this.props,r=t?(0,C.Z)((0,h.Y_)(t,!0,!0)[1]):0,a=e?(0,C.Z)((0,h.Y_)(e,!0,!0)[1]):0;return a>0||r>0?Math.max(a,r):31}getEvents(){const{name:e=""}=this.props,{hiddenSeries:t,series:r}=this.state;return(0,y.u)({chartNames:(0,S.bC)(r),isHidden:e=>(0,S.Yt)(t,e),legendName:`${e}-legend`,onLegendClick:e=>this.handleLegendClick(e.index)})}render(){const{height:e,containerHeight:t=e,intl:r,name:s,padding:o={bottom:120,left:8,right:8,top:8},title:l,xAxisLabel:c,yAxisLabel:u}=this.props,{cursorVoronoiContainer:p,hiddenSeries:h,series:m,width:d}=this.state,g=(0,S.ge)(m,h),y=this.getEndDate(),C=Math.floor(y/2),E=p?i().cloneElement(p,{disable:!(0,S.TW)(m,h),labelComponent:i().createElement(v.M,{legendData:(0,S.oX)(m,h,!0),title:e=>r.formatMessage(n.Z.chartDayOfTheMonth,{day:e.x})})}):void 0;return i().createElement("div",{className:"chartOverride",ref:this.containerRef},i().createElement(a.Title,{headingLevel:"h2",style:Y.title,size:a.TitleSizes.xl},l),i().createElement("div",{style:Object.assign(Object.assign({},Y.chart),{height:t})},i().createElement("div",{style:{height:e,width:d},"data-testid":"historical-chart-wrapper"},i().createElement(f.k,{containerComponent:E,domain:g,events:this.getEvents(),height:e,legendComponent:this.getLegend(),legendData:(0,S.oX)(m,h),legendPosition:"bottom",name:s,padding:o,theme:T.Z,width:d},m&&m.map(((e,t)=>this.getChart(e,t))),i().createElement(b.C,{label:c,style:K.xAxis,tickValues:[1,C,y]}),i().createElement(b.C,{dependentAxis:!0,label:u,style:K.yAxis})))))}}const te=(0,l.ZP)(ee);class re extends i().Component{constructor(){super(...arguments),this.getSkeleton=()=>i().createElement(i().Fragment,null,i().createElement(a.Skeleton,{style:G.chartSkeleton,width:A.N.md}),i().createElement(a.Skeleton,{style:G.legendSkeleton,width:A.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:r,reportPathsType:a,reportType:s}=this.props;e(a,s,t),e(a,s,r)}componentDidUpdate(e){const{fetchReport:t,costType:r,currency:a,currentQueryString:s,previousQueryString:n,reportPathsType:o,reportType:i}=this.props;e.currentQueryString===s&&e.costType===r&&e.currency===a||t(o,i,s),e.previousQueryString===n&&e.costType===r&&e.currency===a||t(o,i,n)}render(){const{chartName:e,currentReport:t,currentReportFetchStatus:r,previousReport:a,previousReportFetchStatus:o,reportType:l,intl:c}=this.props,u=l===s.C.cost,p=(0,h.zJ)(t,u?h.yZ.cumulative:h.yZ.rolling,"date",u?"cost":"usage"),m=(0,h.zJ)(a,u?h.yZ.cumulative:h.yZ.rolling,"date",u?"cost":"usage"),d=t&&t.meta&&t.meta.total&&t.meta.total.cost?t.meta.total.cost.total.units:"USD",g=t&&t.meta&&t.meta.total&&t.meta.total.usage?t.meta.total.usage.units:void 0;let y;if(u){const e=c.formatMessage(n.Z.currencyUnits,{units:d});y=c.formatMessage(n.Z.historicalChartCostLabel,{units:e})}else if(g&&Number.isNaN(Number(t.meta.total.usage.units)))y=c.formatMessage(n.Z.units,{units:(0,z.ZV)(g)});else{const e=c.formatMessage(n.Z.historicalChartUsageLabel,{value:l});y=c.formatMessage(n.Z.units,{units:(0,z.ZV)(e)})}return i().createElement("div",{style:G.chartContainer},i().createElement("div",{style:G.trendChart},r===I.iF.inProgress&&o===I.iF.inProgress?this.getSkeleton():i().createElement(te,{containerHeight:250,currentData:p,formatOptions:{},formatter:z.bM,height:300,name:e,previousData:m,units:u?d:g,xAxisLabel:c.formatMessage(n.Z.historicalChartDayOfMonthLabel),yAxisLabel:y})))}}const ae=(0,I.X1)(((e,{costType:t,currency:r,reportPathsType:a,reportType:s})=>{const n=(0,u.mB)(location.search),o=(0,N.OA)(n),i=o?u.dV:(0,N.VL)(n),l=o||(0,N.pe)(n),c={filter_by:Object.assign(Object.assign(Object.assign({},n&&n.filter_by&&n.filter_by),n&&n.filter&&n.filter.account&&{[`${u.Sq}account`]:n.filter.account}),i&&{[i]:void 0}),exclude:Object.assign({},n&&n.exclude&&n.exclude),group_by:Object.assign({},i&&{[i]:l})},p=Object.assign(Object.assign({},c),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),h=(0,u.pm)(Object.assign(Object.assign({},p),{cost_type:t,currency:r})),m=Object.assign(Object.assign({},c),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),d=(0,u.pm)(Object.assign(Object.assign({},m),{cost_type:t,currency:r}));return{currentQuery:p,currentQueryString:h,currentReport:Q.ZV.selectReport(e,a,s,h),currentReportFetchStatus:Q.ZV.selectReportFetchStatus(e,a,s,h),previousQuery:m,previousQueryString:d,previousReport:Q.ZV.selectReport(e,a,s,d),previousReportFetchStatus:Q.ZV.selectReportFetchStatus(e,a,s,d)}})),se={fetchReport:Q.nx.fetchReport},ne=(0,l.ZP)((0,p.connect)(ae,se)(re)),oe={currentCapacityData:{fill:"none"},currentColorScale:[M.CH.value,k.R0.value,R.t6.value,L.S7.value,w.iM.value],currentLimitData:{fill:"none"},currentRequestData:{fill:"none",strokeDasharray:"3,3"},currentUsageData:{fill:"none"},itemsPerRow:0,previousCapacityData:{fill:"none"},previousColorScale:[O.O6.value,Z.OS.value,D.iY.value,x.cQ.value,P.DD.value],previousLimitData:{fill:"none"},previousRequestData:{fill:"none",strokeDasharray:"3,3"},previousUsageData:{fill:"none"},yAxis:{axisLabel:{padding:15},grid:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{fontSize:0}},xAxis:{axisLabel:{padding:40},grid:{stroke:"none"},ticks:{stroke:"none"}}},ie={chart:{marginTop:j.S1.value},title:{marginLeft:"-"+B.Js.value}};class le extends i().Component{constructor(){super(...arguments),this.containerRef=i().createRef(),this.observer=E.Z,this.state={hiddenSeries:new Set,width:0},this.initDatum=()=>{const{currentLimitData:e,currentRequestData:t,currentUsageData:r,previousLimitData:a,previousRequestData:s,previousUsageData:o}=this.props,i=n.Z.chartLimitLegendLabel,l=n.Z.chartLimitLegendTooltip,c=n.Z.chartRequestsLegendLabel,u=n.Z.chartRequestsLegendTooltip,p=n.Z.chartUsageLegendLabel,m=n.Z.chartUsageLegendTooltip,d=[{childName:"previousUsage",data:o,legendItem:{name:(0,h.Fs)(o,p,!0,!0,1,n.Z.chartUsageLegendNoDataLabel),symbol:{fill:oe.previousColorScale[0],type:"minus"},tooltip:(0,h.I6)(o,m,!1,!1,1)},style:{data:Object.assign(Object.assign({},oe.previousUsageData),{stroke:oe.previousColorScale[0]})}},{childName:"currentUsage",data:r,legendItem:{name:(0,h.Fs)(r,p,!0,!1,0,n.Z.chartUsageLegendNoDataLabel),symbol:{fill:oe.currentColorScale[0],type:"minus"},tooltip:(0,h.I6)(r,m,!1,!1)},style:{data:Object.assign(Object.assign({},oe.currentUsageData),{stroke:oe.currentColorScale[0]})}},{childName:"previousRequest",data:s,legendItem:{name:(0,h.Fs)(s,c,!0,!0,1,n.Z.chartRequestsLegendNoDataLabel),symbol:{fill:oe.previousColorScale[1],type:"dash"},tooltip:(0,h.I6)(s,u,!1,!1,1)},style:{data:Object.assign(Object.assign({},oe.previousRequestData),{stroke:oe.previousColorScale[1]})}},{childName:"currentRequest",data:t,legendItem:{name:(0,h.Fs)(t,c,!0,!1,0,n.Z.chartRequestsLegendNoDataLabel),symbol:{fill:oe.currentColorScale[1],type:"dash"},tooltip:(0,h.I6)(t,u,!1,!1)},style:{data:Object.assign(Object.assign({},oe.currentRequestData),{stroke:oe.currentColorScale[1]})}},{childName:"previousLimit",data:a,legendItem:{name:(0,h.Fs)(a,i,!0,!0,1,n.Z.chartLimitLegendNoDataLabel),symbol:{fill:oe.previousColorScale[2],type:"minus"},tooltip:(0,h.I6)(a,l,!1,!1,1)},style:{data:Object.assign(Object.assign({},oe.previousLimitData),{stroke:oe.previousColorScale[2]})}},{childName:"currentLimit",data:e,legendItem:{name:(0,h.Fs)(e,i,!0,!1,0,n.Z.chartLimitLegendNoDataLabel),symbol:{fill:oe.currentColorScale[2],type:"minus"},tooltip:(0,h.I6)(e,l,!1,!1)},style:{data:Object.assign(Object.assign({},oe.currentLimitData),{stroke:oe.currentColorScale[2]})}}],g=this.getCursorVoronoiContainer();this.setState({cursorVoronoiContainer:g,series:d})},this.getChart=(e,t)=>{const{hiddenSeries:r}=this.state;return i().createElement(m.A,{data:r.has(t)?[{y:null}]:e.data,interpolation:"monotoneX",key:e.childName,name:e.childName,style:e.style})},this.getCursorVoronoiContainer=()=>{const{formatter:e,formatOptions:t}=this.props,r=(0,d.f)("voronoi","cursor");return i().createElement(r,{cursorDimension:"x",labels:({datum:r})=>(0,S.zj)(r,e,t),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:{bottom:130,left:8,right:8,top:8}})},this.getLegend=()=>{const{legendItemsPerRow:e,name:t=""}=this.props,{hiddenSeries:r,series:a,width:s}=this.state,n=e||(s>925?oe.itemsPerRow:2);return i().createElement(g.Qk,{data:(0,S.oX)(a,r),height:25,gutter:20,itemsPerRow:n,name:`${t}-legend`})},this.handleLegendClick=e=>{const t=(0,S.nV)(this.state.series,this.state.hiddenSeries,e);this.setState({hiddenSeries:t})},this.handleResize=()=>{const{width:e}=this.state,{clientWidth:t=0}=this.containerRef.current||{};t!==e&&this.setState({width:t})}}componentDidMount(){this.initDatum(),this.observer=(0,S.pP)(this.containerRef.current,this.handleResize)}componentDidUpdate(e){e.currentLimitData===this.props.currentLimitData&&e.currentRequestData===this.props.currentRequestData&&e.currentUsageData===this.props.currentUsageData&&e.previousLimitData===this.props.previousLimitData&&e.previousRequestData===this.props.previousRequestData&&e.previousUsageData===this.props.previousUsageData||this.initDatum()}componentWillUnmount(){this.observer&&this.observer()}getEndDate(){const{currentRequestData:e,currentUsageData:t,previousRequestData:r,previousUsageData:a}=this.props,s=e?(0,C.Z)((0,h.Y_)(e,!0,!0)[1]):0,n=t?(0,C.Z)((0,h.Y_)(t,!0,!0)[1]):0,o=r?(0,C.Z)((0,h.Y_)(r,!0,!0)[1]):0,i=a?(0,C.Z)((0,h.Y_)(a,!0,!0)[1]):0;return s>0||n>0||o>0||i>0?Math.max(s,n,o,i):31}getEvents(){const{name:e=""}=this.props,{hiddenSeries:t,series:r}=this.state;return(0,y.u)({chartNames:(0,S.bC)(r),isHidden:e=>(0,S.Yt)(t,e),legendName:`${e}-legend`,onLegendClick:e=>this.handleLegendClick(e.index)})}render(){const{adjustContainerHeight:e,height:t,containerHeight:r=t,intl:s,name:o,padding:l={bottom:130,left:8,right:8,top:8},title:c,xAxisLabel:u,yAxisLabel:p}=this.props,{cursorVoronoiContainer:h,hiddenSeries:m,series:d,width:g}=this.state,y=(0,S.ge)(d,m),C=this.getEndDate(),E=Math.floor(C/2),O=e&&g>925?r-50:r,Z=h?i().cloneElement(h,{disable:!(0,S.TW)(d,m),labelComponent:i().createElement(v.M,{legendData:(0,S.oX)(d,m,!0),title:e=>s.formatMessage(n.Z.chartDayOfTheMonth,{day:e.x})})}):void 0;return i().createElement("div",{className:"chartOverride",ref:this.containerRef},i().createElement(a.Title,{headingLevel:"h2",style:ie.title,size:a.TitleSizes.xl},c),i().createElement("div",{style:Object.assign(Object.assign({},ie.chart),{height:O})},i().createElement("div",{style:{height:t,width:g},"data-testid":"historical-chart-wrapper"},i().createElement(f.k,{containerComponent:Z,domain:y,events:this.getEvents(),height:t,legendComponent:this.getLegend(),legendData:(0,S.oX)(d,m),legendPosition:"bottom",name:o,padding:l,theme:T.Z,width:g},d&&d.map(((e,t)=>this.getChart(e,t))),i().createElement(b.C,{label:u,style:oe.xAxis,tickValues:[1,E,C]}),i().createElement(b.C,{dependentAxis:!0,label:p,style:oe.yAxis})))))}}const ce=(0,l.ZP)(le);class ue extends i().Component{constructor(){super(...arguments),this.getSkeleton=()=>i().createElement(i().Fragment,null,i().createElement(a.Skeleton,{style:G.chartSkeleton,width:A.N.md}),i().createElement(a.Skeleton,{style:G.legendSkeleton,width:A.N.xs}))}componentDidMount(){const{fetchReport:e,currentQueryString:t,previousQueryString:r,reportPathsType:a,reportType:s}=this.props;e(a,s,t),e(a,s,r)}componentDidUpdate(e){const{fetchReport:t,currentQueryString:r,previousQueryString:a,reportPathsType:s,reportType:n}=this.props;e.currentQueryString!==r&&t(s,n,r),e.previousQueryString!==a&&t(s,n,a)}render(){const{chartName:e,currentReport:t,currentReportFetchStatus:r,previousReport:a,previousReportFetchStatus:s,intl:o}=this.props,l=(0,h.zJ)(t,h.yZ.rolling,"date","limit"),c=(0,h.zJ)(t,h.yZ.rolling,"date","request"),u=(0,h.zJ)(t,h.yZ.rolling,"date","usage"),p=(0,h.zJ)(a,h.yZ.rolling,"date","limit"),m=(0,h.zJ)(a,h.yZ.rolling,"date","request"),d=(0,h.zJ)(a,h.yZ.rolling,"date","usage"),g=t&&t.meta&&t.meta.total&&t.meta.total.usage?t.meta.total.usage.units:"";return i().createElement("div",{style:G.chartContainer},i().createElement("div",{style:G.usageChart},r===I.iF.inProgress&&s===I.iF.inProgress?this.getSkeleton():i().createElement(ce,{adjustContainerHeight:!0,containerHeight:300,currentLimitData:l,currentRequestData:c,currentUsageData:u,formatter:z.bM,formatOptions:{},height:300,name:e,previousLimitData:p,previousRequestData:m,previousUsageData:d,xAxisLabel:o.formatMessage(n.Z.historicalChartDayOfMonthLabel),yAxisLabel:o.formatMessage(n.Z.units,{units:(0,z.ZV)(g)})})))}}const pe=(0,I.X1)(((e,{reportPathsType:t,reportType:r})=>{const a=(0,u.mB)(location.search),n=(0,N.OA)(a),o=(0,N.VL)(a),i=(0,N.pe)(a),l=r===s.C.instanceType||r===s.C.storage,c={filter_by:Object.assign(Object.assign(Object.assign(Object.assign({},a&&a.filter_by&&a.filter_by),a&&a.filter&&a.filter.account&&{[`${u.Sq}account`]:a.filter.account}),o&&{[o]:void 0}),n&&l&&{[u.dV]:n}),exclude:Object.assign({},a&&a.exclude&&a.exclude),group_by:Object.assign(Object.assign({},n&&!l&&{[u.dV]:n}),o&&!n&&{[o]:i})},p=Object.assign(Object.assign({},c),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-1}}),h=(0,u.pm)(p),m=Q.ZV.selectReport(e,t,r,h),d=Q.ZV.selectReportFetchStatus(e,t,r,h),g=Object.assign(Object.assign({},c),{filter:{resolution:"daily",time_scope_units:"month",time_scope_value:-2}}),y=(0,u.pm)(g);return{currentQuery:p,currentQueryString:h,currentReport:m,currentReportFetchStatus:d,previousQuery:g,previousQueryString:y,previousReport:Q.ZV.selectReport(e,t,r,y),previousReportFetchStatus:Q.ZV.selectReportFetchStatus(e,t,r,y)}})),he={fetchReport:Q.nx.fetchReport},me=(0,l.ZP)((0,p.connect)(pe,he)(ue));class de extends i().Component{constructor(){super(...arguments),this.getTitleKey=(e,t)=>e===s.K.azure?t===s.C.instanceType?"virtual_machine":t:t===s.C.instanceType?"instance_type":t,this.getCostChart=e=>{const{costType:t,currency:r,intl:s}=this.props;return i().createElement(a.Card,null,i().createElement(a.CardTitle,null,i().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},s.formatMessage(n.Z.historicalChartTitle,{value:this.getTitleKey(e.reportPathsType,e.reportType)}))),i().createElement(a.CardBody,null,i().createElement(J,{chartName:e.chartName,costType:t,currency:r,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getTrendChart=e=>{const{costType:t,currency:r,intl:s}=this.props;return i().createElement(a.Card,null,i().createElement(a.CardTitle,null,i().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},s.formatMessage(n.Z.historicalChartTitle,{value:this.getTitleKey(e.reportPathsType,e.reportType)}))),i().createElement(a.CardBody,null,i().createElement(ne,{chartName:e.chartName,costType:t,currency:r,reportPathsType:e.reportPathsType,reportType:e.reportType})))},this.getUsageChart=e=>{const{intl:t}=this.props;return i().createElement(a.Card,null,i().createElement(a.CardTitle,null,i().createElement(a.Title,{headingLevel:"h2",size:a.TitleSizes.lg},t.formatMessage(n.Z.historicalChartTitle,{value:this.getTitleKey(e.reportPathsType,e.reportType)}))),i().createElement(a.CardBody,null,i().createElement(me,{chartName:e.chartName,reportPathsType:e.reportPathsType,reportType:e.reportType})))}}renderWidget(e){switch(e.type){case c.b.cost:return this.getCostChart(e);case c.b.trend:return this.getTrendChart(e);case c.b.usage:return this.getUsageChart(e);default:return null}}render(){const{selectWidgets:e,widgets:t}=this.props;return i().createElement(a.Grid,{hasGutter:!0},t.map((t=>{const r=e[t];return i().createElement(a.GridItem,{key:`widget-${t}`},this.renderWidget(r))})))}}const ge=(0,l.ZP)(de)},33748:(e,t,r)=>{r.d(t,{W:()=>c});var a=r(49382),s=r(33605),n=r(17918),o=r(54881),i=r(98499),l=r(48196);const c={costValue:{marginTop:i.ZP.var,marginBottom:0},costLabelUnit:{fontSize:o.ZP.value,color:s.ZP.var},dateTitle:{textAlign:"end"},header:{backgroundColor:a.ZP.var,padding:i.ZP.var},headerContent:{display:"flex",justifyContent:"space-between"},headerContentLeft:{display:"flex",minHeight:"90px"},headerContentRight:{display:"flex"},info:{verticalAlign:"middle"},infoIcon:{fontSize:n.ZP.value},infoTitle:{fontWeight:"bold"},title:{paddingBottom:l.ZP.var}}},54583:(e,t,r)=>{r.d(t,{T:()=>s,Z:()=>n});var a=r(39333);const s=({basePath:e,description:t,groupBy:r,isPlatformCosts:s,label:n})=>{const o=(0,a.mB)(location.search),i=Object.assign(Object.assign(Object.assign(Object.assign({},o),t&&t!==n&&{[a.eG]:t}),{group_by:{[r]:n}}),s&&{group_by:{[r]:["kube-","openshift-"]}});return`${e}?${(0,a.IV)(i)}`},n=({basePath:e,description:t,groupBy:r,groupByOrg:s,id:n,title:o,type:i})=>{const l=(0,a.mB)(location.search),c=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l),t&&t!==o&&{[a.eG]:t}),o&&{[a.yG]:o}),s&&{[a.dV]:s}),{group_by:{[r]:n}});return"account"===i?(c.filter||(c.filter={}),c.filter.account=n,c.group_by={[a.dV]:s}):"organizational_unit"===i&&(c.group_by={[a.dV]:n}),`${e}?${(0,a.IV)(c)}`}}}]);
//# sourceMappingURL=../sourcemaps/160.8dd6baeaa8a6078a6bfd8ff6fff60439.js.map