"use strict";(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[8141],{93562:(t,e,r)=>{r.r(e),r.d(e,{default:()=>ut});var o=r(1326),s=r(79112),i=r(84717),a=r(6456),n=r(50081),c=r(97027),p=r(92950),l=r.n(p),u=r(74806),m=r(77760),g=r(91919),d=r(55246),h=r(37269),f=r(86482),y=r(1156),b=r(78898),S=r(62331),R=r(15920),P=r(20997),O=r(15829),E=r(68025),v=r(14483),_=r(5842),j=r(67709),F=r(73903);const C=(0,y.X1)(((t,{title:e})=>({selectWidgets:F.cm.selectWidgets(t),widgets:F.cm.selectCurrentWidgets(t),title:e}))),T=(0,m.connect)(C,{})(j.X);var Z=r(87935),w=r(70982);const B=(0,y.X1)(((t,e)=>({selectWidgets:w.P2.selectWidgets(t),widgets:w.P2.selectCurrentWidgets(t)}))),D=(0,m.connect)(B,{})(Z.f);var V=r(90154),q=r(39333),x=r(52016),z=r(89256),Q=r(2136);const W=z.v.recommendations,k=z.N.ros;class M extends l().Component{constructor(){super(...arguments),this.defaultState={},this.state=Object.assign({},this.defaultState),this.updateReport=()=>{const{fetchReport:t,reportFetchStatus:e,reportQueryString:r}=this.props;e!==y.iF.inProgress&&t(W,k,r)}}componentDidMount(){this.updateReport()}render(){const{intl:t,report:e}=this.props,r=e&&e.meta?e.meta.count:0;return l().createElement(V.Badge,{screenReaderText:t.formatMessage(c.Z.optimizationsDetails,{count:r})},r)}}const N=(0,y.X1)(((t,{router:e})=>{const r=(0,x.mB)(e.location.search),o=(0,h.VL)(r),s=(0,h.pe)(r),i=Object.assign(Object.assign({},o&&{[o]:s}),{limit:r.limit||10,offset:r.offset||0}),a=(0,q.pm)(i);return{query:i,report:Q.R0.selectRos(t,W,k,a),reportError:Q.R0.selectRosError(t,W,k,a),reportFetchStatus:Q.R0.selectRosFetchStatus(t,W,k,a),reportQueryString:a}})),X={fetchReport:Q.Ze.fetchRosReport},J=(0,u.ZP)((0,_.E)((0,m.connect)(N,X)(M)));var L=r(52471),H=r(28688),I=r(47947),G=r(59454),A=r(38679),U=r(19727),K=r(14222),Y=r(10066);const $={limit:10,offset:0,order_by:"last_reported",order_how:"desc"},tt=z.N.ros,et=z.v.recommendations;class rt extends l().Component{constructor(){super(...arguments),this.defaultState={columns:[],rows:[]},this.state=Object.assign({},this.defaultState),this.getPagination=(t=!1,e=!1)=>{const{intl:r,report:o}=this.props,s=o&&o.meta?o.meta.count:0,i=o&&o.meta?o.meta.limit:$.limit,a=o&&o.meta?o.meta.offset:$.offset,n=Math.trunc(a/i+1);return l().createElement(V.Pagination,{isCompact:!e,isDisabled:t,itemCount:s,onPerPageSelect:(t,e)=>this.handlePerPageSelect(e),onSetPage:(t,e)=>this.handleSetPage(e),page:n,perPage:i,titles:{paginationTitle:r.formatMessage(c.Z.paginationTitle,{title:r.formatMessage(c.Z.openShift),placement:e?"bottom":"top"})},variant:e?V.PaginationVariant.bottom:V.PaginationVariant.top,widgetId:"exports-pagination"+(e?"-bottom":"")})},this.getTable=()=>{const{query:t,report:e,reportFetchStatus:r,reportQueryString:o,router:s}=this.props;return l().createElement(G.Hy,{isLoading:r===y.iF.inProgress,onSort:(e,r)=>(0,U.yB)(t,s,e,r),report:e,reportQueryString:o})},this.getToolbar=()=>{const{query:t,report:e,router:r}=this.props,o=e&&e.meta?e.meta.limit:0,s=e&&e.meta?e.meta.count:0,i=0===s;return l().createElement(G.IH,{isDisabled:i,itemsPerPage:o,itemsTotal:s,onFilterAdded:e=>(0,U.$3)(t,r,e),onFilterRemoved:e=>(0,U.q7)(t,r,e),pagination:this.getPagination(i),query:t})},this.handlePerPageSelect=t=>{const{query:e,router:r}=this.props,o=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{limit:t}),s=(0,Y.Z)(o,r.location,!0);r.navigate(s,{replace:!0})},this.handleSetPage=t=>{const{query:e,report:r,router:o}=this.props,s=r&&r.meta&&r.meta.limit?r.meta.limit:$.limit,i=t*s-1,a=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{limit:s,offset:i}),n=(0,Y.Z)(a,o.location);o.navigate(n,{replace:!0})},this.updateReport=()=>{const{fetchRosReport:t,reportFetchStatus:e,reportQueryString:r}=this.props;e!==y.iF.inProgress&&t(et,tt,r)}}componentDidMount(){this.updateReport()}componentDidUpdate(t){const{report:e,reportError:r,reportQueryString:o,router:s}=this.props,i=t.reportQueryString!==o,a=!e&&!r,n=!s.location.search;(i||a||n)&&this.updateReport()}render(){const{intl:t,report:e,reportError:r,reportFetchStatus:o}=this.props,s=0===(e&&e.meta?e.meta.count:0),i=t.formatMessage(c.Z.optimizations),a=e&&e.meta&&e.meta.count>0;return r?l().createElement(I.W,{title:i}):a||o!==y.iF.complete?l().createElement("div",{style:A.W.optimizationsContainer},this.getToolbar(),o===y.iF.inProgress?l().createElement(L.g,null):l().createElement(l().Fragment,null,this.getTable(),l().createElement("div",{style:A.W.pagination},this.getPagination(s,!0)))):l().createElement(H.Y,null)}}const ot=(0,y.X1)(((t,{router:e})=>{const r=(0,x.mB)(e.location.search),o=(0,h.VL)(r),s=(0,h.pe)(r),i=(0,K.H)(r)||$.order_by,a=(0,K.j)(r)||$.order_how,n=Object.assign(Object.assign({},r),{filter_by:r.filter_by||$.filter_by,limit:r.limit||$.limit,offset:r.offset||$.offset,order_by:{[$.order_by]:$.order_how}}),c=(0,x.pm)(Object.assign(Object.assign(Object.assign({},o&&{[o]:s}),n.filter_by),{limit:n.limit,offset:n.offset,order_by:i,order_how:a})),p=Q.R0.selectRos(t,et,tt,c),l=Q.R0.selectRosError(t,et,tt,c),u=Q.R0.selectRosFetchStatus(t,et,tt,c);return{groupBy:r.group_by,query:n,report:p,reportError:l,reportFetchStatus:u,reportQueryString:c}})),st={fetchRosReport:Q.Ze.fetchRosReport},it=(0,u.ZP)((0,_.E)((0,m.connect)(ot,st)(rt))),at=(0,E.dI)(g._.ocpDetails.path),nt=a.C.cost,ct=a.K.ocp,pt=(0,y.X1)(((t,{intl:e,router:r})=>{const a=(0,s.mB)(r.location.search),p=a.state?JSON.parse(window.atob(a.state)):void 0,u=(0,h.VL)(a),m=(0,h.pe)(a),g=(0,O.zC)(),d={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},p&&p.filter_by&&p.filter_by),a&&a.isPlatformCosts&&{category:v.rx}),u&&"*"!==m&&{[u]:void 0}),exclude:Object.assign({},p&&p.exclude&&p.exclude),group_by:Object.assign({},u&&{[u]:m}),category:a.category},y=(0,s.pm)(Object.assign(Object.assign({},d),{category:void 0,currency:g})),P=R.ZV.selectReport(t,ct,nt,y),E=R.ZV.selectReportError(t,ct,nt,y),_=R.ZV.selectReportFetchStatus(t,ct,nt,y),j=(0,i.H)(S.NT),F=S.aX.selectProviders(t,o.l.all,j),C=S.aX.selectProvidersFetchStatus(t,o.l.all,j),Z=a[v.yG]?a[v.yG]:m;return{costOverviewComponent:l().createElement(T,{currency:g,groupBy:u,isPlatformCosts:a&&a.isPlatformCosts,report:P,title:Z}),currency:g,description:a[v.eG],detailsURL:at,emptyStateTitle:e.formatMessage(c.Z.ocpDetailsTitle),groupBy:u,groupByValue:m,historicalDataComponent:l().createElement(D,{currency:g}),isOptimizationsTab:void 0!==a.optimizationsTab,isRosFeatureEnabled:b.iJ.selectIsRosFeatureEnabled(t),optimizationsBadgeComponent:l().createElement(J,null),optimizationsComponent:"project"===u&&"*"!==m?l().createElement(it,null):void 0,providers:(0,f.BV)(F,o.l.ocp),providersFetchStatus:C,providerType:o.l.ocp,query:a,report:P,reportError:E,reportFetchStatus:_,reportType:nt,reportPathsType:ct,reportQueryString:y,tagReportPathsType:n.L.ocp,title:Z}})),lt={closeOptimizationsDrawer:P.Aw.Zv,fetchReport:R.nx.fetchReport},ut=(0,u.ZP)((0,_.E)((0,m.connect)(pt,lt)(d.C)))}}]);
//# sourceMappingURL=../sourcemaps/ocpBreakdown.1ee8d040eb1d9f72f8152057db5d131d.js.map