"use strict";(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[8141],{93562:(t,e,r)=>{r.r(e),r.d(e,{default:()=>ut});var o=r(1326),s=r(84717),i=r(39333),a=r(6456),n=r(50081),c=r(97027),p=r(92950),l=r.n(p),u=r(74806),m=r(77760),g=r(91919),h=r(55672),d=r(55246),f=r(37269),y=r(86482),b=r(1156),R=r(78898),S=r(62331),P=r(15920),E=r(20997),O=r(15829),v=r(68025),j=r(14483),F=r(5842),C=r(67709),T=r(73903);const _=(0,b.X1)(((t,{title:e})=>({selectWidgets:T.cm.selectWidgets(t),widgets:T.cm.selectCurrentWidgets(t),title:e}))),Z=(0,m.connect)(_,{})(C.X);var B=r(87935),w=r(70982);const D=(0,b.X1)(((t,e)=>({selectWidgets:w.P2.selectWidgets(t),widgets:w.P2.selectCurrentWidgets(t)}))),V=(0,m.connect)(D,{})(B.f);var k=r(90154),x=r(52016),z=r(89256),Q=r(2136);const W=z.v.recommendations,q=z.N.ros;class M extends l().Component{constructor(){super(...arguments),this.defaultState={},this.state=Object.assign({},this.defaultState),this.updateReport=()=>{const{fetchReport:t,reportFetchStatus:e,reportQueryString:r}=this.props;e!==b.iF.inProgress&&t(W,q,r)}}componentDidMount(){this.updateReport()}render(){const{intl:t,report:e}=this.props,r=e&&e.meta?e.meta.count:0;return l().createElement(k.Badge,{screenReaderText:t.formatMessage(c.Z.optimizationsDetails,{count:r})},r)}}const X=(0,b.X1)(((t,{router:e})=>{const r=(0,x.mB)(e.location.search),o=(0,f.VL)(r),s=(0,f.pe)(r),a=Object.assign(Object.assign({},o&&{[o]:s}),{limit:r.limit||10,offset:r.offset||0}),n=(0,i.pm)(a);return{report:Q.R0.selectRos(t,W,q,n),reportError:Q.R0.selectRosError(t,W,q,n),reportFetchStatus:Q.R0.selectRosFetchStatus(t,W,q,n),reportQueryString:n}})),J={fetchReport:Q.Ze.fetchRosReport},N=(0,u.ZP)((0,F.E)((0,m.connect)(X,J)(M)));var L=r(52471),H=r(14411),I=r(47947),G=r(59454),U=r(38679),A=r(19727),K=r(14222),Y=r(10066);const $={limit:10,offset:0,order_by:{last_reported:"desc"}},tt=z.N.ros,et=z.v.recommendations;class rt extends l().Component{constructor(){super(...arguments),this.defaultState={columns:[],rows:[]},this.state=Object.assign({},this.defaultState),this.getPagination=(t=!1,e=!1)=>{const{intl:r,report:o}=this.props,s=o&&o.meta?o.meta.count:0,i=o&&o.meta?o.meta.limit:$.limit,a=o&&o.meta?o.meta.offset:$.offset,n=Math.trunc(a/i+1);return l().createElement(k.Pagination,{isCompact:!e,isDisabled:t,itemCount:s,onPerPageSelect:(t,e)=>this.handlePerPageSelect(e),onSetPage:(t,e)=>this.handleSetPage(e),page:n,perPage:i,titles:{paginationTitle:r.formatMessage(c.Z.paginationTitle,{title:r.formatMessage(c.Z.openShift),placement:e?"bottom":"top"})},variant:e?k.PaginationVariant.bottom:k.PaginationVariant.top,widgetId:"exports-pagination"+(e?"-bottom":"")})},this.getTable=()=>{const{query:t,report:e,reportFetchStatus:r,reportQueryString:o,router:s}=this.props;return l().createElement(G.Hy,{isLoading:r===b.iF.inProgress,onSort:(e,r)=>(0,A.yB)(t,s,e,r),report:e,reportQueryString:o})},this.getToolbar=()=>{const{query:t,report:e,router:r}=this.props,o=e&&e.meta?e.meta.limit:0,s=e&&e.meta?e.meta.count:0,i=0===s;return l().createElement(G.IH,{isDisabled:i,itemsPerPage:o,itemsTotal:s,onFilterAdded:e=>(0,A.$3)(t,r,e),onFilterRemoved:e=>(0,A.q7)(t,r,e),pagination:this.getPagination(i),query:t})},this.handlePerPageSelect=t=>{const{query:e,router:r}=this.props,o=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{limit:t}),s=(0,Y.Z)(o,r.location,!0);r.navigate(s,{replace:!0})},this.handleSetPage=t=>{const{query:e,report:r,router:o}=this.props,s=r&&r.meta&&r.meta.limit?r.meta.limit:$.limit,i=t*s-1,a=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{limit:s,offset:i}),n=(0,Y.Z)(a,o.location);o.navigate(n,{replace:!0})},this.updateReport=()=>{const{fetchRosReport:t,reportFetchStatus:e,reportQueryString:r}=this.props;e!==b.iF.inProgress&&t(et,tt,r)}}componentDidMount(){this.updateReport()}componentDidUpdate(t){const{report:e,reportError:r,reportQueryString:o,router:s}=this.props,i=t.reportQueryString!==o,a=!e&&!r,n=!s.location.search;(i||a||n)&&this.updateReport()}render(){const{intl:t,report:e,reportError:r,reportFetchStatus:o}=this.props,s=0===(e&&e.meta?e.meta.count:0),i=t.formatMessage(c.Z.optimizations),a=e&&e.meta&&e.meta.count>0;return r?l().createElement(I.W,{title:i}):a||o!==b.iF.complete?l().createElement("div",{style:U.W.optimizationsContainer},this.getToolbar(),o===b.iF.inProgress?l().createElement(L.g,null):l().createElement(l().Fragment,null,this.getTable(),l().createElement("div",{style:U.W.pagination},this.getPagination(s,!0)))):l().createElement(H.Y,null)}}const ot=(0,b.X1)(((t,{router:e})=>{const r=(0,i.mB)(e.location.search),o=(0,f.VL)(r),s=(0,f.pe)(r),a=(0,K.H)(r)||(0,K.H)($),n=(0,K.j)(r)||(0,K.j)($),c=Object.assign(Object.assign({},$),r),p=Object.assign(Object.assign(Object.assign({},o&&{[o]:s}),c.filter_by),{limit:c.limit,offset:c.offset,order_by:a,order_how:n}),l=(0,i.pm)(p),u=Q.R0.selectRos(t,et,tt,l),m=Q.R0.selectRosError(t,et,tt,l),g=Q.R0.selectRosFetchStatus(t,et,tt,l);return{groupBy:r.group_by,query:c,report:u,reportError:m,reportFetchStatus:g,reportQueryString:l}})),st={fetchRosReport:Q.Ze.fetchRosReport},it=(0,u.ZP)((0,F.E)((0,m.connect)(ot,st)(rt))),at=(0,v.dI)(g._.ocpDetails.path),nt=a.C.cost,ct=a.K.ocp,pt=(0,b.X1)(((t,{intl:e,router:r})=>{const a=(0,i.mB)(r.location.search),p=(0,i.fU)(a),u=(0,f.VL)(a),m=(0,f.pe)(a),g=(0,O.zC)(),d=Object.assign({},a),b={currency:g,filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign(Object.assign({},p&&p.filter_by&&p.filter_by),a&&a.isPlatformCosts&&{category:j.rx}),u&&"*"!==m&&{[u]:void 0}),exclude:Object.assign({},p&&p.exclude&&p.exclude),group_by:Object.assign({},u&&{[u]:m})},E=(0,i.pm)(b),v=P.ZV.selectReport(t,ct,nt,E),F=P.ZV.selectReportError(t,ct,nt,E),C=P.ZV.selectReportFetchStatus(t,ct,nt,E),T=(0,s.H)(S.NT),_=S.aX.selectProviders(t,o.l.all,T),B=S.aX.selectProvidersFetchStatus(t,o.l.all,T);let w=!1;if(v&&v.data)for(const t of v.data)if(t.projects.length>0){w=!0;break}const D=a[j.yG]?a[j.yG]:m;return{costOverviewComponent:w?l().createElement(Z,{currency:g,groupBy:u,isPlatformCosts:a&&a.isPlatformCosts,report:v,title:D}):l().createElement(h.J,null),currency:g,description:a[j.eG],detailsURL:at,emptyStateTitle:e.formatMessage(c.Z.ocpDetailsTitle),groupBy:u,groupByValue:m,historicalDataComponent:w?l().createElement(V,{currency:g}):l().createElement(h.J,null),isOptimizationsTab:void 0!==a.optimizationsTab,isRosFeatureEnabled:R.iJ.selectIsRosFeatureEnabled(t),optimizationsBadgeComponent:l().createElement(N,null),optimizationsComponent:"project"===u&&"*"!==m?l().createElement(it,null):void 0,providers:(0,y.BV)(_,o.l.ocp),providersFetchStatus:B,providerType:o.l.ocp,query:d,report:v,reportError:F,reportFetchStatus:C,reportType:nt,reportPathsType:ct,reportQueryString:E,tagReportPathsType:n.L.ocp,title:D}})),lt={closeOptimizationsDrawer:E.Aw.Zv,fetchReport:P.nx.fetchReport},ut=(0,u.ZP)((0,F.E)((0,m.connect)(pt,lt)(d.C)))}}]);
//# sourceMappingURL=../sourcemaps/ocpBreakdown.15f2b0c43ab6702e5d942bd84c7a0865.js.map