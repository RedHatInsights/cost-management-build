"use strict";(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[3758],{65619:(e,t,a)=>{a.d(t,{PK:()=>r,g_:()=>n});var s=a(40400);const r={name:"ErrorCircleOIcon",height:1024,width:1024,svgPath:"M409.5,319 C406.699326,316.168774 402.882413,314.575614 398.9,314.575614 C394.917587,314.575614 391.100674,316.168774 388.3,319 L319,388.3 C316.168774,391.100674 314.575614,394.917587 314.575614,398.9 C314.575614,402.882413 316.168774,406.699326 319,409.5 L421.5,512 L319,614.5 C316.168774,617.300674 314.575614,621.117587 314.575614,625.1 C314.575614,629.082413 316.168774,632.899326 319,635.7 L388.3,705 C391.100674,707.831226 394.917587,709.424386 398.9,709.424386 C402.882413,709.424386 406.699326,707.831226 409.5,705 L512,602.5 L614.5,705 C620.367618,710.877435 629.877455,710.922082 635.8,705.1 L705.1,635.8 C707.926508,632.970191 709.505822,629.128746 709.48721,625.129169 C709.468267,621.129592 707.852954,617.303145 705,614.5 L602.5,512 L705,409.5 C707.821142,406.720523 709.417879,402.93109 709.436648,398.97079 C709.455417,395.01049 707.89467,391.206092 705.1,388.4 L635.8,319 C629.932382,313.122565 620.422545,313.077918 614.5,318.9 L512,421.5 L409.5,319 Z M512,896 C300.2,896 128,723.9 128,512 C128,300.3 300.2,128 512,128 C723.8,128 896,300.2 896,512 C896,723.8 723.7,896 512,896 Z M512.1,0 C229.7,0 0,229.8 0,512 C0,794.2 229.8,1024 512.1,1024 C794.4,1024 1024,794.3 1024,512 C1024,229.7 794.4,0 512.1,0 Z",yOffset:0,xOffset:0},n=(0,s.IU)(r)},43294:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ze});var s=a(90154),r=a(65619),n=a(89376),o=a(39173),i=a(97027),l=a(92950),c=a.n(l),m=a(74806),d=a(77760),u=a(86896),p=a(88611),g=a(1156),h=a(58613),E=a(73805),f=a(10848);class b extends c().Component{constructor(e){super(e),this.handleDistributionChange=(e,t)=>{const{value:a}=t.currentTarget;this.setState({distribution:a})},this.handleDistributePlatformUnallocatedChange=(e,t)=>{const{value:a}=t.currentTarget;this.setState({distributePlatformUnallocated:"true"===a})},this.handleDistributeWorkerUnallocatedChange=(e,t)=>{const{value:a}=t.currentTarget;this.setState({distributeWorkerUnallocated:"true"===a})},this.state={distribution:this.props.current.distribution_info.distribution_type,distributePlatformUnallocated:!0===this.props.current.distribution_info.platform_cost,distributeWorkerUnallocated:!0===this.props.current.distribution_info.worker_cost}}render(){const{error:e,current:t,intl:a,isLoading:r,onClose:n,updateCostModel:o}=this.props;return c().createElement(s.Modal,{title:a.formatMessage(i.Z.costDistribution),description:c().createElement("a",{href:a.formatMessage(i.Z.docsCostModelsDistribution),rel:"noreferrer",target:"_blank"},a.formatMessage(i.Z.learnMore)),isOpen:!0,onClose:()=>n({name:"updateDistribution",isOpen:!1}),variant:s.ModalVariant.medium,actions:[c().createElement(s.Button,{key:"proceed",variant:"primary",onClick:()=>{const e=Object.assign(Object.assign({},t),{source_uuids:t.sources.map((e=>e.uuid)),source_type:"OCP",distribution_info:{distribution_type:this.state.distribution,platform_cost:this.state.distributePlatformUnallocated,worker_cost:this.state.distributeWorkerUnallocated}});o(t.uuid,e,"updateDistribution")}},a.formatMessage(i.Z.save)),c().createElement(s.Button,{key:"cancel",variant:"link",onClick:()=>n({name:"updateDistribution",isOpen:!1}),isDisabled:r},a.formatMessage(i.Z.cancel))]},c().createElement(s.Stack,{hasGutter:!0},c().createElement(s.StackItem,null,e&&c().createElement(s.Alert,{variant:"danger",title:`${e}`})),c().createElement(s.StackItem,null,c().createElement(s.Title,{headingLevel:"h3",size:"md"},a.formatMessage(i.Z.distributionType)),c().createElement(s.TextContent,null,c().createElement(s.Text,{style:f.W.cardDescription},a.formatMessage(i.Z.distributionModelDesc)))),c().createElement(s.StackItem,{isFilled:!0},c().createElement(s.Form,null,c().createElement(s.FormGroup,{isInline:!0,fieldId:"cost-distribution-type",isRequired:!0},c().createElement(s.Radio,{isChecked:"cpu"===this.state.distribution,name:"distributionType",label:a.formatMessage(i.Z.cpuTitle),"aria-label":a.formatMessage(i.Z.cpuTitle),id:"cpuDistribution",value:"cpu",onChange:this.handleDistributionChange}),c().createElement(s.Radio,{isChecked:"memory"===this.state.distribution,name:"distributionType",label:a.formatMessage(i.Z.memoryTitle),"aria-label":a.formatMessage(i.Z.memoryTitle),id:"memoryDistribution",value:"memory",onChange:this.handleDistributionChange})))),c().createElement(s.StackItem,null,c().createElement(s.Title,{headingLevel:"h3",size:"md"},a.formatMessage(i.Z.platform)),c().createElement(s.TextContent,null,c().createElement(s.Text,{style:f.W.cardDescription},a.formatMessage(i.Z.platformDesc)))),c().createElement(s.StackItem,{isFilled:!0},c().createElement(s.Form,null,c().createElement(s.FormGroup,{isInline:!0,fieldId:"cost-distribution-platform-unallocated",isRequired:!0},c().createElement(s.Radio,{isChecked:this.state.distributePlatformUnallocated,name:"distributePlatformUnallocated",label:a.formatMessage(i.Z.distribute),"aria-label":a.formatMessage(i.Z.distribute),id:"distributePlatformTrue",value:"true",onChange:this.handleDistributePlatformUnallocatedChange}),c().createElement(s.Radio,{isChecked:!this.state.distributePlatformUnallocated,name:"distributePlatformUnallocated",label:a.formatMessage(i.Z.doNotDistribute),"aria-label":a.formatMessage(i.Z.doNotDistribute),id:"distributePlatformFalse",value:"false",onChange:this.handleDistributePlatformUnallocatedChange})))),c().createElement(s.StackItem,null,c().createElement(s.Title,{headingLevel:"h3",size:"md"},a.formatMessage(i.Z.workerUnallocated)),c().createElement(s.TextContent,null,c().createElement(s.Text,{style:f.W.cardDescription},a.formatMessage(i.Z.workerUnallocatedDesc)))),c().createElement(s.StackItem,{isFilled:!0},c().createElement(s.Form,null,c().createElement(s.FormGroup,{isInline:!0,fieldId:"cost-distribution-worker-unallocated",isRequired:!0},c().createElement(s.Radio,{isChecked:this.state.distributeWorkerUnallocated,name:"distributeWorkerUnallocated",label:a.formatMessage(i.Z.distribute),"aria-label":a.formatMessage(i.Z.distribute),id:"distributeWorkerTrue",value:"true",onChange:this.handleDistributeWorkerUnallocatedChange}),c().createElement(s.Radio,{isChecked:!this.state.distributeWorkerUnallocated,name:"distributeWorkerUnallocated",label:a.formatMessage(i.Z.doNotDistribute),"aria-label":a.formatMessage(i.Z.doNotDistribute),id:"distributeWorkerFalse",value:"false",onChange:this.handleDistributeWorkerUnallocatedChange}))))))}}const M=(0,g.X1)((e=>({isLoading:h.E6.updateProcessing(e),error:h.E6.updateError(e)}))),C={onClose:h.F0.setCostModelDialog,updateCostModel:h.F0.updateCostModel},y=(0,m.ZP)((0,d.connect)(M,C)(b)),v=(0,d.connect)((0,g.X1)((e=>{const{updateDistribution:t}=h.E6.isDialogOpen(e)("distribution");return{isUpdateDialogOpen:t,costModelDialog:h.E6.isDialogOpen(e)("distribution"),isWritePermission:E.c5.isCostModelWritePermission(e)}})),{setCostModelDialog:h.F0.setCostModelDialog})((({isWritePermission:e,setCostModelDialog:t,current:a,isUpdateDialogOpen:r})=>{const n=(0,u.Z)(),[o,l]=c().useState(!1);return c().createElement(c().Fragment,null,r&&c().createElement(y,{current:a}),c().createElement(s.Card,{style:f.W.card},c().createElement(s.CardHeader,null,c().createElement(s.CardHeaderMain,null,c().createElement(s.Title,{headingLevel:"h2",size:s.TitleSizes.md},n.formatMessage(i.Z.costDistribution))),c().createElement(s.CardActions,null,c().createElement(s.Dropdown,{toggle:c().createElement(s.KebabToggle,{onToggle:l}),isOpen:o,onSelect:()=>l(!1),position:s.DropdownPosition.right,isPlain:!0,dropdownItems:[c().createElement(p.j,{key:"edit",isDisabled:!e},c().createElement(s.DropdownItem,{isDisabled:!e,onClick:()=>t({isOpen:!0,name:"updateDistribution"}),component:"button"},n.formatMessage(i.Z.costModelsDistributionEdit)))]}))),c().createElement(s.CardBody,{style:f.W.cardDescription},n.formatMessage(i.Z.costModelsDistributionDesc)),c().createElement(s.CardBody,{isFilled:!0}),c().createElement(s.CardBody,{style:f.W.cardBody},c().createElement("div",null,n.formatMessage(i.Z.distributionTypeDesc,{type:a.distribution_info.distribution_type})),c().createElement("div",null,n.formatMessage(i.Z.distributeCosts,{value:a.distribution_info.platform_cost,type:"platform"})),c().createElement("div",null,n.formatMessage(i.Z.distributeCosts,{value:a.distribution_info.worker_cost,type:"worker"})))))}));var S=a(91778);class P extends c().Component{constructor(e){super(e),this.handleSignChange=(e,t)=>{const{value:a}=t.currentTarget;this.setState({isDiscount:"true"===a})},this.handleMarkupDiscountChange=(e,t)=>{const{value:a}=t.currentTarget;this.setState({markup:a})},this.handleOnKeyDown=e=>{13!==e.keyCode&&187!==e.keyCode&&189!==e.keyCode||e.preventDefault()},this.markupValidator=()=>{const{markup:e}=this.state;return(0,S.WW)(e)?(0,S.cR)(e)>10?i.Z.markupOrDiscountTooLong:void 0:i.Z.markupOrDiscountNumber};const t=Number(this.props.current.markup.value||0),a=t<0,s=a?t.toString().substring(1):t.toString();this.state={isDiscount:a,markup:(0,S.lu)(Number(s))}}render(){const{error:e,current:t,intl:a,isLoading:r,onClose:n,updateCostModel:o}=this.props,{isDiscount:l}=this.state,m=this.markupValidator(),d=m?"error":"default",u=`${l?"-":""}${(0,S.E3)(this.state.markup)}`;return c().createElement(s.Modal,{title:a.formatMessage(i.Z.editMarkupOrDiscount),isOpen:!0,onClose:()=>n({name:"updateMarkup",isOpen:!1}),variant:s.ModalVariant.medium,actions:[c().createElement(s.Button,{key:"proceed",variant:"primary",onClick:()=>{const e=Object.assign(Object.assign({},t),{source_uuids:t.sources.map((e=>e.uuid)),source_type:"OpenShift Container Platform"===t.source_type?"OCP":"AWS",markup:{value:u,unit:"percent"}});o(t.uuid,e,"updateMarkup")},isDisabled:r||"error"===d||0===u.trim().length||Number(u)===Number(t.markup.value)},a.formatMessage(i.Z.save)),c().createElement(s.Button,{key:"cancel",variant:"link",onClick:()=>n({name:"updateMarkup",isOpen:!1}),isDisabled:r},a.formatMessage(i.Z.cancel))]},c().createElement(s.Stack,{hasGutter:!0},c().createElement(s.StackItem,null,e&&c().createElement(s.Alert,{variant:"danger",title:`${e}`})),c().createElement(s.StackItem,null,c().createElement(s.TextContent,null,c().createElement(s.Text,{style:f.W.cardDescription},a.formatMessage(i.Z.markupOrDiscountModalDesc)))),c().createElement(s.StackItem,null,c().createElement(s.TextContent,null,c().createElement(s.Title,{headingLevel:"h2",size:"md"},a.formatMessage(i.Z.markupOrDiscount))),c().createElement(s.Flex,{style:f.W.markupRadioContainer},c().createElement(s.Flex,{direction:{default:"column"},alignSelf:{default:"alignSelfCenter"}},c().createElement(s.FlexItem,null,c().createElement(s.Radio,{isChecked:!l,name:"discount",label:a.formatMessage(i.Z.markupPlus),"aria-label":a.formatMessage(i.Z.markupPlus),id:"markup",value:"false",onChange:this.handleSignChange,style:f.W.markupRadio}),c().createElement(s.Radio,{isChecked:l,name:"discount",label:a.formatMessage(i.Z.discountMinus),"aria-label":a.formatMessage(i.Z.discountMinus),id:"discount",value:"true",onChange:this.handleSignChange}))),c().createElement(s.Flex,{direction:{default:"column"},alignSelf:{default:"alignSelfCenter"}},c().createElement(s.FlexItem,null,c().createElement(s.Form,null,c().createElement(s.FormGroup,{fieldId:"markup-input-box",helperTextInvalid:m?a.formatMessage(m):void 0,style:f.W.rateContainer,validated:d},c().createElement(s.InputGroup,null,c().createElement(s.InputGroupText,{style:f.W.sign},l?a.formatMessage(i.Z.discountMinus):a.formatMessage(i.Z.markupPlus)),c().createElement(s.TextInput,{"aria-label":a.formatMessage(i.Z.rate),id:"markup-input-box",isRequired:!0,onKeyDown:this.handleOnKeyDown,onChange:this.handleMarkupDiscountChange,placeholder:"0",style:f.W.inputField,type:"text",validated:d,value:this.state.markup}),c().createElement(s.InputGroupText,{style:f.W.percent},a.formatMessage(i.Z.percentSymbol))))))))),c().createElement(s.StackItem,null),c().createElement(s.StackItem,null,c().createElement(s.TextContent,null,c().createElement(s.Title,{headingLevel:"h3",size:"md"},a.formatMessage(i.Z.examplesTitle))),c().createElement(s.List,null,c().createElement(s.ListItem,null,a.formatMessage(i.Z.costModelsExamplesNoAdjust)),c().createElement(s.ListItem,null,a.formatMessage(i.Z.costModelsExamplesDoubleMarkup)),c().createElement(s.ListItem,null,a.formatMessage(i.Z.costModelsExamplesReduceZero)),c().createElement(s.ListItem,null,a.formatMessage(i.Z.costModelsExamplesReduceSeventyfive))))))}}const Z=(0,g.X1)((e=>({isLoading:h.E6.updateProcessing(e),error:h.E6.updateError(e)}))),k={onClose:h.F0.setCostModelDialog,updateCostModel:h.F0.updateCostModel},T=(0,m.ZP)((0,d.connect)(Z,k)(P)),D=(0,m.ZP)((0,d.connect)((0,g.X1)((e=>{const{updateMarkup:t}=h.E6.isDialogOpen(e)("markup");return{isUpdateDialogOpen:t,costModelDialog:h.E6.isDialogOpen(e)("markup"),isWritePermission:E.c5.isCostModelWritePermission(e)}})),{setCostModelDialog:h.F0.setCostModelDialog})((({intl:e,isWritePermission:t,setCostModelDialog:a,current:r,isUpdateDialogOpen:n})=>{const[o,l]=c().useState(!1),m=(0,S.lu)(r&&r.markup&&r.markup.value?Number(r.markup.value):0);return c().createElement(c().Fragment,null,n&&c().createElement(T,{current:r}),c().createElement(s.Card,{style:f.W.card},c().createElement(s.CardHeader,null,c().createElement(s.CardHeaderMain,null,c().createElement(s.Title,{headingLevel:"h2",size:s.TitleSizes.md},e.formatMessage(i.Z.markupOrDiscount))),c().createElement(s.CardActions,null,c().createElement(s.Dropdown,{toggle:c().createElement(s.KebabToggle,{onToggle:l}),isOpen:o,onSelect:()=>l(!1),position:s.DropdownPosition.right,isPlain:!0,dropdownItems:[c().createElement(p.j,{key:"edit",isDisabled:!t},c().createElement(s.DropdownItem,{isDisabled:!t,onClick:()=>a({isOpen:!0,name:"updateMarkup"}),component:"button"},e.formatMessage(i.Z.editMarkup)))]}))),c().createElement(s.CardBody,{style:f.W.cardDescription},e.formatMessage(i.Z.markupOrDiscountDesc)),c().createElement(s.CardBody,{isFilled:!0}),c().createElement(s.CardBody,{style:f.W.cardBody},e.formatMessage(i.Z.percent,{value:m})),c().createElement(s.CardBody,{isFilled:!0})))})));var O=a(7081),x=a(40227),I=a(15984),F=a(42901),L=a(261),R=a(33735),_=a(69732),W=a(44808),j=a(67581),w=a(54001),B=a(41552),A=a(91800),q=a(34660);const $=(0,g.X1)((e=>{const t=h.E6.costModels(e);let a=null;return t.length>0&&(a=t[0]),{costModel:a,isOpen:h.E6.isDialogOpen(e)("rate").addRate,updateError:h.E6.updateError(e),isProcessing:h.E6.updateProcessing(e),metricsHash:A.qw.metrics(e)}})),U=(0,m.ZP)((0,d.connect)($,(e=>({onClose:()=>{e(h.F0.setCostModelDialog({name:"addRate",isOpen:!1}))},updateCostModel:(t,a)=>h.F0.updateCostModel(t,a,"addRate")(e)})))((({costModel:e,intl:t,isOpen:a,isProcessing:r,metricsHash:n,onClose:o,updateCostModel:l,updateError:m})=>{const d=(0,q.bF)(n),u=c().useMemo((()=>(0,q.Cw)(d)),[d.errors,d.rateKind]);return c().useEffect((()=>{d.reset(Object.assign(Object.assign({},W.Pv),{otherTiers:e.rates}))}),[a]),c().createElement(s.Modal,{title:t.formatMessage(i.Z.priceListAddRate),isOpen:a,onClose:o,variant:"large",actions:[c().createElement(s.Button,{key:"add-rate",variant:s.ButtonVariant.primary,isDisabled:!u||r,onClick:()=>{const t=(0,q.L3)(n,e,d);l(e.uuid,t)}},t.formatMessage(i.Z.priceListAddRate)),c().createElement(s.Button,{key:"cancel",variant:s.ButtonVariant.link,isDisabled:r,onClick:o},t.formatMessage(i.Z.cancel))]},c().createElement(s.Form,null,m&&c().createElement(s.Alert,{variant:"danger",title:`${m}`}),c().createElement(q.HJ,{currencyUnits:e.currency,metricsHash:n,rateFormData:d})))}))),z=U;var G=a(69957),K=a(45868);const V=(0,m.ZP)((({intl:e=K.N,onClose:t,onProceed:a,title:r,body:n,actionText:o,isProcessing:l=!1,isOpen:m=!1,isSmall:d=!1,error:u=""})=>{const p=c().createElement(s.Button,{key:"cancel",variant:"link",onClick:t,isDisabled:l},e.formatMessage(i.Z.cancel)),g=c().createElement(s.Button,{key:"proceed",variant:"danger",onClick:a,isDisabled:l},o),h=c().createElement(s.Button,{key:"close",variant:"primary",onClick:t,isDisabled:l},e.formatMessage(i.Z.close)),E=""!==o?[g,p]:[h];return c().createElement(s.Modal,{"aria-label":r,header:c().createElement(s.Title,{headingLevel:"h1",size:s.TitleSizes["2xl"]},c().createElement(G.LP,{color:"orange"})," ",r),isOpen:m,onClose:t,actions:E,variant:d?"small":"default"},u&&c().createElement(s.Alert,{variant:"danger",title:`${u}`}),n)}));var N=a(68239);const H=(0,g.X1)((e=>{const t=h.E6.costModels(e);let a=null;return t.length>0&&(a=t[0]),{costModel:a,isOpen:h.E6.isDialogOpen(e)("rate").updateRate,updateError:h.E6.updateError(e),isProcessing:h.E6.updateProcessing(e),metricsHash:A.qw.metrics(e)}})),X=(0,m.ZP)((0,d.connect)(H,(e=>({onClose:()=>{e(h.F0.setCostModelDialog({name:"updateRate",isOpen:!1}))},updateCostModel:(t,a)=>h.F0.updateCostModel(t,a,"updateRate")(e)})))((({costModel:e,index:t,intl:a=K.N,isOpen:r,isProcessing:n,metricsHash:o,onClose:l,updateCostModel:m,updateError:d})=>{const u=e&&e.rates&&e.rates[t]?e.rates[t]:null,p=(0,q.bF)(o,u,e.rates),g=c().useMemo((()=>(0,q.Cw)(p)),[p]),h=c().useMemo((()=>(0,q.uD)(u,p)),[p]);return c().useEffect((()=>{p.reset((0,q.Pz)(u,void 0,u&&u.tag_rates?e.rates.filter((e=>e.metric.name!==u.metric.name||e.cost_type!==u.cost_type||e.tag_rates&&u.tag_rates&&e.tag_rates.tag_key!==u.tag_rates.tag_key)):e.rates))}),[r]),c().createElement(s.Modal,{title:a.formatMessage(i.Z.priceListEditRate),isOpen:r,onClose:l,variant:"large",actions:[c().createElement(s.Button,{key:"proceed",variant:"primary",onClick:()=>{const a=(0,q.L3)(o,e,p,t);m(e.uuid,a)},isDisabled:!g||n||!h},a.formatMessage(i.Z.save)),c().createElement(s.Button,{key:"cancel",variant:"link",onClick:l,isDisabled:n},a.formatMessage(i.Z.cancel))]},c().createElement(s.Stack,{hasGutter:!0},d&&c().createElement(s.StackItem,null,c().createElement(s.Alert,{variant:"danger",title:`${d}`})),c().createElement(s.StackItem,null,c().createElement(N.l,null,c().createElement(q.HJ,{currencyUnits:(e=>{if(null===e)return"USD";if(e.tiered_rates)for(const t of e.tiered_rates)if(t.unit||t.usage)return t.unit||t.usage.unit;if(e.tag_rates)for(const t of e.tag_rates.tag_values)if(t.unit)return t.unit})(u),metricsHash:o,rateFormData:p})))))}))),J=X;class Q extends c().Component{constructor(){super(...arguments),this.defaultState={deleteRate:null,index:-1,sortBy:{index:0,direction:x.SortByDirection.asc},pagination:{perPage:10,page:1}},this.state=Object.assign({},this.defaultState)}render(){const{fetchStatus:e,fetchError:t,intl:a,isDialogOpen:r,isWritePermission:n,metricsHash:o}=this.props,l=e=>{const t=e.replace(/ /g,"_").toLowerCase();return a.formatMessage(i.Z.metricValues,{value:t})||e},m=e=>a.formatMessage(i.Z.measurementValues,{value:e.toLowerCase().replace("-","_"),count:1})||e,d=Object.keys(o).map((e=>({label:l(e),value:e}))),u=d.reduce(((e,t)=>{const a=Object.keys(o[t.value]).filter((t=>!e.map((e=>e.value)).includes(t))).map((e=>({label:m(e),value:e})));return[...e,...a]}),[]),p=this.props.assignees&&this.props.assignees.length>0,h=this.props.costModel,E=this.state.deleteRate?`${this.state.deleteRate.metric.label_metric}-${this.state.deleteRate.metric.label_measurement} (${this.state.deleteRate.metric.label_measurement_unit})`:"";return c().createElement(c().Fragment,null,c().createElement(z,null),c().createElement(J,{index:this.state.index}),c().createElement(V,{isSmall:!0,isOpen:r.deleteRate,title:a.formatMessage(i.Z.priceListDeleteRate),onClose:()=>{this.props.setDialogOpen({name:"deleteRate",isOpen:!1}),this.setState({deleteRate:null})},isProcessing:this.props.isLoading,onProceed:()=>{const{index:e}=this.state,{current:t}=this.props,a=Object.assign(Object.assign({},t),{source_uuids:t.sources.map((e=>e.uuid)),source_type:"OCP",rates:[...t.rates.slice(0,e),...t.rates.slice(e+1)]});this.props.updateCostModel(t.uuid,a,"deleteRate")},body:c().createElement(c().Fragment,null,a.formatMessage(i.Z.priceListDeleteRateDesc,{metric:c().createElement("b",null,E),costModel:c().createElement("b",null,h),count:p?2:1}),p&&c().createElement(s.List,null,this.props.assignees.map((e=>c().createElement(s.ListItem,{key:e},e))))),actionText:a.formatMessage(i.Z.priceListDeleteRate)}),c().createElement(R.j,{initialFilters:{primary:"metrics",metrics:[],measurements:[]}},(({search:r,setSearch:o,onRemove:l,onSelect:m,onClearAll:p})=>{const h=(this.state.pagination.page-1)*this.state.pagination.perPage,E=this.state.pagination.page*this.state.pagination.perPage,f=this.props.current.rates.map(((e,t)=>Object.assign(Object.assign({},e),{stateIndex:t}))).filter((e=>0===r.metrics.length||r.metrics.includes(e.metric.label_metric))).filter((e=>0===r.measurements.length||r.measurements.includes(e.metric.label_measurement))).sort(((e,t)=>{const s=1===this.state.sortBy.index?e=>{return t=e.metric.label_metric,a.formatMessage(i.Z.metricValues,{value:t})||t;var t}:2===this.state.sortBy.index?e=>{return t=e.metric.label_measurement,s=e.metric.label_measurement_unit,s=a.formatMessage(i.Z.units,{units:(0,S.ZV)(s)})||s,a.formatMessage(i.Z.measurementValues,{value:t.toLowerCase().replace("-","_"),units:s,count:2});var t,s}:()=>"";return(0,W.tT)(e,t,this.state.sortBy.direction,s)})),b=f.slice(h,E);return c().createElement(c().Fragment,null,c().createElement(_.Q,{primary:c().createElement(B.J,{isDisabled:0===this.props.current.rates.length,primary:r.primary,setPrimary:e=>o({primary:e}),options:[{label:a.formatMessage(i.Z.metric),value:"metrics"},{label:a.formatMessage(i.Z.measurement),value:"measurements"}]}),selected:r.primary,secondaries:[{component:c().createElement(w.n,{isDisabled:0===this.props.current.rates.length,placeholderText:a.formatMessage(i.Z.measurementPlaceholder),selections:r.measurements,setSelections:e=>m("measurements",e),options:u}),name:"measurements",onRemove:l,filters:r.measurements},{component:c().createElement(w.n,{isDisabled:0===this.props.current.rates.length,placeholderText:a.formatMessage(i.Z.metricPlaceholder),selections:r.metrics,setSelections:e=>m("metrics",e),options:d}),name:"metrics",onRemove:l,filters:r.metrics}],button:c().createElement(s.Button,{isDisabled:!n,onClick:()=>this.props.setDialogOpen({name:"addRate",isOpen:!0})},a.formatMessage(i.Z.priceListAddRate)),onClear:p,pagination:c().createElement(s.Pagination,{isCompact:!0,itemCount:f.length,perPage:this.state.pagination.perPage,page:this.state.pagination.page,onSetPage:(e,t)=>this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:t})}),onPerPageSelect:(e,t)=>this.setState({pagination:{page:1,perPage:t}}),titles:{paginationTitle:a.formatMessage(i.Z.paginationTitle,{title:a.formatMessage(i.Z.priceList),placement:"top"})}})}),e!==g.iF.complete&&c().createElement(L.G,null),e===g.iF.complete&&t&&c().createElement(I.Z,null),e===g.iF.complete&&0===b.length&&(0!==r.metrics.length||0!==r.measurements.length)&&c().createElement(F.c,null),e===g.iF.complete&&0===b.length&&0===r.measurements.length&&0===r.metrics.length&&c().createElement(s.Bullseye,null,c().createElement(s.EmptyState,null,c().createElement(s.EmptyStateIcon,{icon:O.wl}),c().createElement(s.Title,{headingLevel:"h2",size:s.TitleSizes.lg},a.formatMessage(i.Z.priceListEmptyRate)),c().createElement(s.EmptyStateBody,null,a.formatMessage(i.Z.priceListEmptyRateDesc)))),e===g.iF.complete&&b.length>0&&c().createElement(c().Fragment,null,c().createElement(j.y,{actions:[{title:a.formatMessage(i.Z.priceListEditRate),isDisabled:!n,style:n?void 0:{pointerEvents:"auto"},tooltip:n?void 0:c().createElement("div",null,a.formatMessage(i.Z.costModelsReadOnly)),onClick:(e,t,a)=>{this.setState({deleteRate:null,index:a.data.stateIndex}),this.props.setDialogOpen({name:"updateRate",isOpen:!0})}},{title:a.formatMessage(i.Z.delete),isDisabled:!n,style:n?{}:{pointerEvents:"auto"},tooltip:n?void 0:c().createElement("div",null,a.formatMessage(i.Z.costModelsReadOnly)),onClick:(e,t,a)=>{const s=a.data.stateIndex;this.setState({deleteRate:b[s],index:s+h}),this.props.setDialogOpen({name:"deleteRate",isOpen:!0})}}],tiers:b,sortCallback:e=>{this.setState(Object.assign(Object.assign({},this.state),{sortBy:Object.assign({},e)}))}}),c().createElement(s.Toolbar,{id:"price-list-toolbar-bottom"},c().createElement(s.ToolbarContent,null,c().createElement(s.ToolbarItem,{variant:s.ToolbarItemVariant.pagination},c().createElement(s.Pagination,{itemCount:f.length,perPage:this.state.pagination.perPage,page:this.state.pagination.page,onSetPage:(e,t)=>this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:t})}),onPerPageSelect:(e,t)=>this.setState({pagination:{page:1,perPage:t}}),titles:{paginationTitle:a.formatMessage(i.Z.paginationTitle,{title:a.formatMessage(i.Z.priceList),placement:"bottom"})},variant:"bottom"}))))))})))}}const Y=(0,m.ZP)((0,d.connect)((0,g.X1)((e=>({isLoading:h.E6.updateProcessing(e),error:h.E6.updateError(e),isDialogOpen:h.E6.isDialogOpen(e)("rate"),fetchError:h.E6.error(e),fetchStatus:h.E6.status(e),metricsHash:A.qw.metrics(e),costTypes:A.qw.costTypes(e),isWritePermission:E.c5.isCostModelWritePermission(e)}))),{updateCostModel:h.F0.updateCostModel,setDialogOpen:h.F0.setCostModelDialog})(Q));var ee=a(90),te=a(94550),ae=a(5842),se=a(56790),re=a(30537),ne=a(56728),oe=a(76889),ie=a(80810);const le=({id:e,placeholder:t="",value:a,onChange:r,onSearch:n})=>c().createElement(s.InputGroup,null,c().createElement(s.TextInput,{value:a,placeholder:t,id:e,onChange:r,onKeyPress:e=>{"Enter"===e.key&&""!==a&&n(e)}}),c().createElement(s.InputGroupText,{style:{borderLeft:"0"}},c().createElement(ie.W1,null))),ce=(0,m.ZP)((({filterInputProps:e,intl:t,paginationProps:a,filter:r})=>c().createElement(s.Toolbar,{id:"assign-sources-modal-toolbar",clearAllFilters:r.onClearAll},c().createElement(s.ToolbarContent,null,c().createElement(s.ToolbarToggleGroup,{breakpoint:"xl",toggleIcon:c().createElement(oe.k1,null)},c().createElement(s.ToolbarItem,{variant:"search-filter"},c().createElement(s.ToolbarFilter,{deleteChip:r.onRemove,chips:r.query.name,categoryName:"name"},c().createElement(le,Object.assign({placeholder:t.formatMessage(i.Z.costModelsFilterPlaceholder)},e))))),c().createElement(s.ToolbarItem,{variant:"pagination"},c().createElement(s.Pagination,{isCompact:a.isCompact,itemCount:a.itemCount,page:a.page,perPage:a.perPage,titles:{paginationTitle:t.formatMessage(i.Z.paginationTitle,{title:t.formatMessage(i.Z.costModelsAssignSourcesParen),placement:"top"})},onSetPage:a.onSetPage,onPerPageSelect:a.onPerPageSelect}))))));class me extends c().Component{render(){const{costModel:e,intl:t}=this.props;if(this.props.isLoadingSources)return c().createElement(L.G,null);if(this.props.fetchingSourcesError)return c().createElement(se.fv,null);const a=(t,a,s)=>{if(-1!==s)this.props.setState(Object.assign(Object.assign({},this.props.checked),{[this.props.providers[s].uuid]:{selected:a,meta:this.props.providers[s]}}));else{const t=this.props.providers.reduce(((t,s)=>{const r=s.cost_models.length&&void 0===s.cost_models.find((t=>t.name===e.name)),n=!!this.props.checked[s.uuid]&&this.props.checked[s.uuid].selected;return Object.assign(Object.assign({},t),{[s.uuid]:{selected:r?n:a,meta:s,isAssigned:r}})}),{}),s=Object.assign(Object.assign({},this.props.checked),t);this.props.setState(s)}},r=this.props.providers.map((a=>{const s=!!this.props.checked[a.uuid]&&this.props.checked[a.uuid].selected,r=void 0===a.cost_models?t.formatMessage(i.Z.costModelsWizardSourceTableDefaultCostModel):a.cost_models.map((e=>e.name)).join(","),n=a.cost_models.length&&void 0===a.cost_models.find((t=>t.name===e.name)),o=n?c().createElement(ne.a,{key:a.uuid,text:t.formatMessage(i.Z.costModelsWizardSourceWarning,{costModel:r})}):null;return{cells:[c().createElement("div",{key:a.uuid},a.name," ",o),r||""],selected:s,disableSelection:n}})),n={"OpenShift Container Platform":"OCP","Microsoft Azure":"Azure","Amazon Web Services":"AWS"}[e.source_type];return c().createElement(c().Fragment,null,c().createElement(ce,{filter:{onClearAll:()=>this.props.fetch(`source_type=${n}&limit=${this.props.pagination.perPage}`),onRemove:(e,t)=>{const a=(0,re.fg)({name:this.props.query.name?this.props.query.name.split(","):[]})(e,t);this.props.fetch(`source_type=${n}${a.name?`&name=${a.name.join(",")}`:""}&offset=0&limit=${this.props.pagination.perPage}`)},query:{name:this.props.query.name?this.props.query.name.split(","):[]}},filterInputProps:{id:"assign-sources-modal-toolbar-input",onChange:e=>this.props.updateFilter({currentFilterType:"name",currentFilterValue:e}),value:this.props.currentFilter.value,onSearch:()=>{const e=this.props.query.name?this.props.query.name.split(","):[],t=(0,re.xZ)({name:e})("name",this.props.currentFilter.value);this.props.fetch(`source_type=${n}&name=${t.name.join(",")}&limit=${this.props.pagination.perPage}&offset=0`)}},paginationProps:{isCompact:!0,itemCount:this.props.pagination.count,perPage:this.props.pagination.perPage,page:this.props.pagination.page,onPerPageSelect:(e,t)=>{this.props.fetch(`source_type=${n}&limit=${t}&offset=0&${this.props.query.name?`name=${this.props.query.name}`:""}`)},onSetPage:(e,t)=>{this.props.fetch(`source_type=${n}&limit=${this.props.pagination.perPage}&offset=${this.props.pagination.perPage*(t-1)}&${this.props.query.name?`name=${this.props.query.name}`:""}`)}}}),r.length>0&&c().createElement(x.TableComposable,{"aria-label":t.formatMessage(i.Z.costModelsAssignSources,{count:1})},c().createElement(x.Thead,null,c().createElement(x.Tr,null,c().createElement(x.Th,{select:{onSelect:(e,t)=>a(0,t,-1),isSelected:r.filter((e=>e.disableSelection||e.selected)).length===r.length}}),c().createElement(x.Th,null,t.formatMessage(i.Z.names,{count:1})),c().createElement(x.Th,null,t.formatMessage(i.Z.costModelsWizardSourceTableCostModel)))),c().createElement(x.Tbody,null,r.map(((e,t)=>c().createElement(x.Tr,{key:t},c().createElement(x.Td,{select:{disable:e.disableSelection,onSelect:s=>a(0,!e.selected,t),isSelected:e.selected,rowIndex:t}}),e.cells.map(((e,t)=>c().createElement(x.Td,{key:t},e)))))))),0===r.length&&c().createElement(F.c,{filter:this.props.filter,subTitle:i.Z.emptyFilterSourceStateSubtitle}),c().createElement(s.Toolbar,{id:"costmodels_details.sources_pagination_datatoolbar"},c().createElement(s.ToolbarContent,{style:{flexDirection:"row-reverse"}},c().createElement(s.ToolbarItem,{variant:"pagination"},c().createElement(s.Pagination,{itemCount:this.props.pagination.count,isDisabled:this.props.isLoadingSources,perPage:this.props.pagination.perPage,page:this.props.pagination.page,titles:{paginationTitle:t.formatMessage(i.Z.paginationTitle,{title:t.formatMessage(i.Z.costModelsAssignSourcesParen),placement:"bottom"})},onPerPageSelect:(e,t)=>{this.props.fetch(`limit=${t}&offset=0&${this.props.query.name?`name=${this.props.query.name}`:""}`)},onSetPage:(e,t)=>{this.props.fetch(`limit=${this.props.pagination.perPage}&offset=${this.props.pagination.perPage*(t-1)}&${this.props.query.name?`name=${this.props.query.name}`:""}`)}})))))}}const de=(0,g.X1)((e=>({currentFilter:{name:te.vc.currentFilterType(e),value:te.vc.currentFilterValue(e)},filter:te.vc.filter(e)}))),ue={updateFilter:te.lk.At},pe=(0,m.ZP)((0,d.connect)(de,ue)(me)),ge={"OpenShift Container Platform":"OCP","Microsoft Azure":"Azure","Amazon Web Services":"AWS"};class he extends c().Component{constructor(){super(...arguments),this.defaultState={checked:{}},this.state=Object.assign({},this.defaultState),this.hasSelections=()=>{const{checked:e}=this.state;let t=!1;for(const a of Object.keys(e))if(e[a].selected&&!e[a].disabled){t=!0;break}return t}}componentDidMount(){const{assigned:e}=this.props,{costModel:{source_type:t},fetch:a}=this.props;a(`type=${ge[t]}&limit=10&offset=0`);const s={};for(const t of e)s[t.uuid]={selected:!0,meta:t,disabled:!1};this.setState({checked:s})}render(){const{intl:e,isUpdateInProgress:t,onClose:a,isOpen:r,onSave:n,costModel:o,updateApiError:l}=this.props;return c().createElement(s.Modal,{isOpen:r,title:e.formatMessage(i.Z.costModelsAssignSources,{count:2}),onClose:a,variant:"large",actions:[c().createElement(s.Button,{key:"save",isDisabled:!this.hasSelections()||t||this.props.isLoadingSources||null!==this.props.fetchingSourcesError,onClick:()=>{n(Object.keys(this.state.checked).filter((e=>this.state.checked[e].selected)))}},e.formatMessage(i.Z.costModelsAssignSourcesParen)),c().createElement(s.Button,{key:"cancel",variant:"link",isDisabled:t,onClick:a},e.formatMessage(i.Z.cancel))]},c().createElement(s.Stack,null,c().createElement(s.StackItem,null,l&&c().createElement(s.Alert,{variant:"danger",title:`${l}`})),c().createElement(s.StackItem,null,c().createElement(s.Grid,null,c().createElement(s.GridItem,{span:2},c().createElement(s.TextContent,null,c().createElement(s.Text,{component:s.TextVariants.p},e.formatMessage(i.Z.names,{count:1})))),c().createElement(s.GridItem,{span:10},c().createElement(s.TextContent,null,c().createElement(s.Text,{component:s.TextVariants.p},this.props.costModel.name))),c().createElement(s.GridItem,{span:2},c().createElement(s.TextContent,null,c().createElement(s.Text,{component:s.TextVariants.p},e.formatMessage(i.Z.costModelsSourceType)))),c().createElement(s.GridItem,{span:10},c().createElement(s.TextContent,null,c().createElement(s.Text,{component:s.TextVariants.p},this.props.costModel.source_type))))),c().createElement(s.StackItem,null,c().createElement(pe,{fetch:this.props.fetch,fetchingSourcesError:this.props.fetchingSourcesError,isLoadingSources:this.props.isLoadingSources,providers:this.props.providers,pagination:this.props.pagination,query:this.props.query,costModel:o,checked:this.state.checked,setState:e=>{this.setState({checked:e})}}))))}}const Ee=(0,g.X1)((e=>({fetchingSourcesError:te.vc.error(e)?(0,ee.L)(te.vc.error(e)):null,isLoadingSources:te.vc.status(e)===g.iF.inProgress,isUpdateInProgress:h.E6.updateProcessing(e),pagination:te.vc.pagination(e),providers:te.vc.sources(e),query:te.vc.query(e),updateApiError:h.E6.updateError(e)}))),fe={fetch:te.lk.tP},be=(0,m.ZP)((0,ae.E)((0,d.connect)(Ee,fe)(he))),Me=(0,m.ZP)((0,d.connect)((0,g.X1)((e=>({canWrite:E.c5.isCostModelWritePermission(e),costModels:h.E6.costModels(e)}))))((({canWrite:e,costModels:t,intl:a,showDeleteDialog:s})=>{const r=e?[{title:a.formatMessage(i.Z.costModelsSourceDelete),onClick:(e,t)=>s(t)}]:[{style:{pointerEvents:"auto"},tooltip:a.formatMessage(i.Z.costModelsReadOnly),isDisabled:!0,title:a.formatMessage(i.Z.costModelsSourceDelete)}],n=t.length>0?t[0].sources.map((e=>[e.name])):[];return c().createElement(x.TableComposable,{"aria-label":a.formatMessage(i.Z.costModelsSourceTableAriaLabel),gridBreakPoint:x.TableGridBreakpoint.grid2xl},c().createElement(x.Thead,null,c().createElement(x.Tr,null,c().createElement(x.Th,null,a.formatMessage(i.Z.names,{count:1})),c().createElement(x.Th,null))),c().createElement(x.Tbody,null,n.map(((e,t)=>c().createElement(x.Tr,{key:t},c().createElement(x.Td,null,e),c().createElement(x.Td,{isActionCell:!0},c().createElement(x.ActionsColumn,{items:r.map((a=>Object.assign(Object.assign({},a),{onClick:()=>a.onClick(null,t,e,null)})))})))))))}))),Ce=({id:e,placeholder:t="",value:a,onChange:r,onSearch:n})=>c().createElement(s.InputGroup,null,c().createElement(s.TextInput,{value:a,placeholder:t,id:e,onChange:r,onKeyPress:e=>{"Enter"===e.key&&""!==a&&n(e)}}),c().createElement(s.InputGroupText,{style:{borderLeft:"0"}},c().createElement(ie.W1,null))),ye=({filterInputProps:e,paginationProps:t,filter:a,actionButtonProps:r})=>c().createElement(s.Toolbar,{id:"assign-sources-toolbar",clearAllFilters:a.onClearAll},c().createElement(s.ToolbarContent,null,c().createElement(s.ToolbarToggleGroup,{breakpoint:"xl",toggleIcon:c().createElement(oe.k1,null)},c().createElement(s.ToolbarItem,{variant:"search-filter"},c().createElement(s.ToolbarFilter,{deleteChip:a.onRemove,chips:a.query.name,categoryName:a.categoryNames.name},c().createElement(Ce,Object.assign({},e))))),c().createElement(s.ToolbarItem,null,c().createElement(p.j,{isDisabled:r.isDisabled},c().createElement(s.Button,Object.assign({},r)))),t&&c().createElement(s.ToolbarItem,{variant:"pagination"},c().createElement(s.Pagination,{isCompact:t.isCompact,itemCount:t.itemCount,page:t.page,perPage:t.perPage,onSetPage:t.onSetPage,onPerPageSelect:t.onPerPageSelect})))),ve={emptyState:{display:"flex",flexDirection:"row",justifyContent:"center"},sourceTypeTitle:{marginLeft:20,marginTop:8,marginBottom:8}};class Se extends c().Component{constructor(){super(...arguments),this.defaultState={query:{name:[]},currentFilter:"",filter:"",pagination:{page:1,perPage:10}},this.state=Object.assign({},this.defaultState)}render(){const{pagination:{page:e,perPage:t}}=this.state,{current:a,intl:r,isWritePermission:n,onAdd:o,rows:l}=this.props,m=l.filter((e=>!this.state.query.name||this.state.query.name.every((t=>e.includes(t))))).map((e=>[e])),d=m.slice((e-1)*t,e*t);return c().createElement(c().Fragment,null,c().createElement(s.Title,{headingLevel:"h2",size:s.TitleSizes.md,style:ve.sourceTypeTitle},r.formatMessage(i.Z.costModelsSourceType),": ",a.source_type),c().createElement(ye,{actionButtonProps:{isDisabled:!n,onClick:o,children:r.formatMessage(i.Z.costModelsAssignSources,{count:1})},filter:{onClearAll:()=>this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:1}),query:{name:[]}}),onRemove:(e,t)=>{this.setState({pagination:Object.assign(Object.assign({},this.state.pagination),{page:1}),query:(0,re.fg)(this.state.query)("name",t)})},query:this.state.query,categoryNames:{name:r.formatMessage(i.Z.names,{count:1})}},filterInputProps:{id:"sources-tab-toolbar",onChange:e=>this.setState({currentFilter:e}),onSearch:()=>{this.setState({query:(0,re.xZ)(this.state.query)("name",this.state.currentFilter),currentFilter:"",filter:this.state.currentFilter,pagination:Object.assign(Object.assign({},this.state.pagination),{page:1})})},value:this.state.currentFilter,placeholder:r.formatMessage(i.Z.costModelsFilterPlaceholder)}}),d.length>0&&c().createElement(Me,{showDeleteDialog:e=>{this.props.onDelete(d[e])}}),0===l.length&&c().createElement("div",{style:ve.emptyState},c().createElement(s.EmptyState,null,c().createElement(s.EmptyStateIcon,{icon:O.wl}),c().createElement(s.Title,{headingLevel:"h2",size:s.TitleSizes.lg},r.formatMessage(i.Z.costModelsSourceEmptyStateDesc)),c().createElement(s.EmptyStateBody,null,r.formatMessage(i.Z.costModelsSourceEmptyStateTitle)))),0===m.length&&l.length>0&&c().createElement(F.c,{filter:this.state.filter,subTitle:i.Z.emptyFilterSourceStateSubtitle}))}}const Pe=(0,m.ZP)((0,d.connect)((0,g.X1)((e=>({isWritePermission:E.c5.isCostModelWritePermission(e)}))))(Se));class Ze extends c().Component{constructor(){super(...arguments),this.defaultState={dialogSource:null},this.state=Object.assign({},this.defaultState)}render(){const{intl:e,isDialogOpen:t,isLoading:a,setDialogOpen:s,sources:r,costModel:n}=this.props;return c().createElement(c().Fragment,null,t.addSource&&c().createElement(be,{assigned:r,costModel:n,isOpen:!0,onClose:()=>s({name:"addSource",isOpen:!1}),onSave:e=>{this.props.updateCostModel(n.uuid,Object.assign(Object.assign({},n),{source_type:"OpenShift Container Platform"===n.source_type?"OCP":"AWS",source_uuids:e}),"addSource")}}),c().createElement(V,{isSmall:!0,isOpen:t.deleteSource,title:e.formatMessage(i.Z.costModelsSourceDeleteSource),onClose:()=>{s({name:"deleteSource",isOpen:!1}),this.setState({dialogSource:null})},isProcessing:a,onProceed:()=>{const e=Object.assign(Object.assign({},n),{source_type:"OpenShift Container Platform"===n.source_type?"OCP":"AWS",source_uuids:r.filter((e=>e.name!==this.state.dialogSource)).map((e=>e.uuid))});this.props.updateCostModel(n.uuid,e,"deleteSource")},body:c().createElement(c().Fragment,null,e.formatMessage(i.Z.costModelsSourceDeleteSourceDesc,{source:this.state.dialogSource,costModel:n.name})),actionText:e.formatMessage(i.Z.costModelsSourceDeleteSource)}),c().createElement(Pe,{onDeleteText:e.formatMessage(i.Z.costModelsSourceDelete),onDelete:e=>{this.setState({dialogSource:e[0]}),s({name:"deleteSource",isOpen:!0})},onAdd:()=>s({name:"addSource",isOpen:!0}),rows:r.map((e=>e.name)),current:n}))}}const ke=(0,m.ZP)((0,d.connect)((0,g.X1)((e=>({isLoading:h.E6.updateProcessing(e),isDialogOpen:h.E6.isDialogOpen(e)("sources")}))),{setDialogOpen:h.F0.setCostModelDialog,updateCostModel:h.F0.updateCostModel})(Ze));var Te=a(52471),De=a(47947),Oe=a(49382),xe=a(98499),Ie=a(32412),Fe=a(48196);const Le={headerDescription:{width:"97%",wordWrap:"break-word"},content:{paddingTop:xe.ZP.value,height:"182vh"},costCalculation:{marginLeft:xe.ZP.value,marginRight:xe.ZP.value},costmodelsContainer:{marginLeft:xe.ZP.value,marginRight:xe.ZP.value,backgroundColor:Oe.ZP.value,paddingBottom:Ie.ZP.value,paddingTop:Ie.ZP.value},headerCostModel:{padding:xe.ZP.var,paddingBottom:0,backgroundColor:Oe.ZP.value},title:{paddingBottom:Fe.ZP.var}};var Re=a(39836),_e=a(91919);const We={headerDescription:{width:"97%",wordWrap:"break-word"},content:{paddingTop:xe.ZP.value,height:"182vh"},costmodelsContainer:{marginLeft:xe.ZP.value,marginRight:xe.ZP.value,paddingBottom:Ie.ZP.value,paddingTop:Ie.ZP.value,paddingLeft:xe.ZP.value,paddingRight:xe.ZP.value},currency:{paddingBottom:Ie.ZP.value,paddingTop:xe.ZP.value},tableContainer:{marginLeft:xe.ZP.value,marginRight:xe.ZP.value},paginationContainer:{paddingBottom:Ie.ZP.value,paddingTop:Ie.ZP.value,paddingLeft:xe.ZP.value,paddingRight:xe.ZP.value,marginLeft:xe.ZP.value,marginRight:xe.ZP.value,marginBottom:xe.ZP.value,backgroundColor:Oe.ZP.value},toolbarContainer:{paddingBottom:Ie.ZP.value,paddingTop:Ie.ZP.value,marginLeft:xe.ZP.value,marginRight:xe.ZP.value,backgroundColor:Oe.ZP.value},header:{padding:xe.ZP.var,backgroundColor:Oe.ZP.var},headerContent:{display:"flex",justifyContent:"space-between"},headerCostModel:{padding:xe.ZP.value,paddingBottom:0,backgroundColor:Oe.ZP.var},breadcrumb:{paddingBottom:Ie.ZP.var},title:{paddingBottom:Fe.ZP.var},sourceTypeTitle:{paddingBottom:Ie.ZP.var}};class je extends c().Component{constructor(e){super(e);const t=this.props.costModel[0];this.state={name:t.name,description:t.description}}render(){const{costModel:e,intl:t,isProcessing:a,setDialogOpen:r,updateCostModel:n,updateError:o}=this.props,l=e[0];return c().createElement(s.Modal,{title:t.formatMessage(i.Z.editCostModel),isOpen:!0,onClose:()=>r({name:"updateCostModel",isOpen:!1}),variant:"small",actions:[c().createElement(s.Button,{key:"proceed",variant:"primary",onClick:()=>{const{uuid:e,sources:t}=l,a=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(a[s[r]]=e[s[r]])}return a}(l,["uuid","sources"]);n(e,Object.assign(Object.assign({},a),{source_uuids:t.map((e=>e.uuid)),name:this.state.name,description:this.state.description,source_type:"OpenShift Container Platform"===l.source_type?"OCP":"AWS"}),"updateCostModel")},isDisabled:a||this.state.name===l.name&&this.state.description===l.description},t.formatMessage(i.Z.save)),c().createElement(s.Button,{key:"cancel",variant:"secondary",onClick:()=>r({name:"updateCostModel",isOpen:!1}),isDisabled:a},t.formatMessage(i.Z.cancel))]},c().createElement(c().Fragment,null,o&&c().createElement(s.Alert,{variant:"danger",title:`${o}`}),c().createElement(s.Form,null,c().createElement(s.FormGroup,{label:t.formatMessage(i.Z.names,{count:1}),isRequired:!0,fieldId:"name"},c().createElement(s.TextInput,{isRequired:!0,type:"text",id:"name",name:"name",value:this.state.name,onChange:e=>this.setState({name:e})})),c().createElement(s.FormGroup,{label:t.formatMessage(i.Z.description),fieldId:"description"},c().createElement(s.TextArea,{type:"text",id:"description",name:"description",value:this.state.description,onChange:e=>this.setState({description:e})})))))}}const we=(0,g.X1)((e=>({costModel:h.E6.costModels(e),isProcessing:h.E6.updateProcessing(e),updateError:h.E6.updateError(e)}))),Be={setDialogOpen:h.F0.setCostModelDialog,updateCostModel:h.F0.updateCostModel},Ae=(0,m.ZP)((0,d.connect)(we,Be)(je));var qe=a(68025);const $e=(0,m.ZP)((0,ae.E)((0,d.connect)((0,g.X1)((e=>({isDialogOpen:h.E6.isDialogOpen(e)("costmodel"),isDeleteProcessing:h.E6.deleteProcessing(e),deleteError:h.E6.deleteError(e),isWritePermission:E.c5.isCostModelWritePermission(e)}))),{setDialogOpen:h.F0.setCostModelDialog,deleteCostModel:h.F0.deleteCostModel})((({current:e,deleteCostModel:t,deleteError:a,intl:r,isDeleteProcessing:n,isDialogOpen:o,isWritePermission:l,onSelectTab:m,router:d,setDialogOpen:u,tabRefs:g,tabIndex:h})=>{const[E,f]=c().useState(!1);return c().createElement(c().Fragment,null,o.updateCostModel&&c().createElement(Ae,null),c().createElement(V,{isSmall:!0,isOpen:o.deleteCostModel,title:r.formatMessage(i.Z.costModelsDelete),onClose:()=>u({name:"deleteCostModel",isOpen:!1}),error:a,isProcessing:n,onProceed:()=>{t(e.uuid,"deleteCostModel",d)},body:c().createElement(c().Fragment,null,0===e.sources.length&&r.formatMessage(i.Z.costModelsDeleteDesc,{costModel:e.name}),e.sources.length>0&&c().createElement(c().Fragment,null,r.formatMessage(i.Z.costModelsDeleteSource),c().createElement("br",null),c().createElement("br",null),r.formatMessage(i.Z.costModelsAvailableSources),c().createElement("br",null),c().createElement(s.List,null,e.sources.map((e=>c().createElement(s.ListItem,{key:`${e.uuid}`},e.name)))))),actionText:0===e.sources.length?r.formatMessage(i.Z.costModelsDelete):""}),c().createElement("header",{style:We.headerCostModel},c().createElement("div",{style:We.headerContent},c().createElement(s.Breadcrumb,{style:We.breadcrumb},c().createElement(s.BreadcrumbItem,{render:()=>c().createElement(Re.Link,{to:`${(0,qe.dI)(_e._.costModelsDetails.path)}`},r.formatMessage(i.Z.costModels))}),c().createElement(s.BreadcrumbItem,{isActive:!0},e.name))),c().createElement(s.Split,null,c().createElement(s.SplitItem,{style:We.headerDescription},c().createElement(s.Title,{headingLevel:"h1",style:We.title,size:s.TitleSizes["2xl"]},e.name),e.description),c().createElement(s.SplitItem,null,c().createElement(s.Dropdown,{toggle:c().createElement(s.KebabToggle,{onToggle:f}),isOpen:E,onSelect:()=>f(!1),isPlain:!0,position:"right",dropdownItems:[c().createElement(p.j,{key:"edit",isDisabled:!l},c().createElement(s.DropdownItem,{isDisabled:!l,onClick:()=>u({isOpen:!0,name:"updateCostModel"})},r.formatMessage(i.Z.edit))),c().createElement(p.j,{key:"delete",isDisabled:!l},c().createElement(s.DropdownItem,{isDisabled:!l,onClick:()=>u({isOpen:!0,name:"deleteCostModel"})},r.formatMessage(i.Z.delete)))]}))),c().createElement(s.TextContent,{style:We.currency},c().createElement(s.TextList,{component:s.TextListVariants.dl},c().createElement(s.TextListItem,{component:s.TextListItemVariants.dt},r.formatMessage(i.Z.currency)),c().createElement(s.TextListItem,{component:s.TextListItemVariants.dd},r.formatMessage(i.Z.currencyOptions,{units:e.currency||"USD"})))),"OpenShift Container Platform"===e.source_type?c().createElement(s.Tabs,{activeKey:h,onSelect:(e,t)=>m(t)},c().createElement(s.Tab,{eventKey:0,title:c().createElement(s.TabTitleText,null,r.formatMessage(i.Z.priceList)),tabContentId:"refPriceList",tabContentRef:g[0]}),c().createElement(s.Tab,{eventKey:1,title:c().createElement(s.TabTitleText,null,r.formatMessage(i.Z.costCalculations)),tabContentId:"refMarkup",tabContentRef:g[1]}),c().createElement(s.Tab,{eventKey:2,title:c().createElement(s.TabTitleText,null,r.formatMessage(i.Z.sources)),tabContentId:"refSources",tabContentRef:g[2]})):c().createElement(s.Tabs,{activeKey:h,onSelect:(e,t)=>m(t)},c().createElement(s.Tab,{eventKey:0,title:c().createElement(s.TabTitleText,null,r.formatMessage(i.Z.costCalculations)),tabContentId:"refMarkup",tabContentRef:g[0]}),c().createElement(s.Tab,{eventKey:1,title:c().createElement(s.TabTitleText,null,r.formatMessage(i.Z.sources)),tabContentId:"refSources",tabContentRef:g[1]}))))}))));class Ue extends c().Component{constructor(e){super(e),this.tabRefs=[c().createRef(),c().createRef(),c().createRef()],this.state={tabIndex:0}}componentDidMount(){this.props.fetchRbac(),this.props.fetchMetrics(),this.props.fetchCostModels(`uuid=${this.props.router.params.uuid}`)}render(){const{costModels:e,costModelError:t,costModelStatus:a,intl:l,metricsError:m,metricsStatus:d,rbacError:u,rbacStatus:p}=this.props;if(d!==g.iF.complete||p!==g.iF.complete||a!==g.iF.complete)return c().createElement(Te.g,{title:l.formatMessage(i.Z.costModels)});if(m||u||t)return null!==t&&"detail: Invalid provider uuid"===(0,ee.L)(t)?c().createElement(c().Fragment,null,c().createElement(n.Z,null,c().createElement(o.Z,{title:l.formatMessage(i.Z.costModels)})),c().createElement(s.PageSection,null,c().createElement(s.EmptyState,null,c().createElement(s.EmptyStateIcon,{icon:r.g_}),c().createElement(s.Title,{headingLevel:"h2",size:s.TitleSizes.lg},l.formatMessage(i.Z.costModelsUUIDEmptyState)),c().createElement(s.EmptyStateBody,null,l.formatMessage(i.Z.costModelsUUIDEmptyStateDesc,{uuid:this.props.router.params.uuid}))))):c().createElement(De.W,{title:l.formatMessage(i.Z.costModels)});const h=e[0],E=h.sources;return c().createElement("div",null,c().createElement($e,{current:h,tabRefs:this.tabRefs,tabIndex:this.state.tabIndex,onSelectTab:e=>this.setState({tabIndex:e})}),c().createElement("div",{style:Le.content},"OpenShift Container Platform"===h.source_type?c().createElement(c().Fragment,null,c().createElement(s.TabContent,{eventKey:0,id:"refPriceList",ref:this.tabRefs[0],hidden:0!==this.state.tabIndex},c().createElement("div",{style:Le.costmodelsContainer},c().createElement(Y,{assignees:E.map((e=>e.name)),costModel:h.name,current:h}))),c().createElement(s.TabContent,{eventKey:1,id:"refCostCalculations",ref:this.tabRefs[1],hidden:1!==this.state.tabIndex},c().createElement("div",{style:Le.costCalculation},c().createElement(s.Grid,{hasGutter:!0},c().createElement(s.GridItem,{lg:6,id:"refMarkup"},c().createElement(D,{current:h})),c().createElement(s.GridItem,{lg:6,id:"refDistribution"},c().createElement(v,{current:h}))))),c().createElement(s.TabContent,{eventKey:3,id:"refSources",ref:this.tabRefs[2],hidden:2!==this.state.tabIndex},c().createElement("div",{style:Le.costmodelsContainer},c().createElement(ke,{costModel:h,sources:E})))):c().createElement(c().Fragment,null,c().createElement(s.TabContent,{eventKey:0,id:"refMarkup",ref:this.tabRefs[0],hidden:0!==this.state.tabIndex},c().createElement("div",{style:Le.costCalculation},c().createElement(D,{current:h}))),c().createElement(s.TabContent,{eventKey:1,id:"refSources",ref:this.tabRefs[1],hidden:1!==this.state.tabIndex},c().createElement("div",{style:Le.costmodelsContainer},c().createElement(ke,{costModel:h,sources:E}))))))}}const ze=(0,m.ZP)((0,ae.E)((0,d.connect)((0,g.X1)((e=>({costModels:h.E6.costModels(e),costModelError:h.E6.error(e),costModelStatus:h.E6.status(e),metricsHash:A.qw.metrics(e),maxRate:A.qw.maxRate(e),costTypes:A.qw.costTypes(e),metricsError:A.qw.metricsState(e).error,metricsStatus:A.qw.status(e),rbacError:E.c5.selectRbacState(e).error,rbacStatus:E.c5.selectRbacState(e).status}))),{fetchMetrics:A.Wg.fetchMetrics,fetchRbac:E.O9.fetchRbac,fetchCostModels:h.F0.fetchCostModels})(Ue)))},47947:(e,t,a)=>{a.d(t,{W:()=>c});var s=a(90154),r=a(89376),n=a(39173),o=a(15984),i=a(92950),l=a.n(i);const c=({title:e})=>l().createElement(l().Fragment,null,e&&l().createElement(r.Z,null,l().createElement(n.Z,{title:e})),l().createElement(s.PageSection,null,l().createElement(o.Z,null)))}}]);
//# sourceMappingURL=../sourcemaps/costModel.5babd70cd0d5b7628d2bc734c15e8dc7.js.map