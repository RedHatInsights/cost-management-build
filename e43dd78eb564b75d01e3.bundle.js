(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[855],{65734:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>x});var s=o(90392),a=o(86208),l=o(45997),n=o(19078),r=o(23246),i=o(97522),c=o.n(i),d=o(91768),p=o(43476),u=o(57954),h=o(94377),m=o(45235),g=o(42581),y=o(44696),v=o(64764);const f=(0,h.X1)(((e,t)=>({selectWidgets:v.cm.selectWidgets(e),widgets:v.cm.selectCurrentWidgets(e)}))),S=(0,d.Z)()((0,p.connect)(f,{})(y.X));var b=o(45572),_=o(82462);const E=(0,h.X1)(((e,t)=>({selectWidgets:_.P2.selectWidgets(e),widgets:_.P2.selectCurrentWidgets(e)}))),C=(0,d.Z)()((0,p.connect)(E,{})(b.f)),O=u.Hb.ocpDetails,M="cost",P="ocp",B=(0,h.X1)(((e,t)=>{const o=(0,s.mB)(location.search),n=(0,r.VL)(o),i=(0,r.pe)(o),d={filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:Object.assign(Object.assign({},o&&o.filter_by&&o.filter_by),n&&{[n]:void 0}),group_by:Object.assign({},n&&{[n]:i})},p=(0,s.pm)(d),u=g.ZV.selectReport(e,P,M,p),h=g.ZV.selectReportError(e,P,M,p),y=g.ZV.selectReportFetchStatus(e,P,M,p),v=(0,a.H)(m.Vp),f=m.aX.selectProviders(e,"ocp",v),b=m.aX.selectProvidersFetchStatus(e,"ocp",v);return{costOverviewComponent:c().createElement(S,{groupBy:n,report:u}),description:o[l.eG],detailsURL:O,emptyStateTitle:t.t("navigation.ocp_details"),groupBy:n,groupByValue:i,historicalDataComponent:c().createElement(C,null),providers:f,providersFetchStatus:b,providerType:"ocp",query:o,queryString:p,report:u,reportError:h,reportFetchStatus:y,reportType:M,reportPathsType:P,tagReportPathsType:"ocp",title:i}})),k={fetchReport:g.nx.fetchReport},x=(0,d.Z)()((0,p.connect)(B,k)(n.Z))},98430:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Me});var s=o(80708),a=o(90392),l=o(86208),n=o(45997),r=o(7064),i=o(73466),c=o(16679),d=o(13883),p=o(81787),u=o(46774),h=o(97522),m=o.n(h),g=o(91768),y=o(43476),v=o(94377);const f=e=>{const t=new Set;return e.map((e=>{e.hidden&&t.add(e.value)})),t};class S extends m().Component{constructor(e,t){super(e,t),this.defaultState={hiddenColumns:f(this.props.options)},this.state=Object.assign({},this.defaultState),this.getHidden=e=>{const{hiddenColumns:t}=this.state,o=new Set(t);return o.delete(e)||o.add(e),o},this.isHidden=e=>{const{hiddenColumns:t}=this.state;return t.has(e)},this.handleChange=(e,t)=>{const o=this.getHidden(t.target.id);this.setState({hiddenColumns:o})},this.handleClose=()=>{this.setState(Object.assign({},this.defaultState),(()=>{this.props.onClose(!1)}))},this.handleSave=()=>{const{hiddenColumns:e}=this.state;this.props.onSave(e),this.handleClose()},this.selectAll=()=>{this.setState({hiddenColumns:new Set})}}componentDidUpdate(e){const{options:t}=this.props;if(e.options!==t){const e=f(t);this.setState({hiddenColumns:e})}}render(){const{options:e,t}=this.props;return m().createElement(s.Modal,{description:m().createElement(s.TextContent,null,m().createElement(s.Text,{component:s.TextVariants.p},"Selected categories will be displayed in the table."),m().createElement(s.Button,{isInline:!0,onClick:this.selectAll,variant:"link"},t("details.column_management.select_all"))),isOpen:this.props.isOpen,onClose:this.handleClose,title:t("details.column_management.title"),variant:s.ModalVariant.medium,actions:[m().createElement(s.Button,{key:"save",onClick:this.handleSave,variant:s.ButtonVariant.link},t("details.column_management.save")),m().createElement(s.Button,{key:"cancel",onClick:this.handleClose,variant:s.ButtonVariant.link},t("details.column_management.cancel"))]},m().createElement(s.DataList,{"aria-label":t("details.column_management.aria_label"),id:"table-column-management",isCompact:!0},e.map((e=>m().createElement(s.DataListItem,{"aria-labelledby":e.value,key:e.value},m().createElement(s.DataListItemRow,null,m().createElement(s.DataListCheck,{"aria-labelledby":e.value,checked:!this.isHidden(e.value),name:e.value,id:e.value,onChange:this.handleChange}),m().createElement(s.DataListItemCells,{dataListCells:[m().createElement(s.DataListCell,{id:"table-column-management-item1",key:"table-column-management-item1"},m().createElement("label",{htmlFor:"check1"},t(e.label))),m().createElement(s.DataListCell,{id:"table-column-management-item2",key:"table-column-management-item2"},e.description&&m().createElement("span",null,t(e.description)))]})))))))}}const b=(0,v.X1)((()=>({}))),_=(0,y.connect)(b,{})(S),E=(0,g.Z)()(_);var C=o(23246),O=o(94329),M=o(8091),P=o(45235),B=o(42581),k=o(26018);function x(e={}){return e.project?"project":e.cluster?"cluster":e.node?"node":"date"}var F=o(31447),R=o(99163),T=o(2088),q=o(33307),w=o(901),D=o(57116);const j={delta:"cost",filter:{time_scope_units:"month",time_scope_value:-1,resolution:"monthly"}},A=[{label:"cluster",value:"cluster"},{label:"node",value:"node"},{label:"project",value:"project"}];class I extends m().Component{constructor(){super(...arguments),this.defaultState={},this.state=Object.assign({},this.defaultState)}render(){const{groupBy:e,onGroupByClicked:t,providers:o,providersError:a,report:l,t:n}=this.props,r=l&&!a&&o&&o.meta&&o.meta.count>0;let i=m().createElement(R.L,null),c=m().createElement(R.L,null),d=m().createElement(R.L,null);if(l&&l.meta&&l.meta.total){const e=l.meta.total.cost&&l.meta.total.cost.total,t=l.meta.total.supplementary&&l.meta.total.supplementary.total,o=l.meta.total.infrastructure&&l.meta.total.infrastructure.total;i=(0,w.Bw)(e?l.meta.total.cost.total.value:0,e?l.meta.total.cost.total.units:"USD"),c=(0,w.Bw)(t?l.meta.total.supplementary.total.value:0,t?l.meta.total.supplementary.total.units:"USD"),d=(0,w.Bw)(o?l.meta.total.infrastructure.total.value:0,o?l.meta.total.infrastructure.total.units:"USD")}return m().createElement("header",{style:D.W.header},m().createElement("div",null,m().createElement(s.Title,{headingLevel:"h1",style:D.W.title,size:s.TitleSizes["2xl"]},n("ocp_details.title")),m().createElement(T.X,{getIdKeyForGroupBy:x,groupBy:e,isDisabled:!r,onItemClicked:t,options:A,showTags:!0,tagReportPathsType:"ocp"})),Boolean(r)&&m().createElement("div",null,m().createElement(s.Title,{headingLevel:"h2",style:D.W.costValue,size:s.TitleSizes["4xl"]},m().createElement(s.Tooltip,{content:n("dashboard.total_cost_tooltip",{supplementaryCost:c,infrastructureCost:d}),enableFlip:!0},m().createElement("span",null,i))),m().createElement("div",{style:D.W.dateTitle},(0,q.J4)())))}}const Z=(0,v.X1)(((e,t)=>{const o=(0,a.pm)(j),s=(0,l.H)(P.Vp);return{providers:P.aX.selectProviders(e,"ocp",s),providersError:P.aX.selectProvidersError(e,"ocp",s),providersFetchStatus:P.aX.selectProvidersFetchStatus(e,"ocp",s),queryString:o}})),V=(0,g.Z)()((0,y.connect)(Z,{})(I));var L=o(52636),$=o(75795),X=o(55483),N=o(80878),G=o(88268),H=o(16530),J=o(57954),W=o(49382),U=o(12289),Q=o(40794),z=o(11331),K=o(73861);const Y={emptyState:{backgroundColor:W.ZP.value,display:"flex",justifyContent:"center",paddingTop:z.ZP.value,height:"35vh",width:"100%"},infoArrow:{position:"relative"},infoArrowDesc:{bottom:K.ZP.value},infoDescription:{color:U.ZP.value,fontSize:Q.ZP.value}};const ee="infrastructure",te="monthOverMonth",oe="supplementary";class se extends m().Component{constructor(e){super(e),this.state={columns:[],rows:[]},this.initDatum=()=>{const{hiddenColumns:e,isAllSelected:t,query:o,report:a,selectedItems:l,t:r}=this.props;if(!o||!a)return;const i=x(o.group_by),c=this.getGroupByTagKey(),d=(0,w.xG)(a&&a.meta&&a.meta.total&&a.meta.total.cost&&a.meta.total.cost.total?a.meta.total.cost.total.value:0),p=c?[{title:r("details.tag_names")},{id:te,title:r("details.month_over_month_change")},{id:ee,title:r("ocp_details.infrastructure_cost")},{id:oe,title:r("ocp_details.supplementary_cost")},{orderBy:"cost",title:r("cost",{total:d}),transforms:[$.sortable]},{title:""}]:[{orderBy:i,title:r("details.resource_names",{groupBy:i}),transforms:[$.sortable]},{id:te,title:r("details.month_over_month_change")},{id:ee,orderBy:"infrastructure_cost",title:r("ocp_details.infrastructure_cost")},{id:oe,orderBy:"supplementary_cost",title:r("ocp_details.supplementary_cost")},{orderBy:"cost",title:r("cost"),transforms:[$.sortable]},{title:""}],u=[];(0,F.c)({report:a,idKey:c||i}).map(((e,s)=>{const a=e&&null!==e.label?e.label:"",r=this.getMonthOverMonthCost(e,s),d=this.getInfrastructureCost(e,s),p=this.getSupplementaryCost(e,s),h=this.getTotalCost(e,s),g=this.getActions(e);let y=m().createElement(H.Link,{to:(0,G.T)({basePath:J.Hb.ocpDetailsBreakdown,label:a.toString(),description:e.id,groupBy:c?`${n.P}${c}`:i,query:o})},a);const v=!(a===`no-${i}`||a===`no-${c}`);v||(y=a);const f=e.id&&e.id!==e.label?m().createElement("div",{style:Y.infoDescription},e.id):null;u.push({cells:[{title:m().createElement("div",null,y,f)},{title:m().createElement("div",null,r),id:te},{title:m().createElement("div",null,d),id:ee},{title:m().createElement("div",null,p),id:oe},{title:m().createElement("div",null,h)},{title:m().createElement("div",null,g)}],disableSelection:!v,isOpen:!1,item:e,selected:t||l&&void 0!==l.find((t=>t.id===e.id))})}));const h=[{heightAuto:!0,cells:[{props:{colSpan:7},title:m().createElement(s.Bullseye,null,m().createElement("div",{style:{textAlign:"center"}},m().createElement(s.Spinner,{size:"xl"})))}]}],g=p.filter((t=>!e.has(t.id))),y=u.map((t=>{var o=function(e,t){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(o[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(o[s[a]]=e[s[a]])}return o}(t,[]);return o.cells=o.cells.filter((t=>!e.has(t.id))),o}));this.setState({columns:g,loadingRows:h,rows:y,sortBy:{}})},this.getActions=e=>{const{groupBy:t,query:o}=this.props;return m().createElement(N.e,{groupBy:t,item:e,providerType:"ocp",query:o,reportPathsType:"ocp",showPriceListOption:"cluster"===t})},this.getEmptyState=()=>{const{query:e,t}=this.props;for(const t of Object.values(e.filter_by))if("*"!==t)return m().createElement(X.c,{filter:t,showMargin:!1});return m().createElement(s.EmptyState,null,m().createElement(s.EmptyStateIcon,{icon:L.Xk}),m().createElement(s.EmptyStateBody,null,t("details.empty_state")))},this.getSupplementaryCost=(e,t)=>{const{report:o,t:s}=this.props,a=o&&o.meta&&o.meta.total&&o.meta.total.cost&&o.meta.total.cost.total?o.meta.total.cost.total.value:0,l=0===a?a.toFixed(2):(e.supplementary.total.value/a*100).toFixed(2);return m().createElement(m().Fragment,null,(0,w.xG)(e.supplementary.total.value),m().createElement("div",{style:Y.infoDescription,key:`total-cost-${t}`},s("percent_of_cost",{value:l})))},this.getGroupByTagKey=()=>{const{query:e}=this.props;let t;for(const o of Object.keys(e.group_by)){const e=o.indexOf(n.P);if(-1!==e){t=o.substring(e+n.P.length);break}}return t},this.getInfrastructureCost=(e,t)=>{const{report:o,t:s}=this.props,a=o&&o.meta&&o.meta.total&&o.meta.total.cost&&o.meta.total.cost.total?o.meta.total.cost.total.value:0,l=0===a?a.toFixed(2):(e.infrastructure.total.value/a*100).toFixed(2);return m().createElement(m().Fragment,null,(0,w.xG)(e.infrastructure.total.value),m().createElement("div",{style:Y.infoDescription,key:`total-cost-${t}`},s("percent_of_cost",{value:l})))},this.getMonthOverMonthCost=(e,t)=>{const{t:o}=this.props,s=(0,w.xG)(Math.abs(e.cost.total.value-e.delta_value)),a=null!==e.delta_percent?Math.abs(e.delta_percent).toFixed(2):0,l=!(0===a||"0.00"===a),n=null!==e.delta_percent;let r;return l&&(r="iconOverride",null!==e.delta_percent&&e.delta_value<0&&(r+=" decrease"),null!==e.delta_percent&&e.delta_value>0&&(r+=" increase")),n?m().createElement("div",{className:"monthOverMonthOverride"},m().createElement("div",{className:r,key:`month-over-month-cost-${t}`},l?o("percent",{value:a}):m().createElement(R.L,null),Boolean(l&&null!==e.delta_percent&&e.delta_value>0)&&m().createElement("span",{className:"fa fa-sort-up",style:Y.infoArrow,key:`month-over-month-icon-${t}`}),Boolean(l&&null!==e.delta_percent&&e.delta_value<0)&&m().createElement("span",{className:"fa fa-sort-down",style:Object.assign(Object.assign({},Y.ininfoArrow),Y.infoArrowDesc),key:`month-over-month-icon-${t}`})),m().createElement("div",{style:Y.infoDescription,key:`month-over-month-info-${t}`},(0,q.Y)(s))):(0,q.Tf)()},this.getSortBy=()=>{const{query:e}=this.props,{columns:t}=this.state;let o=-1,s=$.SortByDirection.asc;for(const a of Object.keys(e.order_by)){let l=0;for(const n of t){if(n.orderBy===a){s="asc"===e.order_by[a]?$.SortByDirection.asc:$.SortByDirection.desc,o=l+1;break}l++}}return o>-1?{index:o,direction:s}:{}},this.getTotalCost=(e,t)=>{const{report:o,t:s}=this.props,a=o&&o.meta&&o.meta.total&&o.meta.total.cost&&o.meta.total.cost.total?o.meta.total.cost.total.value:0,l=0===a?a.toFixed(2):(e.cost.total.value/a*100).toFixed(2);return m().createElement(m().Fragment,null,(0,w.xG)(e.cost.total.value),m().createElement("div",{style:Y.infoDescription,key:`total-cost-${t}`},s("percent_of_cost",{value:l})))},this.handleOnSelect=(e,t,o)=>{const{onSelected:s}=this.props;let a,l=[];-1===o?a=this.state.rows.map((e=>(e.selected=t,e))):(a=[...this.state.rows],a[o].selected=t,l=[a[o].item]),this.setState({rows:a},(()=>{s&&s(l,t)}))},this.handleOnSort=(e,t,o)=>{const{onSort:s}=this.props,{columns:a}=this.state;s&&s(a[t-1].orderBy,o===$.SortByDirection.asc)},this.handleOnSelect=this.handleOnSelect.bind(this),this.handleOnSort=this.handleOnSort.bind(this)}componentDidMount(){this.initDatum()}componentDidUpdate(e){const{hiddenColumns:t,query:o,report:s,selectedItems:l}=this.props,n=s&&s.data?JSON.stringify(s.data):"",r=e.report&&e.report.data?JSON.stringify(e.report.data):"";(0,a.pm)(e.query)===(0,a.pm)(o)&&r===n&&e.selectedItems===l&&e.hiddenColumns===t||this.initDatum()}render(){const{isLoading:e}=this.props,{columns:t,loadingRows:o,rows:s}=this.state;return m().createElement(m().Fragment,null,m().createElement($.Table,{"aria-label":"details-table",canSelectAll:!1,cells:t,className:"tableOverride",rows:e?o:s,sortBy:this.getSortBy(),onSelect:e?void 0:this.handleOnSelect,onSort:this.handleOnSort,gridBreakPoint:"grid-2xl"},m().createElement($.TableHeader,null),m().createElement($.TableBody,null)),Boolean(0===s.length)&&m().createElement("div",{style:Y.emptyState},this.getEmptyState()))}}const ae=(0,g.Z)()(se);var le=o(8650),ne=o(28631),re=o(19853);const ie="tag",ce="ocp";class de extends m().Component{constructor(){super(...arguments),this.defaultState={},this.state=Object.assign({},this.defaultState),this.getCategoryOptions=()=>{const{tagReport:e,t}=this.props,o=[{name:t("filter_by.values.cluster"),key:"cluster"},{name:t("filter_by.values.node"),key:"node"},{name:t("filter_by.values.project"),key:"project"},{name:t("filter_by.values.tag"),key:n.up}];return e&&e.data&&e.data.length?o:o.filter((e=>e.key!==n.up))}}componentDidMount(){const{fetchTag:e,queryString:t}=this.props;e(ce,ie,t),this.setState({categoryOptions:this.getCategoryOptions()})}componentDidUpdate(e){const{fetchTag:t,query:o,queryString:s,tagReport:a}=this.props;o&&!(0,re.X)(o,e.query)&&t(ce,ie,s),(0,re.X)(a,e.tagReport)||this.setState({categoryOptions:this.getCategoryOptions()})}render(){const{groupBy:e,isAllSelected:t,isExportDisabled:o,itemsPerPage:s,itemsTotal:a,onBulkSelected:l,onColumnManagementClicked:n,onExportClicked:r,onFilterAdded:i,onFilterRemoved:c,pagination:d,query:p,selectedItems:u,tagReport:h}=this.props,{categoryOptions:g}=this.state;return m().createElement(le.k,{categoryOptions:g,groupBy:e,isAllSelected:t,isExportDisabled:o,itemsPerPage:s,itemsTotal:a,onBulkSelected:l,onColumnManagementClicked:n,onExportClicked:r,onFilterAdded:i,onFilterRemoved:c,pagination:d,query:p,resourcePathsType:"ocp",selectedItems:u,showBulkSelect:!0,showColumnManagement:!0,showExport:!0,showFilter:!0,tagReport:h})}}const pe=(0,v.X1)(((e,t)=>{const o=(0,a.pm)({filter:{resolution:"monthly",time_scope_units:"month",time_scope_value:-1}});return{queryString:o,tagReport:ne.ux.selectTag(e,ce,ie,o),tagReportFetchStatus:ne.ux.selectTagFetchStatus(e,ce,ie,o)}})),ue={fetchTag:ne.xr.Xt},he=(0,y.connect)(pe,ue)(de),me=(0,g.Z)()(he);var ge=o(98499),ye=o(32412);const ve={content:{paddingBottom:ge.ZP.value,paddingTop:ge.ZP.value},ocpDetails:{minHeight:"100%"},paginationContainer:{marginLeft:ge.ZP.value,marginRight:ge.ZP.value},pagination:{backgroundColor:W.ZP.value,padding:ye.ZP.value},tableContainer:{marginLeft:ge.ZP.value,marginRight:ge.ZP.value}},fe={delta:"cost",filter:{limit:10,offset:0,resolution:"monthly",time_scope_units:"month",time_scope_value:-1},filter_by:{},group_by:{project:"*"},order_by:{cost:"desc"}},Se=[{label:"details.month_over_month_change",value:te},{description:"ocp_details.infrastructure_cost_desc",label:"ocp_details.infrastructure_cost",value:ee,hidden:!0},{description:"ocp_details.supplementary_cost_desc",label:"ocp_details.supplementary_cost",value:oe,hidden:!0}],be="cost",_e="ocp";class Ee extends m().Component{constructor(e,t){super(e,t),this.defaultState={columns:[],hiddenColumns:f(Se),isAllSelected:!1,isColumnManagementModalOpen:!1,isExportModalOpen:!1,rows:[],selectedItems:[]},this.state=Object.assign({},this.defaultState),this.getColumnManagementModal=()=>{const{hiddenColumns:e,isColumnManagementModalOpen:t}=this.state,o=(0,r.cloneDeep)(Se);return o.map((t=>{t.hidden=e.has(t.value)})),m().createElement(E,{isOpen:t,options:o,onClose:this.handleColumnManagementModalClose,onSave:this.handleColumnManagementModalSave})},this.getComputedItems=()=>{const{query:e,report:t}=this.props,o=x(e.group_by),s=(0,C.qV)(e);return(0,F.c)({report:t,idKey:s||o})},this.getExportModal=e=>{const{isAllSelected:t,isExportModalOpen:o,selectedItems:s}=this.state,{query:a,report:l}=this.props,r=x(a.group_by),i=(0,C.qV)(a),c=l&&l.meta?l.meta.count:0,d=[];return s.map((e=>{e.label!==`no-${r}`&&e.label!==`no-${i}`&&d.push(e)})),m().createElement(u.X,{isAllItems:(t||s.length===c)&&e.length>0,groupBy:i?`${n.P}${i}`:r,isOpen:o,items:d,onClose:this.handleExportModalClose,query:a,reportPathsType:_e})},this.getPagination=(e=!1)=>{const{report:t}=this.props,o=t&&t.meta?t.meta.count:0,a=t&&t.meta&&t.meta.filter&&t.meta.filter.limit?t.meta.filter.limit:fe.filter.limit,l=(t&&t.meta&&t.meta.filter&&t.meta.filter.offset?t.meta.filter.offset:fe.filter.offset)/a+1;return m().createElement(s.Pagination,{isCompact:!e,itemCount:o,onPerPageSelect:this.handlePerPageSelect,onSetPage:this.handleSetPage,page:l,perPage:a,variant:e?s.PaginationVariant.bottom:s.PaginationVariant.top,widgetId:"`pagination${isBottom ? '-bottom' : ''}`"})},this.getTable=()=>{const{query:e,report:t,reportFetchStatus:o}=this.props,{hiddenColumns:s,isAllSelected:a,selectedItems:l}=this.state,r=x(e.group_by),i=(0,C.qV)(e);return m().createElement(ae,{groupBy:i?`${n.P}${i}`:r,hiddenColumns:s,isAllSelected:a,isLoading:1===o,onSelected:this.handleSelected,onSort:this.handleSort,query:e,report:t,selectedItems:l})},this.getToolbar=e=>{const{query:t,report:o}=this.props,{isAllSelected:s,selectedItems:a}=this.state,l=x(t.group_by),r=(0,C.qV)(t),i=o&&o.meta?o.meta.count:0;return m().createElement(me,{groupBy:r?`${n.P}${r}`:l,isAllSelected:s,isExportDisabled:0===e.length||!s&&0===a.length,itemsPerPage:e.length,itemsTotal:i,onBulkSelected:this.handleBulkSelected,onColumnManagementClicked:this.handleColumnManagementModalOpen,onExportClicked:this.handleExportModalOpen,onFilterAdded:this.handleFilterAdded,onFilterRemoved:this.handleFilterRemoved,pagination:this.getPagination(),query:t,selectedItems:a})},this.handleBulkSelected=e=>{const{isAllSelected:t}=this.state;"none"===e?this.setState({isAllSelected:!1,selectedItems:[]}):"page"===e?this.setState({isAllSelected:!1,selectedItems:this.getComputedItems()}):"all"===e&&this.setState({isAllSelected:!t,selectedItems:[]})},this.handleColumnManagementModalClose=e=>{this.setState({isColumnManagementModalOpen:e})},this.handleColumnManagementModalOpen=()=>{this.setState({isColumnManagementModalOpen:!0})},this.handleColumnManagementModalSave=e=>{this.setState({hiddenColumns:e})},this.handleExportModalClose=e=>{this.setState({isExportModalOpen:e})},this.handleExportModalOpen=()=>{this.setState({isExportModalOpen:!0})},this.handleFilterAdded=(e,t)=>{const{history:o,query:s}=this.props,a=(0,M.W)(s,e,t);o.replace(this.getRouteForQuery(a,!0))},this.handleFilterRemoved=(e,t)=>{const{history:o,query:s}=this.props,a=(0,M.U)(s,e,t);o.replace(this.getRouteForQuery(a,!0))},this.handleGroupByClick=e=>{const{history:t,query:o}=this.props,s=e,a=Object.assign(Object.assign({},JSON.parse(JSON.stringify(o))),{group_by:{[s]:"*"},order_by:{cost:"desc"}});t.replace(this.getRouteForQuery(a,!0)),this.setState({isAllSelected:!1,selectedItems:[]})},this.handlePerPageSelect=(e,t)=>{const{history:o,query:s}=this.props,a=Object.assign({},JSON.parse(JSON.stringify(s)));a.filter=Object.assign(Object.assign({},s.filter),{limit:t});const l=this.getRouteForQuery(a,!0);o.replace(l)},this.handleSelected=(e,t=!1)=>{const{isAllSelected:o,selectedItems:s}=this.state;let a=[...o?this.getComputedItems():s];e&&e.length>0&&(t?e.map((e=>a.push(e))):e.map((e=>{a=a.filter((t=>t.id!==e.id))}))),this.setState({isAllSelected:!1,selectedItems:a})},this.handleSetPage=(e,t)=>{const{history:o,query:s,report:a}=this.props,l=a&&a.meta&&a.meta.filter&&a.meta.filter.limit?a.meta.filter.limit:fe.filter.limit,n=t*l-l,r=Object.assign({},JSON.parse(JSON.stringify(s)));r.filter=Object.assign(Object.assign({},s.filter),{offset:n});const i=this.getRouteForQuery(r);o.replace(i)},this.handleSort=(e,t)=>{const{history:o,query:s}=this.props,a=Object.assign({},JSON.parse(JSON.stringify(s)));a.order_by={},a.order_by[e]=t?"asc":"desc";const l=this.getRouteForQuery(a);o.replace(l)},this.updateReport=()=>{const{query:e,location:t,fetchReport:o,history:s,queryString:a}=this.props;t.search?o(_e,be,a):s.replace(this.getRouteForQuery({filter_by:e?e.filter_by:void 0,group_by:e?e.group_by:void 0,order_by:{cost:"desc"}}))},this.handleBulkSelected=this.handleBulkSelected.bind(this),this.handleColumnManagementModalClose=this.handleColumnManagementModalClose.bind(this),this.handleColumnManagementModalOpen=this.handleColumnManagementModalOpen.bind(this),this.handleColumnManagementModalSave=this.handleColumnManagementModalSave.bind(this),this.handleExportModalClose=this.handleExportModalClose.bind(this),this.handleExportModalOpen=this.handleExportModalOpen.bind(this),this.handleFilterAdded=this.handleFilterAdded.bind(this),this.handleFilterRemoved=this.handleFilterRemoved.bind(this),this.handlePerPageSelect=this.handlePerPageSelect.bind(this),this.handleSelected=this.handleSelected.bind(this),this.handleSetPage=this.handleSetPage.bind(this),this.handleSort=this.handleSort.bind(this)}componentDidMount(){const{resetState:e}=this.props;e(),this.updateReport()}componentDidUpdate(e,t){const{location:o,report:s,reportError:a,queryString:l}=this.props,{selectedItems:n}=this.state,r=e.queryString!==l,i=!s&&!a,c=!o.search,d=t.selectedItems!==n;(r||i||c||d)&&this.updateReport()}getRouteForQuery(e,t=!1){const{history:o}=this.props;return t&&(e.filter=Object.assign(Object.assign({},e.filter),{offset:fe.filter.offset})),`${o.location.pathname}?${(0,a.IV)(e)}`}render(){const{providers:e,providersFetchStatus:t,query:o,report:s,reportError:a,reportFetchStatus:l,t:n}=this.props,r=x(o.group_by),u=this.getComputedItems(),h=n("navigation.ocp_details");if(a)return m().createElement(p.Z,{title:h});if(1===t&&1===l)return m().createElement(i.Z,{title:h});if(2===t&&2===l){if(e&&e.meta&&0===e.meta.count&&2===t)return m().createElement(d.Z,{providerType:"ocp",title:h});if(!(0,O.g8)(e))return m().createElement(c.Z,{title:h})}return m().createElement("div",{style:ve.ocpDetails},m().createElement(V,{groupBy:r,onGroupByClicked:this.handleGroupByClick,report:s}),m().createElement("div",{style:ve.content},this.getToolbar(u),this.getExportModal(u),this.getColumnManagementModal(),1===l?m().createElement(i.Z,null):m().createElement(m().Fragment,null,m().createElement("div",{style:ve.tableContainer},this.getTable()),m().createElement("div",{style:ve.paginationContainer},m().createElement("div",{style:ve.pagination},this.getPagination(!0))))))}}const Ce=(0,v.X1)(((e,t)=>{const o=(0,a.mB)(location.search),s={delta:"cost",filter:Object.assign(Object.assign({},fe.filter),o.filter),filter_by:o.filter_by||fe.filter_by,group_by:o.group_by||fe.group_by,order_by:o.order_by||fe.order_by},n=(0,a.pm)(s),r=B.ZV.selectReport(e,_e,be,n),i=B.ZV.selectReportError(e,_e,be,n),c=B.ZV.selectReportFetchStatus(e,_e,be,n),d=(0,l.H)(P.Vp);return{providers:P.aX.selectProviders(e,"ocp",d),providersFetchStatus:P.aX.selectProvidersFetchStatus(e,"ocp",d),query:s,queryString:n,report:r,reportError:i,reportFetchStatus:c}})),Oe={fetchReport:B.nx.fetchReport,resetState:k.Aw.oA},Me=(0,g.Z)()((0,y.connect)(Ce,Oe)(Ee))}}]);
//# sourceMappingURL=e43dd78eb564b75d01e3.bundle.js.map