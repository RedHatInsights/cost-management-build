"use strict";(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[2340],{66785:(e,t,r)=>{r.d(t,{T:()=>a});var s=r(80129);function a(e){return(0,s.stringify)(e,{encode:!1,indices:!1})}},52413:(e,t,r)=>{r.d(t,{G:()=>n});var s=r(95995),a=r(32004),c=r(93952),i=r(97522),o=r.n(i);const n=(0,r(74806).ZP)((({intl:e=a.N})=>{const t=e.formatMessage(c.Z.LoadingStateTitle),r=e.formatMessage(c.Z.LoadingStateDesc);return o().createElement(s.EmptyState,{variant:s.EmptyStateVariant.large,className:"pf-m-redhat-font"},o().createElement(s.Spinner,{size:"lg"}),o().createElement(s.Title,{headingLevel:"h5",size:"lg"},t),o().createElement(s.EmptyStateBody,null,r))}))},96924:(e,t,r)=>{r.d(t,{X:()=>p});var s=r(95995),a=r(93952),c=r(97522),i=r.n(c),o=r(74806);const n={perspectiveSelector:{display:"flex",alignItems:"center"},perspectiveLabel:{marginBottom:0,marginRight:r(32412).ZP.var,whiteSpace:"nowrap"},perspectiveOptionLabel:{marginBottom:6,marginLeft:8,marginTop:6}};class l extends i().Component{constructor(){super(...arguments),this.defaultState={isSelectOpen:!1},this.state=Object.assign({},this.defaultState),this.getSelectOptions=()=>{const{intl:e,options:t}=this.props,r=[];return t.map((t=>{r.push({toString:()=>e.formatMessage(t.label,{value:t.value}),value:t.value})})),r},this.getSelect=()=>{const{currentItem:e,intl:t,isDisabled:r,options:a}=this.props,{isSelectOpen:c}=this.state;if(1===a.length)return i().createElement("div",{style:n.perspectiveOptionLabel},t.formatMessage(a[0].label,{value:a[0].value}));const o=this.getSelectOptions(),l=o.find((t=>t.value===e));return i().createElement(s.Select,{id:"perspectiveSelect",isDisabled:r,isOpen:c,onSelect:this.handleSelect,onToggle:this.handleToggle,selections:l,variant:s.SelectVariant.single},o.map((e=>i().createElement(s.SelectOption,{key:e.value,value:e}))))},this.handleSelect=(e,t)=>{const{onSelected:r}=this.props;r&&r(t.value),this.setState({isSelectOpen:!1})},this.handleToggle=e=>{this.setState({isSelectOpen:e})}}render(){const{intl:e}=this.props;return i().createElement("div",{style:n.perspectiveSelector},i().createElement(s.Title,{headingLevel:"h3",size:"md",style:n.perspectiveLabel},e.formatMessage(a.Z.Perspective)),this.getSelect())}}const p=(0,o.ZP)(l)},64506:(e,t,r)=>{r.r(t),r.d(t,{default:()=>dt});var s=r(95995),a=r(91290),c=r(86208),i=r(66785),o=r(41560),n=r(51381),l=r(93952),p=r(73466),u=r(64146),h=r(13883),d=r(96924),g=r(97522),m=r.n(g);const v=({DashboardWidget:e,selectWidgets:t,widgets:r})=>m().createElement("div",null,m().createElement(s.Grid,{hasGutter:!0},r.map((r=>t[r].details.showHorizontal?m().createElement(s.GridItem,{sm:12,key:r},m().createElement(e,{widgetId:r})):m().createElement(s.GridItem,{lg:12,xl:6,xl2:4,key:r},m().createElement(e,{widgetId:r}))))));var b=r(43476),y=r(94377),f=r(67119),T=r(95078),P=r(60232),S=r(35956),F=r(7064),R=r(16530),C=r(99291);class D extends m().Component{constructor(){super(...arguments),this.defaultState={currentItem:this.props.options?this.props.options.find((e=>e.default)).value:void 0,isSelectOpen:!1},this.state=Object.assign({},this.defaultState),this.getSelect=()=>{const{isDisabled:e}=this.props,{currentItem:t,isSelectOpen:r}=this.state,a=this.getSelectOptions(),c=a.find((e=>e.value===t));return m().createElement(s.Select,{id:"comparisonSelect",isDisabled:e,isOpen:r,onSelect:this.handleSelect,onToggle:this.handleToggle,selections:c,variant:s.SelectVariant.single},a.map((e=>m().createElement(s.SelectOption,{key:e.value,value:e}))))},this.getSelectOptions=()=>{const{options:e}=this.props,t=[];return e.map((e=>{t.push({toString:()=>e.label,value:e.value})})),t},this.handleSelect=(e,t)=>{const{onItemClicked:r}=this.props;r&&r(t.value),this.setState({currentItem:t.value,isSelectOpen:!1})},this.handleToggle=e=>{this.setState({isSelectOpen:e})}}render(){return this.getSelect()}}const Z=D;var E=r(91707),I=r(32412),w=r(57640);const A={chartAltHeight:250,chartHeight:180,containerAltHeight:250,containerTrendHeight:180,containerUsageHeight:180},O={comparison:{marginBottom:I.ZP.value},comparisonContainer:{display:"flex"},tabs:{marginTop:E.ZP.value},tabItems:{marginTop:w.ZP.value}};class V extends m().Component{constructor(){super(...arguments),this.state={activeTabKey:0,currentComparison:"cumulative"},this.buildDetailsLink=e=>{const{details:t,getIdKeyForTab:r}=this.props,s=r(e);return`${t.viewAllPath}?${(0,T.pm)({group_by:{[s]:"*"},order_by:{cost:"desc"}})}`},this.getChart=(e,t,r=!1)=>{const{chartType:s,trend:a}=this.props;return"dailyTrend"===s?this.getDailyTrendChart(e,t,r,a.showInfrastructureLabel,a.showSupplementaryLabel):"dailyCost"===s?this.getDailyCostChart(e,t,r):"trend"===s?this.getTrendChart(e,t,r,a.showInfrastructureLabel,a.showSupplementaryLabel):"usage"===s?this.getUsageChart(t,r):null},this.getChartComparison=()=>{const{intl:e,trend:t}=this.props,{currentComparison:r}=this.state,s=this.getFormattedUnits(),a=e.formatMessage(t.titleKey,{units:s}),c=[{label:e.formatMessage(t.dailyTitleKey,{units:s}),value:"daily"},{label:a,value:"cumulative",default:!0}];return m().createElement(Z,{currentItem:r||c[0].value,onItemClicked:this.handleComparisonClick,options:c})},this.getDailyCostChart=(e,t,r=!1)=>{const{currentReport:s,previousReport:a,trend:c}=this.props,{currentComparison:i}=this.state,o=c.computedReportItem,n=c.computedReportItemValue,l="daily"===i,p=l?1:c.type,u=(0,P.zJ)(s,p,"date","infrastructure",n),h=(0,P.zJ)(a,p,"date","infrastructure",n),d=(0,P.zJ)(s,p,"date",o,n),g=(0,P.zJ)(a,p,"date",o,n),v=this.getForecastData(s,c.computedForecastItem),b=this.getForecastData(s,c.computedForecastInfrastructureItem),y=l?S.V3:S.me;return m().createElement(m().Fragment,null,m().createElement("div",{style:O.comparisonContainer},m().createElement("div",{style:O.comparison},this.getChartComparison())),m().createElement(y,{adjustContainerHeight:r,containerHeight:e,currentCostData:d,currentInfrastructureCostData:u,forecastConeData:v.forecastConeData,forecastData:v.forecastData,forecastInfrastructureConeData:b.forecastConeData,forecastInfrastructureData:b.forecastData,formatOptions:c.formatOptions,formatter:C.xG,height:t,previousCostData:g,previousInfrastructureCostData:h,showForecast:void 0!==c.computedForecastItem}))},this.getDailyTrendChart=(e,t,r=!1,s=!1,a=!1)=>{const{currentReport:c,details:i,previousReport:o,trend:n}=this.props,{currentComparison:l}=this.state,p=n.computedReportItem,u=n.computedReportItemValue,h="daily"===l,d=h?1:n.type,g=(0,P.zJ)(c,d,"date",p,u),v=(0,P.zJ)(o,d,"date",p,u),{forecastData:b,forecastConeData:y}=this.getForecastData(c,n.computedForecastItem),f=h?S.Y0:S.Nd;return m().createElement(m().Fragment,null,m().createElement("div",{style:O.comparisonContainer},m().createElement("div",{style:O.comparison},this.getChartComparison())),m().createElement(f,{adjustContainerHeight:r,containerHeight:e,currentData:g,forecastData:b,forecastConeData:y,formatOptions:n.formatOptions,formatter:C.xG,height:t,previousData:v,showForecast:void 0!==n.computedForecastItem,showInfrastructureLabel:s,showSupplementaryLabel:a,showUsageLegendLabel:i.showUsageLegendLabel,units:this.getUnits()}))},this.getForecastData=(e,t="cost")=>{const{forecast:r,trend:s}=this.props,{currentComparison:a}=this.state,c="daily"===a?1:s.type;let i,o;if(t){const s=(0,F.cloneDeep)(r);if(s&&(s.data=[]),r&&e&&e.data){const a=e.meta&&e.meta.total&&e.meta.total[t]?e.meta.total[t].total.value:0,i=e.meta&&e.meta.total&&e.meta.total[t]?e.meta.total[t].total.units:"USD",o=e.data.filter((e=>e.values.length)),n=o[o.length-1]?o[o.length-1].date:void 0;if(r&&r.data&&r.data.length>0){const e=new Date(n),t=e.getMonth()+1;for(const a of r.data){const r=new Date(a.date),c=r.getMonth()+1;r>e&&t===c&&s.data.push(a)}if(0===c){const e=r.data[0].values&&r.data[0].values.length>0?r.data[0].values[0].date:void 0,t=1===this.getNumberOfDays(n,e)?n:e;s.data.unshift({date:t,values:[{date:t,cost:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:i}},infrastructure:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:i}},supplementary:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:i}}}]})}}}i=(0,P.nB)(s,c,t),o=(0,P.Qw)(s,c,t)}return{forecastData:i,forecastConeData:o}},this.getNumberOfDays=(e,t)=>{const r=new Date(e),s=new Date(t).getTime()-r.getTime();return Math.round(s/864e5)},this.getTrendChart=(e,t,r=!1,s=!1,a=!1)=>{const{currentReport:c,details:i,intl:o,previousReport:n,trend:l}=this.props,p=l.computedReportItem||"cost",u=l.computedReportItemValue,h=o.formatMessage(l.titleKey,{units:this.getFormattedUnits()}),d=(0,P.zJ)(c,l.type,"date",p,u),g=(0,P.zJ)(n,l.type,"date",p,u),{forecastData:v,forecastConeData:b}=this.getForecastData(c,l.computedForecastItem);return m().createElement(S.Nd,{adjustContainerHeight:r,containerHeight:e,currentData:d,forecastData:v,forecastConeData:b,formatOptions:l.formatOptions,formatter:C.xG,height:t,previousData:g,showForecast:void 0!==l.computedForecastItem,showInfrastructureLabel:s,showSupplementaryLabel:a,showUsageLegendLabel:i.showUsageLegendLabel,title:h,units:this.getUnits()})},this.getUsageChart=(e,t=!1)=>{const{currentReport:r,intl:s,previousReport:a,trend:c}=this.props,i=s.formatMessage(c.titleKey,{units:this.getFormattedUnits()}),o=(0,P.zJ)(r,c.type,"date","request"),n=(0,P.zJ)(a,c.type,"date","request"),l=(0,P.zJ)(r,c.type,"date","usage"),p=(0,P.zJ)(a,c.type,"date","usage");return m().createElement(S.I0,{adjustContainerHeight:t,containerHeight:A.containerUsageHeight,currentRequestData:o,currentUsageData:l,formatOptions:c.formatOptions,formatter:C.bM,height:e,previousRequestData:n,previousUsageData:p,title:i})},this.getDetails=()=>{const{chartType:e,currentReport:t,details:r,reportType:s,trend:a}=this.props,c=a.computedReportItem||"cost",i=a.computedReportItemValue||"total";return m().createElement(S.rN,{chartType:e,computedReportItem:c,computedReportItemValue:i,costLabel:this.getDetailsLabel(r.costKey),formatOptions:r.formatOptions,report:t,reportType:s,requestLabel:this.getDetailsLabel(r.requestKey),showTooltip:r.showTooltip,showUnits:r.showUnits,showUsageFirst:r.showUsageFirst,units:this.getUnits(),usageFormatOptions:r.usageFormatOptions,usageLabel:this.getDetailsLabel(r.usageKey)})},this.getDetailsLabel=e=>{const{intl:t}=this.props;return e?t.formatMessage(e):void 0},this.getDetailsLink=()=>{const{currentTab:e,details:t}=this.props;return t.viewAllPath?m().createElement(R.Link,{to:this.buildDetailsLink(e)},this.getDetailsLinkTitle(e)):null},this.getDetailsLinkTitle=e=>{const{getIdKeyForTab:t,intl:r}=this.props,s=t(e)||"";return r.formatMessage(l.Z.GroupByAll,{value:s,count:2})},this.getFormattedUnits=()=>{const{intl:e,trend:t}=this.props,r=t.computedReportItem||"cost",s=this.getUnits();return"usage"===r?e.formatMessage(l.Z.Units,{units:(0,C.ZV)(s)}):e.formatMessage(l.Z.CurrencyUnits,{units:s})},this.getHorizontalLayout=()=>{const{containerAltHeight:e=A.containerAltHeight,chartAltHeight:t=A.chartAltHeight,currentReportFetchStatus:r,details:s}=this.props;return m().createElement(S.j0,{detailsLink:this.getDetailsLink(),status:r,tabs:this.getTabs(),title:this.getTitle()},this.getDetails(),this.getChart(e,t,s.adjustContainerHeight))},this.getTab=(e,t)=>{const{getIdKeyForTab:r,tabsReport:a,tabsReportFetchStatus:c}=this.props,i=r(e);return m().createElement(s.Tab,{eventKey:t,key:`${r(e)}-tab`,title:m().createElement(s.TabTitleText,null,this.getTabTitle(e))},m().createElement("div",{style:O.tabItems},m().createElement(S.mZ,{idKey:i,key:`${i}-items`,report:a,status:c},(({items:t})=>t.map((t=>this.getTabItem(e,t)))))))},this.getTabItem=(e,t)=>{const{availableTabs:r,getIdKeyForTab:s,tabsReport:a,topItems:c,trend:i}=this.props,{activeTabKey:o}=this.state,n=s(e),l=s(r[o]),p=i.computedReportItem||"cost",u=i.computedReportItemValue||"total";let h;const d=a&&a.meta&&a.meta.total;return"usage"===p?d&&a.meta.total.usage&&(h=a.meta.total.usage.value):d&&a.meta.total[p]&&a.meta.total[p][u]&&(h=a.meta.total[p][u].value),l===n?m().createElement(S.EH,{formatOptions:c?c.formatOptions:void 0,key:`${t.id}-item`,label:t.label?t.label.toString():"",totalValue:h,units:this.getUnits(),value:t[p][u].value}):null},this.getTabs=()=>{const{availableTabs:e}=this.props;return m().createElement(s.Tabs,{isFilled:!0,activeKey:this.state.activeTabKey,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e,t))))},this.getTabTitle=e=>{const{getIdKeyForTab:t,intl:r}=this.props,s=t(e)||"";return r.formatMessage(l.Z.GroupByTop,{value:s,count:2})},this.getTitle=()=>{const{intl:e,titleKey:t}=this.props;return e.formatMessage(t)},this.getUnits=()=>{const{currentReport:e,details:t,trend:r}=this.props,s=r.computedReportItem||"cost",a=r.computedReportItemValue||"total";if(t.units)return t.units;if(!e)return"";const c=e&&e.meta&&e.meta.total;return"usage"===s?c&&e.meta.total.usage?e.meta.total.usage.units:void 0:c&&e.meta.total[s]&&e.meta.total[s][a]?e.meta.total[s][a].units:"USD"},this.getVerticalLayout=()=>{const{availableTabs:e,currentReportFetchStatus:t,details:r}=this.props;return m().createElement(S.iu,{detailsLink:this.getDetailsLink(),status:t,title:this.getTitle()},this.getDetails(),this.getChart(A.containerTrendHeight,A.chartHeight,r.adjustContainerHeight),Boolean(e)&&m().createElement("div",{style:O.tabs},this.getTabs()))},this.handleComparisonClick=e=>{this.setState({currentComparison:e})},this.handleTabClick=(e,t)=>{const{availableTabs:r,id:s,updateTab:a}=this.props;a(s,r[t]),this.setState({activeTabKey:t})}}componentDidMount(){const{availableTabs:e,fetchForecasts:t,fetchReports:r,id:s,trend:a,updateTab:c,widgetId:i}=this.props;e&&c(s,e[0]),r&&r(i),void 0!==a.computedForecastItem&&t(i)}render(){const{details:e}=this.props;return e.showHorizontal?this.getHorizontalLayout():this.getVerticalLayout()}}var L=r(74806),W=r(83127),_=r(42581);const j=e=>{switch(e){case"services":return"service";case"accounts":return"account";case"regions":return"region";case"instance_type":return"instance_type"}},Q=(0,y.X1)(((e,{widgetId:t})=>{const r=f.Cv.selectWidget(e,t),s=f.Cv.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:j,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),K={fetchForecasts:f.Kf.v4,fetchReports:f.Kf.a4,updateTab:f.Kf.as},M=(0,L.ZP)((0,b.connect)(Q,K)(V)),z=(0,y.X1)(((e,t)=>({DashboardWidget:M,selectWidgets:f.Cv.selectWidgets(e),widgets:f.Cv.selectCurrentWidgets(e)}))),U=(0,b.connect)(z,{})(v);var H=r(99317);const k=e=>{switch(e){case"services":return"service";case"accounts":return"account";case"regions":return"region";case"instance_type":return"instance_type"}},X=(0,y.X1)(((e,{widgetId:t})=>{const r=H.Hc.selectWidget(e,t),s=H.Hc.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:k,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),x={fetchForecasts:H.NA.v4,fetchReports:H.NA.a4,updateTab:H.NA.as},G=(0,L.ZP)((0,b.connect)(X,x)(V)),J=(0,y.X1)(((e,t)=>({DashboardWidget:G,selectWidgets:H.Hc.selectWidgets(e),widgets:H.Hc.selectCurrentWidgets(e)}))),B=(0,b.connect)(J,{})(v);var N=r(31554);const q=e=>{switch(e){case"service_names":return"service_name";case"subscription_guids":return"subscription_guid";case"resource_locations":return"resource_location";case"instance_type":return"instance_type"}},$=(0,y.X1)(((e,{widgetId:t})=>{const r=N.rj.selectWidget(e,t),s=N.rj.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:q,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Y={fetchForecasts:N.oc.v4,fetchReports:N.oc.a4,updateTab:N.oc.as},ee=(0,L.ZP)((0,b.connect)($,Y)(V)),te=(0,y.X1)(((e,t)=>({DashboardWidget:ee,selectWidgets:N.rj.selectWidgets(e),widgets:N.rj.selectCurrentWidgets(e)}))),re=(0,b.connect)(te,{})(v);var se=r(44986);const ae=e=>{switch(e){case"service_names":return"service_name";case"subscription_guids":return"subscription_guid";case"resource_locations":return"resource_location";case"instance_type":return"instance_type"}},ce=(0,y.X1)(((e,{widgetId:t})=>{const r=se.MW.selectWidget(e,t),s=se.MW.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:ae,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),ie={fetchForecasts:se._V.v4,fetchReports:se._V.a4,updateTab:se._V.as},oe=(0,L.ZP)((0,b.connect)(ce,ie)(V)),ne=(0,y.X1)(((e,t)=>({DashboardWidget:oe,selectWidgets:se.MW.selectWidgets(e),widgets:se.MW.selectCurrentWidgets(e)}))),le=(0,b.connect)(ne,{})(v);var pe=r(79522);const ue=e=>{switch(e){case"services":return"service";case"projects":return"project";case"regions":return"region";case"instance_type":return"instance_type"}},he=(0,y.X1)(((e,{widgetId:t})=>{const r=pe.oS.selectWidget(e,t),s=pe.oS.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:ue,currentQuery:s.current,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),de={fetchForecasts:pe.n5.v4,fetchReports:pe.n5.a4,updateTab:pe.n5.as},ge=(0,L.ZP)((0,b.connect)(he,de)(V)),me=(0,y.X1)(((e,t)=>({DashboardWidget:ge,selectWidgets:pe.oS.selectWidgets(e),widgets:pe.oS.selectCurrentWidgets(e)}))),ve=(0,b.connect)(me,{})(v);var be=r(85394);const ye=e=>{switch(e){case"services":return"service";case"projects":return"project";case"regions":return"region";case"instance_type":return"instance_type"}},fe=(0,y.X1)(((e,{widgetId:t})=>{const r=be.FF.selectWidget(e,t),s=be.FF.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:ye,currentQuery:s.current,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Te={fetchForecasts:be.uM.v4,fetchReports:be.uM.a4,updateTab:be.uM.as},Pe=(0,L.ZP)((0,b.connect)(fe,Te)(V)),Se=(0,y.X1)(((e,t)=>({DashboardWidget:Pe,selectWidgets:be.FF.selectWidgets(e),widgets:be.FF.selectCurrentWidgets(e)}))),Fe=(0,b.connect)(Se,{})(v);var Re=r(75836);const Ce=e=>{switch(e){case"services":return"service";case"projects":return"project";case"regions":return"region";case"instance_type":return"instance_type"}},De=(0,y.X1)(((e,{widgetId:t})=>{const r=Re.Pi.selectWidget(e,t),s=Re.Pi.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Ce,currentQuery:s.current,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Ze={fetchForecasts:Re.lj.v4,fetchReports:Re.lj.a4,updateTab:Re.lj.as},Ee=(0,L.ZP)((0,b.connect)(De,Ze)(V)),Ie=(0,y.X1)(((e,t)=>({DashboardWidget:Ee,selectWidgets:Re.Pi.selectWidgets(e),widgets:Re.Pi.selectCurrentWidgets(e)}))),we=(0,b.connect)(Ie,{})(v);var Ae=r(83123);const Oe=e=>{switch(e){case"accounts":return"account";case"regions":return"region";case"services":return"service"}},Ve=(0,y.X1)(((e,{widgetId:t})=>{const r=Ae.qN.selectWidget(e,t),s=Ae.qN.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Oe,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Le={fetchForecasts:Ae.BV.v4,fetchReports:Ae.BV.a4,updateTab:Ae.BV.as},We=(0,L.ZP)((0,b.connect)(Ve,Le)(V)),_e=(0,y.X1)(((e,t)=>({DashboardWidget:We,selectWidgets:Ae.qN.selectWidgets(e),widgets:Ae.qN.selectCurrentWidgets(e)}))),je=(0,b.connect)(_e,{})(v);var Qe=r(17563);const Ke=e=>{switch(e){case"clusters":return"cluster";case"nodes":return"node";case"projects":return"project"}},Me=(0,y.X1)(((e,{widgetId:t})=>{const r=Qe.nH.selectWidget(e,t),s=Qe.nH.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Ke,chartAltHeight:250,containerAltHeight:250,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:W.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),ze={fetchForecasts:Qe.U6.v4,fetchReports:Qe.U6.a4,updateTab:Qe.U6.as},Ue=(0,L.ZP)((0,b.connect)(Me,ze)(V)),He=(0,y.X1)(((e,t)=>({DashboardWidget:Ue,selectWidgets:Qe.nH.selectWidgets(e),widgets:Qe.nH.selectCurrentWidgets(e)}))),ke=(0,b.connect)(He,{})(v);var Xe=r(94329),xe=r(45235),Ge=r(26018),Je=r(1723),Be=r(33307),Ne=r(45785),qe=r(49382),$e=r(17918),Ye=r(98499);const et={date:{alignSelf:"center",flexGrow:1,textAlign:"end"},costType:{marginLeft:I.ZP.var},header:{backgroundColor:qe.ZP.var,padding:Ye.ZP.var},headerContent:{display:"flex",justifyContent:"space-between"},headerContentLeft:{display:"flex"},infoIcon:{fontSize:$e.ZP.value},infoTitle:{fontWeight:"bold"},main:{padding:Ye.ZP.value},tabs:{backgroundColor:qe.ZP.var,paddingBottom:Ye.ZP.var,paddingTop:Ye.ZP.var}},tt=e=>{switch(e){case"infrastructure":return"infrastructure";case"ocp":return"ocp"}},rt=[{label:l.Z.PerspectiveValues,value:"ocp"}],st=[{label:l.Z.PerspectiveValues,value:"aws"}],at=[{label:l.Z.PerspectiveValues,value:"aws_ocp"}],ct=[{label:l.Z.PerspectiveValues,value:"azure"}],it=[{label:l.Z.PerspectiveValues,value:"azure_ocp"}],ot=[{label:l.Z.PerspectiveValues,value:"gcp"}],nt=[{label:l.Z.PerspectiveValues,value:"ibm"}],lt=[{label:l.Z.PerspectiveValues,value:"ocp_cloud"}];class pt extends m().Component{constructor(){super(...arguments),this.defaultState={activeTabKey:0},this.state=Object.assign({},this.defaultState),this.getAvailableTabs=()=>{const e=[];return this.isOcpAvailable()&&e.push({contentRef:m().createRef(),tab:"ocp"}),(this.isAwsAvailable()||this.isAzureAvailable()||this.isGcpAvailable()||this.isIbmAvailable()||this.isOcpCloudAvailable())&&e.push({contentRef:m().createRef(),tab:"infrastructure"}),e},this.getCostType=()=>{const{currentInfrastructurePerspective:e,currentOcpPerspective:t}=this.state;return"aws"===("infrastructure"===this.getCurrentTab()?e:t)?m().createElement("div",{style:et.costType},m().createElement(o.T,null)):null},this.getCurrentTab=()=>{const{activeTabKey:e}=this.state,t=this.isAwsAvailable(),r=this.isAzureAvailable(),s=this.isGcpAvailable(),a=this.isIbmAvailable(),c=this.isOcpAvailable(),i=this.isOcpCloudAvailable();return c&&!(t||r||s||a||i)?"ocp":!c&&(t||r||s||a||i)?"infrastructure":0===e?"ocp":"infrastructure"},this.getDefaultInfrastructurePerspective=()=>this.isOcpAvailable()&&insights.chrome.isBeta()?"ocp_cloud":this.isAwsAvailable()?"aws":this.isAzureAvailable()?"azure":this.isGcpAvailable()?"gcp":this.isIbmAvailable()?"ibm":void 0,this.getDefaultOcpPerspective=()=>{const{ocpProviders:e,ocpProvidersFetchStatus:t,userAccess:r}=this.props;if((0,Ne.mn)(r,e,t))return"ocp"},this.getPerspective=()=>{const{currentInfrastructurePerspective:e,currentOcpPerspective:t}=this.state,r=this.isAwsAvailable(),s=this.isAzureAvailable(),a=this.isGcpAvailable(),c=this.isIbmAvailable(),i=this.isOcpAvailable();if(!(r||s||a||c||i))return null;const o=[];"infrastructure"===this.getCurrentTab()?(i&&insights.chrome.isBeta()&&o.push(...lt),r&&o.push(...st),r&&i&&o.push(...at),a&&o.push(...ot),c&&o.push(...nt),s&&o.push(...ct),s&&i&&o.push(...it)):o.push(...rt);const n="infrastructure"===this.getCurrentTab()?e:t;return m().createElement(d.X,{currentItem:n||o[0].value,onSelected:this.handlePerspectiveSelected,options:o})},this.getTab=(e,t,r)=>m().createElement(s.Tab,{eventKey:r,key:`${tt(e)}-tab`,tabContentId:`tab-${r}`,tabContentRef:t,title:m().createElement(s.TabTitleText,null,this.getTabTitle(e))}),this.getTabContent=e=>e.map(((e,t)=>m().createElement(s.TabContent,{eventKey:t,key:`${tt(e.tab)}-tabContent`,id:`tab-${t}`,ref:e.contentRef},this.getTabItem(e.tab,t)))),this.getTabItem=(e,t)=>{const{awsProviders:r,azureProviders:s,gcpProviders:a,ibmProviders:c,ocpProviders:i}=this.props,{activeTabKey:o,currentInfrastructurePerspective:n,currentOcpPerspective:l}=this.state,p=m().createElement(m().Fragment,null),h=m().createElement(u.Z,{showReload:!1});if(o!==t)return p;const d=tt(e);if("infrastructure"===d)return"ocp_cloud"===n?(0,Xe.g8)(i)||(0,Xe.rL)(i)?m().createElement(je,null):h:"aws"===n?(0,Xe.g8)(r)||(0,Xe.rL)(r)?m().createElement(U,null):h:"aws_ocp"===n?(0,Xe.at)(r,i)||(0,Xe.D2)(r,i)?m().createElement(B,null):h:"gcp"===n?(0,Xe.g8)(a)||(0,Xe.rL)(a)?m().createElement(ve,null):h:"gcp_ocp"===n?(0,Xe.at)(a,i)||(0,Xe.D2)(a,i)?m().createElement(Fe,null):h:"ibm"===n?(0,Xe.g8)(c)||(0,Xe.rL)(c)?m().createElement(we,null):h:"azure"===n?(0,Xe.g8)(s)||(0,Xe.rL)(s)?m().createElement(re,null):h:"azure_ocp"===n&&((0,Xe.at)(s,i)||(0,Xe.D2)(s,i))?m().createElement(le,null):h;if("ocp"===d){const e=(0,Xe.g8)(i)||(0,Xe.rL)(i);return"ocp"===l&&e?m().createElement(ke,null):h}return p},this.getTabs=e=>{const{activeTabKey:t}=this.state;return m().createElement(s.Tabs,{activeKey:t,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e.tab,e.contentRef,t))))},this.getTabTitle=e=>{const{intl:t}=this.props;return"infrastructure"===e?t.formatMessage(l.Z.Infrastructure):"ocp"===e?t.formatMessage(l.Z.OpenShift):void 0},this.handlePerspectiveSelected=e=>{const t=this.getCurrentTab();this.setState(Object.assign(Object.assign({},"infrastructure"===t&&{currentInfrastructurePerspective:e}),"ocp"===t&&{currentOcpPerspective:e}))},this.handleTabClick=(e,t)=>{const{activeTabKey:r}=this.state;r!==t&&this.setState({activeTabKey:t})},this.isAwsAvailable=()=>{const{awsProviders:e,awsProvidersFetchStatus:t,userAccess:r}=this.props;return(0,Ne.n9)(r,e,t)},this.isAzureAvailable=()=>{const{azureProviders:e,azureProvidersFetchStatus:t,userAccess:r}=this.props;return(0,Ne.hn)(r,e,t)},this.isGcpAvailable=()=>{const{gcpProviders:e,gcpProvidersFetchStatus:t,userAccess:r}=this.props;return(0,Ne.FE)(r,e,t)},this.isIbmAvailable=()=>{const{ibmProviders:e,ibmProvidersFetchStatus:t,ibmUserAccess:r}=this.props;return(0,Ne.Es)(r,e,t)},this.isOcpAvailable=()=>{const{ocpProviders:e,ocpProvidersFetchStatus:t,userAccess:r}=this.props;return(0,Ne.mn)(r,e,t)},this.isOcpCloudAvailable=()=>this.isAwsAvailable()&&this.isOcpAvailable()}componentDidMount(){const{resetState:e}=this.props;e(),this.setState({currentInfrastructurePerspective:this.getDefaultInfrastructurePerspective(),currentOcpPerspective:this.getDefaultOcpPerspective()})}componentDidUpdate(e){const{awsProviders:t,azureProviders:r,gcpProviders:s,ibmProviders:a,ocpProviders:c,userAccess:i}=this.props;e.userAccess===i&&e.awsProviders===t&&e.azureProviders===r&&e.gcpProviders===s&&e.ibmProviders===a&&e.ocpProviders===c||this.setState({currentInfrastructurePerspective:this.getDefaultInfrastructurePerspective(),currentOcpPerspective:this.getDefaultOcpPerspective()})}render(){const{awsProvidersFetchStatus:e,azureProvidersFetchStatus:t,gcpProvidersFetchStatus:r,ibmProvidersFetchStatus:c,intl:i,ocpProvidersFetchStatus:o,userAccessFetchStatus:u}=this.props,d=this.getAvailableTabs(),g=1===e||1===t||1===r||1===c||1===o||1===u,v=!this.isAwsAvailable()&&2===e,b=!this.isAzureAvailable()&&2===t,y=!this.isGcpAvailable()&&2===r,f=!this.isIbmAvailable()&&2===c,T=!this.isOcpAvailable()&&2===o,P=v&&b&&y&&f&&T,S=i.formatMessage(l.Z.OverviewTitle);return P?m().createElement(h.Z,{title:S}):g?m().createElement(p.Z,{title:S}):m().createElement(m().Fragment,null,m().createElement("header",{style:et.header},m().createElement("div",{style:et.headerContent},m().createElement(s.Title,{headingLevel:"h1",size:s.TitleSizes["2xl"]},S,m().createElement("span",{style:et.infoIcon},m().createElement(s.Popover,{"aria-label":i.formatMessage(l.Z.OverviewInfoArialLabel),enableFlip:!0,bodyContent:m().createElement(m().Fragment,null,m().createElement("p",{style:et.infoTitle},i.formatMessage(l.Z.OpenShiftCloudInfrastructure)),m().createElement("p",null,i.formatMessage(l.Z.OpenShiftCloudInfrastructureDesc)),m().createElement("br",null),m().createElement("p",{style:et.infoTitle},i.formatMessage(l.Z.OpenShift)),m().createElement("p",null,i.formatMessage(l.Z.OpenShiftDesc)),m().createElement("br",null),m().createElement("p",{style:et.infoTitle},i.formatMessage(l.Z.GCP)),m().createElement("p",null,i.formatMessage(l.Z.GCPDesc)),m().createElement("br",null),m().createElement("p",{style:et.infoTitle},i.formatMessage(l.Z.IBM)),m().createElement("p",null,i.formatMessage(l.Z.IBMDesc)),m().createElement("br",null),m().createElement("p",{style:et.infoTitle},i.formatMessage(l.Z.AWS)),m().createElement("p",null,i.formatMessage(l.Z.AWSDesc)),m().createElement("br",null),m().createElement("p",{style:et.infoTitle},i.formatMessage(l.Z.Azure)),m().createElement("p",null,i.formatMessage(l.Z.AzureDesc)))},m().createElement(s.Button,{variant:s.ButtonVariant.plain},m().createElement(a.iC,null))))),m().createElement(n.F,null)),m().createElement("div",{style:et.tabs},this.getTabs(d)),m().createElement("div",{style:et.headerContent},m().createElement("div",{style:et.headerContentLeft},this.getPerspective(),this.getCostType()),m().createElement("div",{style:et.date},(0,Be.J4)()))),m().createElement("div",{style:et.main},this.getTabContent(d)))}}const ut=(0,y.X1)(((e,t)=>{const r=(0,c.H)(xe.JL),s=xe.aX.selectProviders(e,"aws",r),a=xe.aX.selectProvidersFetchStatus(e,"aws",r),o=(0,c.H)(xe.u5),n=xe.aX.selectProviders(e,"azure",o),l=xe.aX.selectProvidersFetchStatus(e,"azure",o),p=(0,c.H)(xe.U6),u=xe.aX.selectProviders(e,"gcp",p),h=xe.aX.selectProvidersFetchStatus(e,"gcp",p),d=(0,c.H)(xe.t8),g=xe.aX.selectProviders(e,"ibm",d),m=xe.aX.selectProvidersFetchStatus(e,"ibm",d),v=(0,c.H)(xe.Vp),b=xe.aX.selectProviders(e,"ocp",v),y=xe.aX.selectProvidersFetchStatus(e,"ocp",v),f=(0,i.T)(Je.BD),T=Je.JO.selectUserAccess(e,"",f),P=Je.JO.selectUserAccessError(e,"",f),S=Je.JO.selectUserAccessFetchStatus(e,"",f),F=(0,i.T)(Je.HC);return{awsProviders:s,awsProvidersFetchStatus:a,awsProvidersQueryString:r,azureProviders:n,azureProvidersFetchStatus:l,azureProvidersQueryString:o,gcpProviders:u,gcpProvidersFetchStatus:h,gcpProvidersQueryString:p,ibmProviders:g,ibmProvidersFetchStatus:m,ibmProvidersQueryString:d,ibmUserAccess:Je.JO.selectUserAccess(e,"ibm",F),ibmUserAccessError:Je.JO.selectUserAccessError(e,"ibm",F),ibmUserAccessFetchStatus:Je.JO.selectUserAccessFetchStatus(e,"ibm",F),ibmUserAccessQueryString:F,ocpProviders:b,ocpProvidersFetchStatus:y,ocpProvidersQueryString:v,userAccess:T,userAccessError:P,userAccessFetchStatus:S,userAccessQueryString:f}})),ht={resetState:Ge.Aw.oA},dt=(0,L.ZP)((0,b.connect)(ut,ht)(pt))},99291:(e,t,r)=>{r.d(t,{cR:()=>c,ZV:()=>i,xG:()=>o,$l:()=>n,og:()=>l,Wx:()=>p,bM:()=>u,rl:()=>h});var s=r(32004),a=r(93952);const c=(e,t=!1)=>{const r=t?Number("1.1").toLocaleString((0,s.K)(),{}).substring(1,2):".",a=e.split(r);return a[1]?a[1].length:0},i=e=>{const t=e?e.replace(/[- ]/g,"_").toLowerCase():"";switch(t){case"core_hours":case"gb":case"gb_hours":case"gb_mo":case"gibibyte_month":case"hour":case"hrs":case"tag_mo":case"vm_hours":return t;default:return}},o=(e,t,r={})=>{let a=e;return e||(a=0),s.N.formatNumber(a,Object.assign({style:"currency",currency:t?t.toUpperCase():"USD"},r))},n=(e,t="USD")=>{let r=e;e||(r=0);const c=[{val:1e15,symbol:"quadrillion"},{val:1e12,symbol:"trillion"},{val:1e9,symbol:"billion"},{val:1e6,symbol:"million"},{val:1e3,symbol:"thousand"}];let i;if(null!=c&&(i=c.find((e=>r>=e.val))),null!=i){const{val:e,symbol:c}=i;return s.N.formatMessage(a.Z.CurrencyAbbreviations,{symbol:c,value:o(r/e,t,{minimumFractionDigits:0,maximumFractionDigits:0})})}return o(e,t,{minimumFractionDigits:0,maximumFractionDigits:0})},l=(e,t,r={minimumFractionDigits:0,maximumFractionDigits:10})=>o(e,t,r),p=(e,t=(0,s.K)())=>{const r=Number("1.1").toLocaleString(t,{}).substring(1,2),a=","===r?/\./g:/,/g;return e.replace(a,r)},u=(e,t,r)=>{const s=e||0;switch(i(t)){case"core_hours":case"hour":case"hrs":return g(s,r);case"gb":case"gb_hours":case"gb_mo":case"gibibyte_month":case"tag_mo":case"vm_hours":return d(s,r)}return m(s,r)},h=(e,t={minimumFractionDigits:0,maximumFractionDigits:2})=>e.toLocaleString((0,s.K)(),t),d=(e,t={minimumFractionDigits:0,maximumFractionDigits:0})=>e.toLocaleString((0,s.K)(),t),g=(e,t={minimumFractionDigits:0,maximumFractionDigits:0})=>e.toLocaleString((0,s.K)(),t),m=(e,t)=>e.toLocaleString((0,s.K)(),t)},45785:(e,t,r)=>{r.d(t,{KT:()=>c,n9:()=>i,FW:()=>o,hn:()=>n,ot:()=>l,Sv:()=>p,FE:()=>u,tt:()=>h,Es:()=>d,Rt:()=>g,mn:()=>m});const s=(e,t)=>{let r=!1;if(e&&Array.isArray(e.data)){const s=e.data.find((e=>e.type===t));r=s&&s.access}else r=e&&!0===e.data;return r},a=(e,t)=>{let r=!1;return 2===t&&(r=void 0!==e&&void 0!==e.meta&&e.meta.count>0),r},c=e=>s(e,"aws"),i=(e,t,r)=>c(e)&&a(t,r),o=e=>s(e,"azure"),n=(e,t,r)=>o(e)&&a(t,r),l=e=>s(e,"cost_model"),p=e=>s(e,"gcp"),u=(e,t,r)=>s(e,"gcp")&&a(t,r),h=e=>p(e),d=(e,t,r)=>h(e)&&a(t,r),g=e=>s(e,"ocp"),m=(e,t,r)=>g(e)&&a(t,r)}}]);
//# sourceMappingURL=5f6aed8bd8c88b7cab4b.bundle.js.map