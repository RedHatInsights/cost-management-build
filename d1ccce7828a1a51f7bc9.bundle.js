(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[2340],{66785:(e,t,r)=>{"use strict";r.d(t,{T:()=>a});var s=r(43702);function a(e){return(0,s.stringify)(e,{encode:!1,indices:!1})}},52413:(e,t,r)=>{"use strict";r.d(t,{G:()=>i});var s=r(48927),a=r(97522),o=r.n(a);const i=(0,r(79878).withTranslation)()((({t:e})=>{const t=e("loading_state.sources_title"),r=e("loading_state.sources_desc");return o().createElement(s.EmptyState,{variant:s.EmptyStateVariant.large,className:"pf-m-redhat-font"},o().createElement(s.Spinner,{size:"lg"}),o().createElement(s.Title,{headingLevel:"h5",size:"lg"},t),o().createElement(s.EmptyStateBody,null,r))}))},52448:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ot});var s=r(48927),a=r(55795),o=r(86208),i=r(66785),c=r(97522),n=r.n(c);const p=({DashboardWidget:e,selectWidgets:t,widgets:r})=>n().createElement("div",null,n().createElement(s.Grid,{hasGutter:!0},r.map((r=>t[r].details.showHorizontal?n().createElement(s.GridItem,{sm:12,key:r},n().createElement(e,{widgetId:r})):n().createElement(s.GridItem,{lg:12,xl:6,xl2:4,key:r},n().createElement(e,{widgetId:r}))))));var l=r(79878),u=r(86588),h=r(94377),d=r(37062),g=r(95078),v=r(60232),m=r(35956),b=r(36234),y=r(17230),T=r(55399),f=r(901);class w extends n().Component{constructor(){super(...arguments),this.defaultState={isChartComparisonOpen:!1},this.state=Object.assign({},this.defaultState),this.getDropDownItems=()=>{const{options:e,t}=this.props;return e.map((e=>n().createElement(s.DropdownItem,{component:"button",key:e.value,onClick:()=>this.handleClick(e.value)},t(e.label))))},this.getCurrentLabel=()=>{const{currentItem:e,options:t,t:r}=this.props;let s="";for(const a of t)if(e===a.value){s=r(a.label);break}return s},this.handleClick=e=>{const{onItemClicked:t}=this.props;t&&t(e)},this.handleSelect=()=>{this.setState({isChartComparisonOpen:!this.state.isChartComparisonOpen})},this.handleToggle=e=>{this.setState({isChartComparisonOpen:e})}}render(){const{isChartComparisonOpen:e}=this.state,t=this.getDropDownItems();return n().createElement(s.Dropdown,{onSelect:this.handleSelect,toggle:n().createElement(s.DropdownToggle,{onToggle:this.handleToggle},this.getCurrentLabel()),isOpen:e,dropdownItems:t})}}const R=(0,l.withTranslation)()(w);var D=r(91707),C=r(32412),P=r(57640);const F={chartAltHeight:250,chartHeight:180,containerAltHeight:250,containerTrendHeight:180,containerUsageHeight:180},S={comparison:{marginBottom:C.ZP.value},tabs:{marginTop:D.ZP.value},tabItems:{marginTop:P.ZP.value}};class I extends n().Component{constructor(){super(...arguments),this.state={activeTabKey:0,currentComparison:"cumulative"},this.buildDetailsLink=e=>{const{details:t,getIdKeyForTab:r}=this.props,s=r(e);return`${t.viewAllPath}?${(0,g.pm)({group_by:{[s]:"*"},order_by:{cost:"desc"}})}`},this.getChart=(e,t,r=!1)=>{const{chartType:s,trend:a}=this.props;return"dailyTrend"===s?this.getDailyTrendChart(e,t,r,a.showSupplementaryLabel):"dailyCost"===s?this.getDailyCostChart(e,t,r):"trend"===s?this.getTrendChart(e,t,r,a.showSupplementaryLabel):"usage"===s?this.getUsageChart(t,r):null},this.getChartComparison=()=>{const{t:e,trend:t}=this.props,{currentComparison:r}=this.state,s=this.getUnits(),a=e(t.titleKey,{units:e(`units.${s}`)}),o=[{label:e(t.dailyTitleKey,{units:e(`units.${s}`)}),value:"daily"},{label:a,value:"cumulative"}];return n().createElement(R,{currentItem:r||o[0].value,onItemClicked:this.handleComparisonClick,options:o})},this.getDailyCostChart=(e,t,r=!1)=>{const{currentReport:s,previousReport:a,trend:o}=this.props,{currentComparison:i}=this.state,c=o.computedReportItem,p=o.computedReportItemValue,l="daily"===i,u=l?1:o.type,h=(0,v.zJ)(s,u,"date","infrastructure",p),d=(0,v.zJ)(a,u,"date","infrastructure",p),g=(0,v.zJ)(s,u,"date",c,p),b=(0,v.zJ)(a,u,"date",c,p),y=this.getForecastData(s,o.computedForecastItem),T=this.getForecastData(s,o.computedForecastInfrastructureItem),w=l?m.V3:m.me;return n().createElement(n().Fragment,null,n().createElement("div",{style:S.comparison},this.getChartComparison()),n().createElement(w,{adjustContainerHeight:r,containerHeight:e,currentCostData:g,currentInfrastructureCostData:h,forecastConeData:y.forecastConeData,forecastData:y.forecastData,forecastInfrastructureConeData:T.forecastConeData,forecastInfrastructureData:T.forecastData,formatDatumValue:f.Bw,formatDatumOptions:o.formatOptions,height:t,previousCostData:b,previousInfrastructureCostData:d,showForecast:void 0!==o.computedForecastItem}))},this.getDailyTrendChart=(e,t,r=!1,s=!1)=>{const{currentReport:a,details:o,previousReport:i,trend:c}=this.props,{currentComparison:p}=this.state,l=this.getUnits(),u=c.computedReportItem,h=c.computedReportItemValue,d="daily"===p,g=d?1:c.type,b=(0,v.zJ)(a,g,"date",u,h),y=(0,v.zJ)(i,g,"date",u,h),{forecastData:T,forecastConeData:w}=this.getForecastData(a,c.computedForecastItem),R=d?m.Y0:m.Nd;return n().createElement(n().Fragment,null,n().createElement("div",{style:S.comparison},this.getChartComparison()),n().createElement(R,{adjustContainerHeight:r,containerHeight:e,currentData:b,forecastData:T,forecastConeData:w,formatDatumValue:f.Bw,formatDatumOptions:c.formatOptions,height:t,previousData:y,showForecast:void 0!==c.computedForecastItem,showSupplementaryLabel:s,showUsageLegendLabel:o.showUsageLegendLabel,units:l}))},this.getForecastData=(e,t="cost")=>{const{forecast:r,trend:s}=this.props,{currentComparison:a}=this.state,o="daily"===a?1:s.type;let i,c;if(t){const s=(0,y.cloneDeep)(r);if(s&&(s.data=[]),r&&e&&e.data){const a=e.meta&&e.meta.total&&e.meta.total[t]?e.meta.total[t].total.value:0,i=e.data.filter((e=>e.values.length)),c=i[i.length-1]?i[i.length-1].date:void 0;if(r&&r.data){const e=new Date(c),t=e.getMonth()+1;for(const a of r.data){const r=new Date(a.date),o=r.getMonth()+1;r>e&&t===o&&s.data.push(a)}}0===o&&s.data.unshift({date:c,values:[{date:c,cost:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:"USD"}},infrastructure:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:"USD"}},supplementary:{confidence_max:{value:0},confidence_min:{value:0},total:{value:a,units:"USD"}}}]})}i=(0,v.nB)(s,o,t),c=(0,v.Qw)(s,o,t)}return{forecastData:i,forecastConeData:c}},this.getTrendChart=(e,t,r=!1,s=!1)=>{const{currentReport:a,details:o,previousReport:i,t:c,trend:p}=this.props,l=this.getUnits(),u=c(p.titleKey,{units:c(`units.${l}`)}),h=p.computedReportItem,d=p.computedReportItemValue,g=(0,v.zJ)(a,p.type,"date",h,d),b=(0,v.zJ)(i,p.type,"date",h,d),{forecastData:y,forecastConeData:T}=this.getForecastData(a,p.computedForecastItem);return n().createElement(m.Nd,{adjustContainerHeight:r,containerHeight:e,currentData:g,forecastData:y,forecastConeData:T,formatDatumValue:f.Bw,formatDatumOptions:p.formatOptions,height:t,previousData:b,showForecast:void 0!==p.computedForecastItem,showSupplementaryLabel:s,showUsageLegendLabel:o.showUsageLegendLabel,title:u,units:l})},this.getUsageChart=(e,t=!1)=>{const{currentReport:r,previousReport:s,t:a,trend:o}=this.props,i=this.getUnits(),c=a(o.titleKey,{units:a(`units.${i}`)}),p=(0,v.zJ)(r,o.type,"date","request"),l=(0,v.zJ)(s,o.type,"date","request"),u=(0,v.zJ)(r,o.type,"date","usage"),h=(0,v.zJ)(s,o.type,"date","usage");return n().createElement(m.I0,{adjustContainerHeight:t,containerHeight:F.containerUsageHeight,currentRequestData:p,currentUsageData:u,formatDatumValue:f.Bw,formatDatumOptions:o.formatOptions,height:e,previousRequestData:l,previousUsageData:h,title:c})},this.getDetails=()=>{const{chartType:e,currentReport:t,details:r,reportType:s,trend:a}=this.props,o=a.computedReportItem||"cost",i=a.computedReportItemValue||"total",c=this.getUnits();return n().createElement(m.rN,{chartType:e,computedReportItem:o,computedReportItemValue:i,costLabel:this.getDetailsLabel(r.costKey,c),formatOptions:r.formatOptions,formatValue:f.Bw,report:t,reportType:s,requestLabel:this.getDetailsLabel(r.requestKey,c),showTooltip:r.showTooltip,showUnits:r.showUnits,showUsageFirst:r.showUsageFirst,units:r.units,usageFormatOptions:r.usageFormatOptions,usageLabel:this.getDetailsLabel(r.usageKey,c)})},this.getDetailsLabel=(e,t)=>{const{t:r}=this.props;return e?r(e,{units:r(`units.${t}`)}):void 0},this.getDetailsLink=()=>{const{currentTab:e,details:t}=this.props;return t.viewAllPath?n().createElement(T.Link,{to:this.buildDetailsLink(e),onClick:this.handleInsightsNavClick},this.getDetailsLinkTitle(e)):null},this.getDetailsLinkTitle=e=>{const{getIdKeyForTab:t,t:r}=this.props;return r("group_by.all",{groupBy:t(e)||""})},this.getHorizontalLayout=()=>{const{containerAltHeight:e=F.containerAltHeight,chartAltHeight:t=F.chartAltHeight,currentReportFetchStatus:r,details:s}=this.props;return n().createElement(m.j0,{detailsLink:this.getDetailsLink(),status:r,subTitle:this.getSubTitle(),tabs:this.getTabs(),title:this.getTitle()},this.getDetails(),this.getChart(e,t,s.adjustContainerHeight))},this.getSubTitle=()=>{const{t:e}=this.props,t=new Date,r=(0,b.getMonth)(t),s=(0,b.format)(t,"d"),a=(0,b.format)((0,b.startOfMonth)(t),"d");return e("dashboard.widget_subtitle",{count:(0,b.getDate)(t),endDate:s,month:r,startDate:a})},this.getTab=(e,t)=>{const{getIdKeyForTab:r,tabsReport:a,tabsReportFetchStatus:o}=this.props,i=r(e);return n().createElement(s.Tab,{eventKey:t,key:`${r(e)}-tab`,title:n().createElement(s.TabTitleText,null,this.getTabTitle(e))},n().createElement("div",{style:S.tabItems},n().createElement(m.mZ,{idKey:i,key:`${i}-items`,report:a,status:o},(({items:t})=>t.map((t=>this.getTabItem(e,t)))))))},this.getTabItem=(e,t)=>{const{availableTabs:r,details:s,getIdKeyForTab:a,tabsReport:o,topItems:i,trend:c}=this.props,{activeTabKey:p}=this.state,l=a(e),u=a(r[p]),h=c.computedReportItem||"cost",d=c.computedReportItemValue||"total";let g;const v=o&&o.meta&&o.meta.total;return"usage"===h?v&&o.meta.total.usage&&(g=o.meta.total.usage.value):v&&o.meta.total[h]&&o.meta.total[h][d]&&(g=o.meta.total[h][d].value),u===l?n().createElement(m.EH,{key:`${t.id}-item`,formatOptions:i.formatOptions,formatValue:f.Bw,label:t.label?t.label.toString():"",totalValue:g,units:s.units?s.units:this.getUnits(),value:t[h][d].value}):null},this.getTabs=()=>{const{availableTabs:e}=this.props;return n().createElement(s.Tabs,{isFilled:!0,activeKey:this.state.activeTabKey,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e,t))))},this.getTabTitle=e=>{const{getIdKeyForTab:t,t:r}=this.props;return r("group_by.top",{groupBy:t(e)||""})},this.getTitle=()=>{const{t:e,titleKey:t}=this.props,r=new Date,s=(0,b.getMonth)(r);return e(t,{endDate:(0,b.format)(r,"Do"),month:s,startDate:(0,b.format)((0,b.startOfMonth)(r),"Do")})},this.getUnits=()=>{const{currentReport:e,details:t,trend:r}=this.props,s=r.computedReportItem||"cost",a=r.computedReportItemValue||"total";if(t.units)return t.units;let o;const i=e&&e.meta&&e.meta.total;return o="usage"===s?i&&e.meta.total.usage?(0,f.dM)(e.meta.total.usage.units):"":i&&e.meta.total[s]&&e.meta.total[s][a]?(0,f.dM)(e.meta.total[s][a].units):"",o},this.getVerticalLayout=()=>{const{availableTabs:e,currentReportFetchStatus:t,details:r}=this.props;return n().createElement(m.iu,{detailsLink:this.getDetailsLink(),status:t,subTitle:this.getSubTitle(),title:this.getTitle()},this.getDetails(),this.getChart(F.containerTrendHeight,F.chartHeight,r.adjustContainerHeight),Boolean(e)&&n().createElement("div",{style:S.tabs},this.getTabs()))},this.handleComparisonClick=e=>{this.setState({currentComparison:e})},this.handleInsightsNavClick=()=>{const{details:e}=this.props;e.appNavId&&insights.chrome.appNavClick({id:e.appNavId,secondaryNav:!0})},this.handleTabClick=(e,t)=>{const{availableTabs:r,id:s,updateTab:a}=this.props;a(s,r[t]),this.setState({activeTabKey:t})}}componentDidMount(){const{availableTabs:e,fetchForecasts:t,fetchReports:r,id:s,trend:a,updateTab:o,widgetId:i}=this.props;e&&o(s,e[0]),r&&r(i),void 0!==a.computedForecastItem&&t(i)}render(){const{details:e}=this.props;return e.showHorizontal?this.getHorizontalLayout():this.getVerticalLayout()}}var E=r(40693),_=r(90203);const O=e=>{switch(e){case"services":return"service";case"accounts":return"account";case"regions":return"region";case"instance_type":return"instance_type"}},A=(0,h.X1)(((e,{widgetId:t})=>{const r=d.jh.selectWidget(e,t),s=d.jh.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:O,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:E.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),V={fetchForecasts:d.k4.v4,fetchReports:d.k4.a4,updateTab:d.k4.as},W=(0,l.withTranslation)()((0,u.connect)(A,V)(I)),Z=(0,h.X1)(((e,t)=>({DashboardWidget:W,selectWidgets:d.jh.selectWidgets(e),widgets:d.jh.selectCurrentWidgets(e)}))),j=(0,l.withTranslation)()((0,u.connect)(Z,{})(p));var k=r(67119);const Q=e=>{switch(e){case"services":return"service";case"accounts":return"account";case"regions":return"region";case"instance_type":return"instance_type"}},L=(0,h.X1)(((e,{widgetId:t})=>{const r=k.Cv.selectWidget(e,t),s=k.Cv.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Q,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:E.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),z={fetchForecasts:k.Kf.v4,fetchReports:k.Kf.a4,updateTab:k.Kf.as},K=(0,l.withTranslation)()((0,u.connect)(L,z)(I)),H=(0,h.X1)(((e,t)=>({DashboardWidget:K,selectWidgets:k.Cv.selectWidgets(e),widgets:k.Cv.selectCurrentWidgets(e)}))),U=(0,l.withTranslation)()((0,u.connect)(H,{})(p));var X=r(49016);const x=e=>{switch(e){case"service_names":return"service_name";case"subscription_guids":return"subscription_guid";case"resource_locations":return"resource_location";case"instance_type":return"instance_type"}},M=(0,h.X1)(((e,{widgetId:t})=>{const r=X.$I.selectWidget(e,t),s=X.$I.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:x,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:E.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),B={fetchForecasts:X._S.v4,fetchReports:X._S.a4,updateTab:X._S.as},$=(0,l.withTranslation)()((0,u.connect)(M,B)(I)),N=(0,h.X1)(((e,t)=>({DashboardWidget:$,selectWidgets:X.$I.selectWidgets(e),widgets:X.$I.selectCurrentWidgets(e)}))),J=(0,l.withTranslation)()((0,u.connect)(N,{})(p));var G=r(31554);const q=e=>{switch(e){case"service_names":return"service_name";case"subscription_guids":return"subscription_guid";case"resource_locations":return"resource_location";case"instance_type":return"instance_type"}},Y=(0,h.X1)(((e,{widgetId:t})=>{const r=G.rj.selectWidget(e,t),s=G.rj.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:q,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:E.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),ee={fetchForecasts:G.oc.v4,fetchReports:G.oc.a4,updateTab:G.oc.as},te=(0,l.withTranslation)()((0,u.connect)(Y,ee)(I)),re=(0,h.X1)(((e,t)=>({DashboardWidget:te,selectWidgets:G.rj.selectWidgets(e),widgets:G.rj.selectCurrentWidgets(e)}))),se=(0,l.withTranslation)()((0,u.connect)(re,{})(p));var ae=r(79522);const oe=e=>{switch(e){case"services":return"service";case"projects":return"project";case"regions":return"region";case"instance_type":return"instance_type"}},ie=(0,h.X1)(((e,{widgetId:t})=>{const r=ae.oS.selectWidget(e,t),s=ae.oS.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:oe,currentQuery:s.current,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:E.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),ce={fetchForecasts:ae.n5.v4,fetchReports:ae.n5.a4,updateTab:ae.n5.as},ne=(0,l.withTranslation)()((0,u.connect)(ie,ce)(I)),pe=(0,h.X1)(((e,t)=>({DashboardWidget:ne,selectWidgets:ae.oS.selectWidgets(e),widgets:ae.oS.selectCurrentWidgets(e)}))),le=(0,l.withTranslation)()((0,u.connect)(pe,{})(p));var ue=r(83123);const he=e=>{switch(e){case"accounts":return"account";case"regions":return"region";case"services":return"service"}},de=(0,h.X1)(((e,{widgetId:t})=>{const r=ue.qN.selectWidget(e,t),s=ue.qN.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:he,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:E.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),ge={fetchForecasts:ue.BV.v4,fetchReports:ue.BV.a4,updateTab:ue.BV.as},ve=(0,l.withTranslation)()((0,u.connect)(de,ge)(I)),me=(0,h.X1)(((e,t)=>({DashboardWidget:ve,selectWidgets:ue.qN.selectWidgets(e),widgets:ue.qN.selectCurrentWidgets(e)}))),be=(0,l.withTranslation)()((0,u.connect)(me,{})(p));var ye=r(17563);const Te=e=>{switch(e){case"clusters":return"cluster";case"nodes":return"node";case"projects":return"project"}},fe=(0,h.X1)(((e,{widgetId:t})=>{const r=ye.nH.selectWidget(e,t),s=ye.nH.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Te,chartAltHeight:250,containerAltHeight:250,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:E.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),we={fetchForecasts:ye.U6.v4,fetchReports:ye.U6.a4,updateTab:ye.U6.as},Re=(0,l.withTranslation)()((0,u.connect)(fe,we)(I)),De=(0,h.X1)(((e,t)=>({DashboardWidget:Re,selectWidgets:ye.nH.selectWidgets(e),widgets:ye.nH.selectCurrentWidgets(e)}))),Ce=(0,l.withTranslation)()((0,u.connect)(De,{})(p));var Pe=r(77e3);const Fe=e=>{switch(e){case"clusters":return"cluster";case"nodes":return"node";case"projects":return"project"}},Se=(0,h.X1)(((e,{widgetId:t})=>{const r=Pe.xX.selectWidget(e,t),s=Pe.xX.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Fe,currentQuery:s.current,forecastQuery:s.forecast,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),forecast:E.mj.selectForecast(e,r.forecastPathsType,r.forecastType,s.forecast),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Ie={fetchForecasts:Pe.T3.v4,fetchReports:Pe.T3.a4,updateTab:Pe.T3.as},Ee=(0,l.withTranslation)()((0,u.connect)(Se,Ie)(I)),_e=(0,h.X1)(((e,t)=>({DashboardWidget:Ee,selectWidgets:Pe.xX.selectWidgets(e),widgets:Pe.xX.selectCurrentWidgets(e)}))),Oe=(0,l.withTranslation)()((0,u.connect)(_e,{})(p));var Ae=r(2891);const Ve=e=>{switch(e){case"clusters":return"cluster";case"nodes":return"node";case"projects":return"project"}},We=(0,h.X1)(((e,{widgetId:t})=>{const r=Ae.b2.selectWidget(e,t),s=Ae.b2.selectWidgetQueries(e,t);return Object.assign(Object.assign({},r),{getIdKeyForTab:Ve,currentQuery:s.current,previousQuery:s.previous,tabsQuery:s.tabs,currentReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.current),currentReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.current),previousReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.previous),tabsReport:_.ZV.selectReport(e,r.reportPathsType,r.reportType,s.tabs),tabsReportFetchStatus:_.ZV.selectReportFetchStatus(e,r.reportPathsType,r.reportType,s.tabs)})})),Ze={fetchReports:Ae.K5.a4,updateTab:Ae.K5.as},je=(0,l.withTranslation)()((0,u.connect)(We,Ze)(I)),ke=(0,h.X1)(((e,t)=>({DashboardWidget:je,selectWidgets:Ae.b2.selectWidgets(e),widgets:Ae.b2.selectCurrentWidgets(e)}))),Qe=(0,l.withTranslation)()((0,u.connect)(ke,{})(p));var Le=r(73466),ze=r(13883),Ke=r(45235),He=r(1723),Ue=r(64146),Xe=r(17918),xe=r(98499);const Me={infoIcon:{fontSize:Xe.ZP.value},infoTitle:{fontWeight:"bold"},perspective:{marginTop:xe.ZP.value},tabs:{marginTop:xe.ZP.value}};var Be=r(62849);const $e=e=>{switch(e){case"infrastructure":return"infrastructure";case"ocp":return"ocp"}},Ne=[{label:"overview.perspective.all",value:"all"},{label:"overview.perspective.supplementary",value:"supplementary"}],Je=[{label:"overview.perspective.all_cloud",value:"all_cloud"}],Ge=[{label:"overview.perspective.aws",value:"aws"}],qe=[{label:"overview.perspective.aws_cloud",value:"aws_cloud"}],Ye=[{label:"overview.perspective.azure",value:"azure"}],et=[{label:"overview.perspective.azure_cloud",value:"azure_cloud"}],tt=[{label:"overview.perspective.gcp",value:"gcp"}],rt=[{label:"overview.perspective.ocp_usage",value:"ocp_usage"}];class st extends n().Component{constructor(){super(...arguments),this.defaultState={activeTabKey:0},this.state=Object.assign({},this.defaultState),this.getAvailableTabs=()=>{const e=[],t=this.isAwsAvailable(),r=this.isAzureAvailable(),s=this.isGcpAvailable(),a=this.isOcpAvailable(),o=this.isOcpCloudAvailable();return a&&e.push({contentRef:n().createRef(),tab:"ocp"}),(t||r||s||o)&&e.push({contentRef:n().createRef(),tab:"infrastructure"}),e},this.getCurrentTab=()=>{const{activeTabKey:e}=this.state,t=this.isAwsAvailable(),r=this.isAzureAvailable(),s=this.isGcpAvailable(),a=this.isOcpAvailable(),o=this.isOcpCloudAvailable();return a&&!(t||r||s||o)?"ocp":!a&&(t||r||s||o)?"infrastructure":0===e?"ocp":"infrastructure"},this.getDefaultInfrastructurePerspective=()=>{const e=this.isAwsAvailable(),t=this.isAzureAvailable(),r=this.isGcpAvailable();return this.isOcpAvailable()?"all_cloud":e?"aws":t?"azure":r?"gcp":void 0},this.getDefaultOcpPerspective=()=>{if(this.isOcpAvailable())return"all"},this.getPerspective=()=>{const{currentInfrastructurePerspective:e,currentOcpPerspective:t}=this.state,r=this.isAwsAvailable(),s=this.isAzureAvailable(),a=this.isGcpAvailable(),o=this.isOcpAvailable();if(!(r||s||a||o))return null;const i=[];"infrastructure"===this.getCurrentTab()?(o&&i.push(...Je),r&&i.push(...Ge),o&&r&&i.push(...qe),a&&i.push(...tt),s&&i.push(...Ye),o&&s&&i.push(...et),o&&i.push(...rt)):i.push(...Ne);const c="infrastructure"===this.getCurrentTab()?e:t;return n().createElement(Be.X,{currentItem:c||i[0].value,onItemClicked:this.handlePerspectiveClick,options:i})},this.getTab=(e,t,r)=>n().createElement(s.Tab,{eventKey:r,key:`${$e(e)}-tab`,tabContentId:`tab-${r}`,tabContentRef:t,title:n().createElement(s.TabTitleText,null,this.getTabTitle(e))}),this.getTabContent=e=>e.map(((e,t)=>n().createElement(s.TabContent,{eventKey:t,key:`${$e(e.tab)}-tabContent`,id:`tab-${t}`,ref:e.contentRef},this.getTabItem(e.tab,t)))),this.hasCurrentMonthData=e=>{let t=!1;if(e&&e.data)for(const r of e.data)if(r.current_month_data){t=!0;break}return t},this.getTabItem=(e,t)=>{const{awsProviders:r,azureProviders:s,gcpProviders:a,ocpProviders:o}=this.props,{activeTabKey:i,currentInfrastructurePerspective:c,currentOcpPerspective:p}=this.state,l=n().createElement(n().Fragment,null),u=n().createElement(Ue.Z,{showReload:!1});if(i!==t)return l;const h=$e(e);return"infrastructure"===h?"all_cloud"===c?this.hasCurrentMonthData(o)?n().createElement(be,null):u:"aws"===c?this.hasCurrentMonthData(r)?n().createElement(U,null):u:"aws_cloud"===c?this.hasCurrentMonthData(r)?n().createElement(j,null):u:"gcp"===c?this.hasCurrentMonthData(a)?n().createElement(le,null):u:"azure"===c?this.hasCurrentMonthData(s)?n().createElement(se,null):u:"azure_cloud"===c?this.hasCurrentMonthData(s)?n().createElement(J,null):u:"ocp_usage"===c?this.hasCurrentMonthData(o)?n().createElement(Qe,null):u:this.hasCurrentMonthData(o)?n().createElement(be,null):u:"ocp"===h?"all"===p?this.hasCurrentMonthData(o)?n().createElement(Ce,null):u:"supplementary"===p?this.hasCurrentMonthData(o)?n().createElement(Oe,null):u:this.hasCurrentMonthData(o)?n().createElement(Ce,null):u:l},this.getTabs=e=>{const{activeTabKey:t}=this.state;return n().createElement(s.Tabs,{activeKey:t,onSelect:this.handleTabClick},e.map(((e,t)=>this.getTab(e.tab,e.contentRef,t))))},this.getTabTitle=e=>{const{t}=this.props;return"infrastructure"===e?t("overview.infrastructure"):"ocp"===e?t("overview.ocp"):void 0},this.handlePerspectiveClick=e=>{const t=this.getCurrentTab();this.setState(Object.assign(Object.assign({},"infrastructure"===t&&{currentInfrastructurePerspective:e}),"ocp"===t&&{currentOcpPerspective:e}))},this.handleTabClick=(e,t)=>{const{activeTabKey:r}=this.state;r!==t&&this.setState({activeTabKey:t})},this.isAwsAvailable=()=>{const{awsProviders:e,userAccess:t}=this.props,r=t.data.find((e=>"aws"===e.type));return r&&r.access&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isAzureAvailable=()=>{const{azureProviders:e,userAccess:t}=this.props,r=t.data.find((e=>"azure"===e.type));return r&&r.access&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isGcpAvailable=()=>{const{gcpProviders:e,userAccess:t}=this.props,r=t.data.find((e=>"gcp"===e.type));return r&&r.access&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isOcpAvailable=()=>{const{ocpProviders:e,userAccess:t}=this.props,r=t.data.find((e=>"ocp"===e.type));return r&&r.access&&void 0!==e&&void 0!==e.meta&&e.meta.count>0},this.isOcpCloudAvailable=()=>this.isAwsAvailable()&&this.isOcpAvailable()}componentDidMount(){this.setState({currentInfrastructurePerspective:this.getDefaultInfrastructurePerspective(),currentOcpPerspective:this.getDefaultOcpPerspective()})}componentDidUpdate(e){const{awsProviders:t,azureProviders:r,gcpProviders:s,ocpProviders:a,userAccess:o}=this.props;e.userAccess===o&&e.awsProviders===t&&e.azureProviders===r&&e.gcpProviders===s&&e.ocpProviders===a||this.setState({currentInfrastructurePerspective:this.getDefaultInfrastructurePerspective(),currentOcpPerspective:this.getDefaultOcpPerspective()})}render(){const{awsProvidersFetchStatus:e,azureProvidersFetchStatus:t,gcpProvidersFetchStatus:r,ocpProvidersFetchStatus:o,userAccessFetchStatus:i,t:c}=this.props,p=this.getAvailableTabs(),l=1===e||1===t||1===r||1===o||1===i,u=!this.isAwsAvailable()&&2===e,h=!this.isAzureAvailable()&&2===t,d=!this.isGcpAvailable()&&2===r,g=!this.isOcpAvailable()&&2===o,v=u&&h&&d&&g,m=c("navigation.overview");return v?n().createElement(ze.Z,{title:m}):l?n().createElement(Le.Z,{title:m}):n().createElement(n().Fragment,null,n().createElement("section",{className:"pf-l-page-header pf-c-page-header pf-l-page__main-section pf-c-page__main-section pf-m-light headerOverride}"},n().createElement("header",{className:"pf-u-display-flex pf-u-justify-content-space-between pf-u-align-items-center"},n().createElement(s.Title,{headingLevel:"h2",size:"2xl"},c("overview.title"),n().createElement("span",{style:Me.infoIcon},n().createElement(s.Popover,{"aria-label":c("ocp_details.supplementary_aria_label"),enableFlip:!0,bodyContent:n().createElement(n().Fragment,null,n().createElement("p",{style:Me.infoTitle},c("overview.ocp_cloud")),n().createElement("p",null,c("overview.ocp_cloud_desc")),n().createElement("br",null),n().createElement("p",{style:Me.infoTitle},c("overview.ocp")),n().createElement("p",null,c("overview.ocp_desc")),n().createElement("br",null),n().createElement("p",{style:Me.infoTitle},c("overview.gcp")),n().createElement("p",null,c("overview.gcp_desc")),n().createElement("br",null),n().createElement("p",{style:Me.infoTitle},c("overview.aws")),n().createElement("p",null,c("overview.aws_desc")),n().createElement("br",null),n().createElement("p",{style:Me.infoTitle},c("overview.azure")),n().createElement("p",null,c("overview.azure_desc")))},n().createElement(s.Button,{variant:s.ButtonVariant.plain},n().createElement(a.iC,null)))))),n().createElement("div",{style:Me.tabs},this.getTabs(p)),n().createElement("div",{style:Me.perspective},this.getPerspective())),n().createElement("section",{className:"pf-l-page__main-section pf-c-page__main-section","page-type":"cost-management-overview"},this.getTabContent(p)))}}const at=(0,h.X1)(((e,t)=>{const r=(0,o.H)(Ke.JL),s=Ke.aX.selectProviders(e,"aws",r),a=Ke.aX.selectProvidersFetchStatus(e,"aws",r),c=(0,o.H)(Ke.u5),n=Ke.aX.selectProviders(e,"azure",c),p=Ke.aX.selectProvidersFetchStatus(e,"azure",c),l=(0,o.H)(Ke.U6),u=Ke.aX.selectProviders(e,"gcp",l),h=Ke.aX.selectProvidersFetchStatus(e,"gcp",l),d=(0,o.H)(Ke.Vp),g=Ke.aX.selectProviders(e,"ocp",d),v=Ke.aX.selectProvidersFetchStatus(e,"ocp",d),m=(0,i.T)(He.BD);return{awsProviders:s,awsProvidersFetchStatus:a,awsProvidersQueryString:r,azureProviders:n,azureProvidersFetchStatus:p,azureProvidersQueryString:c,gcpProviders:u,gcpProvidersFetchStatus:h,gcpProvidersQueryString:l,ocpProviders:g,ocpProvidersFetchStatus:v,ocpProvidersQueryString:d,userAccess:He.JO.selectUserAccess(e,"",m),userAccessError:He.JO.selectUserAccessError(e,"",m),userAccessFetchStatus:He.JO.selectUserAccessFetchStatus(e,"",m),userAccessQueryString:m}})),ot=(0,l.withTranslation)()((0,u.connect)(at)(st))},62849:(e,t,r)=>{"use strict";r.d(t,{X:()=>p});var s=r(48927),a=r(97522),o=r.n(a),i=r(79878);const c={perspectiveSelector:{display:"flex",alignItems:"center"},perspectiveLabel:{marginBottom:0,marginRight:r(32412).ZP.var}};class n extends o().Component{constructor(){super(...arguments),this.defaultState={isPerspectiveOpen:!1},this.state=Object.assign({},this.defaultState),this.getDropDownItems=()=>{const{options:e,t}=this.props;return e.map((e=>o().createElement(s.DropdownItem,{component:"button",key:e.value,onClick:()=>this.handleClick(e.value)},t(e.label))))},this.getCurrentLabel=()=>{const{currentItem:e,options:t,t:r}=this.props;let s="";for(const a of t)if(e===a.value){s=r(a.label);break}return s},this.handleClick=e=>{const{onItemClicked:t}=this.props;t&&t(e)},this.handleSelect=()=>{this.setState({isPerspectiveOpen:!this.state.isPerspectiveOpen})},this.handleToggle=e=>{this.setState({isPerspectiveOpen:e})}}render(){const{isDisabled:e,t}=this.props,{isPerspectiveOpen:r}=this.state,a=this.getDropDownItems();return o().createElement("div",{style:c.perspectiveSelector},o().createElement("label",{style:c.perspectiveLabel},t("overview.perspective.label")),o().createElement(s.Dropdown,{onSelect:this.handleSelect,toggle:o().createElement(s.DropdownToggle,{isDisabled:e,onToggle:this.handleToggle},this.getCurrentLabel()),isOpen:r,dropdownItems:a}))}}const p=(0,i.withTranslation)()(n)},901:(e,t,r)=>{"use strict";r.d(t,{dM:()=>s,Bw:()=>a,xG:()=>i});const s=e=>{const t=e?e.toLowerCase():"";switch(t){case"usd":case"gb":case"gb-hours":case"gb-mo":case"core-hours":case"hrs":case"tag-mo":case"vm-hours":return t;default:return""}},a=(e,t,r={})=>{const a=s(t),p=e||0;switch(a){case"usd":return i(p,a,r);case"gb":case"gb-hours":case"gb-mo":case"tag-mo":case"vm-hours":return c(p,a,r);case"core-hours":case"hrs":return n(p,a,r);default:return o(p,a,r)}},o=(e,t,{fractionDigits:r=0}={})=>e.toLocaleString("en",{minimumFractionDigits:r,maximumFractionDigits:r}),i=(e,t,{fractionDigits:r=2}={})=>{let s=e;return e||(s=0),s.toLocaleString("en",{style:"currency",currency:t||"USD",minimumFractionDigits:r,maximumFractionDigits:r})},c=(e,t,{fractionDigits:r=0}={})=>e.toLocaleString("en",{minimumFractionDigits:r,maximumFractionDigits:r}),n=(e,t,{fractionDigits:r=0}={})=>e.toLocaleString("en",{minimumFractionDigits:r,maximumFractionDigits:r})}}]);
//# sourceMappingURL=d1ccce7828a1a51f7bc9.bundle.js.map