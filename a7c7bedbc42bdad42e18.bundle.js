"use strict";(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[9612],{34310:(e,t,a)=>{a.d(t,{F:()=>E,m:()=>d});var n=a(65834),s=a(93952),r=a(92950),l=a.n(r),o=a(74806),i=a(65048),c=a(94377),m=a(37530);const u={currencySelector:{display:"flex",alignItems:"center"},currencyLabel:{marginBottom:0,marginRight:a(32412).ZP.var,whiteSpace:"nowrap"}},d=[{label:s.Z.currencyOptions,value:"AUD"},{label:s.Z.currencyOptions,value:"CAD"},{label:s.Z.currencyOptions,value:"CHF"},{label:s.Z.currencyOptions,value:"CNY"},{label:s.Z.currencyOptions,value:"DKK"},{label:s.Z.currencyOptions,value:"EUR"},{label:s.Z.currencyOptions,value:"GBP"},{label:s.Z.currencyOptions,value:"HKD"},{label:s.Z.currencyOptions,value:"JPY"},{label:s.Z.currencyOptions,value:"NOK"},{label:s.Z.currencyOptions,value:"NZD"},{label:s.Z.currencyOptions,value:"SEK"},{label:s.Z.currencyOptions,value:"SGD"},{label:s.Z.currencyOptions,value:"USD"},{label:s.Z.currencyOptions,value:"ZAR"}];class p extends l().Component{constructor(){super(...arguments),this.defaultState={isSelectOpen:!1},this.state=Object.assign({},this.defaultState),this.getSelect=()=>{const{isDisabled:e}=this.props,{isSelectOpen:t}=this.state;(0,m.t_)();const a=(0,m.zC)(),s=this.getSelectOptions(),r=s.find((e=>e.value===a));return l().createElement(n.Select,{className:"currencyOverride",id:"currencySelect",isDisabled:e,isOpen:t,onSelect:this.handleSelect,onToggle:this.handleToggle,selections:r,variant:n.SelectVariant.single},s.map((e=>l().createElement(n.SelectOption,{key:e.value,value:e}))))},this.getSelectOptions=()=>{const{intl:e}=this.props,t=[];return d.map((a=>{t.push({toString:()=>e.formatMessage(a.label,{units:a.value}),value:a.value})})),t},this.handleSelect=(e,t)=>{const{onSelect:a}=this.props;(0,m.NW)(t.value),this.setState({isSelectOpen:!1},(()=>{a&&a(t.value)}))},this.handleToggle=e=>{this.setState({isSelectOpen:e})}}render(){const{intl:e}=this.props;return(0,m.eu)(),l().createElement("div",{style:u.currencySelector},l().createElement(n.Title,{headingLevel:"h2",size:"md",style:u.currencyLabel},e.formatMessage(s.Z.currency)),this.getSelect())}}const g=(0,c.X1)((()=>({}))),h=(0,i.connect)(g,{})(p),E=(0,o.ZP)(h)},37487:(e,t,a)=>{a.r(t),a.d(t,{default:()=>rt});var n=a(65834),s=a(92950),r=a.n(s),l=a(65048),o=a(87932),i=a(99627),c=a(46462),m=a(5977),u=a(57472);const d={limit:10,offset:0,ordering:null,name:null,source_type:null,description:null};function p(e){return Object.keys(e).reduce(((t,a)=>null===e[a]?t:""===t?`?${a}=${e[a]}`:`${t}&${a}=${e[a]}`),"")}function g(e,t){return(e-1)*t}Object.keys(d);const h=(0,m.EN)((0,l.connect)((e=>{const{count:t,page:a,perPage:n}=o.E6.pagination(e);return{query:o.E6.query(e),count:t,page:a,perPage:n}}),void 0,((e,t,a)=>{const{history:{push:s}}=a,{count:r,page:l,perPage:o,query:i}=e;return{itemCount:r,page:l,perPage:o,variant:n.PaginationVariant.bottom,onSetPage:(e,t,a)=>{s(p(Object.assign(Object.assign(Object.assign({},d),i),{offset:g(t,a)})))},onPerPageSelect:(e,t)=>{s(p(Object.assign(Object.assign(Object.assign({},d),i),{limit:t,offset:0})))}}}))((function(e){const{variant:t,itemCount:a,page:s,perPage:l,onSetPage:o,onPerPageSelect:i}=e;return r().createElement(n.Toolbar,null,r().createElement(n.ToolbarContent,null,r().createElement(n.ToolbarItem,{variant:n.ToolbarItemVariant.pagination},r().createElement(n.Pagination,{onPerPageSelect:i,onSetPage:o,variant:t,itemCount:a,page:s,perPage:l}))))})));var E=a(32004),f=a(93952),y=a(74806),M=a(43977),S=a(69957),b=a(6813),C=a(44439),T=a(94377),v=a(99291),Z=a(5144);const P={apiError:null,checked:{},clearQuery:()=>null,createError:null,createProcess:!1,createSuccess:!1,currencyUnits:(0,a(37530).tk)(),dataFetched:!1,description:"",dirtyName:!1,distribution:"",error:null,fetchSources:(e,t,a,n)=>null,filterName:"",goToAddPL:e=>null,isDiscount:!1,handleMarkupDiscountChange:(...e)=>null,handleDistributionChange:(...e)=>null,handleSignChange:(...e)=>null,loading:!1,markup:"",metricsHash:{},name:"",onClose:()=>null,onCurrencyChange:e=>null,onDescChange:e=>null,onFilterChange:e=>null,onPageChange:(e,t)=>null,onPerPageChange:(e,t)=>null,onTypeChange:e=>null,onNameChange:e=>null,onSourceSelect:(...e)=>null,page:1,perPage:10,priceListPagination:{page:1,perPage:4,onPerPageSet:(e,t)=>null,onPageSet:(e,t)=>null},query:{},step:1,setSources:e=>null,sources:[],submitTiers:e=>null,tiers:[],total:0,type:""},k=r().createContext(P);var x=a(34310),O=a(6593),D=a(36054),I=a(21084);const L=e=>0===e.length?f.Z.costModelsRequiredField:e.length>100?f.Z.costModelsInfoTooLong:null,z=e=>e.length>500?f.Z.costModelsDescTooLong:null,W=e=>""!==e.trim()&&(!!(0,v.WW)(e)&&!((0,v.cR)(e)>10)),j={"":[()=>!1],AWS:[e=>null===L(e.name)&&null===z(e.description)&&""!==e.type,e=>W(e.markup),()=>!0,()=>!0],Azure:[e=>null===L(e.name)&&null===z(e.description)&&""!==e.type,e=>W(e.markup),()=>!0,()=>!0],GCP:[e=>null===L(e.name)&&null===z(e.description)&&""!==e.type,e=>W(e.markup),()=>!0,()=>!0],OCP:[e=>null===L(e.name)&&null===z(e.description)&&""!==e.type,e=>e.priceListCurrent.justSaved,e=>W(e.markup),()=>!0,()=>!0]},F={form:{width:"350px"},textArea:{maxWidth:"450px",minWidth:"350px",minHeight:"75px",maxHeight:"150px"},selector:{maxHeight:"350px"}};class N extends r().Component{render(){const e=(e,a)=>{const n=a.find((t=>t.value===e));return n?t.formatMessage(n.label,{units:n.value}):e},{intl:t,isCurrencyFeatureEnabled:a}=this.props,s=[{label:f.Z.costModelsWizardOnboardAws,value:"AWS"},{label:f.Z.azure,value:"Azure"},{label:f.Z.gcp,value:"GCP"},{label:f.Z.costModelsWizardOnboardOcp,value:"OCP"}];return r().createElement(k.Consumer,null,(({currencyUnits:l,dirtyName:o,description:i,name:c,type:m,onCurrencyChange:u,onNameChange:d,onDescChange:p,onTypeChange:g})=>r().createElement(n.Stack,{hasGutter:!0},r().createElement(n.StackItem,null,r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.xl},t.formatMessage(f.Z.costModelsWizardGeneralInfoTitle))),r().createElement(n.StackItem,null,r().createElement("a",{href:t.formatMessage(f.Z.docsConfigCostModels),rel:"noreferrer",target:"_blank"},t.formatMessage(f.Z.learnMore))),r().createElement(n.StackItem,null,r().createElement(O.l,{style:F.form},r().createElement(n.FormGroup,{helperTextInvalid:L(c),validated:null!==L(c)&&o?"error":"default",label:t.formatMessage(f.Z.names,{count:1}),isRequired:!0,fieldId:"name"},r().createElement(n.TextInput,{validated:null!==L(c)&&o?"error":"default",isRequired:!0,type:"text",id:"name",name:"name",value:c,onChange:d})),r().createElement(n.FormGroup,{helperTextInvalid:z(i),validated:null===z(i)?"default":"error",label:t.formatMessage(f.Z.description),fieldId:"description"},r().createElement(n.TextArea,{style:F.textArea,type:"text",id:"description",name:"description",value:i,validated:null===z(i)?"default":"error",onChange:p})),r().createElement(D.Q,{isRequired:!0,id:"source-type-selector",direction:n.SelectDirection.up,appendMenuTo:"inline",maxHeight:F.selector.maxHeight,label:f.Z.costModelsSourceType,toggleAriaLabel:t.formatMessage(f.Z.costModelsWizardEmptySourceTypeLabel),placeholderText:t.formatMessage(f.Z.costModelsWizardEmptySourceTypeLabel),value:e(m,s),onChange:g,options:s}),a&&r().createElement(D.Q,{label:f.Z.currency,direction:n.SelectDirection.up,appendMenuTo:"inline",maxHeight:F.selector.maxHeight,toggleAriaLabel:t.formatMessage(f.Z.costModelsWizardCurrencyToggleLabel),value:e(l,x.m),onChange:u,id:"currency-units-selector",options:x.m.map((e=>({label:t.formatMessage(e.label,{units:e.value}),value:e.value})))}))))))}}const B=(0,T.X1)((e=>({isCurrencyFeatureEnabled:I.iJ.selectIsCurrencyFeatureEnabled(e)}))),R=(0,y.ZP)((0,l.connect)(B,{})(N));var V=a(94827);class A extends r().Component{render(){const{intl:e}=this.props,t=e=>{13!==e.keyCode&&187!==e.keyCode&&189!==e.keyCode||e.preventDefault()};return r().createElement(k.Consumer,null,(({handleDistributionChange:a,handleSignChange:s,handleMarkupDiscountChange:l,markup:o,isDiscount:i,distribution:c,type:m})=>{const u=(d=o,(0,v.WW)(d)?(0,v.cR)(d)>10?f.Z.markupOrDiscountTooLong:void 0:f.Z.markupOrDiscountNumber);var d;const p=u?"error":"default";return r().createElement(n.Stack,{hasGutter:!0},r().createElement(n.StackItem,null,r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.xl},e.formatMessage(f.Z.costCalculations))),r().createElement(n.StackItem,null,r().createElement(n.Title,{headingLevel:"h3",size:"md"},e.formatMessage(f.Z.markupOrDiscount)),e.formatMessage(f.Z.markupOrDiscountModalDesc)),r().createElement(n.StackItem,null,r().createElement(n.Flex,{style:V.W.markupRadioContainer},r().createElement(n.Flex,{direction:{default:"column"},alignSelf:{default:"alignSelfCenter"}},r().createElement(n.FlexItem,null,r().createElement(n.Radio,{isChecked:!i,name:"discount",label:e.formatMessage(f.Z.markupPlus),"aria-label":e.formatMessage(f.Z.markupPlus),id:"markup",value:"false",onChange:s,style:V.W.markupRadio}),r().createElement(n.Radio,{isChecked:i,name:"discount",label:e.formatMessage(f.Z.discountMinus),"aria-label":e.formatMessage(f.Z.discountMinus),id:"discount",value:"true",onChange:s}))),r().createElement(n.Flex,{direction:{default:"column"},alignSelf:{default:"alignSelfCenter"}},r().createElement(n.FlexItem,null,r().createElement(O.l,null,r().createElement(n.FormGroup,{fieldId:"markup-input-box",helperTextInvalid:u?e.formatMessage(u):void 0,style:V.W.rateContainer,validated:p},r().createElement(n.InputGroup,null,r().createElement(n.InputGroupText,{style:V.W.sign},i?e.formatMessage(f.Z.discountMinus):e.formatMessage(f.Z.markupPlus)),r().createElement(n.TextInput,{"aria-label":e.formatMessage(f.Z.rate),id:"markup-input-box",isRequired:!0,onKeyDown:t,onChange:l,placeholder:"0",style:V.W.inputField,type:"text",validated:p,value:o}),r().createElement(n.InputGroupText,{style:V.W.percent},e.formatMessage(f.Z.percentSymbol))))))))),r().createElement(n.StackItem,null,r().createElement("div",{style:V.W.exampleMargin},r().createElement(n.TextContent,null,r().createElement(n.Text,{component:n.TextVariants.h6},e.formatMessage(f.Z.examplesTitle))),r().createElement(n.List,null,r().createElement(n.ListItem,null,e.formatMessage(f.Z.costModelsExamplesNoAdjust)),r().createElement(n.ListItem,null,e.formatMessage(f.Z.costModelsExamplesDoubleMarkup)),r().createElement(n.ListItem,null,e.formatMessage(f.Z.costModelsExamplesReduceZero)),r().createElement(n.ListItem,null,e.formatMessage(f.Z.costModelsExamplesReduceSeventyfive))))),"OCP"===m&&r().createElement(r().Fragment,null,r().createElement(n.StackItem,null,r().createElement(n.Title,{headingLevel:"h3",size:"md"},e.formatMessage(f.Z.distributionType)),r().createElement(n.TextContent,null,r().createElement(n.Text,{style:V.W.cardDescription},e.formatMessage(f.Z.distributionModelDesc)))),r().createElement(n.StackItem,{isFilled:!0},r().createElement(O.l,null,r().createElement(n.FormGroup,{isInline:!0,fieldId:"cost-distribution",isRequired:!0},r().createElement(n.Radio,{isChecked:"cpu"===c,name:"distribution",label:e.formatMessage(f.Z.cpuTitle),"aria-label":e.formatMessage(f.Z.cpuTitle),id:"cpuDistribution",value:"cpu",onChange:a}),r().createElement(n.Radio,{isChecked:"memory"===c,name:"distribution",label:e.formatMessage(f.Z.memoryTitle),"aria-label":e.formatMessage(f.Z.memoryTitle),id:"memoryDistribution",value:"memory",onChange:a}))))))}))}}const q=(0,y.ZP)(A);var G=a(70549),w=a(87707);const _=(0,y.ZP)((({cancel:e,currencyUnits:t,intl:a=E.N,metricsHash:s,submitRate:l})=>{const{tiers:o}=r().useContext(k),i=(0,w.bF)(s,void 0,o),c=r().useMemo((()=>(0,w.Cw)(i)),[i.errors,i.rateKind]);return r().createElement(n.Stack,{hasGutter:!0},r().createElement(n.StackItem,null,r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.xl},a.formatMessage(f.Z.costModelsWizardCreatePriceList))),r().createElement(n.StackItem,null,r().createElement(n.TextContent,null,r().createElement(n.Text,{component:n.TextVariants.h6},a.formatMessage(f.Z.costModelsWizardPriceListMetric)))),r().createElement(n.StackItem,null,r().createElement(n.Form,null,r().createElement(w.HJ,{currencyUnits:t,metricsHash:s,rateFormData:i}))),r().createElement(n.StackItem,null,r().createElement(n.ActionGroup,null,r().createElement(n.Button,{variant:n.ButtonVariant.primary,isDisabled:!c,onClick:()=>l(i)},a.formatMessage(f.Z.createRate)),r().createElement(n.Button,{variant:n.ButtonVariant.link,onClick:e},a.formatMessage(f.Z.cancel)))))}));var H=a(7081),$=a(24741),U=a(56232);const K=({id:e,itemCount:t,perPage:a,page:s,variant:l,onPerPageSelect:o,onSetPage:i})=>r().createElement(n.Toolbar,{id:e},r().createElement(n.ToolbarContent,null,r().createElement(n.ToolbarItem,{variant:"pagination"},r().createElement(n.Pagination,{variant:l,itemCount:t,perPage:a,page:s,onSetPage:i,onPerPageSelect:o})))),X=K;var J=a(32350),Q=a(69250),Y=a(32362),ee=a(18306),te=a(84465);class ae extends r().Component{constructor(){super(...arguments),this.state={metrics:[],measurements:[],sortBy:{index:0,direction:u.SortByDirection.asc}}}render(){const{addRateAction:e,deleteRateAction:t,intl:a,items:s,metricsHash:l}=this.props,o=e=>{const t=e.replace(/ /g,"_").toLowerCase();return a.formatMessage(f.Z.metricValues,{value:t})||e},i=e=>a.formatMessage(f.Z.measurementValues,{value:e.toLowerCase().replace("-","_"),count:1})||e,c=Object.keys(l).map((e=>({label:o(e),value:e}))),m=c.reduce(((e,t)=>{const a=Object.keys(l[t.value]).filter((t=>!e.map((e=>e.value)).includes(t))).map((e=>({label:i(e),value:e})));return[...e,...a]}),[]),u=()=>r().createElement(n.Bullseye,null,r().createElement(n.EmptyState,null,r().createElement(n.EmptyStateIcon,{icon:H.wl}),r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.lg},a.formatMessage(f.Z.costModelsWizardEmptyStateTitle)),r().createElement(n.EmptyStateBody,null,a.formatMessage(f.Z.costModelsWizardEmptyStateSkipStep,{value:r().createElement("strong",null,a.formatMessage(f.Z.createRate))}),r().createElement("br",null),a.formatMessage(f.Z.costModelsWizardEmptyStateSkipStep,{value:r().createElement("strong",null,a.formatMessage(f.Z.next))}),r().createElement("br",null),a.formatMessage(f.Z.costModelsWizardEmptyStateOtherTime))));return r().createElement(k.Consumer,null,(({priceListPagination:l})=>r().createElement(n.Stack,{hasGutter:!0},r().createElement(n.StackItem,null,r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.xl},a.formatMessage(f.Z.costModelsWizardCreatePriceList))),r().createElement(n.StackItem,null,r().createElement(n.TextContent,null,r().createElement(n.Text,{component:n.TextVariants.h6},a.formatMessage(f.Z.costModelsWizardSubTitleTable)))),r().createElement(n.StackItem,null,r().createElement(U.j,{initialFilters:{primary:"metrics",metrics:[],measurements:[]}},(({search:o,setSearch:i,onRemove:d,onSelect:p,onClearAll:g})=>{const h=(l.page-1)*l.perPage,E=l.page*l.perPage,y=s.filter((e=>0===o.metrics.length||o.metrics.includes(e.metric.label_metric))).filter((e=>0===o.measurements.length||o.measurements.includes(e.metric.label_measurement))).sort(((e,t)=>{const n=1===this.state.sortBy.index?e=>{return t=e.metric.label_metric,a.formatMessage(f.Z.metricValues,{value:t})||t;var t}:2===this.state.sortBy.index?e=>{return t=e.metric.label_measurement,n=e.metric.label_measurement_unit,n=a.formatMessage(f.Z.units,{units:(0,v.ZV)(n)})||n,a.formatMessage(f.Z.measurementValues,{value:t.toLowerCase().replace("-","_"),units:n,count:2});var t,n}:()=>"";return(0,Q.tT)(e,t,this.state.sortBy.direction,n)})),M=y.slice(h,E);return r().createElement(r().Fragment,null,r().createElement(J.Q,{primary:r().createElement(te.J,{isDisabled:0===s.length,primary:o.primary,setPrimary:e=>i({primary:e}),options:[{label:a.formatMessage(f.Z.metric),value:"metrics"},{label:a.formatMessage(f.Z.measurement),value:"measurements"}]}),selected:o.primary,secondaries:[{component:r().createElement(ee.n,{isDisabled:0===s.length,placeholderText:a.formatMessage(f.Z.toolBarPriceListMeasurementPlaceHolder),selections:o.measurements,setSelections:e=>p("measurements",e),options:m}),name:"measurements",onRemove:d,filters:o.measurements},{component:r().createElement(ee.n,{isDisabled:0===s.length,placeholderText:a.formatMessage(f.Z.toolBarPriceListMetricPlaceHolder),selections:o.metrics,setSelections:e=>p("metrics",e),options:c}),name:"metrics",onRemove:d,filters:o.metrics}],button:r().createElement(n.Button,{onClick:e},a.formatMessage(f.Z.createRate)),onClear:g,pagination:r().createElement(n.Pagination,{isCompact:!0,itemCount:y.length,perPage:l.perPage,page:l.page,onSetPage:l.onPageSet,onPerPageSelect:l.onPerPageSet})}),0===M.length&&(0!==this.state.metrics.length||0!==this.state.measurements.length)&&r().createElement(n.Bullseye,null,r().createElement($.c,null)),0===M.length&&0===this.state.metrics.length&&0===this.state.measurements.length&&r().createElement(u,null),M.length>0&&r().createElement(Y.y,{actions:[{title:"Remove",onClick:(e,a,n)=>{t(n.data.index+h)}}],isCompact:!0,tiers:M,sortCallback:e=>{this.setState(Object.assign(Object.assign({},this.state),{sortBy:Object.assign({},e)}))}}),r().createElement(X,{isCompact:!0,itemCount:y.length,perPage:l.perPage,page:l.page,onSetPage:l.onPageSet,onPerPageSelect:l.onPerPageSet}))}))))))}}const ne=(0,l.connect)((0,T.X1)((e=>({metricsHash:i.qw.metrics(e)}))))((0,y.ZP)(ae)),se=()=>{const{currencyUnits:e,goToAddPL:t,metricsHash:a,tiers:n,submitTiers:s}=r().useContext(k),[l,o]=r().useState("table");return"table"===l?r().createElement(ne,{items:n,deleteRateAction:e=>{const a=[...n.slice(0,e),...n.slice(e+1)];s(a),0===a.length&&(o("form"),t(!1))},addRateAction:()=>{o("form"),t(!1)}}):"form"===l?r().createElement(_,{currencyUnits:e,metricsHash:a,submitRate:r=>{var l;l=(0,w.Nl)(r,a,e),s([...n,l]),o("table"),t(!0)},cancel:()=>{o("table"),t(!0)}}):null};var re=a(53086),le=a(27472);const oe=(0,y.ZP)((({intl:e})=>r().createElement(k.Consumer,null,(({onClose:t,name:a})=>r().createElement(n.EmptyState,null,r().createElement(n.EmptyStateIcon,{icon:re.xX,color:"green"}),r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.lg},e.formatMessage(f.Z.costModelsWizardReviewStatusTitle)),r().createElement(n.EmptyStateBody,null,e.formatMessage(f.Z.costModelsWizardReviewStatusSubTitle,{value:a})),r().createElement(n.EmptyStateSecondaryActions,null,r().createElement(n.Button,{variant:"link",onClick:t},e.formatMessage(f.Z.close)))))))),ie=(0,y.ZP)((({intl:e})=>r().createElement(k.Consumer,null,(({checked:t,createError:a,currencyUnits:s,description:l,distribution:o,isDiscount:i,markup:c,name:m,tiers:u,type:d})=>{const p=Object.keys(t).filter((e=>t[e].selected)).map((e=>t[e].meta));return r().createElement(r().Fragment,null,a&&r().createElement(n.Alert,{variant:"danger",title:`${a}`}),r().createElement(n.Stack,{hasGutter:!0},r().createElement(n.StackItem,null,r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.xl},e.formatMessage(f.Z.costModelsWizardStepsReview))),r().createElement(n.StackItem,null,r().createElement(n.TextContent,null,r().createElement(n.Text,{component:n.TextVariants.h6},e.formatMessage(f.Z.costModelsWizardReviewStatusSubDetails,{create:r().createElement("strong",null,e.formatMessage(f.Z.create)),back:r().createElement("strong",null,e.formatMessage(f.Z.back))})))),r().createElement(n.StackItem,null,r().createElement(n.TextContent,null,r().createElement(n.TextList,{component:n.TextListVariants.dl},r().createElement(n.TextListItem,{component:n.TextListItemVariants.dt},e.formatMessage(f.Z.names,{count:1})),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dd},m),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dt},e.formatMessage(f.Z.description)),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dd},l),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dt},e.formatMessage(f.Z.currency)),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dd},e.formatMessage(f.Z.currencyOptions,{units:s})),"OCP"===d&&r().createElement(r().Fragment,null,r().createElement(n.TextListItem,{component:n.TextListItemVariants.dt},e.formatMessage(f.Z.priceList)),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dd},u.length>0?r().createElement(Y.y,{tiers:u}):e.formatMessage(f.Z.costModelsWizardNoRatesAdded))),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dt},e.formatMessage(f.Z.costModelsWizardReviewMarkDiscount)),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dd},e.formatMessage(f.Z.percent,{value:i?"-"+c:c})),"OCP"===d&&r().createElement(r().Fragment,null,r().createElement(n.TextListItem,{component:n.TextListItemVariants.dt},e.formatMessage(f.Z.distributionType)),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dd},o)),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dt},e.formatMessage(f.Z.costModelsAssignSources,{count:2})," ",p.find((e=>Boolean(e.costmodel)))&&r().createElement(le.a,{text:e.formatMessage(f.Z.costModelsWizardWarningSources)})),r().createElement(n.TextListItem,{component:n.TextListItemVariants.dd},p.map((e=>e.name)).join(", ")))))))})))),ce=()=>r().createElement(k.Consumer,null,(({createSuccess:e})=>e?r().createElement(oe,null):r().createElement(ie,null)));var me=a(87339),ue=a(70562),de=a(69516),pe=a(76889),ge=a(80810);const he=({id:e,placeholder:t="",value:a,onChange:s,onSearch:l})=>r().createElement(n.InputGroup,null,r().createElement(n.TextInput,{value:a,placeholder:t,id:e,onChange:s,onKeyPress:e=>{"Enter"===e.key&&""!==a&&l(e)}}),r().createElement(n.InputGroupText,{style:{borderLeft:"0"}},r().createElement(ge.W1,null))),Ee=(0,y.ZP)((({intl:e,filterInputProps:t,paginationProps:a,filter:s})=>r().createElement(n.Toolbar,{id:"assign-sources-toolbar",clearAllFilters:s.onClearAll},r().createElement(n.ToolbarContent,null,r().createElement(n.ToolbarToggleGroup,{breakpoint:"xl",toggleIcon:r().createElement(pe.k1,null)},r().createElement(n.ToolbarItem,{variant:"search-filter"},r().createElement(n.ToolbarFilter,{deleteChip:s.onRemove,chips:s.query.name,categoryName:"name"},r().createElement(he,Object.assign({placeholder:e.formatMessage(f.Z.costModelsFilterPlaceholder)},t))))),r().createElement(n.ToolbarItem,{variant:"pagination"},r().createElement(n.Pagination,{isCompact:a.isCompact,itemCount:a.itemCount,page:a.page,perPage:a.perPage,onSetPage:a.onSetPage,onPerPageSelect:a.onPerPageSelect})))))),fe=(0,y.ZP)((({intl:e})=>r().createElement(k.Consumer,null,(({checked:t,loading:a,onSourceSelect:s,sources:l,perPage:o,page:i,type:c,query:m,fetchSources:d,filterName:p,onFilterChange:g})=>{const h="Azure"===c?"Azure":c,E=l.length>0?l[0].meta.count:0;return r().createElement(n.Stack,{hasGutter:!0},r().createElement(n.StackItem,null,r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.xl},e.formatMessage(f.Z.costModelsWizardSourceTitle))),r().createElement(n.StackItem,null,r().createElement(n.TextContent,null,r().createElement(n.Text,{component:n.TextVariants.h6},e.formatMessage(f.Z.costModelsWizardSourceSubtitle)))),r().createElement(n.StackItem,null,r().createElement(n.TextContent,null,r().createElement(n.Text,{component:n.TextVariants.h3},e.formatMessage(f.Z.costModelsWizardSourceCaption,{value:c.toLowerCase()})))),r().createElement(n.StackItem,null,r().createElement(Ee,{filter:{onRemove:(e,t)=>d(h,(0,de.fg)(m)(e,t),1,o),onClearAll:()=>d(h,{},1,o),query:m},filterInputProps:{id:"assign-source-search-input",value:p,onChange:g,onSearch:()=>{d(h,(0,de.xZ)(m)("name",p),1,o)}},paginationProps:{isCompact:!0,itemCount:E,perPage:o,page:i,onSetPage:(e,t)=>{d(h,m,t,o)},onPerPageSelect:(e,t)=>d(h,m,1,t)}}),a?r().createElement(me.G,null):r().createElement(u.Table,{"aria-label":e.formatMessage(f.Z.costModelsWizardSourceTableAriaLabel),cells:["",e.formatMessage(f.Z.names,{count:1}),e.formatMessage(f.Z.costModelsWizardSourceTableCostModel)],rows:l.map(((a,l)=>({cells:[r().createElement(r().Fragment,null,r().createElement(n.Checkbox,{onChange:e=>{s(l,e)},id:a.name,key:a.name,isChecked:t[a.uuid]&&t[a.uuid].selected,isDisabled:Boolean(a.costmodel)})),r().createElement(r().Fragment,null,a.name," ",Boolean(a.costmodel)&&r().createElement(le.a,{key:`wrng-${a.name}`,text:e.formatMessage(f.Z.costModelsWizardSourceWarning,{costModel:a.costmodel})})),a.costmodel?a.costmodel:""],selected:t[a.uuid]&&t[a.uuid].selected})))},r().createElement(u.TableHeader,null),r().createElement(u.TableBody,null)),r().createElement(K,{itemCount:E,perPage:o,page:i,onSetPage:(e,t)=>{d(h,m,t,o)},onPerPageSelect:(e,t)=>d(h,m,1,t)})))}))));class ye extends r().Component{constructor(e){super(e),this.fetchData=()=>null,this.fetchData=()=>{const{type:e,query:t,page:a,perPage:n,fetchSources:s}=this.context;s("Azure"===e?"Azure":e,t,a,n)}}componentDidMount(){const{dataFetched:e}=this.context;e||this.fetchData()}renderContent(){return this.context.loading?r().createElement(me.G,null):this.context.apiError?r().createElement(ue.Bu,{onRefresh:this.fetchData}):r().createElement(fe,null)}render(){return this.renderContent()}}ye.contextType=k;const Me=ye,Se=(e,t="USD")=>{const a=(0,C.cloneDeep)(e);return a.map((e=>{if(e.tiered_rates)for(const a of e.tiered_rates)a.unit=t,a.usage.unit=t;if(e.tag_rates)for(const a of e.tag_rates.tag_values)a.unit=t})),a},be=(0,y.ZP)((({intl:e,isProcess:t,isSuccess:a,closeFnc:s,isOpen:l,onMove:o,validators:i,steps:c,current:m=1,context:u,setError:d,setSuccess:p,updateCostModel:g})=>{const h=c.map(((e,t)=>Object.assign(Object.assign({},e),{canJumpTo:m>t})));h[m-1].enableNext=i[m-1](u);const E="OCP"===u.type&&2===m&&!i[m-1](u);return m===c.length&&""!==u.type&&(h[m-1].nextButtonText=e.formatMessage(f.Z.create)),l?r().createElement(n.Wizard,{isOpen:!0,title:e.formatMessage(f.Z.createCostModelTitle),description:e.formatMessage(f.Z.createCostModelDesc),steps:h,startAtStep:m,onNext:o,onBack:o,onGoToStep:o,onClose:s,footer:a||t||E?r().createElement("div",null):null,onSave:()=>{const{currency:e,description:t,distribution:a,isDiscount:n,markup:s,name:r,type:l,tiers:o,sources:i}=u;(0,b.Rl)({name:r,source_type:l,currency:e,description:t,distribution:a,rates:o,markup:{value:`${n?"-":""}${(0,v.E3)(s)}`,unit:"percent"},source_uuids:i.map((e=>e.uuid))}).then((()=>{p(),g()})).catch((e=>d((0,G.L)(e))))}}):null})),Ce={apiError:null,checked:{},createError:null,createProcess:!1,createSuccess:!1,currencyUnits:"USD",dataFetched:!1,description:"",distribution:"cpu",dirtyName:!1,error:null,filterName:"",isDialogOpen:!1,isDiscount:!1,loading:!1,markup:"0",name:"",page:1,perPage:10,priceListCurrent:{metric:"",measurement:"",rate:"",justSaved:!0},priceListPagination:{page:1,perPage:10},query:{},sources:[],step:1,tiers:[],total:0,type:""};class Te extends r().Component{constructor(){super(...arguments),this.state=Ce}render(){const{metricsHash:e,intl:t}=this.props,a=()=>{this.setState({isDialogOpen:!1},this.props.openWizard)},s=r().createElement(n.Button,{key:"cancel",variant:"link",onClick:a},t.formatMessage(f.Z.createCostModelNoContinue)),l=r().createElement(n.Button,{key:"ok",variant:"primary",onClick:()=>this.setState(Object.assign({},Ce))},t.formatMessage(f.Z.createCostModelExitYes));return r().createElement(k.Provider,{value:{apiError:this.state.apiError,checked:this.state.checked,clearQuery:()=>this.setState({query:{}}),createError:this.state.createError,createProcess:this.state.createProcess,createSuccess:this.state.createSuccess,currencyUnits:this.state.currencyUnits,description:this.state.description,dataFetched:this.state.dataFetched,dirtyName:this.state.dirtyName,distribution:this.state.distribution,error:this.state.error,filterName:this.state.filterName,fetchSources:(e,t,a,n)=>{this.setState({loading:!0,apiError:null,filterName:""},(()=>(({type:e,page:t,perPage:a,query:n})=>{const s=(t-1)*a,r=a,l=Object.keys(n).reduce(((e,t)=>e?`${e}&${t}=${n[t]}`:`${t}=${n[t]}`),"");return(0,Z.l)(`type=${e}&limit=${r}&offset=${s}&${l}`).then((e=>{const t=e.data;return t.data.map((e=>({name:e.name,uuid:e.uuid,costmodel:e.cost_models.map((e=>e.name)).join(","),meta:t.meta})))}))})({type:e,query:t,page:a,perPage:n}).then((e=>this.setState({sources:e,query:t,page:a,perPage:n,loading:!1,dataFetched:!0,filterName:""}))).catch((e=>this.setState({apiError:e,loading:!1,dataFetched:!0,filterName:""})))))},goToAddPL:e=>this.setState({priceListCurrent:Object.assign(Object.assign({},this.state.priceListCurrent),{justSaved:e||!1})}),handleDistributionChange:(e,t)=>{const{value:a}=t.currentTarget;this.setState({distribution:a})},handleMarkupDiscountChange:(e,t)=>{const{value:a}=t.currentTarget;this.setState({markup:a})},handleSignChange:(e,t)=>{const{value:a}=t.currentTarget;this.setState({isDiscount:"true"===a})},isDiscount:this.state.isDiscount,loading:this.state.loading,metricsHash:e,onClose:()=>this.setState(Object.assign({},Ce),this.props.closeWizard),onCurrencyChange:e=>this.setState({currencyUnits:e,tiers:Se(this.state.tiers,e)}),onDescChange:e=>this.setState({description:e}),onFilterChange:e=>this.setState({filterName:e}),onNameChange:e=>this.setState({name:e,dirtyName:!0}),onPageChange:(e,t)=>this.setState({page:t}),onPerPageChange:(e,t)=>this.setState({page:1,perPage:t}),onSourceSelect:(e,t)=>{if(-1===e){const e=this.state.sources.map((e=>({[e.uuid]:{selected:t,meta:e}}))),a=Object.assign(Object.assign({},this.state.checked),e);return this.setState({checked:a})}const a=Object.assign(Object.assign({},this.state.checked),{[this.state.sources[e].uuid]:{selected:t,meta:this.state.sources[e]}});return this.setState({checked:a})},onTypeChange:e=>this.setState({type:e,dataFetched:!1,loading:!1}),page:this.state.page,priceListPagination:{page:this.state.priceListPagination.page,perPage:this.state.priceListPagination.perPage,onPageSet:(e,t)=>this.setState({priceListPagination:Object.assign(Object.assign({},this.state.priceListPagination),{page:t})}),onPerPageSet:(e,t)=>this.setState({priceListPagination:{page:1,perPage:t}})},markup:this.state.markup,name:this.state.name,perPage:this.state.perPage,query:this.state.query,setSources:e=>this.setState({sources:e,dataFetched:!0,loading:!1}),sources:this.state.sources,step:this.state.step,submitTiers:e=>{this.setState({tiers:e})},tiers:this.state.tiers,total:this.state.total,type:this.state.type}},r().createElement(be,{metricsHash:e,isProcess:this.state.createProcess,isSuccess:this.state.createSuccess,closeFnc:()=>{"OCP"===this.state.type&&this.state.step>1&&this.state.tiers.length>0||"OCP"!==this.state.type&&this.state.step>2?this.setState({isDialogOpen:!0},this.props.closeWizard):this.setState(Object.assign({},Ce),this.props.closeWizard)},isOpen:this.props.isOpen,onMove:e=>this.setState({step:Number(e.id)}),steps:{"":[{id:1,name:t.formatMessage(f.Z.costModelsWizardStepsGenInfo),component:r().createElement(R,null)}],Azure:[{id:1,name:t.formatMessage(f.Z.costModelsWizardStepsGenInfo),component:r().createElement(R,null)},{id:2,name:t.formatMessage(f.Z.costCalculations),component:r().createElement(q,null)},{id:3,name:t.formatMessage(f.Z.costModelsWizardStepsSources),component:r().createElement(Me,null)},{id:4,name:t.formatMessage(f.Z.costModelsWizardStepsReview),component:r().createElement(ce,null)}],AWS:[{id:1,name:t.formatMessage(f.Z.costModelsWizardStepsGenInfo),component:r().createElement(R,null)},{id:2,name:t.formatMessage(f.Z.costCalculations),component:r().createElement(q,null)},{id:3,name:t.formatMessage(f.Z.costModelsWizardStepsSources),component:r().createElement(Me,null)},{id:4,name:t.formatMessage(f.Z.costModelsWizardStepsReview),component:r().createElement(ce,null)}],GCP:[{id:1,name:t.formatMessage(f.Z.costModelsWizardStepsGenInfo),component:r().createElement(R,null)},{id:2,name:t.formatMessage(f.Z.costCalculations),component:r().createElement(q,null)},{id:3,name:t.formatMessage(f.Z.costModelsWizardStepsSources),component:r().createElement(Me,null)},{id:4,name:t.formatMessage(f.Z.costModelsWizardStepsReview),component:r().createElement(ce,null)}],OCP:[{id:1,name:t.formatMessage(f.Z.costModelsWizardStepsGenInfo),component:r().createElement(R,null)},{id:2,name:t.formatMessage(f.Z.priceList),component:r().createElement(se,null)},{id:3,name:t.formatMessage(f.Z.costCalculations),component:r().createElement(q,null)},{id:4,name:t.formatMessage(f.Z.costModelsWizardStepsSources),component:r().createElement(Me,null)},{id:5,name:t.formatMessage(f.Z.costModelsWizardStepsReview),component:r().createElement(ce,null)}]}[this.state.type],current:this.state.step,validators:j[this.state.type],setError:e=>this.setState({createError:e}),setSuccess:()=>this.setState({createError:null,createSuccess:!0}),updateCostModel:()=>this.props.fetch(),context:{name:this.state.name,type:this.state.type,currency:this.state.currencyUnits,description:this.state.description,distribution:this.state.distribution,markup:`${this.state.isDiscount?"-":""}${this.state.markup}`,tiers:this.state.tiers,priceListCurrent:this.state.priceListCurrent,sources:Object.keys(this.state.checked).map((e=>this.state.checked[e].meta))}}),r().createElement(n.Modal,{"aria-label":t.formatMessage(f.Z.createCostModelExit),isOpen:this.state.isDialogOpen,header:r().createElement(n.Title,{headingLevel:"h1",size:n.TitleSizes["2xl"]},r().createElement(S.LP,{color:"orange"})," ",t.formatMessage(f.Z.createCostModelExit)),onClose:a,actions:[l,s],variant:"small"},t.formatMessage(f.Z.createCostModelConfirmMsg)))}}const ve=(0,l.connect)((0,T.X1)((e=>({metricsHash:i.qw.metrics(e)}))),{fetch:o.F0.fetchCostModels})((0,y.ZP)(Te)),Ze=(0,y.ZP)((0,l.connect)((e=>({canWrite:c.c5.isCostModelWritePermission(e)})),(e=>({openWizard:()=>e(o.F0.setCostModelDialog({name:"createWizard",isOpen:!0})),closeWizard:()=>e(o.F0.setCostModelDialog({name:"createWizard",isOpen:!1}))})),((e,t,a)=>{const{intl:s=E.N}=a,{canWrite:l}=e,{openWizard:o}=t;return{isDisabled:!l,tooltip:s.formatMessage(f.Z.costModelsReadOnly),children:r().createElement(n.Button,{isDisabled:!l,onClick:o},s.formatMessage(f.Z.costModelsWizardCreateCostModel))}}))(M.j)),Pe=(0,l.connect)((e=>({isOpen:o.E6.isDialogOpen(e)("costmodel").createWizard})),(e=>({openWizard:()=>{e(o.F0.setCostModelDialog({name:"createWizard",isOpen:!0}))},closeWizard:()=>{e(o.F0.setCostModelDialog({name:"createWizard",isOpen:!1}))}})),((e,t)=>{const{isOpen:a}=e,{openWizard:n,closeWizard:s}=t;return{isOpen:a,openWizard:n,closeWizard:s}}))(ve);function ke({head:e,body:t,sources:a}){return r().createElement(n.Stack,{hasGutter:!0},r().createElement(n.StackItem,null,r().createElement(n.TextContent,null,r().createElement(n.Text,null,e))),r().createElement(n.StackItem,null,r().createElement(n.TextContent,null,r().createElement(n.Text,null,t),r().createElement(n.TextList,{component:n.TextListVariants.ol},a.map((e=>r().createElement(n.TextListItem,{key:e},e)))))))}const xe=(0,y.ZP)((0,l.connect)((e=>({isOpen:o.E6.isDialogOpen(e)("costmodel").deleteCostModel,isLoading:o.E6.deleteProcessing(e),deleteError:o.E6.deleteError(e),dialogData:o.E6.dialogData(e)})),(e=>({closeDialog:()=>e(o.F0.setCostModelDialog({name:"deleteCostModel",isOpen:!1})),deleteCostModel:t=>o.F0.deleteCostModel(t,"deleteCostModel")(e)})),((e,t,a)=>{const{intl:s=E.N}=a,l=(o=e.isLoading,i=e.isOpen,c=e.deleteError,i?o?"loading":c?"failure":"open":"close");var o,i,c;const m=e.dialogData&&e.dialogData.costModel?e.dialogData.costModel:null,u=m?m.name:"",d=m?m.sources.map((e=>e.name)):[],p=m?m.uuid:"",g=function({status:e,deleteText:t,deleteAction:a,cancelText:s,cancelAction:l,sourcesNo:o}){let i=[];return"loading"===e&&(i=[r().createElement(n.Button,{key:"pending_delete",variant:n.ButtonVariant.danger,isDisabled:!0},t),r().createElement(n.Button,{key:"pending_cancel",variant:n.ButtonVariant.link,isDisabled:!0},s)]),["failure","open"].includes(e)&&o>0&&(i=[r().createElement(n.Button,{key:"sources_cancel",variant:n.ButtonVariant.link,onClick:l},s)]),["failure","open"].includes(e)&&0===o&&(i=[r().createElement(n.Button,{key:"delete",variant:n.ButtonVariant.danger,onClick:a},t),r().createElement(n.Button,{key:"cancel",variant:n.ButtonVariant.link,onClick:l},s)]),i}({status:l,deleteText:s.formatMessage(f.Z.costModelsDelete),deleteAction:()=>t.deleteCostModel(p),cancelText:s.formatMessage(f.Z.cancel),cancelAction:t.closeDialog,sourcesNo:d.length}),h=function({status:e,sources:t,error:a,cannotDeleteTitle:s,cannotDeleteBody:l,canDeleteBody:o}){return"close"!==e&&t.length>0?r().createElement(ke,{head:s,body:l,sources:t}):"close"!==e&&0===t.length?r().createElement(n.Stack,{hasGutter:!0},"failure"===e?r().createElement(n.StackItem,null,r().createElement(n.Alert,{variant:n.AlertVariant.danger,title:a})):null,r().createElement(n.StackItem,null,o)):void 0}({status:l,sources:d,error:e.deleteError,cannotDeleteTitle:s.formatMessage(f.Z.costModelsDeleteSource),cannotDeleteBody:s.formatMessage(f.Z.costModelsCanNotDelete,{name:u}),canDeleteBody:s.formatMessage(f.Z.costModelsCanDelete,{name:u})});return{actions:g,isOpen:"close"!==l,variant:n.ModalVariant.small,"aria-label":s.formatMessage(f.Z.costModelsDelete),title:s.formatMessage(f.Z.costModelsDelete),titleIconVariant:"warning",onClose:t.closeDialog,children:h}}))(n.Modal)),Oe=xe;var De=a(91290);const Ie={headerContent:{display:"flex",justifyContent:"space-between"}},Le=(0,y.ZP)((0,l.connect)(((e,t)=>{const{intl:a}=t;return{children:r().createElement(r().Fragment,null,a.formatMessage(f.Z.costModels),r().createElement(n.Popover,{"aria-label":a.formatMessage(f.Z.costModelsPopoverAriaLabel),bodyContent:a.formatMessage(f.Z.costModelsPopover,{learnMore:r().createElement("a",{href:a.formatMessage(f.Z.docsUsingCostModels),rel:"noreferrer",target:"_blank"},a.formatMessage(f.Z.learnMore))}),enableFlip:!0},r().createElement(n.Button,{variant:n.ButtonVariant.plain},r().createElement(De.iC,null))))}}))((function({children:e}){return r().createElement("div",{style:Ie.headerContent},r().createElement(n.TextContent,null,r().createElement(n.Title,{headingLevel:"h1",size:n.TitleSizes["2xl"]},e)))})));var ze=a(23683),We=a(70722),je=a(73727),Fe=a(35315);const Ne=(0,Fe.Z)((({intl:e=E.N})=>({title:e.formatMessage(f.Z.costModelsEmptyState),description:e.formatMessage(f.Z.costModelsEmptyStateDesc),icon:H.wl,actions:r().createElement(r().Fragment,null,r().createElement(Ze,null),r().createElement("br",null),r().createElement("br",null),r().createElement("a",{href:e.formatMessage(f.Z.docsConfigCostModels),rel:"noreferrer",target:"_blank"},e.formatMessage(f.Z.costModelsEmptyStateLearnMore)))})))((function(e){return r().createElement(n.EmptyState,{className:"pf-m-redhat-font"},r().createElement(n.EmptyStateIcon,{icon:e.icon}),r().createElement(n.Title,{headingLevel:"h2",size:n.TitleSizes.lg},e.title),r().createElement(n.EmptyStateBody,null,e.description),e.actions?e.actions:null)})),Be=(0,y.ZP)(Ne);class Re extends r().Component{constructor(){super(...arguments),this.state={dialogSource:null}}render(){const{actionResolver:e,intl:t=E.N,canWrite:a,costData:s,history:{push:l},openDeleteDialog:o,query:i,stateName:c}=this.props,m=function(e,t){let a=null;return"loading"===e&&(a=r().createElement(me.G,null)),"empty"===e&&(a=r().createElement(Be,null)),"no-match"===e&&(a=r().createElement($.c,null)),"failure"===e&&(a=r().createElement(ze.Z,null)),null!==a?[{heightAuto:!0,cells:[{props:{colSpan:5},title:r().createElement(n.Bullseye,null," ",a," ")}]}]:t.map((e=>{const t=(0,We.format)((0,We.utcToZonedTime)(e.updated_timestamp,"UTC"),"dd LLL yyyy kk:mm zzz",{timeZone:"UTC"});return{cells:[{title:r().createElement(je.rU,{to:`/cost-models/${e.uuid}`},e.name)},e.description,e.source_type,e.sources.length.toString(),t],data:{costModel:e}}}))}(c,s),d=[Object.assign({title:t.formatMessage(f.Z.names,{count:1}),data:{orderName:"name"}},m.length&&{transforms:[u.sortable]}),{title:t.formatMessage(f.Z.description)},Object.assign({title:t.formatMessage(f.Z.costModelsSourceType),data:{orderName:"source_type"}},m.length&&{transforms:[u.sortable]}),{title:t.formatMessage(f.Z.costModelsAssignedSources)},Object.assign({title:t.formatMessage(f.Z.costModelsLastChange),data:{orderName:"updated_timestamp"}},m.length&&{transforms:[u.sortable]})],g=function(e,t){const{ordering:a}=e;if(null===a)return{};const n="-"===a[0]?a.slice(1):a,s="-"===a[0]?u.SortByDirection.desc:u.SortByDirection.asc;return{index:t.findIndex((e=>e.data&&e.data.orderName===n)),direction:s}}(i,d),h=function(e,t,a){return function(n,s,r){const l=e[s]&&e[s].data?e[s].data.orderName:null;null!==l&&(r!==u.SortByDirection.asc?a(p(Object.assign(Object.assign({},t),{ordering:`-${l}`}))):a(p(Object.assign(Object.assign({},t),{ordering:l}))))}}(d,i,l),y=function(e,t,a){return"success"!==e?[]:a.map((e=>Object.assign(Object.assign({},e),{isDisabled:!t,style:t?void 0:{pointerEvents:"auto"},tooltip:t?void 0:e.tooltip})))}(c,a,[{title:t.formatMessage(f.Z.delete),tooltip:t.formatMessage(f.Z.costModelsReadOnly),onClick:(e,t,a)=>{o(a.data)}}]);return r().createElement(n.PageSection,{variant:n.PageSectionVariants.light},r().createElement(u.Table,{gridBreakPoint:u.TableGridBreakpoint.grid2xl,actions:y,actionResolver:e,rows:m,cells:d,onSort:h,sortBy:g,"aria-label":t.formatMessage(f.Z.costModelsTableAriaLabel)},r().createElement(u.TableHeader,null),r().createElement(u.TableBody,null)))}}const Ve=(0,T.X1)((e=>({canWrite:c.c5.isCostModelWritePermission(e),query:o.E6.query(e),costData:o.E6.costModels(e),stateName:o.E6.stateName(e)}))),Ae=(0,l.connect)(Ve,(e=>{const t=o.F0.setCostModelDialog;return{openDeleteDialog:a=>e(t({name:"deleteCostModel",isOpen:!0,meta:a}))}}))(Re),qe=(0,y.ZP)((0,m.EN)(Ae)),Ge=({placeholder:e="",value:t,onChange:a,onKeyPress:s})=>r().createElement(n.InputGroup,null,r().createElement(n.TextInput,{"aria-label":e,value:t,placeholder:e,onChange:a,onKeyPress:e=>{"Enter"===e.key&&""!==t&&s(e)}}),r().createElement(n.InputGroupText,{style:{borderLeft:"0"}},r().createElement(ge.W1,null))),we=(e,t,a,n)=>s=>{if("Enter"===s.key&&""!==n.value){const s=n.value;e(p(Object.assign(Object.assign({},a),{[t]:a[t]?`${a[t]},${s}`:s}))),n.setValue("")}},_e=(e,t,a)=>(n,s)=>{const r=a[t]?a[t].split(",").filter((e=>e!==s)):null;e(p(Object.assign(Object.assign({},a),{[t]:null===r||0===r.length?null:r.join(",")})))},He=(e,t,a)=>()=>{e(p(Object.assign(Object.assign({},t),{[a]:null})))},$e=(0,l.connect)((e=>({filterType:o.E6.currentFilterType(e),query:o.E6.query(e)})),void 0,((e,t,a)=>{const{intl:n=E.N,value:s,setValue:l,history:{push:o}}=a,{filterType:i,query:c}=e,m="description"===i?r().createElement(Ge,{placeholder:n.formatMessage(f.Z.filterByPlaceholder,{value:i}),value:s,onChange:e=>l(e),onKeyPress:we(o,"description",Object.assign(Object.assign({},d),c),{value:s,setValue:l})}):null,u=c.description?c.description.split(","):[];return{deleteChip:_e(o,"description",Object.assign(Object.assign({},d),c)),deleteChipGroup:He(o,Object.assign(Object.assign({},d),c),"description"),chips:u,categoryName:n.formatMessage(f.Z.description),children:m}}))(n.ToolbarFilter),Ue=(0,Fe.Z)((()=>{const[e,t]=r().useState("");return{value:e,setValue:t}}))((0,y.ZP)((0,m.EN)($e))),Ke=(0,l.connect)((e=>({filterType:o.E6.currentFilterType(e),query:o.E6.query(e)})),void 0,((e,t,a)=>{const{intl:n=E.N,setValue:s,value:l,history:{push:o}}=a,{filterType:i,query:c}=e,m="name"===i?r().createElement(Ge,{placeholder:n.formatMessage(f.Z.filterByPlaceholder,{value:i}),value:l,onChange:e=>s(e),onKeyPress:we(o,"name",Object.assign(Object.assign({},d),c),{value:l,setValue:s})}):null,u=c.name?c.name.split(","):[];return{deleteChip:_e(o,"name",Object.assign(Object.assign({},d),c)),deleteChipGroup:He(o,Object.assign(Object.assign({},d),c),"name"),chips:u,categoryName:n.formatMessage(f.Z.names,{count:1}),children:m}}))(n.ToolbarFilter),Xe=(0,Fe.Z)((()=>{const[e,t]=r().useState("");return{value:e,setValue:t}}))((0,y.ZP)((0,m.EN)(Ke))),Je=(e,t)=>()=>{t(!1);const a=document.getElementById(e);a&&a.focus()},Qe=(0,l.connect)((e=>({filterType:o.E6.currentFilterType(e),query:o.E6.query(e)})),void 0,((e,t,a)=>{const s="source-type-filter",{intl:l=E.N,isOpen:o,setIsOpen:i,history:{push:c}}=a,{filterType:m,query:u}=e,g=e=>c(p(Object.assign(Object.assign(Object.assign({},d),u),{source_type:e}))),h="sourceType"===m?r().createElement(n.Dropdown,{onSelect:Je(s,i),isOpen:o,toggle:r().createElement(n.DropdownToggle,{onToggle:e=>{i(e)},id:s},l.formatMessage(f.Z.filterByPlaceholder,{value:"source_type"})),dropdownItems:[r().createElement(n.DropdownItem,{key:"aws",component:"button",onClick:()=>g("aws")},l.formatMessage(f.Z.aws)),r().createElement(n.DropdownItem,{key:"azure",component:"button",onClick:()=>g("azure")},l.formatMessage(f.Z.azure)),r().createElement(n.DropdownItem,{key:"ocp",component:"button",onClick:()=>g("ocp")},l.formatMessage(f.Z.openShift))]}):null,y=u.source_type?[u.source_type]:[];return{deleteChip:He(c,Object.assign(Object.assign({},d),u),"source_type"),chips:y,categoryName:l.formatMessage(f.Z.costModelsSourceType),children:h}}))(n.ToolbarFilter),Ye=(0,Fe.Z)((()=>{const[e,t]=r().useState(!1);return{isOpen:e,setIsOpen:t}}))((0,y.ZP)((0,m.EN)(Qe))),et=(0,m.EN)((0,l.connect)((e=>({query:o.E6.query(e)})),void 0,((e,t,a)=>{const{history:{push:n}}=a,{query:s}=e;return{id:"cost-models-toolbar",clearAllFilters:()=>n(p(Object.assign(Object.assign(Object.assign({},d),s),{description:null,source_type:null,name:null}))),children:a.children}}))(n.Toolbar)),tt=(0,Fe.Z)((()=>{const[e,t]=r().useState(!1);return{isOpen:e,setIsOpen:t}}))((0,y.ZP)((0,l.connect)((e=>({filterType:o.E6.currentFilterType(e)})),(e=>({updateFilterType:t=>{e(o.F0.updateFilterToolbar({currentFilterType:t}))}})),((e,t,a)=>{const{intl:s=E.N}=a,l=[r().createElement(n.SelectOption,{key:"name",value:"name"},s.formatMessage(f.Z.names,{count:1})),r().createElement(n.SelectOption,{key:"description",value:"description"},s.formatMessage(f.Z.description)),r().createElement(n.SelectOption,{key:"sourceType",value:"sourceType"},s.formatMessage(f.Z.costModelsSourceType))];return{variant:n.SelectVariant.single,selections:e.filterType,onToggle:a.setIsOpen,isOpen:a.isOpen,onSelect:(e,n)=>{t.updateFilterType(n),a.setIsOpen(!1)},children:l,toggleIcon:r().createElement(pe.k1,null)}}))(n.Select))),at=(0,m.EN)((0,l.connect)((e=>{const{count:t,page:a,perPage:n}=o.E6.pagination(e);return{count:t,page:a,perPage:n,query:o.E6.query(e)}}),void 0,((e,t,a)=>{const{history:{push:s}}=a,{count:r,page:l,perPage:o,query:i}=e;return{isCompact:!0,itemCount:r,page:l,perPage:o,variant:n.PaginationVariant.top,onSetPage:(e,t,a)=>{s(p(Object.assign(Object.assign(Object.assign({},d),i),{offset:g(t,a)})))},onPerPageSelect:(e,t)=>{s(p(Object.assign(Object.assign(Object.assign({},d),i),{limit:t,offset:0})))}}}))(n.Pagination)),nt=()=>r().createElement(et,null,r().createElement(n.ToolbarContent,null,r().createElement(n.ToolbarGroup,{variant:"filter-group"},r().createElement(n.ToolbarToggleGroup,{breakpoint:"xl",toggleIcon:r().createElement(pe.k1,null)},r().createElement(n.ToolbarItem,null,r().createElement(tt,null)),r().createElement(n.ToolbarItem,null,r().createElement(Xe,null),r().createElement(Ue,null),r().createElement(Ye,null))),r().createElement(n.ToolbarItem,null,r().createElement(Ze,null))),r().createElement(n.ToolbarItem,{variant:n.ToolbarItemVariant.pagination},r().createElement(at,null))));class st extends r().Component{componentDidMount(){this.props.getCostModelsData(this.props.search.slice(1)),this.props.getRbacData(),this.props.getMetricsData()}componentDidUpdate(e){e.search!==this.props.search&&this.props.getCostModelsData(this.props.search.slice(1))}render(){return r().createElement(r().Fragment,null,r().createElement(n.PageSection,{variant:n.PageSectionVariants.light},r().createElement(Le,null)),r().createElement(n.PageSection,{isFilled:!0},r().createElement(Pe,null),r().createElement(Oe,null),r().createElement(nt,null),r().createElement(qe,null),r().createElement(h,null)))}}const rt=(0,l.connect)(((e,t)=>({search:t.location.search})),(e=>({getCostModelsData:t=>o.F0.fetchCostModels(t)(e),getRbacData:()=>c.O9.fetchRbac()(e),getMetricsData:()=>i.Wg.fetchMetrics()(e)})))(st)}}]);
//# sourceMappingURL=a7c7bedbc42bdad42e18.bundle.js.map