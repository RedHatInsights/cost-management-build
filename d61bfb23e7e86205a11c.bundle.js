(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{127:function(e,t,a){"use strict";a.r(t),function(e){var r=a(46),s=a(504);t.default=Object(r.hot)(e)(s.a)}.call(this,a(45)(e))},156:function(e,t,a){"use strict";a.d(t,"a",function(){return r}),a.d(t,"b",function(){return s});const r=e=>({"data-testid":e}),s={details:{historical_data_btn:"historical-data-btn",tag_lnk:"tag-lnk",show_more_btn:"show-more-btn"},export:{cancel_btn:"cancel-btn",submit_btn:"submit-btn"},login:{alert:"alert",form:"login-form",username_input:"username-input",password_input:"password-input",submit:"submit"},masthead:{masthead:"masthead",username:"username",sidebarToggle:"sidebar-toggle",logout:"logout"},providers:{add_btn:"add-btn",bucket_input:"bucket-input",cancel_btn:"cancel-btn",empty_state_add_btn:"empty_state_add-btn",name_input:"provider-name-input",resource_name_input:"provider-resource-name-input",cluster_id_input:"provider-cluster-id-input",submit_btn:"submit-btn",type_input:"provider-type-input"},sidebar:{nav:"vertical-nav",link:"vertical-nav-link",backdrop:"sidebar-backdrop"}}},227:function(e,t,a){"use strict";var r=a(705),s=a(1),n=a.n(s);let l=0;class i extends n.a.Component{constructor(){super(...arguments),this.id=`${this.props.prefix}${l++}`}render(){return this.props.children({id:this.id})}}i.defaultProps={prefix:"random-id-"};var o=a(130);const c=r.a.create({formGroup:{marginBottom:o.C.value},label:{display:"block",fontWeight:o.s.value,paddingBottom:o.I.value}}),d=({label:e,children:t})=>n.a.createElement(i,{prefix:e},({id:a})=>n.a.createElement("div",{className:Object(r.b)(c.formGroup)},n.a.createElement("label",{className:Object(r.b)(c.label),htmlFor:a},e),n.a.createElement("div",null,n.a.cloneElement(n.a.Children.only(t),{id:a}))));a.d(t,"a",function(){return d})},504:function(e,t,a){"use strict";var r=a(673),s=a(695),n=a(679),l=a(681),i=a(696),o=a(705),c=a(227),d=a(3),u=a(1),p=a.n(u),b=a(33),h=a(26),m=a(42),v=a(10),_=a(22),g=a(156),O=a(694);var f=e=>p.a.createElement(c.a,{label:e.label},p.a.createElement(O.a,Object.assign({"aria-label":`input-${e.label}`},e.testProps,{autoFocus:Boolean(e.autoFocus),isValid:!Boolean(e.error),onChange:e.onChange,placeholder:e.placeholder,value:e.value}))),P=a(130);const k=o.a.create({alert:{marginBottom:P.H.value},docs:{marginBottom:P.H.value},modal:{width:"700px"}}),j={name:(e,t)=>new RegExp("^.?").test(e)?null:t("providers.name_error"),bucket:(e,t)=>new RegExp("^[a-zA-Z0-9.\\-_]{0,255}$").test(e)?null:t("providers.bucket_error"),resourceName:(e,t)=>{let a;return 0!==(a=e.length>="arn:aws:".length?e.indexOf("arn:aws:"):"arn:aws:".indexOf(e))?t("providers.resource_name_error"):null},clusterID:(e,t)=>new RegExp("^.?").test(e)?null:t("providers.name_error")};t.a=Object(h.b)(Object(m.a)(e=>({isProviderModalOpen:_.c.selectIsProvidersModalOpen(e),error:v.e.selectAddProviderError(e),fetchStatus:v.e.selectAddProviderFetchStatus(e)})),{addProvider:v.c.addProvider,clearProviderFailure:v.c.clearProviderFailure,closeProvidersModal:_.a.closeProvidersModal})(Object(b.c)()(class extends p.a.Component{constructor(){super(...arguments),this.defaultState={name:{id:"name",label:"providers.name_label",placeholder:"HCCM",testProps:Object(g.a)(g.b.providers.name_input),value:"",error:null,autoFocus:!0},bucket:{id:"bucket",label:"providers.bucket_label",placeholder:"cost-usage-bucket",testProps:Object(g.a)(g.b.providers.bucket_input),value:"",error:null},resourceName:{id:"resourceName",label:"providers.resource_name_label",testProps:Object(g.a)(g.b.providers.resource_name_input),placeholder:"arn:aws:iam::589173575009:role/CostManagement",value:"",error:null},clusterID:{id:"clusterID",label:"providers.cluster_id_label",testProps:Object(g.a)(g.b.providers.cluster_id_input),placeholder:"OCP-CostManagement",value:"",error:null},type:"AWS"},this.state=Object.assign({},this.defaultState),this.handleAddProvider=(()=>{switch(this.state.type){case"AWS":return this.props.addProvider({name:this.state.name.value,type:this.state.type,authentication:{provider_resource_name:this.state.resourceName.value},billing_source:{bucket:this.state.bucket.value}});case"OCP":return this.props.addProvider({name:this.state.name.value,type:this.state.type,authentication:{provider_resource_name:this.state.clusterID.value}})}}),this.handleCancel=(()=>{this.props.closeProvidersModal()}),this.handleChange=((e,t)=>a=>{const{t:r}=this.props;this.setState(()=>Object.assign({},this.state,{[t.id]:Object.assign({},t,{value:a,error:e(a,r)})})),this.props.clearProviderFailure()}),this.handleSelect=(e=>{this.setState(Object.assign({},this.defaultState,{type:e})),this.props.clearProviderFailure()}),this.attributes=(()=>{switch(this.state.type){case"AWS":return[this.state.name,this.state.bucket,this.state.resourceName];case"OCP":return[this.state.name,this.state.clusterID];default:return[]}})}componentDidUpdate(e){const{isProviderModalOpen:t}=this.props;t&&!e.isProviderModalOpen&&this.setState(Object.assign({},this.defaultState))}render(){const{t:e,error:t}=this.props,a=this.attributes().some(e=>0===e.value.trim().length),u=this.attributes().find(e=>null!==e.error);let b=e("providers.default_error");if(t&&t.response&&t.response.data&&t.response.data.errors&&1===t.response.data.errors.length){const e=t.response.data.errors[0];e.detail&&(b=e.detail)}return p.a.createElement(l.a,{className:Object(o.b)(k.modal),isLarge:!0,isOpen:this.props.isProviderModalOpen,onClose:this.handleCancel,title:e("providers.add_source"),actions:[p.a.createElement(r.c,Object.assign({},Object(g.a)(g.b.providers.cancel_btn),{key:"cancel",onClick:this.handleCancel,variant:r.b.secondary}),e("providers.cancel")),p.a.createElement(r.c,Object.assign({},Object(g.a)(g.b.providers.submit_btn),{key:"confirm",isDisabled:a||Boolean(u)||1===this.props.fetchStatus,onClick:this.handleAddProvider,variant:r.b.primary}),e("providers.confirm"))]},Boolean(t||u)&&p.a.createElement("div",{className:Object(o.b)(k.alert)},p.a.createElement(n.b,Object.assign({},Object(g.a)(g.b.login.alert),{variant:n.a.danger,title:u&&u.error||b}))),p.a.createElement("p",{className:Object(o.b)(k.docs)},"View the"," ",p.a.createElement("a",{href:"https://koku.readthedocs.io/en/latest/providers.html#adding-an-aws-account",target:"_blank"},"Koku documentation")," ","and learn how to configure your AWS account to allow Koku access."),p.a.createElement(c.a,{label:e("providers.type_label")},p.a.createElement(i.a,{value:this.state.type,"aria-label":"provider type selector",onBlur:d.d,onFocus:d.d,onChange:this.handleSelect},p.a.createElement(s.a,{label:"AWS",value:"AWS"}),p.a.createElement(s.a,{label:"OCP",value:"OCP"}))),this.attributes().map(t=>p.a.createElement(f,{key:`attribute-field-${t.id}`,value:t.value,label:e(t.label),testProps:t.testProps,placeholder:t.placeholder,error:t.error,onChange:this.handleChange(j[t.id],t)})))}}))}}]);
//# sourceMappingURL=d61bfb23e7e86205a11c.bundle.js.map