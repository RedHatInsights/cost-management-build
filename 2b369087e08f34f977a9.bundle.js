(self.webpackChunkkoku_ui=self.webpackChunkkoku_ui||[]).push([[6156,8446],{20167:(e,t,a)=>{"use strict";a.d(t,{Z:()=>u});var r=a(97522),s=a.n(r),l=a(9947),n=a(38424),i=a(75106),c=a(60485),o=a(43047);const u=function(){return s().createElement(l.u,{variant:l.I.large,className:"ins-c-empty-state__unavailable pf-m-redhat-font"},s().createElement(n.k,{icon:o.ZP}),s().createElement(c.D,{headingLevel:"h5",size:"lg"},"This page is temporarily unavailable"),s().createElement(i.B,null,"Try refreshing the page. If the problem persists, contact your organization administrator or visit our",s().createElement("a",{href:"https://status.redhat.com/",target:"_blank",rel:"noopener noreferrer"}," status page")," for known outages."))}},18446:(e,t,a)=>{var r=a(90939);e.exports=function(e,t){return r(e,t)}},28368:(e,t,a)=>{var r=a(90939);e.exports=function(e,t,a){var s=(a="function"==typeof a?a:void 0)?a(e,t):void 0;return void 0===s?r(e,t,void 0,a):!!s}},30236:(e,t,a)=>{var r=a(42980),s=a(21463)((function(e,t,a,s){r(e,t,a,s)}));e.exports=s},51508:(e,t,a)=>{"use strict";a.d(t,{l:()=>n});var r=a(83115),s=a(97522),l=a.n(s);const n=e=>{var{children:t}=e,a=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(a[r[s]]=e[r[s]])}return a}(e,["children"]);return l().createElement(r.l,Object.assign({onSubmit:e=>e.preventDefault()},a),t)}},27916:(e,t,a)=>{"use strict";a.d(t,{Bu:()=>f,fv:()=>y});var r=a(9947),s=a(38424),l=a(60485),n=a(75106),i=a(49739),c=a(83826),o=a(47173),u=a(84564),g=a(7193),d=a(97522),m=a.n(d),p=a(57827),_=a(86588),b=a(62226);const v=({variant:e,actionButton:t,title:a,description:o})=>m().createElement(r.u,{variant:e},m().createElement(s.k,{icon:u.$O,color:g.ZP.value}),m().createElement(l.D,{headingLevel:"h4",size:"lg"},a),m().createElement(n.B,null,m().createElement(i.K,null,m().createElement(c.v,null,o))),t),f=({onRefresh:e})=>{const{t}=(0,p.useTranslation)(),a=t("cost_models_wizard.source.error.title"),s=m().createElement(p.Trans,{i18nKey:"cost_models_wizard.source.error.desc"},m().createElement("a",{href:t("status_url"),rel:"noreferrer",target:"_blank"})),n=m().createElement(o.zx,{onClick:e},t("cost_models_details.assign_sources_error_action_button"));return m().createElement(i.K,{hasGutter:!0},m().createElement(c.v,null,m().createElement(l.D,{headingLevel:"h2",size:"xl"},t("cost_models_wizard.source.title"))),m().createElement(c.v,null,m().createElement(v,{variant:r.I.large,actionButton:n,description:s,title:a})))},y=(0,_.connect)((e=>({query:b.vc.query(e)})),(e=>({fetch:t=>b.lk.fetchSources(t)(e)})),((e,t)=>{const{query:a}=e,{fetch:r}=t,s=Object.keys(a).reduce(((e,t)=>null===a[t]?e:""===e?`${t}=${a[t]}`:`${e}&${t}=${a[t]}`),"");return{onRefresh:()=>r(s)}}))((({onRefresh:e})=>{const{t}=(0,p.useTranslation)(),a=t("cost_models_details.assign_sources_error_title"),s=m().createElement(p.Trans,{i18nKey:"cost_models_details.assign_sources_error_desc"},m().createElement("a",{href:t("status_url"),rel:"noreferrer",target:"_blank"})),l=m().createElement(o.zx,{onClick:e},t("cost_models_details.assign_sources_error_action_button"));return m().createElement(v,{variant:r.I.large,actionButton:l,description:s,title:a})}))},10209:(e,t,a)=>{"use strict";a.d(t,{xZ:()=>r,fg:()=>s});const r=e=>(t,a)=>Object.assign(Object.assign({},e),{[t]:e[t]?[...e[t],a]:[a]}),s=e=>(t,a)=>{if(void 0===e[t])return e;const r=e[t].filter((e=>e!==a));return 0===r.length?Object.keys(e).reduce(((a,r)=>r===t?a:Object.assign(Object.assign({},a),{[r]:e[r]})),{}):Object.assign(Object.assign({},e),{[t]:r})}},77656:(e,t,a)=>{"use strict";a.d(t,{j:()=>n});const r=(e,t)=>e.filter((e=>e!==t));var s=a(97522),l=a.n(s);class n extends l().Component{constructor(e){super(e),this.state={filters:this.props.initialFilters},this.handleChange=this.handleChange.bind(this),this.onRemove=this.onRemove.bind(this),this.onSelect=this.onSelect.bind(this),this.onClearAll=this.onClearAll.bind(this)}handleChange(e){this.setState({filters:Object.assign(Object.assign({},this.state.filters),e)})}onClearAll(){this.setState({filters:Object.assign(Object.assign({},this.state.filters),{metrics:[],measurements:[]})})}onRemove(e,t){this.setState({filters:Object.assign(Object.assign({},this.state.filters),{[e]:r(this.state.filters[e],t)})})}onSelect(e,t){var a,s;this.setState({filters:Object.assign(Object.assign({},this.state.filters),{[e]:(a=this.state.filters[e],s=t,a.includes(s)?r(a,s):[...a,s])})})}render(){return this.props.children({onClearAll:this.onClearAll,onRemove:this.onRemove,onSelect:this.onSelect,setSearch:this.handleChange,search:this.state.filters})}}},95507:(e,t,a)=>{"use strict";a.d(t,{j:()=>n});var r=a(97522),s=a.n(r),l=a(47235);class n extends s().Component{constructor(e){super(e),this.service=null,this.service=(0,l.interpret)(e.machine).onTransition((e=>this.setState({current:e}))),this.state={current:e.machine.initialState}}componentDidMount(){this.service.start()}componentWillUnmount(){this.service.stop()}render(){const{current:e}=this.state,{send:t}=this.service;return this.props.children({current:e,send:t})}}},18728:(e,t,a)=>{"use strict";a.d(t,{q:()=>r});const r=(0,a(47235).Machine)({context:{selection:[]},initial:"collapsed",states:{collapsed:{on:{TOGGLE:"expanded"}},expanded:{on:{TOGGLE:"collapsed",SELECT:{target:"collapsed",actions:["assignSelection"]}}}}})},80963:(e,t,a)=>{"use strict";a.d(t,{N:()=>u,Z:()=>g});var r=a(84812),s=a(78919),l=a(1595),n=a(35472),i=a(97522),c=a.n(i),o=a(57827);const u=e=>c().createElement(o.Translation,null,(t=>{const a=((e,t)=>Object.assign(Object.assign({},t),{"aria-label":e(t["aria-label"])}))(t,e),{id:i,"aria-label":o,itemCount:u,perPage:g,page:d,variant:m,onPerPageSelect:p,onSetPage:_}=a;return c().createElement(r.o,{id:i},c().createElement(s.c,{"aria-label":o},c().createElement(l.E,{variant:"pagination"},c().createElement(n.t,{variant:m,itemCount:u,perPage:g,page:d,onSetPage:_,onPerPageSelect:p}))))})),g=u},66555:(e,t,a)=>{"use strict";a.d(t,{Q:()=>g});var r=a(84812),s=a(78919),l=a(33109),n=a(1595),i=a(35248),c=a(97522),o=a.n(c);const u={toolbar:{gridGap:a(32412).ZP.value}},g=({primary:e,secondaries:t,pagination:a,button:c,onClear:g,selected:d})=>o().createElement(r.o,{style:u.toolbar,clearAllFilters:g,id:"price-list-toolbar"},o().createElement(s.c,null,o().createElement(l.k,{variant:"filter-group"},o().createElement(n.E,null,e),t.map((e=>o().createElement(n.E,{key:e.name},o().createElement(i.p,{deleteChip:e.onRemove,chips:e.filters,categoryName:e.name},d===e.name?e.component:""))))),o().createElement(n.E,null,c),o().createElement(n.E,{variant:n.A.pagination},a)),o().createElement("hr",{className:"pf-c-divider"}))},76427:(e,t,a)=>{"use strict";a.d(t,{u:()=>r});const r={duplicate:"cost_models.add_rate_form.duplicate",required:"cost_models.required_field",not_number:"cost_models.add_rate_form.not_number",not_positive:"cost_models.add_rate_form.not_positive",description_too_long:"cost_models.description_too_long",tag_too_long:"cost_models.add_rate_form.tag_too_long"}},35842:(e,t,a)=>{"use strict";a.d(t,{HJ:()=>k,Cw:()=>A,Pz:()=>r.Pz,uD:()=>P,L3:()=>r.L3,Nl:()=>r.Nl,bF:()=>c});var r=a(96085),s=a(97522),l=a.n(s),n=a(76427);function i(e=r.Pv,t){switch(t.type){case"UPDATE_DESCRIPTION":return Object.assign(Object.assign({},e),{description:t.value,errors:Object.assign(Object.assign({},e.errors),{description:(0,r.zp)(t.value)})});case"UPDATE_METRIC":{const a=e.errors,s=e.measurement;s.isDirty&&(s.value="",a.measurement=n.u.required);let l=e.step;"initial"===l&&(l="set_metric");const i=Object.assign(Object.assign({},e),{metric:t.value,measurement:s,errors:a,step:l,calculation:t.defaultCalculation,rateKind:"Cluster"===t.value?"regular":e.rateKind}),c=(0,r.cQ)(i),o=i.otherTiers.find((e=>(0,r.lI)((0,r.Um)(e),c)));return Object.assign(Object.assign({},i),{errors:Object.assign(Object.assign({},i.errors),{tagKey:o?n.u.duplicate:null})})}case"UPDATE_MEASUREMENT":{if("initial"===e.step)return e;let a=e.step;"set_metric"===a&&(a="set_rate");const s=Object.assign(Object.assign({},e),{measurement:{value:t.value,isDirty:!0},errors:Object.assign(Object.assign({},e.errors),{measurement:null}),step:a}),l=(0,r.cQ)(s),i=s.otherTiers.find((e=>(0,r.lI)((0,r.Um)(e),l)));return Object.assign(Object.assign({},s),{errors:Object.assign(Object.assign({},s.errors),{tagKey:i?n.u.duplicate:null})})}case"UPDATE_CALCULATION":{if("set_rate"!==e.step)return e;const a=Object.assign(Object.assign({},e),{calculation:t.value}),s=(0,r.cQ)(a),l=a.otherTiers.find((e=>(0,r.lI)((0,r.Um)(e),s)));return Object.assign(Object.assign({},a),{errors:Object.assign(Object.assign({},a.errors),{tagKey:l?n.u.duplicate:null})})}case"TOGGLE_RATE_KIND":return"set_rate"!==e.step?e:Object.assign(Object.assign({},e),{rateKind:"regular"===e.rateKind?"tagging":"regular"});case"UPDATE_REGULAR":return Object.assign(Object.assign({},e),{tieredRates:[{value:t.value,isDirty:!0}],errors:Object.assign(Object.assign({},e.errors),{tieredRates:(0,r.MD)(t.value)})});case"UPDATE_TAG_KEY":{if("set_rate"!==e.step||"tagging"!==e.rateKind)return e;const a=Object.assign(Object.assign({},e),{taggingRates:Object.assign(Object.assign({},e.taggingRates),{tagKey:{value:t.value,isDirty:!0}}),errors:Object.assign(Object.assign({},e.errors),{tagKey:(0,r.eU)(t.value)})}),s=(0,r.cQ)(a),l=a.otherTiers.find((e=>(0,r.lI)((0,r.Um)(e),s)));return Object.assign(Object.assign({},a),{errors:Object.assign(Object.assign({},a.errors),{tagKey:l?n.u.duplicate:a.errors.tagKey})})}case"UPDATE_TAG_DEFAULT":return"set_rate"!==e.step&&"tagging"!==e.rateKind?e:Object.assign(Object.assign({},e),{taggingRates:Object.assign(Object.assign({},e.taggingRates),{defaultTag:e.taggingRates.defaultTag===t.index?null:t.index})});case"UPDATE_TAG":{if("set_rate"!==e.step||"tagging"!==e.rateKind)return e;let a=e.errors.tagValues[t.index],s=e.errors.tagValueValues[t.index],l=e.errors.tagDescription[t.index],n=e.taggingRates.tagValues[t.index].isDirty,i=e.taggingRates.tagValues[t.index].isTagValueDirty;if(void 0!==t.payload.value){const{value:e}=t.payload;a=(0,r.MD)(e),n=!0}return void 0!==t.payload.tagValue&&(s=(0,r.eU)(t.payload.tagValue),i=!0),void 0!==t.payload.description&&(l=(0,r.zp)(t.payload.description)),Object.assign(Object.assign({},e),{taggingRates:Object.assign(Object.assign({},e.taggingRates),{tagValues:[...e.taggingRates.tagValues.slice(0,t.index),Object.assign(Object.assign(Object.assign({},e.taggingRates.tagValues[t.index]),t.payload),{isDirty:n,isTagValueDirty:i}),...e.taggingRates.tagValues.slice(t.index+1)]}),errors:Object.assign(Object.assign({},e.errors),{tagDescription:[...e.errors.tagDescription.slice(0,t.index),l,...e.errors.tagDescription.slice(t.index+1)],tagValueValues:[...e.errors.tagValueValues.slice(0,t.index),s,...e.errors.tagValueValues.slice(t.index+1)],tagValues:[...e.errors.tagValues.slice(0,t.index),a,...e.errors.tagValues.slice(t.index+1)]})})}case"REMOVE_TAG":return"set_rate"!==e.step||"tagging"!==e.rateKind?e:Object.assign(Object.assign({},e),{errors:Object.assign(Object.assign({},e.errors),{tagValues:[...e.errors.tagValues.slice(0,t.index),...e.errors.tagValues.slice(t.index+1)],tagValueValues:[...e.errors.tagValueValues.slice(0,t.index),...e.errors.tagValueValues.slice(t.index+1)]}),taggingRates:Object.assign(Object.assign({},e.taggingRates),{defaultTag:e.taggingRates.defaultTag===t.index?null:e.taggingRates.defaultTag>t.index?e.taggingRates.defaultTag-1:e.taggingRates.defaultTag,tagValues:[...e.taggingRates.tagValues.slice(0,t.index),...e.taggingRates.tagValues.slice(t.index+1)]})});case"ADD_TAG":return"set_rate"!==e.step||"tagging"!==e.rateKind?e:Object.assign(Object.assign({},e),{errors:Object.assign(Object.assign({},e.errors),{tagValues:[...e.errors.tagValues,n.u.required],tagDescription:[...e.errors.tagDescription,null]}),taggingRates:Object.assign(Object.assign({},e.taggingRates),{tagValues:[...e.taggingRates.tagValues,Object.assign({},r.fP.tagValues[0])]})});case"RESET_FORM":return t.payload;default:return e}}function c(e,t,a=[]){const s=(0,r.Pz)(t,void 0,a),[n,c]=l().useReducer(i,s);return Object.assign(Object.assign({},n),{reset:e=>c({type:"RESET_FORM",payload:e}),setDescription:e=>c({type:"UPDATE_DESCRIPTION",value:e}),setMetric:t=>c({type:"UPDATE_METRIC",value:t,defaultCalculation:(0,r.Bk)(e,t)}),setMeasurement:e=>c({type:"UPDATE_MEASUREMENT",value:e}),setCalculation:e=>c({type:"UPDATE_CALCULATION",value:e}),setRegular:e=>c({type:"UPDATE_REGULAR",value:e}),toggleTaggingRate:()=>c({type:"TOGGLE_RATE_KIND"}),setTagKey:e=>c({type:"UPDATE_TAG_KEY",value:e}),removeTag:e=>c({type:"REMOVE_TAG",index:e}),addTag:()=>c({type:"ADD_TAG"}),updateTag:(e,t)=>c({type:"UPDATE_TAG",index:t,payload:e}),updateDefaultTag:e=>c({type:"UPDATE_TAG_DEFAULT",index:e})})}var o=a(50693),u=a(16475),g=a(43627),d=a(92504),m=a(13946),p=a(47173),_=a(20777),b=a(65802),v=a(46836),f=a(92607),y=a(85111),h=a(57827);const E=({fieldId:e,label:t="cost_models.rate",helperTextInvalid:a="cost_models.add_rate_form.error_message",style:r,validated:s,value:n,onChange:i,onBlur:c})=>{const{t:o}=(0,h.useTranslation)(),u=o(a),d=o(t);return l().createElement(g.c,{isRequired:!0,style:r,label:d,fieldId:e,helperTextInvalid:u,validated:s},l().createElement(b.B,null,l().createElement(v.O,null,l().createElement(y.bk,null)),l().createElement(f.oi,{onBlur:c,isRequired:!0,type:"text","aria-label":`rate input ${e}`,id:e,placeholder:"0.00",value:n,onChange:i,validated:s})))};var O=a(90784),T=a(22608);const j=e=>{const{t}=(0,h.useTranslation)(),{"aria-label":a,label:r,id:s,value:n,onChange:i,options:c,helperTextInvalid:o,isDisabled:u=!1,isInvalid:d=!1,isRequired:m=!1,style:p}=((e,t)=>Object.assign(Object.assign({},t),{label:"string"==typeof t.label?e(t.label):t.label,helperTextInvalid:"string"==typeof t.helperTextInvalid?e(t.helperTextInvalid):t.helperTextInvalid,options:t.options.map((t=>Object.assign(Object.assign({},t),{label:e(t.label)})))}))(t,e);return l().createElement(g.c,{isRequired:m,style:p,label:r,fieldId:s,helperTextInvalid:o,validated:d?"error":"default"},l().createElement(O.i,{isRequired:m,isDisabled:u,value:n,onChange:i,"aria-label":a,id:s,validated:d?"error":"default"},c.map((e=>l().createElement(T.j,{key:`${e.value}`,value:e.value,label:e.label,isDisabled:e.isDisabled})))))},D=e=>{const{t}=(0,h.useTranslation)(),{onChange:a,value:r,id:s,label:n,style:i,helperTextInvalid:c,validated:o,onBlur:u,isRequired:d,placeholder:m}=((e,t)=>{let a=t.label;"string"==typeof t.label&&(a=e(t.label));let r=t.helperTextInvalid;return"string"==typeof t.helperTextInvalid&&(r=e(t.helperTextInvalid)),Object.assign(Object.assign({},t),{label:a,helperTextInvalid:r})})(t,e);return l().createElement(g.c,{isRequired:d,style:i,fieldId:s,label:n,helperTextInvalid:c,validated:o},l().createElement(f.oi,{validated:o,value:r,onChange:a,id:s,onBlur:u,isRequired:d,placeholder:m}))};var R=a(79851),V=a(34512),x=a(93149),C=a(70710);const I=({tagValues:e,updateDefaultTag:t,defaultTag:a,updateTag:r,removeTag:s,errors:n})=>{const{t:i}=(0,h.useTranslation)(),c={width:"200px"},o={height:"100%",position:"relative",top:"50%"};return l().createElement(l().Fragment,null,e.map(((u,d)=>l().createElement(R.P,{hasGutter:!0,key:d},l().createElement(V.J,{style:o},"="),l().createElement(V.J,null,l().createElement(D,{isRequired:!0,style:c,id:`tagValue_${d}`,label:"cost_models.tag_value",placeholder:i("cost_models.add_rate_form.enter_a_tag_value"),value:u.tagValue,onChange:e=>r({tagValue:e},d),validated:e[d].isTagValueDirty&&n.tagValueValues[d]?"error":"default",helperTextInvalid:n.tagValueValues[d]})),l().createElement(V.J,null,l().createElement(E,{style:c,fieldId:`rate_${d}`,validated:e[d].isDirty&&n.tagValues[d]?"error":"default",value:u.value,onChange:e=>r({value:e},d),helperTextInvalid:n.tagValues[d]})),l().createElement(V.J,null,l().createElement(D,{style:c,id:`desc_${d}`,label:"description",validated:n.tagDescription[d]?"error":"default",value:u.description,onChange:e=>r({description:e},d),helperTextInvalid:n.tagDescription[d]})),l().createElement(V.J,null,l().createElement(g.c,{fieldId:`isDefault_${d}`,label:i("cost_models.default")},l().createElement(x.X,{id:`isDefault_${d}`,isChecked:a===d,onChange:()=>t(d)}))),l().createElement(V.J,null,l().createElement(g.c,{fieldId:"__irrelevant",label:l().createElement("div",null,"Â ")},l().createElement(p.zx,{"data-testid":`remove_tag_${d}`,variant:p.Wu.plain,isDisabled:1===e.length,onClick:()=>s(d)},l().createElement(C.$_,null))))))))},k=({metricsHash:e,rateFormData:t})=>{const{t:a}=(0,h.useTranslation)(),{step:r,description:s,metric:n,measurement:{value:i,isDirty:c},calculation:b,rateKind:v,taggingRates:{tagKey:{value:f,isDirty:y},defaultTag:O,tagValues:T},tieredRates:{0:{value:R,isDirty:V}},setDescription:x,setMetric:C,setMeasurement:k,setCalculation:A,setRegular:P,toggleTaggingRate:K,setTagKey:S,updateTag:U,updateDefaultTag:q,removeTag:G,addTag:L,errors:N}=t,$=l().useMemo((()=>Object.keys(e)),[e]),w=l().useMemo((()=>$.includes(n)?Object.keys(e[n]):[]),[$,n]),M={width:"360px"};return l().createElement(l().Fragment,null,l().createElement(D,{style:M,id:"description",label:"description",value:s,validated:N.description?"error":"default",helperTextInvalid:N.description,onChange:x}),l().createElement(o.r,{hasGutter:!0},l().createElement(u.P,{span:6},l().createElement(j,{isRequired:!0,style:M,id:"metric",label:"cost_models.add_rate_form.metric_select",value:n,onChange:C,options:[{label:"cost_models.add_rate_form.default_option",value:"",isDisabled:!0},...$.map((e=>({label:e,value:e,isDisabled:!1})))]})),"initial"===r?null:l().createElement(u.P,{span:6},l().createElement(j,{isRequired:!0,helperTextInvalid:N.measurement,isInvalid:N.measurement&&c,style:M,id:"measurement",label:"cost_models.add_rate_form.measurement_select",value:i,onChange:k,options:[{label:"cost_models.add_rate_form.default_option",value:"",isDisabled:!0},...w.map((t=>({label:`${t} (${e[n][t].label_measurement_unit})`,value:t,isDisabled:!1})))]}))),"set_rate"===r?l().createElement(l().Fragment,null,l().createElement(l().Fragment,null,l().createElement(g.c,{isInline:!0,style:M,fieldId:"calculation",label:a("cost_models.calculation_type")},l().createElement(d.Y,{name:"calculation",id:"calculation_infra",label:a("cost_models.add_rate_form.infrastructure"),isChecked:"Infrastructure"===b,onChange:()=>A("Infrastructure")}),l().createElement(d.Y,{name:"calculation",id:"calculation_suppl",label:a("cost_models.add_rate_form.supplementary"),isChecked:"Supplementary"===b,onChange:()=>A("Supplementary")})),"Cluster"!==n?l().createElement(m.r,{"aria-label":"Enter rate by tag",label:a("cost_models.add_rate_form.rate_switch"),isChecked:"tagging"===v,onChange:K}):null),"regular"===v?l().createElement(E,{style:M,helperTextInvalid:N.tieredRates,validated:N.tieredRates&&V?"error":"default",value:R,onChange:P,fieldId:"regular-rate"}):l().createElement(l().Fragment,null,l().createElement(D,{isRequired:!0,style:M,value:f,onChange:S,id:"tag-key",label:a("cost_models.add_rate_form.tag_key"),placeholder:a("cost_models.add_rate_form.enter_a_tag_key"),validated:N.tagKey&&y?"error":"default",helperTextInvalid:N.tagKey}),l().createElement(I,{errors:{tagValues:N.tagValues,tagValueValues:N.tagValueValues,tagDescription:N.tagDescription},updateDefaultTag:q,defaultTag:O,tagValues:T,updateTag:U,removeTag:G}),l().createElement(p.zx,{"data-testid":"add_more",style:{paddingLeft:"0",textAlign:"left"},variant:p.Wu.link,onClick:L},l().createElement(_.wl,null)," ",a("cost_models.add_rate_form.add_more_tag_values")))):null)};function A(e){return"tagging"===e.rateKind?null===e.errors.description&&null===e.errors.measurement&&e.errors.tagValues.every((e=>null===e))&&e.errors.tagValueValues.every((e=>null===e))&&e.errors.tagDescription.every((e=>null===e))&&null===e.errors.tagKey:null===e.errors.description&&null===e.errors.measurement&&null===e.errors.tieredRates}function P(e,t){if(!e)return!0;if(e.description!==t.description)return!0;if(e.metric.label_metric!==t.metric)return!0;if(e.metric.label_measurement!==t.measurement.value)return!0;if(e.cost_type!==t.calculation)return!0;const a=e.tiered_rates?"regular":"tagging";if(a!==t.rateKind)return!0;if("regular"===a&&e.tiered_rates[0].value!==Number(t.tieredRates[0].value))return!0;if("tagging"===a){const a=e.tag_rates;if(a.tag_key!==t.taggingRates.tagKey.value)return!0;if(a.tag_values.length!==t.taggingRates.tagValues.length)return!0;if(a.tag_values.some(((e,a)=>{const r=t.taggingRates.tagValues[a],s=t.taggingRates.defaultTag===a;return e.tag_value!==r.tagValue||e.value!==Number(r.value)||e.description!==r.description||e.default!==s})))return!0}return!1}},96085:(e,t,a)=>{"use strict";a.d(t,{fP:()=>l,Pv:()=>n,MD:()=>i,Bk:()=>c,Pz:()=>o,L3:()=>u,Nl:()=>g,Um:()=>d,cQ:()=>m,lI:()=>p,tT:()=>_,zp:()=>b,eU:()=>v});var r=a(38800),s=a(76427);const l={tagKey:{value:"",isDirty:!1},defaultTag:null,tagValues:[{tagValue:"",value:"",description:"",isDirty:!1,isTagValueDirty:!1}]},n={otherTiers:[],step:"initial",description:"",metric:"",measurement:{value:"",isDirty:!1},calculation:"",rateKind:"regular",tieredRates:[{value:"",isDirty:!1}],taggingRates:Object.assign({},l),errors:{description:null,measurement:s.u.required,tieredRates:s.u.required,tagValues:[s.u.required],tagDescription:[null],tagKey:s.u.required,tagValueValues:[s.u.required]}},i=e=>0===e.length?s.u.required:isNaN(Number(e))?s.u.not_number:Number(e)<0?s.u.not_positive:null;function c(e,t){let a=Object.keys(e);return a.includes(t)?(a=Object.keys(e[t]),0===a.length?"":e[t][a[0]].default_cost_type):""}function o(e,t=n,a){const r=a||t.otherTiers;if(!e)return Object.assign(Object.assign({},t),{otherTiers:r});const i=e.tiered_rates?"regular":"tagging";let c=[{value:"",isDirty:!0}];const o=Object.assign({},l),u={description:null,measurement:null,tieredRates:null,tagValues:[null],tagKey:null,tagValueValues:[null],tagDescription:[null]};if("tagging"===i){const t=e.tag_rates;o.tagKey={value:t.tag_key,isDirty:!0};const a=t.tag_values.findIndex((e=>e.default));o.defaultTag=-1===a?null:a,o.tagValues=t.tag_values.map((e=>({tagValue:e.tag_value,value:e.value.toString(),description:e.description,isDirty:!1,isTagValueDirty:!1}))),u.tieredRates=s.u.required,u.tagValueValues=new Array(t.tag_values.length).fill(null),u.tagValues=new Array(t.tag_values.length).fill(null),u.tagDescription=new Array(t.tag_values.length).fill(null)}return"regular"===i&&(c=e.tiered_rates.map((e=>({value:e.value.toString(),isDirty:!0}))),u.tagValues=[s.u.required],u.tagValueValues=[s.u.required]),{otherTiers:r,step:"set_rate",description:e.description,metric:e.metric.label_metric,measurement:{value:e.metric.label_measurement,isDirty:!0},calculation:e.cost_type,rateKind:i,tieredRates:c,taggingRates:o,errors:u}}const u=(e,t,a,r=-1)=>{r<0&&(r=t.rates.length);const s=g(a,e);return{name:t.name,source_type:"OCP",description:t.description,source_uuids:t.sources.map((e=>e.uuid)),markup:{value:t.markup.value,unit:"percent"},rates:[...t.rates.slice(0,r),s,...t.rates.slice(r+1)]}},g=(e,t)=>{const a="tagging"===e.rateKind?"tag_rates":"tiered_rates",r="tagging"===e.rateKind?{tag_key:e.taggingRates.tagKey.value,tag_values:e.taggingRates.tagValues.map(((t,a)=>({tag_value:t.tagValue,unit:"USD",value:Number(t.value),description:t.description,default:a===e.taggingRates.defaultTag})))}:e.tieredRates.map((e=>({value:Number(e.value),unit:"USD",usage:{unit:"USD"}}))),s=t[e.metric][e.measurement.value];return{description:e.description,metric:{metric:s.metric,name:s.metric,label_metric:s.label_metric,label_measurement:s.label_measurement,label_measurement_unit:s.label_measurement_unit,source_type:"OpenShift Cluster Platform",default_cost_type:s.default_cost_type},cost_type:e.calculation,[a]:r}},d=e=>{const t=e.tag_rates&&e.tag_rates.tag_key?e.tag_rates.tag_key:null;return{metric:e.metric.label_metric,measurement:e.metric.label_measurement,tagKey:t,costType:e.cost_type}},m=e=>{const t=e.taggingRates&&e.taggingRates.tagKey?e.taggingRates.tagKey.value:null;return{metric:e.metric,measurement:e.measurement?e.measurement.value:null,tagKey:t,costType:e.calculation}},p=(e,t)=>e.metric===t.metric&&e.measurement===t.measurement&&e.costType===t.costType&&e.tagKey===t.tagKey;function _(e,t,a,s){const l=s(e),n=s(t);return a===r.B.asc?l>n?1:l<n?-1:0:l>n?-1:l<n?1:0}const b=e=>e.length>500?s.u.description_too_long:null,v=e=>0===e.length?s.u.required:e.length>100?s.u.tag_too_long:null},39574:(e,t,a)=>{"use strict";a.d(t,{y:()=>v});var r=a(7732),s=a(56869),l=a(83255),n=a(75863),i=a(6934),c=a(22860),o=a(97522),u=a.n(o),g=a(901),d=a(96085),m=a(84273),p=a(57827);const _=["cost_models.table.tag_key","cost_models.tag_value","cost_models.rate","description","cost_models.default"],b=({tagRates:e})=>{const{t}=(0,p.useTranslation)(),a=((e,t)=>t.map((t=>{const a=t.cells.map((t=>"string"==typeof t?e(t):t));return Object.assign(Object.assign({},t),{cells:a})})))(t,e.tag_values.map(((t,a)=>({cells:[0===a?e.tag_key:"",t.tag_value,(0,g.xG)(t.value),t.description,t.default?"cost_models.yes":"cost_models.no"]}))));return u().createElement(m.T,{"aria-label":`tag-table-rate-${e.tag_key}`,borders:!1,variant:n.B.compact,cells:_,rows:a})},v=({t:e,tiers:t,actions:a,isCompact:o})=>{const[m,p]=u().useState({}),[_,v]=u().useState({}),f=[{title:e("description")},{title:e("cost_models.table.metric"),transforms:[r.p]},{title:e("cost_models.table.measurement"),transforms:[r.p]},{title:e("cost_models.calculation_type")},{title:e("cost_models.rate"),cellTransforms:[s.z]}];let y=0;const h=t.sort(((e,t)=>{const a=1===_.index?e=>e.metric.label_metric:2===_.index?e=>e.metric.label_measurement:()=>"";return(0,d.tT)(e,t,_.direction,a)})).reduce(((t,a,r)=>{const s=a.tiered_rates?"regular":"tagging";let l=[];"tagging"===s&&(l=[{compoundParent:4,parent:r+y,cells:[{title:u().createElement(b,{tagRates:a.tag_rates}),props:{colSpan:6,className:"pf-m-no-padding"}}]}],y+=1);const n="tagging"===s?m[r+y-1]||!1:void 0;return[...t,{data:{index:r,hasChildren:"tagging"===s},cells:[a.description||"",a.metric.label_metric,`${a.metric.label_measurement} (${a.metric.label_measurement_unit})`,a.cost_type,{title:"regular"===s?`${(0,g.xG)(Number(a.tiered_rates[0].value),"USD")}`:e("cost_models.table.tagged_rates"),props:{isOpen:n,style:{padding:"tagging"===s?"":"1.5rem 1rem"}}}]},...l]}),[]);return u().createElement(l.i,{onSort:(e,t,a)=>{v({index:t,direction:a})},sortBy:_,"aria-label":"price list",variant:o?n.B.compact:void 0,rows:h,cells:f,actionResolver:e=>e.compoundParent?[]:a,onExpand:(e,t,a,r)=>{p(Object.assign(Object.assign({},m),{[t]:!r}))}},u().createElement(i.x,null),u().createElement(c.R,null))}},20546:(e,t,a)=>{"use strict";a.d(t,{j:()=>n});var r=a(35224),s=a(97522),l=a.n(s);const n=({children:e,tooltip:t="You have read only permissions",isDisabled:a})=>a?l().createElement(r.u,{isContentLeftAligned:!0,content:l().createElement("div",null,t)},l().createElement("div",null,e)):e},84273:(e,t,a)=>{"use strict";a.d(t,{T:()=>u});var r=a(83255),s=a(75863),l=a(6934),n=a(22860),i=a(97522),c=a.n(i),o=a(57827);const u=e=>{const{t}=(0,o.useTranslation)();return c().createElement(r.i,Object.assign({gridBreakPoint:s.L.grid2xl},((e,t)=>{const a=t.cells.map((t=>"string"==typeof t?e(t):"string"==typeof t.title?Object.assign(Object.assign({},t),{title:e(t.title)}):t)),r=t.actions?t.actions.map((t=>{let a=Object.assign({},t);return"string"==typeof t.title&&(a=Object.assign(Object.assign({},a),{title:e(t.title)})),t.tooltip&&"string"==typeof t.tooltip&&(a=Object.assign(Object.assign({},a),{tooltip:e(t.tooltip)})),a})):null;return Object.assign(Object.assign({},t),{cells:a,actions:r})})(t,e)),c().createElement(l.x,null),c().createElement(n.R,null))}},85218:(e,t,a)=>{"use strict";a.d(t,{n:()=>u});var r=a(1211),s=a(64403),l=a(92694),n=a(95507),i=a(18728),c=a(97522),o=a.n(c);const u=({options:e,placeholderText:t,setSelections:a,selections:c,isDisabled:u})=>o().createElement(n.j,{machine:i.q.withConfig({actions:{assignSelection:(e,t)=>{a(t.selection)}}})},(({send:a,current:n})=>o().createElement(r.P,{isDisabled:u,variant:s.TM.checkbox,placeholderText:t,selections:c,isOpen:n.matches("expanded"),onSelect:(e,t)=>a({type:"SELECT",selection:t}),onToggle:()=>a({type:"TOGGLE"})},e.map((e=>o().createElement(l.$,{key:e.value,value:e.value},e.label))))))},60477:(e,t,a)=>{"use strict";a.d(t,{J:()=>u});var r=a(1211),s=a(92694),l=a(8755),n=a(95507),i=a(18728),c=a(97522),o=a.n(c);const u=({setPrimary:e,primary:t,options:a,isDisabled:c})=>o().createElement(n.j,{machine:i.q.withConfig({actions:{assignSelection:(t,a)=>{e(a.selection)}}})},(({current:e,send:n})=>o().createElement(r.P,{isDisabled:c,toggleIcon:o().createElement(l.k1,null),isOpen:e.matches("expanded"),selections:t,onSelect:(e,t)=>n({type:"SELECT",selection:t}),onToggle:()=>n({type:"TOGGLE"})},a.map((e=>o().createElement(s.$,{key:e.value,value:e.value},e.label))))))},39887:(e,t,a)=>{"use strict";a.d(t,{a:()=>i});var r=a(35224),s=a(50506),l=a(97522),n=a.n(l);const i=({text:e})=>n().createElement(r.u,{content:e,enableFlip:!0},n().createElement(s.T6,{color:"orange"}))}}]);
//# sourceMappingURL=2b369087e08f34f977a9.bundle.js.map